var $jscomp = $jscomp || {};
$jscomp.scope = {};
$jscomp.createTemplateTagFirstArg = function(a) {
    return a.raw = a
}
;
$jscomp.createTemplateTagFirstArgWithRaw = function(a, b) {
    a.raw = b;
    return a
}
;
$jscomp.arrayIteratorImpl = function(a) {
    var b = 0;
    return function() {
        return b < a.length ? {
            done: !1,
            value: a[b++]
        } : {
            done: !0
        }
    }
}
;
$jscomp.arrayIterator = function(a) {
    return {
        next: $jscomp.arrayIteratorImpl(a)
    }
}
;
$jscomp.makeIterator = function(a) {
    var b = "undefined" != typeof Symbol && Symbol.iterator && a[Symbol.iterator];
    return b ? b.call(a) : $jscomp.arrayIterator(a)
}
;
$jscomp.arrayFromIterator = function(a) {
    for (var b, d = []; !(b = a.next()).done; )
        d.push(b.value);
    return d
}
;
$jscomp.arrayFromIterable = function(a) {
    return a instanceof Array ? a : $jscomp.arrayFromIterator($jscomp.makeIterator(a))
}
;
$jscomp.getGlobal = function(a) {
    a = ["object" == typeof globalThis && globalThis, a, "object" == typeof window && window, "object" == typeof self && self, "object" == typeof global && global];
    for (var b = 0; b < a.length; ++b) {
        var d = a[b];
        if (d && d.Math == Math)
            return d
    }
    throw Error("Cannot find global object");
}
;
$jscomp.global = $jscomp.getGlobal(this);
$jscomp.ASSUME_ES5 = !1;
$jscomp.ASSUME_NO_NATIVE_MAP = !1;
$jscomp.ASSUME_NO_NATIVE_SET = !1;
$jscomp.SIMPLE_FROUND_POLYFILL = !1;
$jscomp.ISOLATE_POLYFILLS = !1;
$jscomp.FORCE_POLYFILL_PROMISE = !1;
$jscomp.defineProperty = $jscomp.ASSUME_ES5 || "function" == typeof Object.defineProperties ? Object.defineProperty : function(a, b, d) {
    if (a == Array.prototype || a == Object.prototype)
        return a;
    a[b] = d.value;
    return a
}
;
$jscomp.IS_SYMBOL_NATIVE = "function" === typeof Symbol && "symbol" === typeof Symbol("x");
$jscomp.TRUST_ES6_POLYFILLS = !$jscomp.ISOLATE_POLYFILLS || $jscomp.IS_SYMBOL_NATIVE;
$jscomp.polyfills = {};
$jscomp.propertyToPolyfillSymbol = {};
$jscomp.POLYFILL_PREFIX = "$jscp$";
var $jscomp$lookupPolyfilledValue = function(a, b) {
    var d = $jscomp.propertyToPolyfillSymbol[b];
    if (null == d)
        return a[b];
    d = a[d];
    return void 0 !== d ? d : a[b]
};
$jscomp.polyfill = function(a, b, d, h) {
    b && ($jscomp.ISOLATE_POLYFILLS ? $jscomp.polyfillIsolated(a, b, d, h) : $jscomp.polyfillUnisolated(a, b, d, h))
}
;
$jscomp.polyfillUnisolated = function(a, b, d, h) {
    d = $jscomp.global;
    a = a.split(".");
    for (h = 0; h < a.length - 1; h++) {
        var m = a[h];
        if (!(m in d))
            return;
        d = d[m]
    }
    a = a[a.length - 1];
    h = d[a];
    b = b(h);
    b != h && null != b && $jscomp.defineProperty(d, a, {
        configurable: !0,
        writable: !0,
        value: b
    })
}
;
$jscomp.polyfillIsolated = function(a, b, d, h) {
    var m = a.split(".");
    a = 1 === m.length;
    h = m[0];
    h = !a && h in $jscomp.polyfills ? $jscomp.polyfills : $jscomp.global;
    for (var t = 0; t < m.length - 1; t++) {
        var f = m[t];
        if (!(f in h))
            return;
        h = h[f]
    }
    m = m[m.length - 1];
    d = $jscomp.IS_SYMBOL_NATIVE && "es6" === d ? h[m] : null;
    b = b(d);
    null != b && (a ? $jscomp.defineProperty($jscomp.polyfills, m, {
        configurable: !0,
        writable: !0,
        value: b
    }) : b !== d && ($jscomp.propertyToPolyfillSymbol[m] = $jscomp.IS_SYMBOL_NATIVE ? $jscomp.global.Symbol(m) : $jscomp.POLYFILL_PREFIX + m,
    m = $jscomp.propertyToPolyfillSymbol[m],
    $jscomp.defineProperty(h, m, {
        configurable: !0,
        writable: !0,
        value: b
    })))
}
;
$jscomp.polyfill("Array.from", function(a) {
    return a ? a : function(b, d, h) {
        d = null != d ? d : function(n) {
            return n
        }
        ;
        var m = []
          , t = "undefined" != typeof Symbol && Symbol.iterator && b[Symbol.iterator];
        if ("function" == typeof t) {
            b = t.call(b);
            for (var f = 0; !(t = b.next()).done; )
                m.push(d.call(h, t.value, f++))
        } else
            for (t = b.length,
            f = 0; f < t; f++)
                m.push(d.call(h, b[f], f));
        return m
    }
}, "es6", "es3");
$jscomp.initSymbol = function() {}
;
$jscomp.polyfill("Symbol", function(a) {
    if (a)
        return a;
    var b = function(m, t) {
        this.$jscomp$symbol$id_ = m;
        $jscomp.defineProperty(this, "description", {
            configurable: !0,
            writable: !0,
            value: t
        })
    };
    b.prototype.toString = function() {
        return this.$jscomp$symbol$id_
    }
    ;
    var d = 0
      , h = function(m) {
        if (this instanceof h)
            throw new TypeError("Symbol is not a constructor");
        return new b("jscomp_symbol_" + (m || "") + "_" + d++,m)
    };
    return h
}, "es6", "es3");
$jscomp.initSymbolIterator = function() {}
;
$jscomp.polyfill("Symbol.iterator", function(a) {
    if (a)
        return a;
    a = Symbol("Symbol.iterator");
    for (var b = "Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "), d = 0; d < b.length; d++) {
        var h = $jscomp.global[b[d]];
        "function" === typeof h && "function" != typeof h.prototype[a] && $jscomp.defineProperty(h.prototype, a, {
            configurable: !0,
            writable: !0,
            value: function() {
                return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))
            }
        })
    }
    return a
}, "es6", "es3");
$jscomp.initSymbolAsyncIterator = function() {}
;
$jscomp.iteratorPrototype = function(a) {
    a = {
        next: a
    };
    a[Symbol.iterator] = function() {
        return this
    }
    ;
    return a
}
;
$jscomp.iteratorFromArray = function(a, b) {
    a instanceof String && (a += "");
    var d = 0
      , h = !1
      , m = {
        next: function() {
            if (!h && d < a.length) {
                var t = d++;
                return {
                    value: b(t, a[t]),
                    done: !1
                }
            }
            h = !0;
            return {
                done: !0,
                value: void 0
            }
        }
    };
    m[Symbol.iterator] = function() {
        return m
    }
    ;
    return m
}
;
$jscomp.polyfill("Array.prototype.keys", function(a) {
    return a ? a : function() {
        return $jscomp.iteratorFromArray(this, function(b) {
            return b
        })
    }
}, "es6", "es3");
$jscomp.owns = function(a, b) {
    return Object.prototype.hasOwnProperty.call(a, b)
}
;
$jscomp.polyfill("Object.entries", function(a) {
    return a ? a : function(b) {
        var d = [], h;
        for (h in b)
            $jscomp.owns(b, h) && d.push([h, b[h]]);
        return d
    }
}, "es8", "es3");
$jscomp.checkStringArgs = function(a, b, d) {
    if (null == a)
        throw new TypeError("The 'this' value for String.prototype." + d + " must not be null or undefined");
    if (b instanceof RegExp)
        throw new TypeError("First argument to String.prototype." + d + " must not be a regular expression");
    return a + ""
}
;
$jscomp.polyfill("String.prototype.startsWith", function(a) {
    return a ? a : function(b, d) {
        var h = $jscomp.checkStringArgs(this, b, "startsWith");
        b += "";
        var m = h.length
          , t = b.length;
        d = Math.max(0, Math.min(d | 0, h.length));
        for (var f = 0; f < t && d < m; )
            if (h[d++] != b[f++])
                return !1;
        return f >= t
    }
}, "es6", "es3");
$jscomp.polyfill("Array.prototype.fill", function(a) {
    return a ? a : function(b, d, h) {
        var m = this.length || 0;
        0 > d && (d = Math.max(0, m + d));
        if (null == h || h > m)
            h = m;
        h = Number(h);
        0 > h && (h = Math.max(0, m + h));
        for (d = Number(d || 0); d < h; d++)
            this[d] = b;
        return this
    }
}, "es6", "es3");
$jscomp.typedArrayFill = function(a) {
    return a ? a : Array.prototype.fill
}
;
$jscomp.polyfill("Int8Array.prototype.fill", $jscomp.typedArrayFill, "es6", "es5");
$jscomp.polyfill("Uint8Array.prototype.fill", $jscomp.typedArrayFill, "es6", "es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill", $jscomp.typedArrayFill, "es6", "es5");
$jscomp.polyfill("Int16Array.prototype.fill", $jscomp.typedArrayFill, "es6", "es5");
$jscomp.polyfill("Uint16Array.prototype.fill", $jscomp.typedArrayFill, "es6", "es5");
$jscomp.polyfill("Int32Array.prototype.fill", $jscomp.typedArrayFill, "es6", "es5");
$jscomp.polyfill("Uint32Array.prototype.fill", $jscomp.typedArrayFill, "es6", "es5");
$jscomp.polyfill("Float32Array.prototype.fill", $jscomp.typedArrayFill, "es6", "es5");
$jscomp.polyfill("Float64Array.prototype.fill", $jscomp.typedArrayFill, "es6", "es5");
$jscomp.assign = $jscomp.TRUST_ES6_POLYFILLS && "function" == typeof Object.assign ? Object.assign : function(a, b) {
    for (var d = 1; d < arguments.length; d++) {
        var h = arguments[d];
        if (h)
            for (var m in h)
                $jscomp.owns(h, m) && (a[m] = h[m])
    }
    return a
}
;
$jscomp.polyfill("Object.assign", function(a) {
    return a || $jscomp.assign
}, "es6", "es3");
$jscomp.polyfill("Object.is", function(a) {
    return a ? a : function(b, d) {
        return b === d ? 0 !== b || 1 / b === 1 / d : b !== b && d !== d
    }
}, "es6", "es3");
$jscomp.polyfill("Array.prototype.includes", function(a) {
    return a ? a : function(b, d) {
        var h = this;
        h instanceof String && (h = String(h));
        var m = h.length;
        d = d || 0;
        for (0 > d && (d = Math.max(d + m, 0)); d < m; d++) {
            var t = h[d];
            if (t === b || Object.is(t, b))
                return !0
        }
        return !1
    }
}, "es7", "es3");
$jscomp.polyfill("String.prototype.includes", function(a) {
    return a ? a : function(b, d) {
        return -1 !== $jscomp.checkStringArgs(this, b, "includes").indexOf(b, d || 0)
    }
}, "es6", "es3");
$jscomp.polyfill("Promise", function(a) {
    function b() {
        this.batch_ = null
    }
    function d(f) {
        return f instanceof m ? f : new m(function(n, r) {
            n(f)
        }
        )
    }
    if (a && !$jscomp.FORCE_POLYFILL_PROMISE)
        return a;
    b.prototype.asyncExecute = function(f) {
        if (null == this.batch_) {
            this.batch_ = [];
            var n = this;
            this.asyncExecuteFunction(function() {
                n.executeBatch_()
            })
        }
        this.batch_.push(f)
    }
    ;
    var h = $jscomp.global.setTimeout;
    b.prototype.asyncExecuteFunction = function(f) {
        h(f, 0)
    }
    ;
    b.prototype.executeBatch_ = function() {
        for (; this.batch_ && this.batch_.length; ) {
            var f = this.batch_;
            this.batch_ = [];
            for (var n = 0; n < f.length; ++n) {
                var r = f[n];
                f[n] = null;
                try {
                    r()
                } catch (p) {
                    this.asyncThrow_(p)
                }
            }
        }
        this.batch_ = null
    }
    ;
    b.prototype.asyncThrow_ = function(f) {
        this.asyncExecuteFunction(function() {
            throw f;
        })
    }
    ;
    var m = function(f) {
        this.state_ = 0;
        this.result_ = void 0;
        this.onSettledCallbacks_ = [];
        this.isRejectionHandled_ = !1;
        var n = this.createResolveAndReject_();
        try {
            f(n.resolve, n.reject)
        } catch (r) {
            n.reject(r)
        }
    };
    m.prototype.createResolveAndReject_ = function() {
        function f(p) {
            return function(z) {
                r || (r = !0,
                p.call(n, z))
            }
        }
        var n = this
          , r = !1;
        return {
            resolve: f(this.resolveTo_),
            reject: f(this.reject_)
        }
    }
    ;
    m.prototype.resolveTo_ = function(f) {
        if (f === this)
            this.reject_(new TypeError("A Promise cannot resolve to itself"));
        else if (f instanceof m)
            this.settleSameAsPromise_(f);
        else {
            a: switch (typeof f) {
            case "object":
                var n = null != f;
                break a;
            case "function":
                n = !0;
                break a;
            default:
                n = !1
            }
            n ? this.resolveToNonPromiseObj_(f) : this.fulfill_(f)
        }
    }
    ;
    m.prototype.resolveToNonPromiseObj_ = function(f) {
        var n = void 0;
        try {
            n = f.then
        } catch (r) {
            this.reject_(r);
            return
        }
        "function" == typeof n ? this.settleSameAsThenable_(n, f) : this.fulfill_(f)
    }
    ;
    m.prototype.reject_ = function(f) {
        this.settle_(2, f)
    }
    ;
    m.prototype.fulfill_ = function(f) {
        this.settle_(1, f)
    }
    ;
    m.prototype.settle_ = function(f, n) {
        if (0 != this.state_)
            throw Error("Cannot settle(" + f + ", " + n + "): Promise already settled in state" + this.state_);
        this.state_ = f;
        this.result_ = n;
        2 === this.state_ && this.scheduleUnhandledRejectionCheck_();
        this.executeOnSettledCallbacks_()
    }
    ;
    m.prototype.scheduleUnhandledRejectionCheck_ = function() {
        var f = this;
        h(function() {
            if (f.notifyUnhandledRejection_()) {
                var n = $jscomp.global.console;
                "undefined" !== typeof n && n.error(f.result_)
            }
        }, 1)
    }
    ;
    m.prototype.notifyUnhandledRejection_ = function() {
        if (this.isRejectionHandled_)
            return !1;
        var f = $jscomp.global.CustomEvent
          , n = $jscomp.global.Event
          , r = $jscomp.global.dispatchEvent;
        if ("undefined" === typeof r)
            return !0;
        "function" === typeof f ? f = new f("unhandledrejection",{
            cancelable: !0
        }) : "function" === typeof n ? f = new n("unhandledrejection",{
            cancelable: !0
        }) : (f = $jscomp.global.document.createEvent("CustomEvent"),
        f.initCustomEvent("unhandledrejection", !1, !0, f));
        f.promise = this;
        f.reason = this.result_;
        return r(f)
    }
    ;
    m.prototype.executeOnSettledCallbacks_ = function() {
        if (null != this.onSettledCallbacks_) {
            for (var f = 0; f < this.onSettledCallbacks_.length; ++f)
                t.asyncExecute(this.onSettledCallbacks_[f]);
            this.onSettledCallbacks_ = null
        }
    }
    ;
    var t = new b;
    m.prototype.settleSameAsPromise_ = function(f) {
        var n = this.createResolveAndReject_();
        f.callWhenSettled_(n.resolve, n.reject)
    }
    ;
    m.prototype.settleSameAsThenable_ = function(f, n) {
        var r = this.createResolveAndReject_();
        try {
            f.call(n, r.resolve, r.reject)
        } catch (p) {
            r.reject(p)
        }
    }
    ;
    m.prototype.then = function(f, n) {
        function r(I, E) {
            return "function" == typeof I ? function(K) {
                try {
                    p(I(K))
                } catch (H) {
                    z(H)
                }
            }
            : E
        }
        var p, z, F = new m(function(I, E) {
            p = I;
            z = E
        }
        );
        this.callWhenSettled_(r(f, p), r(n, z));
        return F
    }
    ;
    m.prototype.catch = function(f) {
        return this.then(void 0, f)
    }
    ;
    m.prototype.callWhenSettled_ = function(f, n) {
        function r() {
            switch (p.state_) {
            case 1:
                f(p.result_);
                break;
            case 2:
                n(p.result_);
                break;
            default:
                throw Error("Unexpected state: " + p.state_);
            }
        }
        var p = this;
        null == this.onSettledCallbacks_ ? t.asyncExecute(r) : this.onSettledCallbacks_.push(r);
        this.isRejectionHandled_ = !0
    }
    ;
    m.resolve = d;
    m.reject = function(f) {
        return new m(function(n, r) {
            r(f)
        }
        )
    }
    ;
    m.race = function(f) {
        return new m(function(n, r) {
            for (var p = $jscomp.makeIterator(f), z = p.next(); !z.done; z = p.next())
                d(z.value).callWhenSettled_(n, r)
        }
        )
    }
    ;
    m.all = function(f) {
        var n = $jscomp.makeIterator(f)
          , r = n.next();
        return r.done ? d([]) : new m(function(p, z) {
            function F(K) {
                return function(H) {
                    I[K] = H;
                    E--;
                    0 == E && p(I)
                }
            }
            var I = []
              , E = 0;
            do
                I.push(void 0),
                E++,
                d(r.value).callWhenSettled_(F(I.length - 1), z),
                r = n.next();
            while (!r.done)
        }
        )
    }
    ;
    return m
}, "es6", "es3");
$jscomp.polyfill("Promise.prototype.finally", function(a) {
    return a ? a : function(b) {
        return this.then(function(d) {
            return Promise.resolve(b()).then(function() {
                return d
            })
        }, function(d) {
            return Promise.resolve(b()).then(function() {
                throw d;
            })
        })
    }
}, "es9", "es3");
$jscomp.findInternal = function(a, b, d) {
    a instanceof String && (a = String(a));
    for (var h = a.length, m = 0; m < h; m++) {
        var t = a[m];
        if (b.call(d, t, m, a))
            return {
                i: m,
                v: t
            }
    }
    return {
        i: -1,
        v: void 0
    }
}
;
$jscomp.polyfill("Array.prototype.find", function(a) {
    return a ? a : function(b, d) {
        return $jscomp.findInternal(this, b, d).v
    }
}, "es6", "es3");
$jscomp.polyfill("Array.prototype.values", function(a) {
    return a ? a : function() {
        return $jscomp.iteratorFromArray(this, function(b, d) {
            return d
        })
    }
}, "es8", "es3");
$jscomp.polyfill("Array.prototype.findIndex", function(a) {
    return a ? a : function(b, d) {
        return $jscomp.findInternal(this, b, d).i
    }
}, "es6", "es3");
$jscomp.checkEs6ConformanceViaProxy = function() {
    try {
        var a = {}
          , b = Object.create(new $jscomp.global.Proxy(a,{
            get: function(d, h, m) {
                return d == a && "q" == h && m == b
            }
        }));
        return !0 === b.q
    } catch (d) {
        return !1
    }
}
;
$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS = !1;
$jscomp.ES6_CONFORMANCE = $jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS && $jscomp.checkEs6ConformanceViaProxy();
$jscomp.polyfill("WeakMap", function(a) {
    function b() {
        if (!a || !Object.seal)
            return !1;
        try {
            var p = Object.seal({})
              , z = Object.seal({})
              , F = new a([[p, 2], [z, 3]]);
            if (2 != F.get(p) || 3 != F.get(z))
                return !1;
            F.delete(p);
            F.set(z, 4);
            return !F.has(p) && 4 == F.get(z)
        } catch (I) {
            return !1
        }
    }
    function d() {}
    function h(p) {
        var z = typeof p;
        return "object" === z && null !== p || "function" === z
    }
    function m(p) {
        if (!$jscomp.owns(p, f)) {
            var z = new d;
            $jscomp.defineProperty(p, f, {
                value: z
            })
        }
    }
    function t(p) {
        if (!$jscomp.ISOLATE_POLYFILLS) {
            var z = Object[p];
            z && (Object[p] = function(F) {
                if (F instanceof d)
                    return F;
                Object.isExtensible(F) && m(F);
                return z(F)
            }
            )
        }
    }
    if ($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS) {
        if (a && $jscomp.ES6_CONFORMANCE)
            return a
    } else if (b())
        return a;
    var f = "$jscomp_hidden_" + Math.random();
    t("freeze");
    t("preventExtensions");
    t("seal");
    var n = 0
      , r = function(p) {
        this.id_ = (n += Math.random() + 1).toString();
        if (p) {
            p = $jscomp.makeIterator(p);
            for (var z; !(z = p.next()).done; )
                z = z.value,
                this.set(z[0], z[1])
        }
    };
    r.prototype.set = function(p, z) {
        if (!h(p))
            throw Error("Invalid WeakMap key");
        m(p);
        if (!$jscomp.owns(p, f))
            throw Error("WeakMap key fail: " + p);
        p[f][this.id_] = z;
        return this
    }
    ;
    r.prototype.get = function(p) {
        return h(p) && $jscomp.owns(p, f) ? p[f][this.id_] : void 0
    }
    ;
    r.prototype.has = function(p) {
        return h(p) && $jscomp.owns(p, f) && $jscomp.owns(p[f], this.id_)
    }
    ;
    r.prototype.delete = function(p) {
        return h(p) && $jscomp.owns(p, f) && $jscomp.owns(p[f], this.id_) ? delete p[f][this.id_] : !1
    }
    ;
    return r
}, "es6", "es3");
$jscomp.MapEntry = function() {}
;
$jscomp.polyfill("Map", function(a) {
    function b() {
        if ($jscomp.ASSUME_NO_NATIVE_MAP || !a || "function" != typeof a || !a.prototype.entries || "function" != typeof Object.seal)
            return !1;
        try {
            var r = Object.seal({
                x: 4
            })
              , p = new a($jscomp.makeIterator([[r, "s"]]));
            if ("s" != p.get(r) || 1 != p.size || p.get({
                x: 4
            }) || p.set({
                x: 4
            }, "t") != p || 2 != p.size)
                return !1;
            var z = p.entries()
              , F = z.next();
            if (F.done || F.value[0] != r || "s" != F.value[1])
                return !1;
            F = z.next();
            return F.done || 4 != F.value[0].x || "t" != F.value[1] || !z.next().done ? !1 : !0
        } catch (I) {
            return !1
        }
    }
    if ($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS) {
        if (a && $jscomp.ES6_CONFORMANCE)
            return a
    } else if (b())
        return a;
    var d = new WeakMap
      , h = function(r) {
        this.data_ = {};
        this.head_ = f();
        this.size = 0;
        if (r) {
            r = $jscomp.makeIterator(r);
            for (var p; !(p = r.next()).done; )
                p = p.value,
                this.set(p[0], p[1])
        }
    };
    h.prototype.set = function(r, p) {
        r = 0 === r ? 0 : r;
        var z = m(this, r);
        z.list || (z.list = this.data_[z.id] = []);
        z.entry ? z.entry.value = p : (z.entry = {
            next: this.head_,
            previous: this.head_.previous,
            head: this.head_,
            key: r,
            value: p
        },
        z.list.push(z.entry),
        this.head_.previous.next = z.entry,
        this.head_.previous = z.entry,
        this.size++);
        return this
    }
    ;
    h.prototype.delete = function(r) {
        r = m(this, r);
        return r.entry && r.list ? (r.list.splice(r.index, 1),
        r.list.length || delete this.data_[r.id],
        r.entry.previous.next = r.entry.next,
        r.entry.next.previous = r.entry.previous,
        r.entry.head = null,
        this.size--,
        !0) : !1
    }
    ;
    h.prototype.clear = function() {
        this.data_ = {};
        this.head_ = this.head_.previous = f();
        this.size = 0
    }
    ;
    h.prototype.has = function(r) {
        return !!m(this, r).entry
    }
    ;
    h.prototype.get = function(r) {
        return (r = m(this, r).entry) && r.value
    }
    ;
    h.prototype.entries = function() {
        return t(this, function(r) {
            return [r.key, r.value]
        })
    }
    ;
    h.prototype.keys = function() {
        return t(this, function(r) {
            return r.key
        })
    }
    ;
    h.prototype.values = function() {
        return t(this, function(r) {
            return r.value
        })
    }
    ;
    h.prototype.forEach = function(r, p) {
        for (var z = this.entries(), F; !(F = z.next()).done; )
            F = F.value,
            r.call(p, F[1], F[0], this)
    }
    ;
    h.prototype[Symbol.iterator] = h.prototype.entries;
    var m = function(r, p) {
        var z = p && typeof p;
        "object" == z || "function" == z ? d.has(p) ? z = d.get(p) : (z = "" + ++n,
        d.set(p, z)) : z = "p_" + p;
        var F = r.data_[z];
        if (F && $jscomp.owns(r.data_, z))
            for (r = 0; r < F.length; r++) {
                var I = F[r];
                if (p !== p && I.key !== I.key || p === I.key)
                    return {
                        id: z,
                        list: F,
                        index: r,
                        entry: I
                    }
            }
        return {
            id: z,
            list: F,
            index: -1,
            entry: void 0
        }
    }
      , t = function(r, p) {
        var z = r.head_;
        return $jscomp.iteratorPrototype(function() {
            if (z) {
                for (; z.head != r.head_; )
                    z = z.previous;
                for (; z.next != z.head; )
                    return z = z.next,
                    {
                        done: !1,
                        value: p(z)
                    };
                z = null
            }
            return {
                done: !0,
                value: void 0
            }
        })
    }
      , f = function() {
        var r = {};
        return r.previous = r.next = r.head = r
    }
      , n = 0;
    return h
}, "es6", "es3");
$jscomp.polyfill("Set", function(a) {
    function b() {
        if ($jscomp.ASSUME_NO_NATIVE_SET || !a || "function" != typeof a || !a.prototype.entries || "function" != typeof Object.seal)
            return !1;
        try {
            var h = Object.seal({
                x: 4
            })
              , m = new a($jscomp.makeIterator([h]));
            if (!m.has(h) || 1 != m.size || m.add(h) != m || 1 != m.size || m.add({
                x: 4
            }) != m || 2 != m.size)
                return !1;
            var t = m.entries()
              , f = t.next();
            if (f.done || f.value[0] != h || f.value[1] != h)
                return !1;
            f = t.next();
            return f.done || f.value[0] == h || 4 != f.value[0].x || f.value[1] != f.value[0] ? !1 : t.next().done
        } catch (n) {
            return !1
        }
    }
    if ($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS) {
        if (a && $jscomp.ES6_CONFORMANCE)
            return a
    } else if (b())
        return a;
    var d = function(h) {
        this.map_ = new Map;
        if (h) {
            h = $jscomp.makeIterator(h);
            for (var m; !(m = h.next()).done; )
                this.add(m.value)
        }
        this.size = this.map_.size
    };
    d.prototype.add = function(h) {
        h = 0 === h ? 0 : h;
        this.map_.set(h, h);
        this.size = this.map_.size;
        return this
    }
    ;
    d.prototype.delete = function(h) {
        h = this.map_.delete(h);
        this.size = this.map_.size;
        return h
    }
    ;
    d.prototype.clear = function() {
        this.map_.clear();
        this.size = 0
    }
    ;
    d.prototype.has = function(h) {
        return this.map_.has(h)
    }
    ;
    d.prototype.entries = function() {
        return this.map_.entries()
    }
    ;
    d.prototype.values = function() {
        return this.map_.values()
    }
    ;
    d.prototype.keys = d.prototype.values;
    d.prototype[Symbol.iterator] = d.prototype.values;
    d.prototype.forEach = function(h, m) {
        var t = this;
        this.map_.forEach(function(f) {
            return h.call(m, f, f, t)
        })
    }
    ;
    return d
}, "es6", "es3");
$jscomp.polyfill("Object.values", function(a) {
    return a ? a : function(b) {
        var d = [], h;
        for (h in b)
            $jscomp.owns(b, h) && d.push(b[h]);
        return d
    }
}, "es8", "es3");
var localStorageSupported = !1, localStorageIsPolyFill = !1, storagePolyFillHasDataCallback = null, progressBar, storage, isOpera = !!window.opr && !!opr.addons || !!window.opera || 0 <= navigator.userAgent.indexOf(" OPR/"), isFirefox = "undefined" !== typeof InstallTrigger, isSafari = !!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/), isIE = !!document.documentMode, isEdge = !isIE && !!window.StyleMedia, isChrome = !!window.chrome && !!window.chrome.webstore, isBlink = (isChrome || isOpera) && !!window.CSS, isTest = /test\.keepa/.test(location.href) || /keepa.com\/test/.test(location.href) || /localhost:63342/.test(location.href), isIframe = -1 !== window.location.href.indexOf("keepa.com/iframe_addon") || -1 !== window.location.href.indexOf("keepa.com/test/iframe_addon") || -1 !== window.location.href.indexOf("keepa.com/keepaBox");
keepaApp && (isIframe = !0);
var storagePolyFillHasData = !1
  , waitForExtensionStorage = !1
  , polyFillLocalStorage = function() {
    localStorageIsPolyFill = !0;
    var a = {}
      , b = function() {};
    b.prototype.getItem = function(h) {
        h = String(h);
        return a.hasOwnProperty(h) ? String(a[h]) : null
    }
    ;
    b.prototype.setItem = function(h, m) {
        a[String(h)] = String(m)
    }
    ;
    b.prototype.removeItem = function(h) {
        delete a[String(h)]
    }
    ;
    b.prototype.clear = function() {
        a = {}
    }
    ;
    b.prototype.key = function(h) {
        if (0 === arguments.length)
            throw new TypeError("Failed to execute 'key' on 'Storage': 1 argument required, but only 0 present.");
        return Array.from(Object.keys(a))[h]
    }
    ;
    b.prototype.forEach = function(h) {
        Object.entries(obj).forEach(function(m) {
            var t = $jscomp.makeIterator(m);
            m = t.next().value;
            t = t.next().value;
            h(m, t)
        })
    }
    ;
    b.prototype.toJSON = function(h) {
        return JSON.stringify(a)
    }
    ;
    $jscomp.global.Object.defineProperties(b.prototype, {
        length: {
            configurable: !0,
            enumerable: !0,
            get: function() {
                return Object.keys(a).length
            }
        }
    });
    var d = new b;
    storage = d;
    storage = new Proxy(d,{
        set: function(h, m, t) {
            b.prototype.hasOwnProperty(m) ? d[m] = t : d.setItem(m, t);
            return !0
        },
        get: function(h, m) {
            if (b.prototype.hasOwnProperty(m))
                return d[m];
            if (a.hasOwnProperty(m))
                return d.getItem(m)
        },
        has: function(h, m) {
            return a.hasOwnProperty(m)
        }
    })
}
  , deferredStorage = {};
function sendReceive(a) {
    var b = $.Deferred()
      , d = Date.now() + Math.floor(1E4 * Math.random());
    "ping" == a.key ? deferredStorage.pong = b : deferredStorage[d] = b;
    window.parent.postMessage({
        key: a.key,
        value: a.value,
        id: d,
        origin: "keepaIframe",
        location: "" + document.location
    }, "*");
    return b.promise()
}
var amznpopupwin = null;
function openPopup(a) {
    var b = $.Deferred()
      , d = "Popup" + Date.now() + Math.floor(1E4 * Math.random());
    deferredStorage[d] = b;
    amznpopupwin = window.open(a, d, popupSettings);
    var h = setInterval(function() {
        amznpopupwin.closed && (clearInterval(h),
        b.reject())
    }, 500);
    b.done(function() {
        clearInterval(h)
    });
    return b.promise()
}
function initContentScriptListener() {
    window.addEventListener("message", function(a) {
        if (a.data && a.data.origin && ("keepaContentScript" == a.data.origin || "keepaBoxHost" == a.data.origin)) {
            if ("updateASIN" == a.data.key) {
                if (lastSubUrl == a.data.value)
                    return;
                lastSubUrl = a.data.value;
                loadProductIFrame()
            }
            var b = deferredStorage[a.data.id];
            delete deferredStorage[a.data.id];
            b || "ping" != a.data.key && "pong" != a.data.key || (b = deferredStorage.pong,
            delete deferredStorage.pong);
            b && b.resolve(a.data)
        }
    }, !1)
}
var currencyDomainId = 0
  , calledOnReady = !1
  , getTokenFromExtension = function(a) {
    sendReceive({
        key: "getToken"
    }).done(function(b) {
        if (a || 0 == storage.accountType || "undefined" == typeof storage.accountType)
            storage.token = b.value.token,
            storagePolyFillHasData = !0;
        if (!calledOnReady)
            if (calledOnReady = !0,
            "undefined" == typeof onready) {
                var d = -2;
                d = setInterval(function() {
                    "undefined" != typeof onready && (clearInterval(d),
                    onready(!1))
                }, 300)
            } else
                onready(!1)
    })
};
try {
    initContentScriptListener();
    var l = localStorage.language
      , x = "test_localstorage_available_" + Date.now();
    localStorage.setItem(x, x);
    var y = localStorage.getItem(x);
    localStorage.removeItem(x);
    for (var k in localStorage)
        0 < k.indexOf("_localstorage_available_") && localStorage.removeItem(x),
        k.startsWith("__$") && localStorage.removeItem(x);
    if (x === y)
        localStorageSupported = !0,
        storage = window.localStorage;
    else
        throw Error("localStorage not supported / accessible.");
    currencyDomainId = isNaN(Number(storage.currencyDomainId)) ? 0 : Number(storage.currencyDomainId);
    waitForExtensionStorage = !0;
    getTokenFromExtension(!1);
    setTimeout(function() {
        if (!calledOnReady)
            if ("undefined" == typeof onready) {
                var a = -2;
                a = setInterval(function() {
                    "undefined" != typeof onready && (clearInterval(a),
                    calledOnReady || (calledOnReady = !0,
                    onready(!1)))
                }, 300)
            } else
                calledOnReady = !0,
                onready(!1)
    }, 300)
} catch (a) {
    if (isIframe || keepaApp)
        localStorageSupported = !0,
        polyFillLocalStorage(!0),
        console.log("isolated context", localStorageIsPolyFill),
        localStorageIsPolyFill && !keepaApp && (waitForExtensionStorage = !0,
        getTokenFromExtension(!0),
        setTimeout(function() {
            calledOnReady || (calledOnReady = !0,
            onready(!1))
        }, 3E3));
    else
        try {
            localStorage.clear(),
            serviceWorker.unregister(),
            indexedDB.deleteDatabase("keepa"),
            showPopup("Browser mode unsupported", 'Your web browser does not support storing settings locally (all cookies blocked).<br>In Safari, the most common cause of this is using "Private Browsing Mode". Some settings may not save or some features may not work properly for you.', !0)
        } catch (b) {
            console.error(b)
        }
    setTimeout(function() {
        console.log(a + " " + navigator.userAgent + " isIframe: " + isIframe)
    }, 0)
}
var hasDataAccessSubscription = !1
  , activeWebSocketRequests = 0
  , network = function() {
    function a() {
        try {
            localforage.dropInstance({
                name: "keepa"
            }).then(function() {})
        } catch (R) {}
        A = A || cw({
            pakoType: {
                to: "string"
            },
            initDatabase: function(R, T) {
                importScripts("localforage.min.1.6.0.js");
                importScripts("https://cdn.keepa.com/helper4.js");
                (asyncSupported = localforage.supports(localforage.INDEXEDDB)) ? (L = localforage.createInstance({
                    driver: localforage.INDEXEDDB,
                    name: "keepaCache",
                    version: 1,
                    size: 838860800,
                    storeName: "cache",
                    description: "Caches network data"
                }),
                databaseMeta = localforage.createInstance({
                    driver: localforage.INDEXEDDB,
                    name: "keepaCache",
                    version: 1,
                    size: 838860800,
                    storeName: "cacheMeta",
                    description: "Caches Cache metadata"
                }),
                L.getItem("test").then(databaseMeta.getItem("test")).then(function() {
                    T(!0)
                }).catch(function(oa) {
                    asyncSupported = !1;
                    T(!1)
                })) : T(!1)
            },
            clearDatabase: function() {
                L.clear();
                databaseMeta.clear()
            },
            keepaTime: {
                now: function() {
                    return Math.floor(Date.now() / 6E4 - 21564E3)
                },
                minutesToEpoch: function(R) {
                    return 6E4 * (R + 21564E3)
                },
                epochToMinutes: function(R) {
                    return Math.round(R / 6E4) - 21564E3
                },
                timeShiftOffset: -(new Date).getTimezoneOffset()
            },
            removeOudatedCacheEntries: function() {
                if (asyncSupported)
                    try {
                        databaseMeta.getItem("lastClear").then(function(R) {
                            var T = Date.now();
                            null == R && (R = 0);
                            if (!(30 > T - R)) {
                                databaseMeta.setItem("lastClear", T);
                                var oa = [];
                                databaseMeta.iterate(function(Z, ja, W) {
                                    "lastClear" != ja && T - Z.cached > Z.ttl && oa.push(ja)
                                }).then(function() {
                                    if (0 < oa.length) {
                                        console.log("Clearing cached items: ", oa.length);
                                        for (var Z in oa)
                                            L.removeItem(oa[Z]),
                                            databaseMeta.removeItem(oa[Z])
                                    }
                                }).catch(function(Z) {
                                    console.log("2: " + Z.toString())
                                })
                            }
                        }).catch(function(R) {
                            console.log("3: " + R.toString())
                        })
                    } catch (R) {
                        console.log(R)
                    }
            },
            calculateStatistics: function(R) {
                return R
            },
            read: function(R) {
                try {
                    R instanceof ArrayBuffer && (R = pako.inflate(R, this.pakoType));
                    var T = JSON.parse(R);
                    return T && "object" === typeof T && null !== T ? T : null
                } catch (oa) {
                    return console.error("4: " + oa.toString()),
                    null
                }
            },
            addProduct: function(R) {
                try {
                    var T = R.pr
                      , oa = null != T.csv;
                    if (!oa || !T.csv[3] || 2 !== T.csv[3].length || -2 !== T.csv[3][1]) {
                        var Z = T.domainId + T.asin + "h" + (oa ? "1" : "0")
                          , ja = Date.now()
                          , W = oa ? T.csv[15] : null
                          , Aa = null == W || 0 == W.length ? -1 : W[W.length - 2];
                        oa = !1;
                        0 < Aa && 12E4 > ja - this.keepaTime.minutesToEpoch(Aa) && (oa = !0);
                        databaseMeta.setItem(Z, {
                            g: T.g,
                            extra: oa,
                            cached: ja,
                            ttl: R.ttl,
                            type: "pr"
                        }).then(function() {
                            L.setItem(Z, pako.deflate(JSON.stringify(T)))
                        })
                    }
                } catch (Ca) {
                    console.error("5: " + Ca.toString())
                }
            },
            getProduct: function(R, T, oa) {
                var Z = this;
                try {
                    var ja = R.domainId + R.asin + "h" + (R.history ? "1" : "0");
                    databaseMeta.getItem(ja).then(function(W) {
                        null == W ? T(null) : 0 < R.offerPages && !W.extra ? T(null) : L.getItem(ja).then(function(Aa) {
                            T(null == Aa ? null : {
                                data: JSON.parse(pako.inflate(Aa, Z.pakoType)),
                                cached: W.cached
                            })
                        }).catch(function(Aa) {
                            T(null)
                        })
                    }).catch(function(W) {
                        T(null);
                        console.log("7: " + e.toString())
                    })
                } catch (W) {
                    T(null),
                    console.error("8; " + W.toString())
                }
            },
            trackingKeyPrefix: "tr",
            addComTracking: function(R) {
                try {
                    var T = R.tr;
                    if (T && 0 != T.length) {
                        var oa = this.trackingKeyPrefix + T[0].asin
                          , Z = Date.now();
                        databaseMeta.setItem(oa, {
                            cached: Z,
                            ttl: R.ttl,
                            type: "tr"
                        }).then(function() {
                            L.setItem(oa, pako.deflate(JSON.stringify(T)))
                        })
                    }
                } catch (ja) {
                    console.error("5: " + ja.toString())
                }
            },
            getComTracking: function(R, T, oa) {
                var Z = this;
                try {
                    var ja = Z.trackingKeyPrefix + R.asin;
                    databaseMeta.getItem(ja).then(function(W) {
                        null == W ? T(null) : L.getItem(ja).then(function(Aa) {
                            T(null == Aa ? null : {
                                data: JSON.parse(pako.inflate(Aa, Z.pakoType)),
                                cached: W.cached
                            })
                        }).catch(function(Aa) {
                            T(null)
                        })
                    }).catch(function(W) {
                        console.log("c7: " + W.toString());
                        T(null)
                    })
                } catch (W) {
                    console.error("c8: " + W.toString())
                }
            }
        }, 1, !0);
        A.initDatabase().then(function(R) {
            O = R;
            console.log("cache supported: " + O)
        })
    }
    function b(R, T) {
        H[0] || (H = $("#networkBar"),
        V = $("#networkOverlay"));
        T.id = Number(P++ + "" + Math.floor(1E8 * Math.random()) % 12345);
        T.version || (T.version = 2);
        T.user || (T.user = localStorageSupported && null != storage.token && "null" != storage.token && 64 == storage.token.length ? storage.token : Guid.newGuid());
        if ("undefined" == typeof pako)
            return J.done(function() {
                d(T).done(R.resolve).fail(R.reject)
            }).fail(R.reject),
            R;
        0 < T.id % 2 ? ++T.id : 1;
        var oa = pako.deflate(JSON.stringify(T));
        if (0 == activeWebSocketRequests && "service/features" != T.path)
            try {
                progressBar.open()
            } catch (ja) {}
        "service/features" != T.path && activeWebSocketRequests++;
        5 < ua.length && ua.shift();
        ua.push({
            path: T.path,
            type: T.type,
            version: T.version
        });
        var Z = null == pa ? !1 : 1 == pa.readyState;
        za() && 0 <= serviceWorker.workerConnectionState() && !Z ? (window.networkInitTimestamp = Date.now(),
        Z = function(ja) {
            ja.error || "abort" == ja.data || "connectError" == ja.data ? (T.status = 500,
            V.hide(),
            h(T)) : "connectError" != ja.data && ("tokenError" == ja.data ? (window.forceNoSWConnection = !1,
            m(),
            serviceWorker.updateTokenInSW(),
            setTimeout(function() {
                null == pa || 1 != pa.readyState ? N.push(oa) : pa.send(oa)
            }, 500)) : (V.hide(),
            q = 2,
            h(ja.data)))
        }
        ,
        0 == q && (q = 1),
        serviceWorker.postMessage({
            command: "request",
            value: T
        }, function(ja) {
            h(ja)
        }).then(Z).catch(Z)) : (iframe.parent && (keepaApp && (iframe.parent = "Keepa_App"),
        T.keepaBoxParent = iframe.parent,
        delete iframe.parent),
        iframe.isIframe && (T.keepaBoxReferrer = document.referrer),
        2 != q && (q = 1),
        null != pa && 1 == pa.readyState && Q ? pa.send(oa) : (N.push(oa),
        m(!1)));
        Z = $.Deferred();
        Z.cachedData = R.cachedData;
        Z.cachedType = R.cachedType;
        D["" + T.id] = Z;
        Z.promise().done(function(ja) {
            R.resolve(ja)
        }).fail(function(ja) {
            "retry" !== ja || T.isRetry ? R.reject(ja) : (T.isRetry = !0,
            b(R, T))
        }).always(function() {
            "service/features" != T.path && (activeWebSocketRequests = Math.max(0, --activeWebSocketRequests));
            if (0 == activeWebSocketRequests)
                try {
                    progressBar.close()
                } catch (ja) {}
        })
    }
    function d(R) {
        var T = $.Deferred();
        M.push({
            entry: R,
            promise: T
        });
        return T
    }
    function h(R) {
        try {
            if (null != R.tokenBucketSize && (hasDataAccessSubscription = 5E3 < R.tokenBucketSize),
            R.exchange && (currencies = R.exchange),
            R.isAWS && (isAWS = !0),
            R.forceLogout)
                logout(!0);
            else {
                null != R.token && localStorageSupported && settings.setToken(R.token, !0);
                var T = D[R.id];
                if (T) {
                    if (R.isHuman)
                        isHuman = R.isHuman;
                    else if (R.checkHuman) {
                        u ? v.done(function() {
                            T.reject("retry")
                        }) : (u = !0,
                        v = $.Deferred(),
                        isUserHuman(!1).done(function(Ba) {
                            network.request({
                                path: "isHuman",
                                captcha: Ba,
                                version: 3
                            }).done(function(ta) {
                                v.resolve();
                                u = !1;
                                T.reject("retry")
                            }).fail(showErrorPopup)
                        }).fail(showErrorPopup));
                        return
                    }
                    delete D[R.id];
                    if (304 == R.status)
                        null != T.cachedData ? (R[T.cachedType] = T.cachedData,
                        R[T.cachedType].lastUpdate = R.lastUpdate,
                        T.resolve(R)) : (T.reject(R),
                        reportBug(null, "304 but cachedData empty. " + JSON.stringify(R)));
                    else {
                        if (R.products)
                            for (var oa = 0; oa < R.products.length; oa++) {
                                var Z = R.products[oa];
                                null != Z && null != Z.csv && 3 < Z.csv.length && null == Z.csv[CsvType.SALES.index] && (Z.csv[CsvType.SALES.index] = [Z.lastUpdate, -1]);
                                if (null != Z.csv && null != Z.csv[CsvType.SALES.index] && 0 < Z.csv[CsvType.SALES.index].length && (2 < Z.csv[CsvType.SALES.index].length || -1 != Z.csv[CsvType.SALES.index][1])) {
                                    splitRootSalesRank(Z);
                                    if ("undefined" == typeof Z.salesRanks || null == Z.salesRanks)
                                        Z.salesRanks = {};
                                    Z.salesRanks[Z.salesRankReference] = Z.csv[CsvType.SALES.index]
                                }
                            }
                        if (R.products && null != R.deals && null != R.deals.dr && 0 < R.deals.dr.length)
                            for (oa = 0; oa < R.products.length; oa++)
                                R.products[oa].deal = R.deals.dr[oa];
                        if (O && (R.comTrackings && A.addComTracking({
                            tr: R.comTrackings,
                            ttl: 864E5
                        }),
                        R.products))
                            for (oa = 0; oa < R.products.length; oa++)
                                A.addProduct({
                                    pr: R.products[oa],
                                    ttl: 864E5
                                });
                        if (100 == R.status) {
                            var ja = tryParseJSON(R.json);
                            null != ja && T.notify(ja.p)
                        } else if (402 == R.status)
                            $("body").html('<br><br>Unauthorized access detected. Please visit <a target="_blank" href="https://get.keepa.com">Keepa.com</a> to get our browser extension from a trusted source.'),
                            setInterval(function() {
                                $("body").html('<br><br>Unauthorized access detected. Please visit <a target="_blank" href="https://get.keepa.com">Keepa.com</a> to get our browser extension from a trusted source.')
                            }, 500),
                            T.reject(R);
                        else if (429 == R.status)
                            T.reject(R);
                        else if (R.products)
                            T.resolve(R);
                        else if (3 === R.version)
                            R.offers && (R.offers = tryParseJSON(R.offers)),
                            T.resolve(R);
                        else if (200 == R.status) {
                            var W = tryParseJSON(R.json);
                            null == W ? T.reject(R) : (R.timestamp && !R.timeStamp && (R.timeStamp = R.timestamp),
                            W.timeStamp = R.timeStamp,
                            "undefined" != typeof W.exchange && (currencies = W.exchange),
                            T.resolve(W),
                            ba = 0)
                        } else if (505 == R.status)
                            2 === Number(storage.forceReload) ? (V.show(),
                            H.html("You are using an outdated version of Keepa. Please clear your cache and/or restart your browser. If you need any help, you can contact us at info@keepa.com."),
                            storage.removeItem("forceReload")) : (document.location.reload(!0),
                            storage.forceReload = 2);
                        else if (500 == R.status || 404 == R.status)
                            H.html(la._error + '&emsp;<span id="networkAbort" style="color:rgb(0, 0, 0); cursor:pointer">Close.</span>'),
                            T.reject(R),
                            $("#networkAbort").click(function() {
                                w()
                            });
                        else {
                            if ((401 == R.status || 400 == R.status) && 400 == R.status) {
                                var Aa = tryParseJSON(R.errorMsg);
                                null == Aa ? T.reject({
                                    error: "invalidParameter",
                                    message: la._error,
                                    details: ""
                                }) : Aa = Aa.invalidParameter;
                                ja = !1;
                                try {
                                    if (null != Aa)
                                        for (var Ca in Aa)
                                            "invalid" != Aa[Ca].message && (ja = !0)
                                } catch (Ba) {
                                    reportBug(Ba, JSON.stringify(R))
                                }
                                if (ja) {
                                    T.reject({
                                        error: "invalidParameter",
                                        message: la._error,
                                        details: Aa
                                    });
                                    return
                                }
                                V.show();
                                H.html(la._error + '&emsp;<span id="networkAbort" style="color:rgb(0, 0, 0); cursor:pointer">Close.</span>');
                                $("#networkAbort").click(function() {
                                    w()
                                })
                            }
                            T.reject(R)
                        }
                    }
                }
            }
        } catch (Ba) {
            reportBug(Ba),
            console.log(Ba)
        }
    }
    function m(R) {
        if (za() && 0 <= serviceWorker.workerConnectionState())
            R && serviceWorker.postMessage({
                command: "connect"
            }, function(Aa) {
                console.log("SW reconnect command received")
            }).then(function() {
                console.log("SW reconnected")
            }).catch(function() {
                console.log("reconnect fail")
            });
        else if (null != pa && R)
            ka = !0,
            console.trace("webSocket.close"),
            pa.close(4108, "reconnect");
        else {
            if (null == B || "pending" != B.state())
                B = $.Deferred();
            var T = Date.now() - G;
            if (4E3 > T)
                setTimeout(function() {
                    m(R)
                }, 4E3 - T);
            else {
                var oa = {
                    to: "string"
                };
                if (null == pa || 1 != pa.readyState && 0 != pa.readyState) {
                    !localStorageSupported || null != storage.token && "null" != storage.token && 64 == storage.token.length || settings.setToken(Guid.newGuid(), !1);
                    "undefined" !== typeof window.connection && (window.connection.onmessage = function(Aa) {
                        window.preInitWS = window.preInitWS || [];
                        window.preInitWS.push(Aa)
                    }
                    );
                    var Z = function(Aa) {
                        if (null == Aa)
                            showErrorPopup();
                        else if (null != Aa.tokenBucketSize && (hasDataAccessSubscription = 5E3 < Aa.tokenBucketSize),
                        108 == Aa.status) {
                            Q = !0;
                            window.networkInitTimestamp = Date.now();
                            null != B && B.resolve();
                            for (B = null; 1 == pa.readyState && 0 < N.length; )
                                Aa = N.pop(),
                                pa.send(Aa);
                            V.hide()
                        } else
                            1 == q && (q = 2),
                            h(Aa)
                    };
                    T = function(Aa) {
                        Aa = Aa.data;
                        A ? A.read(Aa).then(function(Ca) {
                            Z(Ca)
                        }) : (Aa instanceof ArrayBuffer && (Aa = pako.inflate(Aa, oa)),
                        Z(tryParseJSON(Aa)))
                    }
                    ;
                    G = Date.now();
                    pa = null != window.connection && 1 == window.connection.readyState ? window.connection : new WebSocket("wss://" + na[qa] + "/apps/cloud/?app=keepaWebsite&version=1.6");
                    q = 0;
                    pa.binaryType = "arraybuffer";
                    pa.onmessage = T;
                    pa.onclose = function(Aa) {
                        Q = !1;
                        q = 0;
                        if (ka)
                            ka = !1,
                            m(!1);
                        else if ("blocked" == Aa.reason)
                            V.show(),
                            H.html("You are blocked from our services. Please contact us via info@keepa.com for resolution."),
                            storage.updated1008 = "1";
                        else {
                            qa++;
                            qa %= na.length;
                            5 <= ba && (V.show(),
                            H.html('Unable to connect to Keepa.com. <span id="networkAgain" style="color:rgb(255, 228, 192); cursor:pointer">Try again?</span>&emsp;<span id="networkAbort" style="color:rgb(0, 0, 0); cursor:pointer">Abort!</span>'),
                            $("#networkAgain").click(function() {
                                H.text("Connecting...");
                                m(!1)
                            }),
                            $("#networkAbort").click(function() {
                                N = [];
                                w()
                            }));
                            if (null == B || "RESOLVED" == B.state)
                                B = $.Deferred();
                            5 > ba && (ba++,
                            setTimeout(function() {
                                m(!1)
                            }, 6E3 * Math.random() * ba * ba))
                        }
                    }
                    ;
                    pa.onerror = function(Aa) {
                        pa.close()
                    }
                    ;
                    pa.onopen = function(Aa) {}
                    ;
                    if (window.preInitWS)
                        for (var ja = $jscomp.makeIterator(window.preInitWS), W = ja.next(); !W.done; W = ja.next())
                            T(W.value);
                    delete window.preInitWS
                }
            }
        }
    }
    function t() {
        fa = $.Deferred();
        var R = setInterval(function() {
            1 == Number($("#networkSeconds").text()) && (fa.resolve(),
            clearInterval(R));
            $("#networkSeconds").text(Number($("#networkSeconds").text()) - 1)
        }, 1E3);
        return fa
    }
    try {
        var f = window.location.hash;
        f = f.replace("%21", "!");
        "#!" != f.substring(0, 2) && (f = "#!" + f.substring(1));
        var n = f.split("/");
        if ("#!r" == n[0] && 64 <= n[1].length) {
            var r = n[1].substring(64)
              , p = n[1].substr(0, 64)
              , z = n[2] && 0 < n[2].length ? "/" + n[2] : "";
            if (storage.token != p) {
                var F = storage.install
                  , I = storage.optOut_crawl
                  , E = storage.overlayPriceGraph
                  , K = storage.revealStock;
                storage.clear();
                F && (storage.install = F);
                I && (storage.optOut_crawl = I);
                E && (storage.overlayPriceGraph = E);
                K && (storage.revealStock = K);
                p && 64 == p.length && storage.token != p && (storage.token = p,
                storage.removeItem("hashSynced"),
                storage.removeItem("keepa.hash"))
            }
            window.location.hash = "#!" + r + z
        }
    } catch (R) {
        console.error(R)
    }
    var H = $("#networkBar")
      , V = $("#networkOverlay")
      , S = $.Deferred()
      , aa = !1
      , ea = {}
      , ra = 0
      , pa = null
      , ua = [];
    "undefined" == typeof window.server && (window.server = ["dyn.keepa.com"]);
    var na = window.server;
    "undefined" == typeof window.serverIndex && (window.serverIndex = Math.floor(window.server.length * Math.random()));
    var qa = (window.serverIndex + 1) % na.length
      , ka = !1;
    try {
        if ("undefined" != typeof storage.initFailed || isMobile)
            window.forceNoSWConnection = !0
    } catch (R) {}
    var za = function() {
        return window.forceNoSWConnection ? !1 : serviceWorker.checkSupport() && null != navigator.serviceWorker.controller
    };
    $("#loadingBar").html('\n        <div role="progressbar" class="mdc-linear-progress mdc-linear-progress--indeterminate">\n          <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">\n            <span class="mdc-linear-progress__bar-inner"></span>\n          </div>\n          <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">\n            <span class="mdc-linear-progress__bar-inner"></span>\n          </div>\n        </div>');
    f = document.querySelector(".mdc-linear-progress");
    null != f && (progressBar = mdc.linearProgress.MDCLinearProgress.attachTo(f));
    try {
        if ("undefined" == typeof pako) {
            console.log("pako undefined");
            var J = $.getScript("//cdn.keepa.com/helper4.js")
        }
    } catch (R) {
        console.log(R),
        reportBug(R)
    }
    var g = $.ajaxSettings.xhr
      , D = {}
      , N = []
      , ba = 0
      , q = 0
      , L = null
      , A = null
      , O = !1;
    if (!isTest)
        try {
            a(),
            setTimeout(function() {
                A.removeOudatedCacheEntries()
            }, 3E4)
        } catch (R) {
            console.error(R)
        }
    var P = 1
      , M = async.queue(function(R, T) {
        var oa = R.entry
          , Z = R.promise;
        Z.always(function(ja) {
            T()
        });
        R = !1;
        oa.path && oa.path.startsWith("pro/") && 0 == storage.accountType && ("pro/seller" == oa.path ? "undefined" !== typeof oa.storefront && (R = !0) : R = !0);
        if (R)
            return Z.reject("You are not authorized to use this feature. Please register or login first."),
            Z;
        O && oa.path ? -1 < oa.path.indexOf("product") && !oa.refreshProduct && 0 !== oa.maxAge && null != oa.asin && 10 == oa.asin.length ? A.getProduct(oa).then(function(ja) {
            try {
                if (null != ja && ja.data) {
                    var W = ja.data;
                    Date.now() - ja.cached > 6E4 * oa.maxAge ? (oa.g = W.g,
                    Z.cachedData = [W],
                    Z.cachedType = "products",
                    b(Z, oa)) : Z.resolve({
                        products: [W]
                    })
                } else
                    b(Z, oa)
            } catch (Aa) {
                console.error(Aa)
            }
        }) : 0 == oa.path.indexOf("tracking/community") && 0 != oa.maxAge ? A.getComTracking(oa).then(function(ja) {
            try {
                null == ja || !ja.data || Date.now() - ja.cached > 6E4 * oa.maxAge ? b(Z, oa) : Z.resolve({
                    comTrackings: ja.data
                })
            } catch (W) {
                console.error(W)
            }
        }) : b(Z, oa) : b(Z, oa);
        return Z
    }, isTest ? 300 : 100)
      , u = !1
      , v = null
      , G = 0
      , w = function() {
        V.hide();
        for (var R = 0; R < D.length; R++)
            D[R].reject(null)
    };
    $.ajaxSetup({
        progress: function(R) {
            try {
                var T = R.loaded
                  , oa = R.srcElement || R.currentTarget || R.target;
                if (oa && -1 != oa.responseURL.indexOf("https://dyn.keepa")) {
                    var Z = Number(oa.getResponseHeader("Content-Uncompressed-Length"));
                    if (Z && !(1E5 > Z) && T) {
                        R = T / Z;
                        try {
                            progressBar.close(),
                            progressBar.determinate = !0,
                            progressBar.open()
                        } catch (ja) {}
                        progressBar.progress = R;
                        1 <= R && (progressBar.close(),
                        progressBar.determinate = !1)
                    }
                }
            } catch (ja) {}
        },
        xhr: function() {
            try {
                var R = g()
                  , T = this;
                R && "function" == typeof R.addEventListener && R.addEventListener("progress", function(oa) {
                    try {
                        T.progress(oa)
                    } catch (Z) {}
                }, !1);
                return R
            } catch (oa) {
                console.log(oa)
            }
            return g()
        }
    });
    var B = null, Q = !1, fa;
    return {
        ajax: function(R, T) {
            5 < ua.length && ua.shift();
            ua.push(R);
            var oa = $.Deferred()
              , Z = 1;
            H[0] || (H = $("#networkBar"),
            V = $("#networkOverlay"));
            var ja, W = ra, Aa = Date.now(), Ca = function() {
                if (0 > Aa && !T)
                    oa.reject("cancel"),
                    console.info("request cancelled due to navigation.", R);
                else {
                    aa = !0;
                    "jsonp" == R.dataType && (ja = setTimeout(Ea, 3E4));
                    if (R.url && -1 == R.url.indexOf("http") || R.backUrl)
                        R.backUrl = R.backUrl || R.url,
                        R.url = "https://dyn.keepa.com/v2/" + R.backUrl;
                    var va = $.ajax(R);
                    va.done(Ba).fail(Ea).always(function() {
                        delete ea[W];
                        aa = !1;
                        try {
                            0 < ea.length || progressBar.close()
                        } catch (da) {}
                        S.resolve()
                    });
                    T || (ea[ra] = va);
                    ra++
                }
            }, Ba = function(va) {
                clearTimeout(ja);
                V.hide();
                "text" != R.dataType && va && va.timestamp && (va.timeStamp = va.timestamp);
                oa.resolve(va)
            }, ta = function(va) {
                V.hide();
                oa.reject(va)
            }, Ea = function(va, da, Y) {
                try {
                    if (-1 == R.url.indexOf("://dyn") || -1 < R.url.indexOf("isOnline") || -1 < R.url.indexOf("app/stats") || -1 < R.url.indexOf("bugreport") || "undefined" != typeof isLoggerPage) {
                        -1 == R.url.indexOf("://discuss.keepa") && console.log("failure", R, "textStatus: " + da, Y);
                        oa.reject(va);
                        return
                    }
                } catch (ia) {}
                clearTimeout(ja);
                if ("abort" != Y)
                    if (500 == va.status)
                        qa++,
                        qa %= na.length,
                        H.html(va.responseText + '&emsp;<span id="networkAbort" style="color:rgb(0, 0, 0); cursor:pointer">Close.</span>'),
                        oa.reject(va, da, Y),
                        $("#networkAbort").click(function() {
                            ta(va, da, Y)
                        });
                    else if (401 == va.status || 400 == va.status || isIE && 0 == va.status) {
                        if (400 == va.status) {
                            var ma = tryParseJSON(va.responseText);
                            if (null == ma) {
                                oa.reject(null);
                                return
                            }
                            ma = ma.data;
                            var ca = ""
                              , ha = !1;
                            if ("invalidParameter" == ma.error) {
                                for (var C in ma.details) {
                                    var U = ma.details[C];
                                    "invalid" != U.message && (ha = !0);
                                    ca += "invalid parameter: " + U.type + " message: " + U.message + "<br>"
                                }
                                setTimeout(function() {
                                    reportBug(null, ca)
                                }, 250)
                            }
                            if (ha) {
                                oa.reject(ma);
                                return
                            }
                            V.show();
                            H.html(ma.message + '&emsp;<span id="networkAbort" style="color:rgb(0, 0, 0); cursor:pointer">Close.</span>');
                            $("#networkAbort").click(function() {
                                ta(va, da, Y)
                            })
                        }
                        oa.reject(va, da, Y)
                    } else
                        H.html('Connection timeout. Automatic retry in <span id="networkSeconds">' + 2E3 * Z / 1E3 + "</span> seconds."),
                        V.show(),
                        403 == va.status ? (H.html(va.responseText + '&emsp;<span id="networkAbort" style="color:rgb(0, 0, 0); cursor:pointer">Close.</span>'),
                        oa.reject(va, da, Y),
                        $("#networkAbort").click(function() {
                            ta(va, da, Y)
                        })) : 404 == va.status ? oa.reject(va, da, Y) : 3 == Z ? (H.html('Unable to connect to Keepa.com. <span id="networkAgain" style="color:rgb(255, 228, 192); cursor:pointer">Try again?</span>&emsp;<span id="networkAbort" style="color:rgb(0, 0, 0); cursor:pointer">Abort!</span>'),
                        $("#networkAgain").click(function() {
                            H.text("Connecting...");
                            Ca()
                        }),
                        $("#networkAbort").click(function() {
                            oa.reject(va);
                            ta(va, da, Y)
                        })) : (Z++,
                        t().always(Ca))
            };
            Ca();
            return oa
        },
        waitForNetworkCompletion: function() {
            S = $.Deferred();
            aa || S.resolve();
            return S
        },
        cancel: function() {},
        activeRequests: ea,
        lastUrls: ua,
        server: na,
        serverIndex: qa,
        onConnected: function() {
            return B
        },
        getWorker: function() {
            return A
        },
        connectToServer: function(R) {
            m(R)
        },
        reauthorize: function() {
            q = 0;
            za() && -1 != serviceWorker.workerConnectionState() || setTimeout(function() {
                d({})
            }, 400);
            serviceWorker.updateTokenInSW()
        },
        request: d,
        clearDatabase: function() {
            try {
                A && A.clearDatabase()
            } catch (R) {}
        }
    }
}()
  , networkHelper = function() {
    var a = null;
    return {
        abortAll: function() {
            return null != a ? a.notify() : void 0
        },
        loadASINs: function(b, d, h) {
            isTest && console.time("load");
            var m = []
              , t = $.Deferred();
            null != a && a.notify();
            a = t;
            var f = 0
              , n = $(h);
            n.show();
            var r = 0
              , p = !1
              , z = !1
              , F = null;
            onPageNavigation.progress(function(H) {
                p = !0;
                "pending" == t.state() && console.info("cancelled loading due to navigation.")
            });
            t.progress(function() {
                isTest && console.info("%cNetwork:", "color:red;font-weight:bold;", "aborting batch call");
                p = !0
            }).always(function() {});
            h = async.queue(function(H, V) {
                var S = !1;
                p || (z ? V() : async.timeout(function(aa) {
                    var ea = {
                        path: b.path,
                        offerPages: b.offerPages,
                        maxAge: b.maxAge,
                        type: b.type,
                        history: b.history,
                        domainId: H.domainId,
                        version: 3,
                        refreshProduct: b.refreshProduct,
                        getTracking: b.getTracking || !1,
                        includeDeals: b.includeDeals || !1,
                        stats: b.stats || null
                    };
                    0 < H.asin.indexOf(",") ? ea.asin = H.asin : 10 == H.asin.length ? ea.asin = H.asin : ea.code = H.asin;
                    network.request(ea).done(function(ra) {
                        switch (ra.status) {
                        case 429:
                        case 400:
                        case 401:
                        case 404:
                        case 505:
                        case 500:
                        case 1001:
                        case 402:
                            z = !0,
                            F = ra
                        }
                        if (null != ra.products && 0 < ra.products.length && null != ra.products[0])
                            for (var pa = 0; pa < ra.products.length; pa++) {
                                var ua = ra.products[pa];
                                null != ua && m.push(ua)
                            }
                        else
                            isTest && console.log("failed loading: ", H.domainId + " " + H.asin, ra.status)
                    }).fail(function(ra) {
                        if (!p)
                            switch (ra.status) {
                            case 429:
                            case 400:
                            case 401:
                            case 404:
                            case 505:
                            case 500:
                            case 1001:
                            case 402:
                                z = !0,
                                F = ra
                            }
                    }).always(function() {
                        p || aa(null)
                    })
                }, 4E4 * (b.offerPages && 0 < b.offerPages ? 2 : 1))(function(aa) {
                    p || S || (aa && isTest && console.log("product " + H.asin + " took too long."),
                    f += H.batchSize,
                    aa = Math.round(f / r * 100).toFixed(0),
                    $(".loadingProgress").html('<div class="bigAndBold" style="text-align: right">' + aa + " %</div><div>" + f + " / " + r + "</div>"),
                    S = !0,
                    V())
                }))
            }, isMobile ? 30 : 200);
            for (var I in d) {
                var E = d[I];
                if (null != E && 0 != E.length) {
                    r += E.length;
                    E = E.reduce(function(H, V, S) {
                        0 == S % 1 && 0 !== S && H.push([]);
                        H[H.length - 1].push(V);
                        return H
                    }, [[]]);
                    for (var K = 0; K < E.length; K++)
                        h.push({
                            index: K,
                            domainId: I,
                            batchSize: E[K].length,
                            asin: E[K].join(",")
                        })
                }
            }
            h.drain = function() {
                p || (isTest && console.timeEnd("load"),
                n.hide(),
                "pending" == t.state() && (z ? (F.products = m,
                t.reject(F)) : t.resolve(m)))
            }
            ;
            return t
        },
        loadSellers: function(b, d, h, m) {
            var t = {}
              , f = $.Deferred();
            null != a && a.notify();
            a = f;
            var n = 0
              , r = $(m);
            r.show();
            var p = !1;
            onPageNavigation.progress(function(I) {
                p = !0;
                "pending" == f.state() && console.info("cancelled loading due to navigation.")
            });
            m = async.queue(function(I, E) {
                p || network.request({
                    path: b.path,
                    storefront: b.storefront || 0,
                    maxAge: b.maxAge || 0,
                    domainId: d,
                    history: b.history || !1,
                    seller: I.entry,
                    version: 3
                }).done(function(K) {
                    null != K.merchants ? Object.assign(t, K.merchants) : console.warn("failed loading: ", I.entry)
                }).fail(function(K) {
                    if (!p)
                        switch (K.status) {
                        case 429:
                        case 400:
                        case 401:
                        case 404:
                        case 505:
                        case 500:
                        case 1001:
                        case 402:
                            p = !0,
                            "pending" == f.state() && f.reject(K)
                        }
                }).always(function() {
                    if (!p) {
                        ++n;
                        var K = Math.round(n / h.length * 100).toFixed(0);
                        replaceHtml("loadingProgress", '<div class="bigAndBold" style="text-align: right">' + K + " %</div><div>" + n + " / " + h.length + "</div>");
                        E()
                    }
                })
            }, isMobile ? 15 : 70);
            for (var z = 0; z < h.length; z++) {
                var F = h[z];
                null != F && m.push({
                    index: z,
                    entry: F
                })
            }
            m.drain = function() {
                if (!p) {
                    r.hide();
                    for (var I = {}, E = [], K = 0; K < h.length; K++)
                        E = E.concat(h[K].split(","));
                    for (K = 0; K < E.length; K++) {
                        var H = E[K];
                        t[H] && (I[H] = t[H])
                    }
                    f.resolve(I)
                }
            }
            ;
            return f
        }
    }
}();
function log(a) {}
function clone(a) {
    if (null == a || "object" != typeof a)
        return a;
    var b = a.constructor(), d;
    for (d in a)
        a.hasOwnProperty(d) && (b[d] = a[d]);
    return b
}
function logAppend(a) {}
var plotActiveIFrame = !1
  , graphRangeIFrame = !1
  , graphZoomIFrame = !1
  , trackTypeIFrame = !1
  , trackPercentIFrame = !1
  , graphDateFormatIFrame = !1
  , isMobile = !1;
try {
    isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
} catch (a) {}
var disableStockFeatures = !1, disableSoldNumbers = !1, isNewPage = !0, isAWS = !1, interval, offset = 129384E7, offsetMinutes = offset / 6E4, offsetHours = offset / 36E5, precisionDevisor = 6E4, offsetVar = offset / precisionDevisor, isHuman = !1, sso = null, sig = null, changeV5 = 4827410, changeV5Epoch = 15834846E5, keepaTime = {
    now: function() {
        return Math.floor(Date.now() / precisionDevisor - offsetMinutes)
    },
    minutesToEpoch: function(a) {
        return (a + offsetMinutes) * precisionDevisor
    },
    epochToMinutes: function(a) {
        return Math.round(a / 6E4) - offsetMinutes
    },
    timeShiftOffset: -(new Date).getTimezoneOffset(),
    precisionDevisor: 6E4
}, ajaxURL = "https://dyn.keepa.com/v2/", ajaxPrefix = "/v2/", protocol = "https://", rootURL = "https://keepa.com/", imageServer = "https://images-na.ssl-images-amazon.com/images/I/", imageServerAsin = "https://images-na.ssl-images-amazon.com/images/P/", CDNUrl = "https://cdn.keepa.com/", graphBaseUrl = "https://graph.keepa.com/", graphBaseFileName = "pricehistory.png", imgCDNUrl = CDNUrl + "img/", currency, dollar = "$", euro = "\u20ac", pound = "\u00a3", yen = "\u00a5", real = "R$", rupee = "\u20b9", numberOfDomains = 14, invalidIfLargerCatId = 0x7fffc055dadda000, maxCatId = 0x7fffffffffffffff, flag_1 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAABzElEQVQoU12Sz0sUUQDHP29bKuoQemkhUPCfyEBaCjEKr4ELRcEQQQUhBNUhSjS6R7BKEBrioaAicOoQmCGdxEstWVIL66HENHaddefH+xFvxpnN5vLevPfm+/nw5iucywuGfx8tkze9na1OdLnQ2ubn+q9szd+ZCRvwuHyM6Q+GUlEzM5ej1KeZnM9xsdge7XmldsIBYwyu+4w4oFjqZWZex5mBhEglUlJBKzIs7RvB/N6AP5vQaIDnIc4Psry4gHAuvTfHS30x9dQozN6OGBjL8/pGkxNjB6jkFBt3ErJSCq01HR3XabXGqVSW2gGTczojByGE2sQfy+ZH5PpERja+D0FA7sIgi18/IRzHNeVyPyfvGWZv+vSP7ufNrS0O3w+oDod0XfnC5tPemGwN0ruoFwp8d58nAUeHBnjyTmH3LfmzWkOF32A1gqpCHnpASjaeF4fsuTrEC2tQq1VNoXAEKaOYkhDatP/Jdr/Z3KJnb55Hr6YRcuSayZ0+i3n5dvdN25Oeh6nX41BLTuexwfA5pmo/ECsry6a7u4dGPs/BIKmH/cepTWoEOrb0/U6EWEPKkM6HdxGrzpmsiWm70rqFVgJIHNpjI+sj/AUdjRg+yE6/CgAAAABJRU5ErkJggg==", flag_10 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAAAa0lEQVQoU2P8P9P4PwMFgHEQGLC7nEIv/P+P1YCnT78wbNt2h+H/f0YGX18VBklJbqwhxfgfhwFr1txk+Pz5FwPIeH5+dobgYDXSDHj27CvD5s13GBgY/jH4+anhdkHiTF3KwkCog32IGwAA50I1lFJfIREAAAAASUVORK5CYII=", flag_11 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAAAq0lEQVQoU2NkAIEM9/9gGgr+T9+BzIWzzwupo4gbvb/FyDh4Dfj3/w/DzQPLGVYvWcaQ1DaJQVJEkeGSqDZxXvgzZQvD9y/PGPYvmcJw/txlBkMjXQavjDbiDfjRv4rh9p3rDMevnWd4vnMjg1FkAoOrjSfDNSlT4lzwd9oWhmev7jNcuHwOrMFA14hBRkyF4bywBnEGwKLx549PYA3s7LxgmmQD0BPD4EwHAKQAcQyYJnJzAAAAAElFTkSuQmCC", flag_12 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAABm0lEQVQoU6WSv0ubURiFn3u/DKIxCSQSTdRaFQRFBKVLKxStDoWiuDi42hZEhwoZRBERFEEEbdKhIo79A0Q7qqV0aJvBQRAyaAZj/AGKTbRE/L57i5+00SrS4tnf5xzecwThp5p7SNwKUBKE5lVg20bPJUtAC5DqhtVfAAGmQZUrxag/Tt2RtA/WvYrhvYfEUi5wWEA2dBagDIRQ9BYm6M9PEo60sPClAvPcov3JFqHQCjPpIiK7JSgtQV6AwAZILWjISzMe3KTVd8xitIP5zy/wO03SGZPo6hHdz5YY6P/G8p6HoZ1yoqculNCXgNqcnyxXrVGQY9rU7pFOPkXL8bgVvqAT7wMv1YEYQ+1hhAMOMwZNsXrWM7nZBI/yUkwUb9Lk/8HMbCNTH5rxOE8wzxUnZy4mB9boer7I6oGbwUQF368msG2VgSEs+ooSvMnfZfptK0tfKzEckrbHcXpefuTdWYBIshhLG9d/8Kebi6qsyxbG/HFqDiVaw4ZPMbJfxkbKDYZlV/xbd+7gdXAbieZ9shTUP+3g/yf5Cw8+o/xdML+uAAAAAElFTkSuQmCC", flag_13 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAACV0lEQVQoU02Qa0iTcRTGf+9U0jI1ZYqWl1WzNCKMog8apeHCyhDKqCShC4X0wQxMxMAiFZQsxA9FhREJlVgkEctSnGFGkEiQQxpGZVpeWFOYe/fe/uEU63x5znPg/A7nkd5XXBOO0PVUvnLT6HlGsGFQatgoT/hBzrYk8u5Mg9cDKMxX3qkc7C0dwGTAS/vzG8X9yizUuETkwQGE7ENKXkuUOYquEZmPn8fRNQOfolKUv5mQYBMjo27svSM8vN6INBAWJuJr6wiankSdncXw+wkJX4HfkJjzKdSH7sSjSSiyQmJ8JLZMC/V332FJiqatqQnp5vZCcaymhLCpn3hcX5GCgom0Wpgcm2Z4bhmtvyOwZafSbnfilRV8PpXKc1n0fPhGc/UlpOp6uyjZk0Cnc4YNE0OYNJ2hrXvZJUbpH3YzF59MSnwEmCSqGrs5ui+dVEsMQsDB3EKk87nlIq3ARv+YSob2KxBM71wk1oRw0oJmeDrkpfhwBi8dX3C6pkiIXUlupoXXfSPYWxqQ4LSouHGc8XEPXl1CUXWCdQW/X8enGiAMZFlF0TQMXXDmSAb32gYxRy/nzYPL84AToqKhmO/jHg7stmJNieZqswNFM9A0HVXVA1BV0/ErKj5ZwyQJLGtW0d1avQAoqytibGKG2rIcwsNCeOFw0drxaRFgLC2vjovgkG0jNbfeYk2KwfHoyjygQJTWnA1c2WQ1syXVzO3HAwghAm/oQqBpBrJf4eLJHaSvi+V51zDtnU76nlxYAIA3EN4//bPo52Xmv96NNbsKV0/t0uwv1AgflzdsYf8AAAAASUVORK5CYII=", flag_1l = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAUCAYAAACaq43EAAACHElEQVRIS72UwUuTcRjHv4+jiUTsvejIUbyxJduch2HFVkw2mGKwgwoKogdh4MFLl27eOojTm53Ug2XKLGUb9EYii704KCFih8UodDSLCgfBRizT5p54/4P39x72u3wuz/f5PDzwe2h6OsMw+JYRN5gEKBpN89ycH6XSb8jyFSHewbEhcWNlBTQ1tcfRqAcWyyXs7/9EX99VXdSMMzMeYTERoV6vgyYmXvP8/D3s7BQRCtmQyXzXzQdQhcXo6cG/tTXQ2NhLnpzshs12Gen0N4TD13RRMz7EG2ExuVz4u7EBGh5OcCwWxNbWIQYHr2N396tuzs7eEhZrgVqtBopEXvDISDecTgmKUkIkIuui1uARXgmLyeFANZEADQxs8sJCGOvrnzE0dAOp1BfdjCElLpZl/FIUUDD4hPv7XfD5rNjeLmJ01K6LmnFpKSAuJkK5XAb5/cu8uHgfq6sFjI/fRDx+qJtGDgh1duKHqoJ6ex+zz+fGyckf4emf4alwhqxWHB8cgPL5PNvtdjAbvpxCcu2AFItF0IeuLna63eBKRaiB0WKSJHwqFEDvZJk9Dge4WjXaSyhHFgs+Hh2BVFVlr9fb1FXncjnQXns73+7oAE5PhSY3XNzWhvfad1Ikie9KEvj83HAvkSCZzXhbqYCSySQHAoGmrjqbzYKem80cam0FGg2RwY3XtrQgc3YG2jSZmEwmoEn/GETgiwv8B94wQe5VjuptAAAAAElFTkSuQmCC", flag_2 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAACDklEQVQoU32RXUiTYRTH/0+2dRPSB6YVCiKDXBOWom4ZTIJqROqcROisHGoE0YqB+TKbClaOZhHTG132BWHUnI5I1sdFE9mmSRtJzV3MwEGpbUYXXujUR3xeei8ceK5+5zz/8+ec85D7vQEqL8qCZzKEX3Nr+B9cjQxTd2wszbttQLNljHEsnoDkWBqK/a8Q1ehAng/+oDoSxg6NBpHoEryTs0x4sTIXie6HjEXXjeiyBxkrjqai2PMUO7k2dL+fBtF3eGj1ORlO/hxlgpRKDax9QTRdkYM21LMaedwP410/rNI5rEVnIDYY8cIZQnOrmzcolaZhPraMC5I9yPD1Q2zqYI3MYDEG4nQxJhYLvi4AN8yjKMw/jIEBH0g4EqeS7H0gRFhfAKqt4CdwupIeKQUCoT8gDn0bLZOnQvTtOy9ajCWJV6K/k2rizIPonJjffoLlwiLWuOvLhGCwvr4qcHD6L8gJrYOWn8lh1zffVCL/AEA5jh1uq8Fm7mtsR7UtDMXxHAwPfeINGnVSXNLmYuWeGdi9F9dmj8DedVYwEI17oTrvgudNBVZ7bPgX8OOZ0oRbLU9AHo1MUYNahkSnGeMqPYY+L7ARH5gUQBV/ROoYRNXVEcbGyzKUKLMQr6+BaX8dSIt9jGYOv4T7kBp+b0TY793rWrhPl7Fc/eEtClT8125GRno2OOspWJo+YgOa38rkXZuAuAAAAABJRU5ErkJggg==", flag_2l = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAUCAYAAACaq43EAAAFD0lEQVRIS6VTe0xTZxw9l1eLtGChRR7lMR7FFQWsViRjPGfUgfgKGxjdjJuPKMl0g2w6xbllcU4RkzFDJVPIItPhm6EbE0G3+WKCoMUJgmCBVijQQmsLBe/Sr6PuBlSM95/m3u88fufr71AqmYx2S08HHCfhwnUFTl1S4EVP/pZotGzahBGtFsGHD2Pb99eg7h9+Li1upifm27ZBW3kR/KVLQSmLi2mOSAS2SARbDgcGgwFN7QYMmkaeKSQVC6CvqSHnThIJ6pt6n4ln2dsiwM0O9moVwdsFBpFfaut3V+jP0sXQl58DS+AObuRskr7mXg+q5d3jmm9IFaOroICcua9Zg8LSe3hsHDvo9EAXSPAIusZGTJZIwBKJMDw8jG+LakGlZpXRGe+GEZHpffcw1NIMl9hYAnrU+xjn/1JAqzMxBvgofRoxfqLVwiMzkxj/H+PCsUeCyAms2j9h6+QEXnw8uc3qhm4YjUPIO1ZvMV69SIz6+30Q8Bzx9lQ7oOoibDw8CMGc/kqdEtfuPE2f9V4EVHv3kmHMxgdKGqA3DJH3sCAeotk90N+8yQhQ+bcSCtUAOT90psFivCRRhBZFrzXVmzO8SHpjbQ14KSnW9CcqWqHp12PrB1KrsWDzx8j7uQH2djZIDnMG+/J50Fwu+MnJjKFNJsutBfi44lRFI6i31h6nlyeF4v7DPsZ1Clw5WCp2gP3vZ0EJhUSIZrNRcaMDibO9od6/H4MaDYQ7vyRtiDQ0k0G5CQlgh0dArTXCPGhnVz9DN8iXh+IyucV4ceJUtLQzjUfRcyOFmNlTD/3166QGZlHz074jGyM6Hfxy9qHn0A/km7mWo8P9UauEcWjswgUIeThd8Q+ojs5O2l3gDpp+8qL6Ms4fZmaSd9///uuJkinKBl3dXaBuxMTQguhoDHV0TJT7SjgHb2/UVVaCOh0VRU+TSjHU2flKghMlO3h54U51Nahbt+/SwQG+E+VZcfdTU2E/aRL8iopemtvU8hBUcFI+HSH2QZ/WMK6AeeOXxXlhRKOBViYjC+W5axfkCxaAxeEgqKSE8AavXIVKlg8baSQuCONw+lLbuHo8F0fcalCA8ozaQodOn4nefiMDGOjDQ/aH4fD14GKwqgpKmQxTFi1CEUuK9UsCcTcmBjYuLggpLcWPvzQibd5rsNHr0ZuTg4H2dvSnrUdetQnNCmZbXJ3ZkN++aTH29AtlmK5eGMIQ0qnV0C5eha8uWDp5Ys9chnH8ulKYBbevjUREsDMZtDUnB85JC3HcNQYnK5oY+so2+VPjgQEd/Lz5yP1kDkn5uKwMivx8Qj5oNwelF+WEzOVyUClbiDqxGA58Pl6/fBmzlv9kFX5/8QxyI+b03dnZ0D54AEPGNjJ0W4ea8K3GHFc/jBKGe/qg2rkDlEYDzapN2HyyCyq13irswXdCed58NISHk2/iujqEpZ1gJDJjcjNjEervCFN5Odp278aUpCQUeCaj8Mxt0PpWy3KVfBMLoafACpq8fAX2DUfi+K/1YxbE33vyGGPRkqPjLtL6dyTYuMwftgN6EsYol2Pw8z1Iy60EdfTIMTpulgTKLZ/CpFajZd1GbC/uQ2fP4LhiXm4sVBWkoFkqtSb2Sz7yzEqF+Lvh64w3IJ3KJcGasrJwJyEB1IGVK+n+s2fhnJKCc1Qwfrva/txe8vluyM2IQOuGtQTnf+AgVn5R8cIuz4sSYsW8EJh0GnALC/EvQHYvjUeU0r4AAAAASUVORK5CYII=", flag_3 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAABYUlEQVQoU41STUtCQRQ9b1EkUZt+iLaNIMLCEoOQoGgZEe36kKhNfyDoF7SVECyCjBZBSFm2KQha9xNMnzoz72tm4s3VpxKBA8O995x7z517GSudTmmoFvoPE2HEBrD/Aiu9NKP3D48j3vc94zuOE2FC8A5mlOE4ZIvFAiKB6tsnkYJIu2FHAvVG3fjNJlnGWtjMJHF5dwtrZ3lWb+/l8PXyQQKcuokWjSU4B7MbkZhd+zF+IrtAAo/z03ru4ASovBtCCwHteeYq14V2XUhG+1CMQQkBxTlG1lMolcuDAsMWh2J/BPRDZajOYXH4orGtLL2gcBrXaxtH8L5faYR2LZpXMppXiqaxgaDFSpdjMpHBzXkV1n0+rhdXcpDtCpEBJUufkoNOHPiEq4BDKR+xqVVc5Z9JIJnajbqaYq+3den3PpkM2gN51xdPsEpncd2Psm5+rIe2FDDhAswDxkfJds8v17z51coLdO4AAAAASUVORK5CYII=", flag_3l = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAUCAYAAACaq43EAAABjUlEQVRIS8XWQUuaARzH8d9ftyIaJKwMBEmY5JQexKSoYGCHOj0XPYigB+WB550EnbrslCBe3LCLXTzVISGoKJrIM3SCYw1JMBo42Bjbyl/v4t/3DXyuX7Ftm3iGxLIs2ratSheLRUg+n6dlWWi1Wip4NBpFqVSCZLNZFgoFOI6jAhuGgXK5DEmn08zlcuh0OipwOBxGpVKBJJNJZjIZdLtdFTgUCqFarUJM02QqlUKv11OBg8EgarUaZLi9zdemCd7cqMASCOBHvQ65TSTo3doC+30d2O/H3fEx5Nv6On2JBDgY6MA+HwaNBqQbj3NhbQ0cDnXg+Xl8v7iAOIbBN7EYeH+vA8/O4muzCbleXOTbSAQcjXRgjwdf2m3I+ccAlyJB8OGnDvxiBp/bPUij7GPM8IOPv3Vg9zSaTh9ytD/HlagXGP9RgeGawlXrDlJ/7+HGsgcc/1OBxTWBs08jyOHeNN/FX4H8rwPLS5xe/4Ic7E5wc3US4FgFhrhwcvkX8mHHTRE3AK0DEpCPeAIBmJeHAt4UxgAAAABJRU5ErkJggg==", flag_4 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAAB2UlEQVQoU43S30tTYRzH8ff3WNJwcwYaOoc1hTlpNfOs+aPLyG1qIXUnBA0qY5INjS67DbW7uuuif6A/QOZFUKh110U33QTR1UZRWGc7ds55ntiOSCOInj/gxefzfD8yP/tEj5qjeI6HCOzbLtcLKU4nu/nzqXc72A8LEAyB1gSmh/nx7AVyOb+hh2IpFKoJ1GsOt5dMTLMPpZRvGAbumy3qpRkk2AlKERoPUHn5BZnLb+jB2FnQLiKGDxRNzPORVmB3C2tl3ge0R9gMUN2uIHO5dX3q5JlmgjbR1G2PxSWTdLq/FdguY927gtERBkPRORakultBZrNrOhpNYoii0cGuORSX06Qz0RbAebXJz5t5JBgGrTgeP0bl0x6Sn17X/ZERRBRaa/a+25TuTzJ5YeBv4NYMRsgHugbbqXy2kNylNd3Xm8DzHFBQqzusPphiYuo/gezFR7qnZ7ipNq9gu6z8I8FhhaGDBHO5x7r3RBxEIfjA3dI4mYnWP3Bfb2LdaZzRrxCOt1P9aCEL157qaCROI7+0Cfs1lxuL50iNte7A2ylTX85hBLuaO+hIHuXrBwspFp7r2EDCT3CwxKsLIySS3SilD4ek3pb5tZpFGmdsLDFzhG/vLX4DfLjm5WxVFyQAAAAASUVORK5CYII=", flag_4l = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAUCAYAAACaq43EAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAAAZtJREFUSIm9lEGO1DAQRZ9jt8RiGrgGV2DHaLZzBM7ATTjPXIQNG/YI0U2cdBK7XMUiHQmG7iQNEX9l2b/q6Zctu4eHj+Z9xZKenj4segC+PL5fNlWOUFUV9/dvVjVdo7t3bxc9/afPBBFlGDLH4wkD3DOTAc7Wg/PXb+fCc5FzuPPagPD6JZYGgqrSdYm+z+u7z8j64c+9X9baD6gIIWel6zJdtxG46+fPdztIQhApNM1A26ZNwKU9zRt8hYmMdxxjR9uOI7p0z7dIl8DOYUMaE9d1v1liWwCb2QjOuRDjcOGOp+y3zaA0E/hyvRVFUxofV133DMMEnszwN0PX05XEZuOYi0DKBBEhRiVnuRlyEdy2s+cuJfB+TNw0J3Ium4DL9+M8eLfDv9qPj0vEKOWG72lOOvW50q8UNGdCjC1mfrPEltLvz+S5nCPHhiBieA+q2yQ2s+tQwDmHZCGUIngfxoJtyIsWLYVKVXHuX/6qG+UcqkplZvxP7gQOI9ix37/YpG+1v1v0qBkBjBh/LJoPh8Mq8LGuFz0G/ARPQgf/2BYuEAAAAABJRU5ErkJggg==", flag_5 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAABVUlEQVQoU12SQWoCQRBFfw/ZqKM3EG8huPEA3sAslGTtwpXncJ+Q6Fb0Ai7cJKcQRCMogk5kGFzojP2lu+3WmYGmiuqp11X1S5xOJyLzSSl1RNmsb2PKJvIKoQD5fF4nkA+Wceli6i57drvdA5BOJjCbgT+/YHwBq1Ww0UgBhBDYbrcGkMvlXBMaNJmAwyEYx+7gtQn59u4gCrDZbNIAXeLhAHQ6YBia5MtFW93QYABZqWiIAqzXa4goilgoFBw5ns/x0u2mknk+g0kC9vtgrWYAnoe/1QoiDEP6vm8AIETwD9lug1FkXr9XoGbqjcdIymX9r+d5WC6XBmArsErw8wP8+n7MQEGaTbDXc6qoFlaqguPxyGKx6PRWdK39aAROp6aCeh3XVkv3bdVS/mKxgAiCgKVSyc3AVaHUsAt13xG7B1YyDdjv98xul0yubguf7559C7kBliRnuKPjqCMAAAAASUVORK5CYII=", flag_5l = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAUCAYAAACaq43EAAAB90lEQVRIS8XVPUgjQRgG4HcE/41JNibZKCFCFMGAghba2GljYWdjc8gVNjaieFhYWRwn2tlYiNjY2FnYaGfjFlE0qBFJMCTm12wS179TyBxzC1uIzk4hcepvvmfej51ZkkwmKb5hEQZ7PJ6K0qlUCgZMaWWCE0JgwLIsVzRxOp3WEzNYNPFLLImnqxj+ZvIApaiVW9DQ5UOdr1Xo8CyxAbvdbtNN9PUNd3uHeDyPfFjbGPCjZXQIpKbatFcmk9ETM9gscWprF8+ROLdpvd8Lz48xbg1LbMAul4sLP5xeIb29Z5qEFcgTo2jq7fq0lsHZbFZP7HQ6ufDt+s6nI34vsJG3TY1z4Vwup8MOh4MLRxbX8JZVhRJXuyT4l6a5cD6f12FJkrjw9dwqXtlXLLBq3A50rsxyYVVVddhms3Hhm98b0I4vBFjA0teN9oWfXLhYLOqw1WrlwsXDIGJ/NoVg369J2Ib6uXCpVNJhi8Viep2u51agnYS5eHN/AB3LM6bXSdM0kEQiIQSXn18QW96Eun/0YWNpZBC++UlU1deJwdFolNrtdqExsqJ75QzqgYLHyyhQLqMx0AFpeADNAz3CPQqFAkg4HKZmD4hwR4FC4wEJhUL//8dmT6ZAT6ES47cYDAap1+sV2vRVRfF4HERRFMpOUcnFpvsPHXUA1Vwc3ioAAAAASUVORK5CYII=", flag_6 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAACEklEQVQoU1WSzUtUURiHnzufztz5qAn6YCS1jFqEtOgDoyCDVkZF/QeCSBtFEyooEBRE/CDCEANpES0iatOiTURLoRaGIhQtwsHGudfbdZp05s69556417rZuznve87vffidc16l3HlDyrKJF/a6RuLjvJ/vDNd1/dJxHPRcLjjaAJQfJ9pl8lbvtqBSJtHTHQhqpieBaCbtr65wKQ8MEk0mkbbg68NJlI1zF2VDTzfCMLAMg+zQPV8shGBjcorIlkX0ziChP1jz2nVCiTTh/H6+zUz/c+CslRCmRmp4mNriMpZbR87MIiwLt6uLiBDETp3E7LxCuCGO0tjE4pPH24BE703s70Uc0yA1OoLZNxDYdGwLp1Znq1Bg36vnGBcuEVITxJsPs/B0DkU/dlwm+wcQuo6taaQnRn3rfFrAjaqENuvUKxr1I63sGhnGON+BklKJHWxh+cUzlFLTUane7qdeLCHXVkk/msb+WcEYGiKyUvRvvhmPsntqnJCaRDt9lngmi8w38uX1S5TinrzM3L+LVVjB0UtkZmcRroBqjV/v3/mA8Jl2v9l7WK2tjVhuL+FDrcx7gM8g8+MPsAoFhLaKOjeHlBLv77f0EpFYImj2YB4grGYJN7fw4e2bbcCBkTEcq4a9rpOaGAsA3uDsDM9B+fJVZDrrbweAvyJvbNSlJarVatBnWVaQ27ZNsaPjP+hvICgB410MezgAAAAASUVORK5CYII=", flag_7 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAABtElEQVQoU52SP2gTcRTHP+93uYv9g43aqilBKSnoIJEs6uIgUhAK4lKhDoKCFRx0EbqIg7gILjoIVlBwsGAXEQqiiLgpHohRxMFENNKgNnjVhjZe7p7c/VyKDup3+A3v8T7v8+AnQRBofOMy/xNz5CRSq9W0d+Y6A3sP/JERrlHcr/Jb78vDOyyOHUV839f87DSDo+MEL5+T2RgTLQjaFsRTMgNKpykQCxoBArktZeZmp2mMjlvAutvX6B/ZB/IOb7iDN9/HwocW0bxBO4K3KUoHw7oBB9zCZpqP7tE8eMwCmJpiaPcOnFyd7j0hUUP4fj+LLgMGRECTI9IH3PV5ao+fwcTEL8ClcxTKOzG9n3FyCkZpv86gHazBUOIO4XtrkFnbT91/CqfOWkDr/GmK20pEiwG6LJBRxEmtMX0Ksd0efZO06KzOUX1VoefMRQv4NHmcrcNF4lbLTiWqCpJVusodlnyXOCSFJjHdPbx5W2XDhasWUD1xiO2FQeJ2cvTKaAxiVtZMdhUvPs5RvHLLAiqH91Pqyv/TX6osNSjdvGsBT8ZGcFwPTdb9RUQMUfiDXTMP+AkkxbXvqu101QAAAABJRU5ErkJggg==", flag_7l = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAUCAYAAACaq43EAAAChUlEQVRIS71VTWsTURQ9982byUySSSJYq7UQFyoKLVi0ixaz6KYLQVGwFBW3IrjxN/QPuHHhD/AfuHYl7kQRXLTYalvbgmBsmnaSTGbmXZnMTBtspBMDeas3951zz/16b2h74QGTJtBrkckQRUbws/d5T1IaIwnQzuJDNis3e8LlCCNzLYDzVgIqjcd0mPbyCmj7/iJbszNQe3Uwc4dJRJEHqaDZDP93lHFo78Yk+265hPsvnCgW4K2EwncX2Jy+DlXfj7TKCv62APwjdyLHyN7x0Hov4W8OVnZRsOGtroG2bt9j88YkVGMfEEDpmYvay0yntOxGmZME5LiC2iUEe3E10lX1GCoU9r9vgLbmb7Esl6EcB6WnbZgVH613ErVXxiEpFDYmAvhbAsGvAYVzOQTVKmhzbp7luVFws4nScxf11zoKjz3UXmSAqOWgPKP4pA3njYT3VfvPXGNfWavTVtqszLEonQL0JviAIjECyFKAIGgFBX+nWywGJFGF4M5K7Elc3bijKpFpglst0MZMhcm0wK4bhxSKR6kalxXsRx6qS2Z0nWI7kqkPv5P9SXWIsWQYgO+B1qdnOeSy5x0fhCygnWZ4P+JKnOQ8xTnpOqBpoPWpaQ4cB+ghnMJP/xBdh2bboG8TU8zNBuAnFzfsx0n9iqfuWH+7eQnmr9ikBOXzoLUrk0yuCz4U7j+JfhgkJdiyQKsXr7Lw/Z497sdhWmzYY6VL0PKFS6wzg9vttNyBcOFUe0KAvoyV2TKMzgMyjEWWhYbXBn0+O862lYVqNIahC5HNYr/VBH0aPc/FXL7zVg9jiVwOe84B6OOZMS7ZhWFoHmrs1uugDyNjPNj/pv+Ywxv+B4u6+rLjbNaLAAAAAElFTkSuQmCC", flag_8 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAABk0lEQVQoU43Sz08TQRTA8e/bpS0xwDYNoW5riMGoJSZevCF48UYrJca/gYug8cLZhH9CTxzl6t3UePfKQUL8Qct2dg2ljTGB0p1HutYa08Y4p5n3Mp+892bk7vZjTd2Y5feqB4bw5dvh+a/N/DzMzQ1DhwsLyM2tijZnJ3B6iiNC29TR1x9HgAtjSPk+ZLPQbif5d5UKUnq+pt9zfcAmQGiOxgJdE5L2r6L5PFiLxDG1lRVk8dkjjTzBsYorDiZqjAcCQ7ro/wGs/QWUtioaTWsCOOISnQRjgfMgIFMsop6HdDpJC7VqFSltljW8EuP0Iz3LyfEBuvdlZAZDIJtFBjOora8ji5tlPZ48Q7p9xHIa1dE3n/8fuP10VT9dhMkFLzNFJzpC9/4BTHvIj0ELa1XkzouyNlI/cfuCuLTCr+ju4WgFzSaZQgG9lgMGr7D8ELm3U1Uzc4bEFhfhW6uB7uyPAN2oSXq1gOZ8iGNE4P2tB8jSqyd6mj9He5oA+60A3RjzkTqG1LYPM9dBY5iAD1P3uQSwOL94YLv3EgAAAABJRU5ErkJggg==", flag_8l = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAUCAYAAACaq43EAAACfklEQVRIS62WXUiTURyHf8dNl6VhkZplJpb6TjfExFj0wSpmRhosRCwzlcEiqYSsMCswA0tKCSlIobAsSEQkS0JiERTShbPcZOkyN3NujCYqNsxMT3nR7X/novf6ec7D74X3gxnf3OEQuJr2lgtQwMi1m0IcM7yu50b1oYDw9ujkgMwyMGu1BeQ87Z1gJT23uEGVjQHfKCmUqXMDHrgMeJ51kFxYciLcHc/BCrtreak6G9ZJBymUp+mFwu4nbSS3MnEL3J0vwPK7avhxlQ6fJ7+RwvlteULhiZandDghHq6uV2D6jqu8QLUfw1MuUriceVQoPN7cQnKh8XEY7+4By2mr5EdStRiZdpNCjeaEUHjsbjO9OC4WYz0msKzWCp6j2gXnjJcU6nYahMLOhnskt2JjDJymt2Dah2e4LlWD8dnvpNC4p0woPHqjnuQU66PheNcLtuP+Sa5NyYTbP0kK/+sFooiKxNfeD2AZjaVck5IOr3+KDLdmXRRabK+sJrmQdWvxpa8fTH27kKcr1fDNzZBC+8ErQuGhc1UkF7wmAvYBC1hSbR5PkZSYnv9BCi9zrwuFbWUVJCdfHY4hmw0svvow3yolYWbeTwomfZ1QeNBwmg6Hh8Fmt4NtuJTNN0kJ8C/8JIX3eQ1CYUuRkeRkoaEYdDrAIiv28ShpM+Z+z5OCuYB+Pv/Jn/KLyXOCFApYJlxgEWd38wgpFr8WF0jBeqxJaHG/vpBeHCzHR68HbNUpDQ+TYrCwuEgKw0UPhMLmnHx6sVyOfp8XLMSQwRXKaCzxJVJwFD8WCvcdCPD5ZEEwT/nAZCVpXBYkA+f0H9Aj3QWhsL2qhuYYA/97d/8Ay4HaIqKlU4EAAAAASUVORK5CYII=", flag_9 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAABSklEQVQoU2P88OHD/48TZjGQA/gL0hgYL1269J97+UYGsSAfksx4tW4Lw9dIf4gBrPNWMkj4ezJ8v3WHKEM41VQYXmzczvA7KRxigPL/VgYOyWCGf98fEmUAE6c8w4/naxnuMlZDDJD4Ws8gKGXF8O/3B4a3r1kYnj9iZ5CU+8kgLPoHq4FMrAIM758dY3jB3QgxgO91CYOkvCnDt4/fGG5dZGL4+FeLQU6Nk0Gc5zQDJ9c3DEMYWUUYnj88zfBJtAdiwL+bcQwaOuYMH979Z3h4k5fh2ZNfDFIybAzy6p8ZeHk+YhjAzCbAcOPKSQYm9UUIA5TkhRm+/WFl+PH9H8P/n6xgTZwCfxm4WH5j9ca9h28RBpwIjGXQEhIlKgBhiq69e81gsX4xxAW7XAIYDPiESDLgwqd3DG57NkAM2GrvTZJmmGLvg1sZAKZYjW3zq1NvAAAAAElFTkSuQmCC", flag_9l = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAUCAYAAACaq43EAAACdklEQVRIS72VT2sTQRjGn3c3+z+bpCG0YmkVqSJKUQShlnowFaEWBD+D934K8Sp61osgopeCHyAetQhFoU3Fg1ZKW0xKSLLdbXY3O6/srq3tQUpSzXOZ3dmZ9/c+M+/M0vbtOYaqYtCiGGyUbw2UG1TXcACOarW/wxkAHZNbPCbW4XGH5/3+Lo8MIwFvzZRZm56CaLUH4lrK5xCsrKZg9crkQMHh93VQ/c0kW8Z1sO8MxDFpNjpuC8TtGYZ0CmD3CJhZoONbcH6mm2OPEHTNBZF0sgTJAgsnBl9lxggIh8AZwGtE2Fk0EYoUpEgCpfsezKIMdPtnM6yERdy6zKAhALsH0ZbfBhi9oEBeF6ivmVALOdizWbD3DZtfQ1y7d5Jzn01YxK3zDMSBghQsR2i6Zfg/PmL98V7SNX7nWdIad18kbcGqAJHcp+006RTMLeyvX9gO0Kg8gF9dxPaGjqX6EKZvLmB0fAy68QReq4ThuZdQcv26zgCUB4nmGSbEzlLHYbubgGWzgujzFl4vTST98xMW8uU6Iq+MYvk5lFymb8cMAxQ1TrMkdQBOKyZ0BGrNBQwV38F/VYVTz2NzOV4R4Nyjs+jq8xguPIVi91ndlIEQOsivl1hVBMB+EjzoGnhfncJFYyMprlhxgdnqCpTZCXzZG8ONSx+gZtL971mkIQglUO1hkTNaBKkTHsRoOSVoigtd30P8HCt+j+WHFvL2Ts+8/QlCV9D1ZdCqkmVTUcGe13ewXiaSacILgxRsqRqEe/Tm6iVYL2Mly4Ib+KBPpHMha0M4g7mrJdtGc9f5A4ZIC+m/S5LQcNqgZWgs0XF/+X+bjmDGLwotAlW0wG/NAAAAAElFTkSuQmCC", flags = [null, flag_1, flag_2, flag_3, flag_4, flag_5, flag_6, flag_7, flag_8, flag_9, flag_10, flag_11, flag_12, flag_13], flagsLarge = [null, flag_1l, null, flag_3l, flag_4l, flag_5l, null, flag_7l, flag_8l, flag_9l, null, null, null, null], englishFlag = flag_2;
try {
    englishFlag = "en-US" == navigator.language ? flag_1 : flag_2
} catch (a) {}
var englishFlagLarge = flag_2l;
try {
    englishFlagLarge = "en-US" == navigator.language ? flag_1l : flag_2l
} catch (a) {}
var maxTrackingAllowed = 5E3, verifyRegExp = {
    email: /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,
    asin: /([BC][A-Z0-9]{9}|\d{9}(!?X|\d))/,
    globalAsin: /([BC][A-Z0-9]{9}|\d{9}(!?X|\d))/g,
    productCode: /(\d{12,13})/,
    globalProductCode: /(\d{12,13})/g,
    sellerId: /([A-Z0-9]{9,21})/,
    domainId: /^([1-9]|10|11|12|13)$/,
    vatId: /^((AT)?U[0-9]{8}|(BE)?0[0-9]{9}|(BG)?[0-9]{9,10}|(CY)?[0-9A-Z]{8}[A-Z]{1}|(CZ)?[0-9]{8,10}|(DE)?[0-9]{9}|(DK)?[0-9]{8}|(EE)?[0-9]{9}|(EL|GR)?[0-9]{9}|(ES)?[0-9A-Z][0-9]{7}[0-9A-Z]|(FI)?[0-9]{8}|(FR)?[0-9A-Z]{2}[0-9]{9}|(GB)?([0-9]{9}([0-9]{3})?|[A-Z]{2}[0-9]{3})|(HR)?[0-9]{11}|(HU)?[0-9]{8}|(IE)?[0-9]S[0-9]{5}L|(IE)?[0-9]{7}[A-Z]{1,2}|(IT)?[0-9]{11}|(LT)?([0-9]{9}|[0-9]{12})|(LU)?[0-9]{8}|(LV)?[0-9]{11}|(MT)?[0-9]{8}|(NL)?[0-9]{9}B[0-9]{2}|(PL)?[0-9]{10}|(PT)?[0-9]{9}|(RO)?[0-9]{2,10}|(SE)?[0-9]{12}|(SI)?[0-9]{8}|(SK)?[0-9]{10})$/
}, tld, CsvType = {
    AMAZON: {
        index: 0,
        deal: !0,
        currency: !0,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !0,
        graphAPI: !0,
        color: "#FFA500",
        fillColor: ["rgba(255, 224, 193, 0.5)", "rgba(255, 224, 193, 1)"],
        bg: "rgba(255, 225, 192, 0.8)"
    },
    NEW: {
        index: 1,
        deal: !0,
        currency: !0,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !0,
        graphAPI: !0,
        color: "#88d",
        bg: "rgba(225, 235, 255, 0.8)"
    },
    USED: {
        index: 2,
        deal: !0,
        currency: !0,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !0,
        graphAPI: !0,
        color: "#444",
        bg: "rgba(230, 230, 230, 0.8)"
    },
    SALES: {
        index: 3,
        deal: !0,
        currency: !1,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !0,
        graphAPI: !0,
        color: "#8FBC8F",
        bg: "rgba(198, 237, 203, 0.8)"
    },
    LISTPRICE: {
        index: 4,
        deal: !1,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !0,
        color: "#8B4513",
        bg: "rgba(214, 175, 147, 0.8)"
    },
    COLLECTIBLE: {
        index: 5,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !0,
        color: "#B0C4DE",
        bg: "rgba(220, 233, 251, 0.8)"
    },
    REFURBISHED: {
        index: 6,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !0,
        color: "#00FFFF",
        bg: "rgba(198, 255, 255, 0.8)"
    },
    NEW_FBM_SHIPPING: {
        index: 7,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !0,
        isTopGraph: !0,
        isBeta: function() {
            return la._498 + la._496
        },
        isOfferData: !0,
        isTrackable: !0,
        graphAPI: !0,
        color: "#039BE5",
        bg: "rgba(177, 213, 255, 0.8)"
    },
    LIGHTNING_DEAL: {
        index: 8,
        deal: !0,
        currency: !0,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isBeta: function() {
            return 'Tip: To only view lightning deals sold by Amazon use the "Has Amazon offer" filter.'
        },
        isOfferData: !1,
        isTrackable: !0,
        graphAPI: !0,
        color: "#ff0000",
        bg: "rgba(255, 221, 221, 0.8)"
    },
    WAREHOUSE: {
        index: 9,
        deal: !0,
        currency: !0,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isBeta: function() {
            return la._498 + la._494
        },
        isOfferData: !0,
        isTrackable: !0,
        graphAPI: !0,
        color: "#9c27b0",
        bg: "rgba(237, 206, 243, 0.8)"
    },
    NEW_FBA: {
        index: 10,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isBeta: function() {
            return la._498 + la._495
        },
        isOfferData: !0,
        isTrackable: !0,
        graphAPI: !0,
        color: "#ff5722",
        bg: "rgba(255, 188, 167, 0.8)"
    },
    COUNT_NEW: {
        index: 11,
        deal: !1,
        currency: !1,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !1,
        isOfferData: !1,
        isTrackable: !0,
        color: "#88d",
        bg: "rgba(225, 235, 255, 0.8)"
    },
    COUNT_USED: {
        index: 12,
        deal: !1,
        currency: !1,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !1,
        isOfferData: !1,
        isTrackable: !0,
        color: "#444",
        bg: "rgba(230, 230, 230, 0.8)"
    },
    COUNT_REFURBISHED: {
        index: 13,
        deal: !1,
        currency: !1,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !1,
        isOfferData: !1,
        isTrackable: !0,
        color: "#00FFFF",
        bg: "rgba(198, 255, 255, 0.8)"
    },
    COUNT_COLLECTIBLE: {
        index: 14,
        deal: !1,
        currency: !1,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !1,
        isOfferData: !1,
        isTrackable: !0,
        color: "rgba(220, 233, 251, 0.8)",
        bg: "rgba(220, 233, 251, 0.8)"
    },
    EXTRA_INFO_UPDATES: {
        index: 15,
        deal: !1,
        currency: !1,
        showDefault: 0,
        isEnabled: !1,
        isWithShipping: !1,
        isTopGraph: !0,
        color: "#444",
        bg: "rgba(255, 225, 192, 0.8)"
    },
    RATING: {
        index: 16,
        deal: !1,
        currency: !1,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !1,
        isOfferData: !0,
        isTrackable: !0,
        color: "#009688",
        bg: "rgba(200, 255, 251, 0.8)"
    },
    COUNT_REVIEWS: {
        index: 17,
        deal: !1,
        currency: !1,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !1,
        isOfferData: !0,
        isTrackable: !0,
        color: "#8ab300",
        bg: "rgba(222, 239, 167, 0.8)"
    },
    BUY_BOX_SHIPPING: {
        index: 18,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !0,
        graphAPI: !0,
        color: "#ff00b4",
        bg: "rgba(255, 204, 240, 0.8)"
    },
    USED_NEW_SHIPPING: {
        index: 19,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !0,
        color: "#444",
        bg: "rgba(173, 173, 173, 0.7)"
    },
    USED_VERY_GOOD_SHIPPING: {
        index: 20,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !0,
        color: "#009678",
        bg: "rgba(162, 255, 236, 0.7)"
    },
    USED_GOOD_SHIPPING: {
        index: 21,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !0,
        color: "#795548",
        bg: "rgba(189, 162, 153, 0.8)"
    },
    USED_ACCEPTABLE_SHIPPING: {
        index: 22,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !0,
        color: "#9E9E9E",
        bg: "rgba(220, 220, 220, 0.8)"
    },
    COLLECTIBLE_NEW_SHIPPING: {
        index: 23,
        deal: !1,
        currency: !0,
        showDefault: 0,
        isEnabled: isTest,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !1,
        color: "#444",
        bg: "rgba(255, 225, 192, 0.8)"
    },
    COLLECTIBLE_VERY_GOOD_SHIPPING: {
        index: 24,
        deal: !1,
        currency: !0,
        showDefault: 0,
        isEnabled: isTest,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !1,
        color: "#444",
        bg: "rgba(255, 225, 192, 0.8)"
    },
    COLLECTIBLE_GOOD_SHIPPING: {
        index: 25,
        deal: !1,
        currency: !0,
        showDefault: 0,
        isEnabled: isTest,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !1,
        color: "#444",
        bg: "rgba(255, 225, 192, 0.8)"
    },
    COLLECTIBLE_ACCEPTABLE_SHIPPING: {
        index: 26,
        deal: !1,
        currency: !0,
        showDefault: 0,
        isEnabled: isTest,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !1,
        color: "#222",
        bg: "rgba(255, 225, 192, 0.8)"
    },
    REFURBISHED_SHIPPING: {
        index: 27,
        deal: !1,
        currency: !0,
        showDefault: 0,
        isEnabled: isTest,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !1,
        color: "#009688",
        bg: "rgba(192, 255, 226, 0.8)"
    },
    EBAY_NEW_SHIPPING: {
        index: 28,
        deal: !1,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !1,
        color: "#009688",
        bg: "rgba(94, 226, 225, 0.8)"
    },
    EBAY_USED_SHIPPING: {
        index: 29,
        deal: !1,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !1,
        color: "#99E600",
        bg: "rgba(207, 255, 107, 0.8)"
    },
    TRADE_IN: {
        index: 30,
        deal: !0,
        currency: !0,
        showDefault: 0,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        isTrackable: !0,
        color: "#ff597c",
        bg: "rgba(255, 201, 213, 0.7)"
    },
    RENT: {
        index: 31,
        deal: !1,
        currency: !0,
        showDefault: 0,
        isEnabled: !1,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !0,
        isTrackable: !1,
        color: "#b3809a",
        bg: "rgba(212, 212, 241, 0.8)"
    },
    length: 32,
    getName: function(a) {
        switch (a) {
        case 0:
            return "Amazon";
        case 1:
            return la._93;
        case 2:
            return la._94;
        case 3:
            return la._391;
        case 4:
            return la._398;
        case 5:
            return la._399;
        case 6:
            return la._400;
        case 7:
            return la._401;
        case 8:
            return la._402;
        case 9:
            return la._403;
        case 10:
            return la._404;
        case 11:
            return la._405;
        case 12:
            return la._406;
        case 13:
            return la._407;
        case 14:
            return la._408;
        case 15:
            return la._439;
        case 16:
            return la._440;
        case 17:
            return la._441;
        case 18:
            return la._442;
        case 19:
            return la._443;
        case 20:
            return la._444;
        case 21:
            return la._445;
        case 22:
            return la._446;
        case 23:
            return la._447;
        case 24:
            return la._448;
        case 25:
            return la._449;
        case 26:
            return la._450;
        case 27:
            return la._451;
        case 28:
            return "eBay New \ud83d\ude9a";
        case 29:
            return "eBay Used \ud83d\ude9a";
        case 30:
            return "Trade-In";
        case 31:
            return "Rental";
        case 32:
            return "eBay Auction Used \ud83d\ude9a";
        default:
            return ""
        }
    },
    getCondition: function(a) {
        var b = "Unknown";
        switch (a) {
        case 1:
            b = la._93;
            break;
        case 2:
            b = la._443;
            break;
        case 3:
            b = la._444;
            break;
        case 4:
            b = la._445;
            break;
        case 5:
            b = la._446
        }
        return b.replace(" \ud83d\ude9a", "")
    },
    getNameWithCircle: function(a) {
        return '<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(a).color + '" ></i> ' + CsvType.getName(a)
    },
    getDescription: function(a) {
        switch (a) {
        case 0:
            return la._499;
        case 1:
            return la._500;
        case 2:
            return la._501;
        case 3:
            return la._502;
        case 4:
            return la._409;
        case 5:
            return la._503;
        case 6:
            return la._504;
        case 7:
            return la._505;
        case 8:
            return la._402;
        case 9:
            return la._403;
        case 10:
            return la._506;
        case 11:
            return la._405;
        case 12:
            return la._406;
        case 13:
            return la._407;
        case 14:
            return la._408;
        case 15:
            return la._439;
        case 16:
            return la._440;
        case 17:
            return la._441;
        case 18:
            return la._507;
        case 19:
            return la._508;
        case 20:
            return la._508;
        case 21:
            return la._508;
        case 22:
            return la._508;
        case 23:
            return la._447;
        case 24:
            return la._448;
        case 25:
            return la._449;
        case 26:
            return la._450;
        case 27:
            return la._451;
        case 28:
            return "eBay Fixed Price New \ud83d\ude9a";
        case 29:
            return "eBay Fixed Price Used \ud83d\ude9a";
        case 30:
            return "Amazon Trade-In Value";
        case 31:
            return "Rental price";
        case 32:
            return "eBay Auction Used \ud83d\ude9a";
        default:
            return ""
        }
    },
    getDescriptionTracking: function(a) {
        switch (a) {
        case 0:
            return la._818;
        case 1:
            return la._819;
        case 2:
            return la._820;
        case 3:
            return la._391;
        case 4:
            return la._398;
        case 5:
            return la._821;
        case 6:
            return la._822;
        case 7:
            return la._823;
        case 8:
            return la._402;
        case 9:
            return la._403;
        case 10:
            return la._824;
        case 11:
            return la._405;
        case 12:
            return la._406;
        case 13:
            return la._407;
        case 14:
            return la._408;
        case 16:
            return la._440;
        case 17:
            return la._441;
        case 18:
            return la._825;
        case 19:
            return la._826;
        case 20:
            return la._827;
        case 21:
            return la._828;
        case 22:
            return la._829;
        case 23:
            return la._830;
        case 24:
            return la._831;
        case 25:
            return la._832;
        case 26:
            return la._833;
        case 27:
            return la._834;
        case 30:
            return la._835;
        default:
            return ""
        }
    },
    getObjectNameByName: function(a) {
        if (0 == a.indexOf(la._391))
            return "SALES";
        if (0 == a.indexOf("eBay New \ud83d\ude9a"))
            return "EBAY_NEW_SHIPPING";
        if (0 == a.indexOf("eBay Used \ud83d\ude9a"))
            return "EBAY_USED_SHIPPING";
        for (var b in CsvType)
            if ("object" == typeof CsvType[b] && a == CsvType.getName(CsvType[b].index))
                return b
    },
    getObject: function(a) {
        for (var b in CsvType)
            if ("object" == typeof CsvType[b] && CsvType[b].index == a)
                return CsvType[b]
    },
    getObjectName: function(a) {
        for (var b in CsvType)
            if ("object" == typeof CsvType[b] && CsvType[b].index == a)
                return b
    },
    format: function(a, b, d) {
        if ("undefined" === typeof CsvType[a])
            return "";
        if (null == b || -1 == b)
            return "-";
        if (CsvType[a].currency)
            return Money.format(b, {
                sourceDomainId: d,
                targetDomainId: d
            });
        if ("RATING" == a)
            return (b / 10).toFixed(1);
        b = NumberUtil.format(b);
        "SALES" === a && (b = "# " + b);
        return b
    }
}, graphIsRestricted = function(a, b, d) {
    return hasDataAccessSubscription && !0 !== d ? !1 : [CsvType.EBAY_NEW_SHIPPING.index, CsvType.EBAY_USED_SHIPPING.index].includes(Number(b)) ? !0 : !0 !== [!1, !0, !0, !0, !0, !0, !0, !1, !0, !0, !0, !0, !1, !1][Number(a)] || !0 !== [!1, !1, !1, !0, !1, !1, !1, !1, !1, !1, !1, !0, !0, !0, !0, !1, !0, !0, !0, !1, !1, !1, !1, !1, !1, !1, !1, !1, !0, !0, !1, !1][Number(b)] ? !1 : !0
};
function getStarsFromRating(a) {
    a *= 10;
    for (var b = "#f1bb00", d = "", h = 100; 600 > h; h += 100) {
        if (h <= a)
            var m = "fa-star";
        else
            a + 100 < h ? m = "fa-star-o" : (m = a % 100,
            75 <= m ? m = "fa-star" : 25 > m ? (m = "fa-star-o",
            b = "rgba(241, 187, 0, .5)") : m = "fa-star-half-o");
        d += '<i style="color:' + b + '" class="fa ' + m + '"></i>'
    }
    return d
}
function findOffer(a, b, d, h, m, t, f) {
    if (null == a)
        return null;
    if (null == f && t == CsvType.BUY_BOX_SHIPPING && null != b && 1 < b.length)
        for (var n = 0; n < b.length; n += 2) {
            var r = Number(b[n]);
            if (r > d)
                break;
            if (!(r < d && n + 2 != b.length && b[n + 2] <= d)) {
                f = b[n + 1];
                break
            }
        }
    for (b = 0; b < a.length; b++)
        if (n = a[b],
        !(d > n.lastSeen || null != f && n.sellerId != f || null == n.offerCSV || 2 > n.offerCSV.length)) {
            switch (t.index) {
            case CsvType.AMAZON.index:
                if (!n.isAmazon)
                    continue;
                break;
            case CsvType.WAREHOUSE.index:
                if (!n.isWarehouseDeal)
                    continue;
                break;
            case CsvType.NEW_FBA.index:
                if (n.isAmazon || !n.isPrime || n.condition != ConditionType.NEW)
                    continue;
                break;
            case CsvType.NEW_FBM_SHIPPING.index:
                if (n.isAmazon || n.isPrime || n.condition != ConditionType.NEW)
                    continue;
                break;
            case CsvType.USED_NEW_SHIPPING.index:
                if (n.condition != ConditionType.USED_NEW)
                    continue;
                break;
            case CsvType.USED_VERY_GOOD_SHIPPING.index:
                if (n.condition != ConditionType.USED_VERY_GOOD)
                    continue;
                break;
            case CsvType.USED_GOOD_SHIPPING.index:
                if (n.condition != ConditionType.USED_GOOD)
                    continue;
                break;
            case CsvType.USED_ACCEPTABLE_SHIPPING.index:
                if (n.condition != ConditionType.USED_ACCEPTABLE)
                    continue;
                break;
            case CsvType.BUY_BOX_SHIPPING.index:
                if (null == f || n.sellerId != f)
                    continue;
                break;
            default:
                continue
            }
            for (r = 0; r < n.offerCSV.length; r += 3) {
                var p = n.offerCSV[r];
                if (p > d)
                    break;
                if (!(p < d && r + 3 != n.offerCSV.length && n.offerCSV[r + 3] < d)) {
                    var z = n.offerCSV[r + 1]
                      , F = n.offerCSV[r + 2]
                      , I = !1;
                    t.isWithShipping ? null == m && (z + F == h ? I = !0 : z == h && F == m && (I = !0)) : z == h && (I = !0);
                    if (I)
                        return n.item || (n.item = {}),
                        !0 !== disableStockFeatures && (n.item.stock = getValueAtTime(n.stockCSV, d, CsvType.AMAZON)),
                        n.item.price = z,
                        n.item.shipping = F,
                        n.item.time = keepaTime.minutesToEpoch(p),
                        n
                }
            }
        }
    return null
}
var AmazonSellerIds = " ATVPDKIKX0DER A3P5ROKL5A1OLE A3JWKAKR8XB7XF A1X6FK5RDHNB96 AN1VRQENFRJN5 A3DWYIK6Y9EEQB A1AJ19PSB66TGU A11IL2PNWYJU7H A1AT7YVPFBWXBL  AVDBXBAVVSXLQ A1ZZFT5FULY4LN ANEGB3WVEVKZB A17D2BRD4YMT0X".split(" ")
  , AltAmazonSellerIds = " A3SLTBYT1P4ASM AZH2GF8Z5J95G AMUN6OW4OKOC5 A2W68NJA5YNXUP    A1TMZHY2SHKLH2 A13P6277X44WWB     ".split(" ")
  , AmazonDigitalSellerIds = {
    A3M32Z6M072V6G: "",
    A17SFUTIVB227Z: "",
    A73J8FUD3TCA5: "",
    A3T7DQBB0CKEM6: "",
    A3ODHND3J0WMC8: "",
    A6D8GZQLZZGO9: "",
    A3NKQTGM3PCAIZ: "",
    A3SLTBYT1P4ASM: "",
    A5UUIVRC5HDTS: "",
    A1NHYT4IBWIJVV: "",
    A1SL8GN8WYR9PY: "",
    A27GA0YBG6SP60: "",
    A3MTENA2RGT54E: "",
    AR9ZQCUDB1BRG: "",
    A18FWS6K2KEZVH: "",
    A272UC180L3PT5: "",
    A3QNOO22OOSRVA: "",
    A8FQRD0WW0VW5: "",
    AYRD2K1E2G5OI: "",
    A3OSP7RQDCZTFI: "",
    A2KAVP39WOVYMY: "",
    ALQGD0RUJOUO0: "",
    A2VH1G09VXWEK4: "",
    A3DMYT37LYXJWC: "",
    A1HAK8FCVUIIJW: "",
    A3HBS5CIENBL3I: "",
    AZ8B0UT6GFHPA: "",
    AE2QNCE40KCLM: "",
    A1RJCHJCQT9WV5: "",
    A1XE56C8KJF3Q8: "",
    A1XHM9JTFOBM5W: "",
    A3G9IOHQDOG823: "",
    A2U5JVE7GGFD8B: "",
    A23R8XU9UYU5MY: "",
    A14WSK88711B1Q: "",
    A27LXP2YCQ2WLE: "",
    A1RIR7ZBMS38LR: "",
    A20WXWN33S3JGD: "",
    A1PT7S6F0FISH: "",
    A2X9BIRDIKC20I: "",
    A1JW18WKUHUG7I: "",
    A1G3UP32AZJ14F: "",
    A1LD4FJ97AUVJA: ""
};
function isSellerIdAmazon(a, b) {
    return a == AmazonSellerIds[b] || a == AltAmazonSellerIds[b] || "" === AmazonDigitalSellerIds[a]
}
for (var continents = [[1, 6, 11], [12], [2, 3, 4, 8, 9], [5, 10], [13]], domainIdToContinent = [0, 0, 2, 2, 2, 3, 0, 3, 2, 2, 3, 0, 1, 4], LocaleType = {
    length: numberOfDomains,
    getName: function(a) {
        a = Number(a);
        switch (a) {
        case 1:
            return "US";
        case 2:
            return "UK";
        case 3:
            return "DE";
        case 4:
            return "FR";
        case 5:
            return "JP";
        case 6:
            return "CA";
        case 7:
            return "CN";
        case 8:
            return "IT";
        case 9:
            return "ES";
        case 10:
            return "IN";
        case 11:
            return "MX";
        case 12:
            return "BR";
        case 13:
            return "AU";
        default:
            return ""
        }
    },
    getByRegionOrder: function(a) {
        return a ? [la._664, 1, 6, 11, la._353, 2, 3, 4, 8, 9, la._354, 5, 10] : [1, 6, 11, 2, 3, 4, 8, 9, 5, 10]
    },
    getObjectNameByName: function(a) {
        return a
    },
    getObject: function(a) {
        for (var b in LocaleType)
            if ("object" == typeof LocaleType[b] && LocaleType[b].index == a)
                return LocaleType[b]
    },
    getObjectName: function(a) {
        return LocaleType.getName(a)
    },
    getContinentId: function(a) {
        return domainIdToContinent[a]
    },
    getContinentName: function(a) {
        return [la._664, la._665, la._353, la._354, la._663][domainIdToContinent[a]]
    },
    getShippingInfoLink: function(a) {
        a = Number(a);
        switch (a) {
        case 1:
            return "http://www.amazon.com/gp/redirect.html?location=/gp/help/customer/display.html/ref=hp_left_ac?ie=UTF8&nodeId=596184";
        case 2:
            return "http://www.amazon.co.uk/gp/redirect.html?location=/gp/help/customer/display.html?nodeId=11072981";
        case 3:
            return "http://www.amazon.de/gp/redirect.html?location=/gp/help/customer/display.html/ref=hp_left_sib?ie=UTF8&nodeId=200170100";
        case 4:
            return "http://www.amazon.fr/gp/redirect.html?location=/gp/help/customer/display.html/ref=hp_left_sib?ie=UTF8&nodeId=200781660";
        case 5:
            return "http://www.amazon.co.jp/gp/redirect.html?location=/gp/help/customer/display.html/ref=footer_shiprates?ie=UTF8&nodeId=642982";
        case 6:
            return "http://www.amazon.ca/gp/redirect.html?location=/gp/help/customer/display.html/ref=hp_rel_topic?ie=UTF8&nodeId=915474";
        case 7:
            return "";
        case 8:
            return "http://www.amazon.it/gp/redirect.html?location=/gp/help/customer/display.html/ref=hp_left_cn?ie=UTF8&nodeId=200533920";
        case 9:
            return "http://www.amazon.es/gp/redirect.html?location=/gp/help/customer/display.html/ref=hp_left_cn?ie=UTF8&nodeId=200533920";
        case 10:
            return "";
        case 11:
            return "";
        case 12:
            return "";
        case 13:
            return "";
        default:
            return ""
        }
    }
}, LanguageHelper = {
    getAlpha2: function(a) {
        a = Number(a);
        switch (a) {
        case 1:
            return "en";
        case 3:
            return "de";
        case 5:
            return "jp";
        case 7:
            return "cn";
        case 8:
            return "it";
        default:
            return "en"
        }
    },
    getLocaleString: function(a, b) {
        a = Number(a);
        b = Number(b);
        switch (a) {
        case 1:
            return a = LocaleType.getName(b),
            ["US", "CA", "UK"].includes(a) ? "en-" + ("UK" == a ? "GB" : a) : "en-US";
        case 3:
            return "de-DE";
        case 5:
            return "ja-JP";
        case 7:
            return "cn-CN";
        case 8:
            return "it-IT";
        default:
            return "en-US"
        }
    }
}, MerchantType = {
    RATING: {
        index: 0,
        deal: !1,
        currency: !1,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        color: "#009688",
        bg: "rgba(200, 255, 251, 0.8)"
    },
    RATING_COUNT: {
        index: 1,
        deal: !1,
        currency: !1,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        color: "#8ab300",
        bg: "rgba(222, 239, 167, 0.8)"
    },
    LISTINGS_COUNT: {
        index: 2,
        deal: !1,
        currency: !1,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !0,
        color: "#B0C4DE",
        bg: "rgba(225, 235, 255, 0.8)"
    },
    length: 3,
    getName: function(a) {
        a = Number(a);
        switch (a) {
        case 0:
            return la._440;
        case 1:
            return la._441;
        case 2:
            return "Listing Count";
        default:
            return ""
        }
    },
    getObjectNameByName: function(a) {
        for (var b in MerchantType)
            if ("object" == typeof MerchantType[b] && a == MerchantType.getName(MerchantType[b].index))
                return b
    },
    getObject: function(a) {
        for (var b in MerchantType)
            if ("object" == typeof MerchantType[b] && MerchantType[b].index == a)
                return MerchantType[b]
    },
    getObjectName: function(a) {
        for (var b in MerchantType)
            if ("object" == typeof MerchantType[b] && MerchantType[b].index == a)
                return b
    }
}, OfferType = {
    STOCK: {
        index: 0,
        deal: !1,
        currency: !1,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !1,
        isTopGraph: !0,
        isOfferData: !1,
        color: "#2692c2",
        bg: "rgba(185, 238, 255, 1.0)"
    },
    PRICE: {
        index: 1,
        deal: !1,
        currency: !0,
        showDefault: 1,
        isEnabled: !0,
        isWithShipping: !0,
        isTopGraph: !0,
        isOfferData: !1,
        color: "#000",
        background: "#000"
    },
    length: 2,
    getName: function(a) {
        a = Number(a);
        switch (a) {
        case 0:
            return la._632;
        case 1:
            return la._488;
        default:
            return ""
        }
    },
    getObjectNameByName: function(a) {
        for (var b in OfferType)
            if ("object" == typeof OfferType[b] && a == OfferType.getName(OfferType[b].index))
                return b
    },
    getObject: function(a) {
        for (var b in OfferType)
            if ("object" == typeof OfferType[b] && OfferType[b].index == a)
                return OfferType[b]
    },
    getObjectName: function(a) {
        for (var b in OfferType)
            if ("object" == typeof OfferType[b] && OfferType[b].index == a)
                return b
    }
}, ConditionType = {
    UNKNOWN: 0,
    NEW: 1,
    USED_NEW: 2,
    USED_VERY_GOOD: 3,
    USED_GOOD: 4,
    USED_ACCEPTABLE: 5,
    REFURBISHED: 6,
    COLLECTIBLE_NEW: 7,
    COLLECTIBLE_VERY_GOOD: 8,
    COLLECTIBLE_GOOD: 9,
    COLLECTIBLE_ACCEPTABLE: 10,
    RENTAL: 11,
    length: 12,
    getName: function(a) {
        a = Number(a);
        switch (a) {
        case 0:
            return la._530;
        case 1:
            return la._93;
        case 2:
            return la._637;
        case 3:
            return la._638;
        case 4:
            return la._639;
        case 5:
            return la._640;
        case 6:
            return la._645;
        case 7:
            return la._641;
        case 8:
            return la._642;
        case 9:
            return la._643;
        case 10:
            return la._644;
        case 11:
            return la._655;
        default:
            return la._530
        }
    },
    getCorrespondingCsvType: function(a) {
        var b = null;
        switch (a) {
        case 2:
            b = CsvType.USED_NEW_SHIPPING;
            break;
        case 3:
            b = CsvType.USED_VERY_GOOD_SHIPPING;
            break;
        case 4:
            b = CsvType.USED_GOOD_SHIPPING;
            break;
        case 5:
            b = CsvType.USED_ACCEPTABLE_SHIPPING;
            break;
        case 6:
            b = CsvType.REFURBISHED_SHIPPING;
            break;
        case 7:
            b = CsvType.COLLECTIBLE_NEW_SHIPPING;
            break;
        case 8:
            b = CsvType.COLLECTIBLE_VERY_GOOD_SHIPPING;
            break;
        case 9:
            b = CsvType.COLLECTIBLE_GOOD_SHIPPING;
            break;
        case 10:
            b = CsvType.COLLECTIBLE_ACCEPTABLE_SHIPPING;
            break;
        case 11:
            b = CsvType.RENT
        }
        return b
    },
    getMetaCondition: function(a) {
        a = Number(a);
        switch (a) {
        case 1:
            return "NEW";
        case 2:
        case 3:
        case 4:
        case 5:
            return "USED";
        case 6:
            return "REFURBISHED";
        case 7:
        case 8:
        case 9:
        case 10:
            return "COLLECTIBLE";
        case 11:
            return "RENTAL";
        default:
            return "UNKNOWN"
        }
    }
}, domainId = 0; domainId < numberOfDomains; domainId++)
    7 != domainId && (LocaleType[LocaleType.getName(domainId)] = {
        index: domainId,
        deal: !0,
        currency: !0,
        showDefault: 1
    });
var AccountType = ["GUEST", "ANON", "KEEPA"]
  , EmailStatus = ["NEW", "VERIFIED", "BLOCKED"]
  , NotificationType = "NONE EMAIL TWITTER FACEBOOK BROWSER RSS API".split(" ")
  , checkboxNameArray = " US GB DE FR JP CA CN IT ES IN MX BR AU".split(" ")
  , NotifyIfType = ["OUT_OF_STOCK", "BACK_IN_STOCK", "EVERY_CHANGE"]
  , desiredSeriesPrefix = "desired-"
  , window_focus = !0;
$(window).focus(function() {
    window_focus = !0
}).blur(function() {
    window_focus = !1
});
var selectText = function(a) {
    if (document.body.createTextRange) {
        var b = document.body.createTextRange();
        b.moveToElementText(a);
        b.select()
    } else if (window.getSelection) {
        b = window.getSelection();
        var d = document.createRange();
        d.selectNodeContents(a);
        b.removeAllRanges();
        b.addRange(d)
    }
};
function tryParseJSON(a, b) {
    try {
        var d = JSON.parse(a);
        if (d && "object" === typeof d && null !== d)
            return d
    } catch (h) {
        b || reportBug(h, a)
    }
    return null
}
var material = function() {
    return {
        getButton: function(a, b, d, h, m, t) {
            return '<button id="' + a + '" class="mdc-button ' + (m ? "" : "mdc-button--raised") + " " + (t ? "mdc-button--secondary" : "mdc-button--primary") + '" data-mdc-auto-init="MDCRipple" name="action">\n\t\t\t' + (d ? '<i class="fa fa-' + d + '" ></i>&ensp;' : "") + "\n\t\t\t" + b + "\n\t\t\t" + (h ? '&ensp;<i class="fa fa-' + h + '" ></i>' : "") + "\n\t\t</button>"
        },
        getCheckbox: function(a, b, d, h, m, t) {
            return '<div class="mdc-form-field">\n\t\t  <div class="mdc-checkbox" data-mdc-auto-init="MDCCheckbox">\n\t\t\t<input class="mdc-checkbox__native-control" type="checkbox" id="' + a + '-checkbox" ' + (d ? "checked" : "") + ' name="' + m + '" ' + (h ? "required" : "") + (0 == t || t ? ' value="' + t + '"' : "") + ' />\n\t\t\t<div class="mdc-checkbox__background">\n\t\t\t  <svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24">\n\t\t\t\t<path class="mdc-checkbox__checkmark-path" fill="none" stroke="white" d="M1.73,12.91 8.1,19.28 22.79,4.59"/>\n\t\t\t  </svg>\n\t\t\t  <div class="mdc-checkbox__mixedmark"></div>\n\t\t\t</div>\n\t\t  </div>\n\t\t  <label for="' + a + '-checkbox">' + b + "</label>\n\t\t</div>"
        },
        getCountrySelect: function(a, b) {
            for (var d = "", h = [], m = [], t = "US GB DE FR JP CA CN IT ES IN MX BR AU".split(" "), f = $jscomp.makeIterator(t), n = f.next(); !n.done; n = f.next())
                m.push(a[n.value]);
            for (var r in a)
                h.push([a[r].name, a[r]]);
            h.sort(function(F, I) {
                return F[0].localeCompare(I[0])
            });
            for (var p in h)
                m.push(h[p][1]);
            a = !1;
            for (var z in m)
                h = m[z],
                (f = b == h.id && !a) && (a = !0),
                d += "<option " + (f ? 'selected="selected"' : "") + ' id="' + h.id + '" data-country="' + h.name + '">' + h.name + "</option>",
                Number(z) == t.length - 1 && (d += "<option disabled>----------------</option>");
            return '<div class="mdc-select" style="margin-top:12px;">\n\t\t\t\t<select id="countrySelect" name="billing-country" autocomplete="billing country" class="mdc-select__native-control">' + d + "</select>\n\t\t\t</div>"
        },
        getInput: function(a, b, d, h, m, t, f, n, r, p, z) {
            return '<div class="mdc-text-field mdc-text-field--dense"' + (r ? ' style="width:inherit;"' : "") + ' data-mdc-auto-init="MDCTextField">\n\t\t\t  <input type="text" id="' + d + '" class="mdc-text-field__input" ' + (n ? 'placeholder="' + n + '"' : "") + "  " + (b ? 'pattern="' + b + '"' : "") + ' name="' + t + '"' + (z ? ' value="' + z + '"' : "") + " " + (a ? "required" : "") + " " + (m ? 'autocomplete="' + m + '"' : "") + ' aria-controls="' + d + '-validation-msg">\n\t\t\t  <label for="' + d + '" class="mdc-floating-label"' + (p ? ' style="' + p + '"' : "") + ">" + h + "</label>\n\t\t</div>\n\t\t" + (f ? '<p id="' + d + '-validation-msg" class="mdc-text-field-helper-text mdc-text-field-helper-text--validation-msg" aria-hidden="true"> \n\t\t\t\t' + f + "\n\t\t</p>" : "")
        },
        getInputNumber: function(a, b, d, h, m, t, f, n) {
            return (t ? t + "&ensp;" : "") + '\n\t\t<div class="mdc-text-field mdc-text-field--dense">\n\t\t\t<input type="number" id="' + a + '" class="mdc-text-field__input" value="' + b + '" min="' + d + '" max="' + h + '"' + (m ? " disabled" : "") + (n ? ' style="' + n + '"' : "") + ">\n\t\t</div>\n\t\t" + (f ? "&ensp;" + f : "")
        },
        getInputNumberPattern: function(a, b, d, h, m, t, f, n, r, p) {
            return '<div class="mdc-text-field mdc-text-field--dense' + (n || p ? " mdc-text-field--with-leading-icon" : "") + (r ? " mdc-text-field--with-trailing-icon" : "") + '" data-mdc-auto-init="MDCTextField">\n\t\t\t' + (n ? '<i class="mdc-text-field__icon fa fa-fw fa-lg fa-' + n + '"></i>' : "") + "\n\t\t\t" + (p ? p : "") + '\n\t\t\t<input type="text" id="' + a + '" class="mdc-text-field__input" name="' + b + '"' + (0 == h || h ? ' value="' + h + '"' : "") + (m ? ' pattern="' + m + '"' : "") + (t ? ' title="' + t + '"' : "") + (f ? 'autocomplete="' + f + '"' : "") + '>\n\t\t\t<label for="' + a + '" class="mdc-floating-label">' + d + "</label>\n\t\t\t" + (r ? '<i class="mdc-text-field__icon fa fa-fw fa-lg fa-' + r + '"></i>' : "") + "\n\t\t</div>"
        },
        getInputDate: function(a, b, d, h) {
            return '<label class="mdc-text-field mdc-text-field--dense" data-mdc-auto-init="MDCTextField">\n\t\t\t<input type="date" id="' + a + '" name="' + b + '" ' + (h ? ' value="' + h + '"' : "") + ' min="1900-01-01" max="2999-12-31" step="1" class="mdc-text-field__input" autocomplete="off">\n\t\t\t<label for="' + a + '" class="mdc-floating-label">' + d + "</label>\n\t\t</label>"
        },
        getInputFile: function(a, b, d, h, m, t, f) {
            return '<div class="mdc-text-field mdc-text-field--dense"' + (t ? ' style="width:inherit;"' : "") + ' data-mdc-auto-init="MDCTextField">\n\t\t\t<input id="' + a + 'Trigger" class="mdc-text-field__input"' + (m ? " required" : "") + '>\n\t\t\t<input id="' + a + '" name="' + b + '" type="file"' + (h ? ' accept="' + h + '"' : "") + ' style="display:none;">\n\t\t\t<label for="' + a + '" class="mdc-floating-label"' + (f ? ' style="' + f + '"' : "") + ">" + d + '</label>\n\t\t</div>\n\t\t<p id="' + a + '-validation-msg" class="mdc-text-field-helper-text mdc-text-field-helper-text--validation-msg" aria-hidden="true">\n\t\t\tno valid file found\n\t\t</p>'
        },
        getMenu: function(a, b) {
            var d = "";
            b = $jscomp.makeIterator(b);
            for (var h = b.next(); !h.done; h = b.next())
                h = h.value,
                d = h.divider ? d + '<li class="mdc-list-divider"></li>' : d + ("<li" + (h.value ? ' data-value="' + h.value + '"' : "") + ' class="mdc-list-item" role="menuitem" tabindex="' + (h.disabled ? -1 : 0) + '"' + (h.disabled ? ' aria-disabled="true"' : "") + (h.style ? ' style="' + h.style + '"' : "") + ">\n\t\t\t\t\t" + h.content + "\n\t\t\t\t</li>");
            return "\n\t\t\t<div" + (a ? ' id="' + a + '"' : "") + ' class="mdc-menu" tabindex="-1">\n\t\t\t\t<ul class="mdc-menu__items mdc-list" role="menu" aria-hidden="true">\n\t\t\t\t' + d + "\n\t\t\t\t</ul>\n\t\t\t</div>\t\n\t\t"
        },
        getRadio: function(a, b, d, h, m, t, f) {
            return '<div class="mdc-form-field"' + ("undefined" != typeof f ? ' title="' + f + '"' : "") + '>\n\t\t  <div class="mdc-radio ' + (m ? "mdc-radio--disabled" : "") + '" data-mdc-auto-init="MDCRadio">\n\t\t\t<input class="mdc-radio__native-control" type="radio" id="' + a + '-radio" name="' + h + '"' + ("undefined" != typeof t ? ' value="' + t + '"' : "") + (d ? " checked" : "") + (m ? " disabled" : "") + '>\n\t\t\t<div class="mdc-radio__background">\n\t\t\t  <div class="mdc-radio__outer-circle"></div>\n\t\t\t  <div class="mdc-radio__inner-circle"></div>\n\t\t\t</div>\n\t\t  </div>\n\t\t  <label id="' + a + '-radio1-label" for="' + a + '-radio">' + b + "</label>\n\t\t</div>"
        },
        getSelect: function(a, b, d, h, m, t, f) {
            var n = f ? "" : -1;
            m = !0 !== t ? '<option value="' + n + '"' + (d == n ? ' selected="selected"' : "") + ">" + (m ? m : "All") + "</option>" : "";
            for (var r in h)
                t = h[r],
                m += '<option value="' + t.value + '"' + (d == t.value ? ' selected="selected"' : "") + ">" + t.label + "</option>";
            return '<div class="mdc-select">\n\t\t\t<select id="' + a + '" name="' + b + '" class="mdc-select__native-control"' + (f ? " required" : "") + ">\n\t\t\t \t" + m + "\n\t\t\t</select>\n\t\t</div>"
        },
        getSwitch: function(a, b, d) {
            return '<div class="mdc-switch">\n\t\t\t<input type="checkbox" id="' + a + '-switch" class="mdc-switch__native-control"' + (b ? " checked" : "") + (d ? " disabled" : "") + ' />\n\t\t\t<div class="mdc-switch__background">\n\t\t\t<div class="mdc-switch__knob"></div>\n\t\t\t</div>\n\t\t</div>'
        },
        getTabs: function(a) {
            for (var b = a.mode ? a.mode : "text-icon", d = "", h = "", m = $jscomp.makeIterator(a.tabs), t = m.next(); !t.done; t = m.next())
                if (t = t.value)
                    "text-icon" === b ? d += '<a class="mdc-tab mdc-tab--with-icon-and-text' + (t.isActive ? " mdc-tab--active" : "") + '"' + (t.tab.id ? ' id="' + t.tab.id + '"' : "") + '>\n\t\t\t\t\t\t<i class="fa fa-' + t.tab.icon + ' mdc-tab__icon" aria-hidden="' + (t.isActive ? "false" : "true") + '"></i>\n\t\t\t\t\t\t<span class="mdc-tab__icon-text">' + t.tab.label + "</span>\n\t\t\t\t\t</a>" : "text" === b && (d += '<a class="mdc-tab' + (t.isActive ? " mdc-tab--active" : "") + '"' + (t.tab.id ? ' id="' + t.tab.id + '"' : "") + ">\n\t\t\t\t\t\t" + t.tab.label + "\n\t\t\t\t\t</a>"),
                    h += '<div class="panel ' + (t.isActive ? "active" : "") + '" ' + (t.panel.style ? 'style="' + t.panel.style + '"' : "") + " " + (t.panel.id ? 'id="' + t.panel.id + '"' : "") + ' role="tabpanel" aria-hidden="false">' + (t.panel.content ? t.panel.content : "") + "</div>";
            return '<section class="dynamic-toolbar">\n\t\t\t\t<nav id="' + (a.id ? a.id : "icon-text-tab-bar") + '" class="mdc-tab-bar' + ("text-icon" === b ? " mdc-tab-bar--icons-with-text" : "") + '">\n\t\t\t\t\t' + d + '\n\t\t\t\t\t<span class="mdc-tab-bar__indicator"></span>\n\t\t\t\t</nav>\n\t\t\t</section>\n\t\t\t<section>\n\t\t\t\t<div class="panels ' + (a.panelsClass ? a.panelsClass : "") + '">\n\t\t\t\t\t' + h + "\n\t\t\t\t</div>\n\t\t\t</section>"
        },
        init: function(a) {
            setTimeout(function() {
                mdc.autoInit($(a)[0], function() {})
            }, 0)
        }
    }
}();
function getAmazonWishListUrl(a) {
    return "https://www.amazon." + getTldByDomain(a.domain) + "/gp/registry/wishlist/" + a.id + "/"
}
NotificationType = {
    getName: function(a) {
        switch (a) {
        case 0:
            return "Email";
        case 1:
            return "Twitter";
        case 2:
            return "Facebook";
        case 3:
            return "Web Push";
        case 4:
            return "Facebook Messenger";
        case 5:
            return "API";
        case 6:
            return "Keepa App";
        case 7:
            return "Telegram";
        default:
            return "Unknown"
        }
    },
    getNotifiedViaText: function(a) {
        for (var b = "", d = 0; d < a.length; d++)
            a[d] && (b += NotificationType.getName(d) + ", ");
        return b.substr(0, b.length - 2)
    }
};
var NotificationCause = {
    getName: function(a, b) {
        b = void 0 === b ? !0 : b;
        switch (a) {
        case 0:
            return la._525;
        case 1:
            return b ? la._526 : la._864;
        case 2:
            return b ? la._527 : la._865;
        case 3:
            return b ? la._528 : la._866;
        case 4:
            return la._134;
        case 5:
            return la._462;
        case 6:
            return b ? la._529 : la._867;
        case 7:
            return la._560;
        default:
            return la._530
        }
    }
};
function getQueryVariable(a) {
    var b = null
      , d = [];
    location.hash.substr(7).split("&").forEach(function(h) {
        d = h.split("=");
        d[0] === a && (b = d[1])
    });
    return b
}
function getCurrencyByDomain(a) {
    a = parseInt(a);
    switch (a) {
    case 1:
    case 6:
        return dollar;
    case 2:
        return pound;
    case 3:
    case 4:
    case 8:
    case 9:
        return euro;
    case 7:
    case 5:
        return yen;
    case 10:
        return rupee;
    case 11:
        return dollar;
    case 12:
        return real;
    case 13:
        return dollar;
    default:
        return dollar
    }
}
function getCurrencyCodeByDomain(a) {
    a = parseInt(a);
    switch (a) {
    case 1:
        return "USD";
    case 2:
        return "GBP";
    case 3:
    case 4:
    case 8:
    case 9:
        return "EUR";
    case 5:
        return "JPY";
    case 6:
        return "CAD";
    case 7:
        return "CNY";
    case 10:
        return "INR";
    case 11:
        return "MXN";
    case 12:
        return "BRL";
    case 13:
        return "AUD";
    default:
        return "???"
    }
}
var globalEbayArray = [!1, !0, !0, !0, !1, !1, !0, !1, !0, !0, !0, !1, !1, !1];
function getBucketInformation() {
    if (("undefined" !== typeof storage.bucketUpdated || null == storage.bucketUpdated) && 1E3 > Date.now() - Number(storage.bucketUpdated)) {
        var a = {
            tokenBucketSize: storage.tokenBucketSize,
            tokens: storage.tokens
        };
        updateQuotaWidget(a);
        return $.Deferred().resolve(a)
    }
    return network.request({
        path: "user/settings",
        type: "getTokenStatus",
        version: 3
    }).done(function(b) {
        isTest && "undefined" == typeof b.tokenBucketSize && console.error("BUCKET ERROR: tokenBucketSize is undefined");
        updateQuotaWidget({
            tokenBucketSize: b.tokenBucketSize,
            tokens: b.tokens
        });
        settings.applyDataBucket(b.tokenBucketSize, b.tokens)
    }).fail(function(b) {
        401 == b.status ? console.log("not authorized - no account") : console.log(b)
    })
}
function getAmazonRedirectByDomain(a, b) {
    var d = lastUrl.substr(2);
    if (1 == $("#dealSearchBar").length) {
        d = "dealsOverlay";
        try {
            var h = dealWrapperInstance.get();
            h.lastRequest && h.lastRequest.priceTypes && (d += "/" + CsvType.getObjectName(h.lastRequest.priceTypes[0]))
        } catch (m) {}
    } else
        1 == $("#trackingSearch").length ? d = "manageOverlay" : 1 == $("#searchPage").length && (d = "searchOverlay");
    return "https://dyn.keepa.com/r/?type=amazon&smile=" + ("true" === storage.useSmile ? "1" : "0") + "&domain=" + a + "&asin=" + b + "&source=website&path=" + d
}
function getEbayRedirectByDomain(a, b, d, h) {
    return "https://dyn.keepa.com/r/?type=ebay&domain=" + a + "&asin=" + b + "&search=" + (d ? 1 : 0) + "&source=website&path=" + (h || CsvType.EBAY_NEW_SHIPPING.index)
}
function refreshDomain(a) {
    a = parseInt(a);
    switch (a) {
    case 1:
        currency = dollar;
        tld = "com";
        break;
    case 2:
        currency = pound;
        tld = "co.uk";
        break;
    case 3:
        currency = euro;
        tld = "de";
        break;
    case 4:
        currency = euro;
        tld = "fr";
        break;
    case 5:
        currency = yen;
        tld = "co.jp";
        break;
    case 6:
        currency = dollar;
        tld = "ca";
        break;
    case 7:
        currency = yen;
        tld = "cn";
        break;
    case 8:
        currency = euro;
        tld = "it";
        break;
    case 9:
        currency = euro;
        tld = "es";
        break;
    case 10:
        currency = rupee;
        tld = "in";
        break;
    case 11:
        currency = dollar;
        tld = "com.mx";
        break;
    case 12:
        currency = real;
        tld = "com.br";
        break;
    case 13:
        currency = dollar;
        tld = "com.au";
        break;
    default:
        currency = dollar,
        tld = "com"
    }
}
function getTldByDomain(a) {
    a = parseInt(a);
    switch (a) {
    case 1:
        return "com";
    case 2:
        return "co.uk";
    case 3:
        return "de";
    case 4:
        return "fr";
    case 5:
        return "co.jp";
    case 6:
        return "ca";
    case 7:
        return "cn";
    case 8:
        return "it";
    case 9:
        return "es";
    case 10:
        return "in";
    case 11:
        return "com.mx";
    case 12:
        return "com.br";
    case 13:
        return "com.au";
    default:
        return "com"
    }
}
function getSSTldByDomain(a) {
    a = parseInt(a);
    switch (a) {
    case 1:
        return "com";
    case 2:
        return "co.uk";
    case 3:
        return "co.uk";
    case 4:
        return "co.uk";
    case 5:
        return "co.jp";
    case 6:
        return "com";
    case 7:
        return "cn";
    case 8:
        return "co.uk";
    case 9:
        return "co.uk";
    case 10:
        return "co.uk";
    case 11:
        return "com";
    case 12:
        return "com";
    case 13:
        return "com.au";
    default:
        return "com"
    }
}
function getSSMktByDomain(a) {
    a = parseInt(a);
    switch (a) {
    case 1:
        return "1";
    case 2:
        return "3";
    case 3:
        return "4";
    case 4:
        return "5";
    case 5:
        return "6";
    case 6:
        return "7";
    case 7:
        return "3240";
    case 8:
        return "35691";
    case 9:
        return "44551";
    case 10:
        return "44571";
    case 11:
        return "771770";
    case 12:
        return "526970";
    case 13:
        return "111172";
    default:
        return "1"
    }
}
function getDomainByTld(a) {
    a = a.toLowerCase();
    switch (a) {
    case "com":
        return 1;
    case "co.uk":
        return 2;
    case "de":
        return 3;
    case "fr":
        return 4;
    case "co.jp":
        return 5;
    case "ca":
        return 6;
    case "cn":
        return 7;
    case "it":
        return 8;
    case "es":
        return 9;
    case "in":
        return 10;
    case "com.mx":
        return 11;
    case "com.br":
        return 12;
    case "com.au":
        return 13;
    default:
        return 1
    }
}
(function(a) {
    a.fn.onEnter = function(b) {
        this.bind("keypress", function(d) {
            13 == d.keyCode && b.apply(this, [d])
        });
        return this
    }
}
)(jQuery);
function DiscourseApi(a) {
    this.url = a
}
DiscourseApi.prototype.category = function(a, b) {
    network.ajax({
        url: this.url + "/c/" + a + ".json"
    }).done(function(d) {
        b(d)
    })
}
;
DiscourseApi.prototype.topic = function(a, b) {
    network.ajax({
        url: this.url + "/t/" + a + ".json"
    }).done(function(d) {
        b(d)
    })
}
;
DiscourseApi.prototype.notification = function(a) {
    network.ajax({
        url: this.url + "/notifications.json",
        xhrFields: {
            withCredentials: !0
        }
    }).done(function(b) {
        a(b)
    })
}
;
var discourseUrl = "https://discuss.keepa.com"
  , discourseBaseUrl = "#!discuss"
  , discourseApi = new DiscourseApi(discourseUrl)
  , serviceWorker = function() {
    function a(H, V) {
        if (!t())
            return !1;
        var S = !1;
        m().done(function(aa) {
            S = !0
        }).fail(function(aa) {
            S = aa ? !1 : null
        }).always(function() {
            if (null != S && (!S || V)) {
                var aa = 'Receive Web Push Notifications for Price Alerts<br><div style="font-size:11px;margin-left:35px;"><span style="color:black;">Chrome and Firefox</span>: You will receive notifications whenever your browser is open. <span style="color:black">Chrome for Android</span>: Always.<br>Registration needs to be repeated for each browser through which you want to receive web push notifications.' + (S ? ' To send a test message, <span class="settings-chpw" id="testMessage">click here</span>.' : "") + (V ? "" : "<br> You can change your decision anytime in your account settings.") + "</div>"
                  , ea = '<i class="settings-chpw fa fa-toggle-' + (S ? "on" : "off") + ' fa-18"></i>';
                iframe.isIframe && (aa = 'Want to receive Web Push Notifications for Price Alerts? Go to your <a target="_parent" href="https://keepa.com/#!settings" class="url">account settings</a> to enable them on all your supported devices.',
                ea = "");
                replaceHtml(H, ea + "&emsp;" + aa);
                $("#" + H).css("color", "#444");
                V = !0;
                var ra = !1;
                $("#testMessage").on("click", function() {
                    ra || (b(),
                    ra = !0,
                    setTimeout(function() {
                        ra = !1
                    }, 5E3))
                });
                $("#" + H + " i").on("click", function(pa) {
                    $(pa.currentTarget).replaceWith('<i style="margin:0 4px;" class="fa fa-refresh fa-rotate-90 fa-spin"></i>');
                    S ? d().always(function() {
                        a(H, V)
                    }) : h().always(function() {
                        a(H, V)
                    })
                })
            }
        })
    }
    function b() {
        var H = $.Deferred();
        network.request({
            path: "user/session",
            type: "webPushSendTest",
            content: "",
            version: 3
        }).done(function(V) {
            null == V.error ? H.resolve(p) : H.reject(p)
        }).fail(function() {
            H.reject(p)
        });
        return H
    }
    function d() {
        var H = $.Deferred();
        navigator.serviceWorker.ready.then(function(V) {
            V.pushManager.getSubscription().then(function(S) {
                if (S) {
                    var aa = S.endpoint
                      , ea = S.getKey ? S.getKey("p256dh") : ""
                      , ra = S.getKey ? S.getKey("auth") : "";
                    network.request({
                        path: "user/session",
                        type: "webPushUnregister",
                        content: aa,
                        key: ea ? btoa(String.fromCharCode.apply(null, new Uint8Array(ea))) : "",
                        auth: ra ? btoa(String.fromCharCode.apply(null, new Uint8Array(ra))) : "",
                        version: 3
                    }).always(function() {
                        S.unsubscribe().then(function() {
                            H.resolve(aa)
                        }).catch(function(pa) {
                            H.reject(aa);
                            console.error("Error unsubscribing: ", pa)
                        })
                    })
                } else
                    H.resolve()
            }).catch(function(S) {
                console.error("Error unsubscribing.", S);
                H.reject(null)
            })
        });
        return H
    }
    function h() {
        var H = $.Deferred();
        navigator.serviceWorker.ready.then(function(V) {
            V.pushManager.subscribe({
                userVisibleOnly: !0,
                applicationServerKey: "BPD1V1O2wWmO_i2VyaeAxu1EiKnrZDJS-zgZ3pAPUJbtMz8jC5lTg0OUxCmJBd1opBSWIEakIjWOEEtOEMoP2TA"
            }).then(function(S) {
                var aa = S.getKey ? S.getKey("p256dh") : ""
                  , ea = S.getKey ? S.getKey("auth") : ""
                  , ra = S.endpoint;
                network.request({
                    path: "user/session",
                    type: "webPushRegister",
                    content: ra,
                    key: aa ? btoa(String.fromCharCode.apply(null, new Uint8Array(aa))) : "",
                    auth: ea ? btoa(String.fromCharCode.apply(null, new Uint8Array(ea))) : "",
                    version: 3
                }).done(function(pa) {
                    null == pa.error ? H.resolve(ra) : H.reject(ra)
                }).fail(function() {
                    H.reject(ra)
                })
            }).catch(function(S) {
                V.unregister().finally(function() {
                    V.pushManager.subscribe({
                        userVisibleOnly: !0,
                        applicationServerKey: "BPD1V1O2wWmO_i2VyaeAxu1EiKnrZDJS-zgZ3pAPUJbtMz8jC5lTg0OUxCmJBd1opBSWIEakIjWOEEtOEMoP2TA"
                    }).then(function(aa) {
                        var ea = aa.getKey ? aa.getKey("p256dh") : ""
                          , ra = aa.getKey ? aa.getKey("auth") : ""
                          , pa = aa.endpoint;
                        network.request({
                            path: "user/session",
                            type: "webPushRegister",
                            content: pa,
                            key: ea ? btoa(String.fromCharCode.apply(null, new Uint8Array(ea))) : "",
                            auth: ra ? btoa(String.fromCharCode.apply(null, new Uint8Array(ra))) : "",
                            version: 3
                        }).done(function(ua) {
                            null == ua.error ? H.resolve(pa) : H.reject(pa)
                        }).fail(function() {
                            H.reject(pa)
                        })
                    }).catch(function(aa) {
                        V.unregister();
                        H.reject(null);
                        showPopup("Unable to register push subscription", '<div style="width:600px;">' + aa + "<br><br>Please try again. If it still does not work: Are using incognito or private mode? If that is not the case, please change your Notification exception of https://keepa.com:443 here:<br><br>Chrome:<br>chrome://settings/contentExceptions#notifications<br><br>Firefox:<br>Open about:preferences#privacy and open the Notifications settings.</div>", !0)
                    })
                })
            })
        });
        return H
    }
    function m() {
        var H = $.Deferred();
        navigator.serviceWorker.ready.then(function(V) {
            V.pushManager.getSubscription().then(function(S) {
                if (S) {
                    var aa = S.endpoint
                      , ea = S.getKey ? S.getKey("p256dh") : "";
                    S = S.getKey ? S.getKey("auth") : "";
                    network.request({
                        path: "user/session",
                        type: "webPushStatus",
                        content: aa,
                        key: ea ? btoa(String.fromCharCode.apply(null, new Uint8Array(ea))) : "",
                        auth: S ? btoa(String.fromCharCode.apply(null, new Uint8Array(S))) : "",
                        version: 3
                    }).done(function(ra) {
                        null == ra.error ? H.resolve(aa) : H.reject(aa)
                    }).fail(function() {
                        H.reject(aa)
                    })
                } else
                    H.reject(!0)
            }).catch(function(S) {
                console.error("Error getting subscription", S);
                H.reject(!1)
            })
        });
        return H
    }
    function t() {
        return E ? "serviceWorker"in navigator && "showNotification"in ServiceWorkerRegistration.prototype && "PushManager"in window ? !0 : !1 : !1
    }
    function f() {
        try {
            if (!t())
                return !1;
            if (null != navigator.serviceWorker.controller)
                return r({
                    command: "localStorage",
                    value: {
                        key: "token",
                        value: storage.token
                    }
                }).then(function(H) {
                    try {
                        "undefined" != typeof H.networkState && (z = H.networkState),
                        "undefined" != typeof H.lastActivate && (F = H.lastActivate)
                    } catch (V) {
                        console.error(V)
                    }
                    I.resolve()
                }).catch(function() {
                    z = -1;
                    I.reject()
                })
        } catch (H) {
            return reportBug(H, "updateTokenInSW"),
            z = -1,
            I.reject(),
            !1
        }
    }
    function n() {
        try {
            navigator.serviceWorker.getRegistration().then(function(H) {
                try {
                    H.unregister()
                } catch (V) {}
            })
        } catch (H) {}
    }
    function r(H, V) {
        return new Promise(function(S, aa) {
            try {
                var ea = new MessageChannel;
                ea.port1.onmessage = function(ra) {
                    if ("pong" == ra.data.data)
                        S(ra.data);
                    else if (100 == ra.data.status)
                        V(ra.data);
                    else if (ra.data.update)
                        switch (ra.data.update) {
                        case "connectionErrorRetry":
                            $("#networkOverlay").show();
                            $("#networkBar").text("Connecting...");
                            break;
                        case "connected":
                            $("#networkOverlay").hide();
                            break;
                        case "connectError":
                            var pa = function() {
                                $("#networkOverlay").show();
                                $("#networkBar").html('Unable to connect to Keepa.com. <span id="networkAgain" style="color:rgb(255, 228, 192); cursor:pointer">Try again?</span>&emsp;<span id="networkAbort" style="color:rgb(0, 0, 0); cursor:pointer">Abort!</span>');
                                $("#networkAgain").click(function() {
                                    $("#networkBar").text("Connecting...");
                                    serviceWorker.postMessage({
                                        command: "connect"
                                    }).then(function() {
                                        $("#networkOverlay").hide()
                                    }).catch(pa)
                                });
                                $("#networkAbort").click(function() {
                                    $("#networkOverlay").hide();
                                    ra.data.error = "connectError";
                                    r({
                                        command: "abort"
                                    }).catch(function(ua) {});
                                    aa(ra.data)
                                })
                            };
                            pa()
                        }
                    else
                        ra.data.error ? (console.log("sw message error", ra.data),
                        aa(ra.data.error)) : "connectError" == ra.data || "abort" == ra.data ? aa(ra.data) : S(ra.data)
                }
                ;
                null == navigator.serviceWorker.controller ? aa() : navigator.serviceWorker.controller.postMessage(H, [ea.port2])
            } catch (ra) {
                console.log(ra)
            }
        }
        )
    }
    var p, z = -1, F = -1, I = $.Deferred(), E = !1;
    try {
        if (-1 < navigator.userAgent.toLowerCase().indexOf("firefox")) {
            var K = navigator.userAgent.toLowerCase().match(/firefox\/(\d\d)\.\d\d?/);
            K && 48 >= Number(K[1]) ? n() : E = !0
        } else
            E = !0
    } catch (H) {
        console.log(H)
    }
    return {
        checkSupport: t,
        isInitialized: I,
        generatePushHtml: a,
        unsubscribePush: d,
        subscribePush: h,
        checkSubscription: m,
        register: function() {
            if (!t())
                return I.reject(),
                !1;
            if (null == navigator.serviceWorker.controller)
                navigator.serviceWorker.register("./" + (storage.swFile || "serviceWorker.js")).then(navigator.serviceWorker.ready).then(f).then(function(V) {}).catch(function(V) {
                    z = -1;
                    I.reject()
                });
            else
                try {
                    f();
                    navigator.serviceWorker.addEventListener("message", function(V) {
                        isTest && console.log("message from SW", V)
                    });
                    var H = {
                        command: "ping"
                    };
                    setInterval(function() {
                        try {
                            r(H).then(function(V) {
                                "undefined" != typeof V.networkState && (F != V.lastActivate && (console.log("lastActivate change!", F, V.lastActivate),
                                F = V.lastActivate),
                                z = V.networkState)
                            }).catch(function() {
                                z = -1
                            })
                        } catch (V) {
                            console.log(V),
                            z = -1,
                            network.connectToServer(!1)
                        }
                    }, 3E3)
                } catch (V) {
                    reportBug(V, "register"),
                    z = -1,
                    network.connectToServer(!1),
                    "pending" == I.state() && I.reject()
                }
        },
        showNotification: b,
        postMessage: r,
        unregister: n,
        updateTokenInSW: f,
        workerConnectionState: function() {
            return z
        }
    }
}();
serviceWorker.register();
var ProductImageHover = function() {
    var a = {
        image_urls_main: [],
        pf_preview_current: "",
        preview_images: [],
        img_string: '<img style="border: 1px solid #ff9f29;  -moz-border-radius: 0px;  margin: -3px;   display:block;   position: relative;   top: -3px;   left: -3px;" src=\'',
        createNewImageElement: function(b, d) {
            b = b.createElement(d ? d : "img");
            b.style.borderTop = "4px solid #328dc3";
            b.style.borderBottom = "3px solid #999999";
            b.style.display = "block";
            b.style.position = "relative";
            b.style.padding = "5px";
            return b
        },
        preview_image: function(b, d) {
            var h = document;
            if (!h.getElementById("pf_preview")) {
                var m = h.createElement("div");
                m.id = "pf_preview";
                m.addEventListener("mouseout", function(F) {
                    a.clear_image(F)
                }, !1);
                m.style.boxShadow = "rgb(68, 68, 68) 0px 1px 7px -2px";
                m.style.position = "fixed";
                m.style.zIndex = "10000000";
                m.style.bottom = "0px";
                m.style.right = "0px";
                m.style.margin = "12px 12px";
                m.style.backgroundColor = "#fff";
                h.body.appendChild(m)
            }
            a.pf_preview_current = h.getElementById("pf_preview");
            if (!a.pf_preview_current.firstChild) {
                m = d;
                var t = Math.max(Math.floor(.4 * h.defaultView.innerHeight), 256)
                  , f = Math.max(Math.floor(.4 * h.defaultView.innerWidth), 256)
                  , n = b.clientX > h.defaultView.innerWidth / 2
                  , r = 256;
                try {
                    var p = h.defaultView.innerWidth - b.clientX
                      , z = h.defaultView.innerHeight - b.clientY;
                    n && (p = h.defaultView.innerWidth - p);
                    r = Math.max(Math.max(p, z) - 150, r);
                    f = Math.min(Math.floor(.9 * h.defaultView.innerWidth), r);
                    t = Math.min(Math.floor(.9 * h.defaultView.innerHeight), r);
                    r = Math.min(f, t)
                } catch (F) {}
                768 < r && (r = 768);
                r -= r % 10;
                a.pf_preview_current.current = -1;
                a.pf_preview_current.a = d;
                a.pf_preview_current.href = "";
                a.pf_preview_current.size = Math.floor(1.1 * Math.min(f, t));
                n && (b = h.getElementById("pf_preview"),
                b.style.right = "",
                b.style.left = "6px");
                "object" === typeof d && "svgBarcode" === d.type ? $.when(LoaderUtil.js(CDNUrl + "JsBarcode-3.11.0.ean-upc.min.js")).then(function() {
                    if (JsBarcode) {
                        h.getElementById("pf_preview").style.display = "block";
                        var F = "jsBarcode-" + d.value
                          , I = a.createNewImageElement(h, "span");
                        I.innerHTML = '<svg id="' + F + '"></svg>';
                        a.pf_preview_current.appendChild(I);
                        setTimeout(function() {
                            $("#" + F).length && JsBarcode("#" + F, d.value, {
                                format: d.format ? d.format : "auto"
                            })
                        }, 100)
                    }
                }) : (d.startsWith("https://cdn.keepa") || d.startsWith("https://dyn.keepa.com") || d.startsWith("https://graph.keepa.com") || (m = imageServer,
                m += d.replace(".", "._SL" + r + "_.")),
                h.getElementById("pf_preview").style.display = "block",
                b = a.createNewImageElement(h),
                b.setAttribute("src", m),
                a.pf_preview_current.appendChild(b))
            }
        },
        clear_image: function(b) {
            try {
                var d = document.getElementById("pf_preview");
                d.style.display = "none";
                d.style.right = "2px";
                d.style.left = "";
                a.pf_preview_current.innerHTML = ""
            } catch (h) {}
        },
        add_events: function(b, d) {
            "pf_prevImg" != b.getAttribute("keepaPreview") && (b.addEventListener("mouseover", function(h) {
                a.preview_image(h, d);
                return !0
            }, !0),
            b.addEventListener("mouseout", function(h) {
                a.clear_image(h)
            }, !1),
            b.setAttribute("keepaPreview", "pf_prevImg"))
        }
    };
    return {
        preview: a
    }
}()
  , browserInfo = function(a) {
    a = a || navigator.userAgent;
    var b = a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
    if (/trident/i.test(b[1])) {
        var d = /\brv[ :]+(\d+)/g.exec(a) || [];
        return {
            name: "IE",
            version: d[1] || ""
        }
    }
    if ("Chrome" === b[1] && (d = a.match(/\b(OPR|Edge)\/(\d+)/),
    null != d))
        return {
            name: d[1].replace("OPR", "Opera"),
            version: d[2]
        };
    b = b[2] ? [b[1], b[2]] : [navigator.appName, navigator.appVersion, "-?"];
    null != (d = a.match(/version\/(\d+)/i)) && b.splice(1, 1, d[1]);
    return {
        name: b[0],
        version: b[1]
    }
};
function wait(a) {
    return $.Deferred(function() {
        setTimeout(this.resolve, a)
    }).promise()
}
var intranet = function() {
    var a = null
      , b = 0
      , d = function(m, t) {
        b = Date.now();
        null != a ? wait(100).always(function() {
            d(m, t)
        }) : (a = t,
        null != m && (storage.postMessage = JSON.stringify(m)),
        isIframe && "login" == m.key && document.location.reload())
    }
      , h = null;
    window.addEventListener("storage", function(m) {
        if (!(isFbLoginPage || 1E3 > Date.now() - b) && "postMessage" == m.key && m.newValue) {
            m = m.newValue;
            storage.removeItem("postMessage");
            var t = tryParseJSON(m);
            if (null != t) {
                try {
                    null != h && h.close()
                } catch (f) {}
                switch (t.key) {
                case "login":
                    isIframe && "login" == t.key && document.location.reload();
                    break;
                case "logout":
                    network.reauthorize();
                    updateMenuUserPanel(0);
                    refreshLoginBar();
                    try {
                        callSubPage(1)
                    } catch (f) {
                        reportBug(f)
                    }
                    "logout" == t.key && (h = showPopup("Your session ended", "You have signed out from Keepa in another tab.", !0))
                }
                null != a && (t = a,
                a = null,
                t(tryParseJSON(m)))
            }
        }
    }, !1);
    return {
        postMessage: d,
        key: "postMessage"
    }
}();
function inIframe() {
    try {
        return window.self !== window.top
    } catch (a) {
        return !0
    }
}
RegExp.escape = function(a) {
    return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")
}
;
function onlyUnique(a, b, d) {
    return d.indexOf(a) === b
}
String.prototype.replaceAt = function(a, b) {
    a = Number(a);
    b = String(b);
    return this.substr(0, a) + b + this.substr(a + b.length)
}
;
function reportBug(a, b) {
    try {
        if (!localStorageSupported || isTest)
            console.warn(a, b);
        else {
            storage.lastBugReport || (storage.lastBugReport = 0);
            try {
                if (-1 < ("" + a).indexOf("getComputedStyle") || -1 < ("" + a).indexOf("'plot' of undefined") || -1 < ("" + a).indexOf("NS_ERROR_FILE_CORRUPTED") || -1 < ("" + a).indexOf("mooikfkahbdckldjjndioackbalphokd") || -1 < ("" + a).indexOf("Invalid dimensions for plot"))
                    return
            } catch (p) {}
            var d = Date.now();
            if (!(2E4 > d - Number(storage.lastBugReport))) {
                storage.lastBugReport = d;
                d = a;
                var h = "";
                try {
                    h = Error().stack.split("\n").splice(1).splice(1).join("&ensp;&lArr;&ensp;"),
                    h = h.replace(/http|s:\/\/.*?\//g, "").replace(/:[0-9]*?\)/g, ")").replace(/[ ]{2,}/g, ""),
                    d = a.message ? a.message : a
                } catch (p) {}
                if (!(-1 < h.indexOf("KasperskyLab") || -1 < h.indexOf("Invalid dimensions for plot") || -1 < h.indexOf("mprogress.min"))) {
                    var m = function(p, z, F, I) {
                        var E = new XMLHttpRequest;
                        F && (E.onreadystatechange = function() {
                            4 == E.readyState && F.call(this, E.responseText)
                        }
                        );
                        E.withCredentials = I;
                        E.open("POST", p, !0);
                        E.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
                        E.send(z)
                    }
                      , t = {};
                    try {
                        for (var f in navigator)
                            t[f] = navigator[f]
                    } catch (p) {}
                    f = [];
                    for (var n in network.lastUrls)
                        /.*discuss.keepa.*/.test(network.lastUrls[n].url) || /.*js\/languages.*/.test(network.lastUrls[n].url) || "service/features" == network.lastUrls[n].path || "user/settings" == network.lastUrls[n].path || "user/session" == network.lastUrls[n].path || ("string" === typeof network.lastUrls[n] && (network.lastUrls[n] = {
                            url: network.lastUrls[n]
                        }),
                        f.push(network.lastUrls[n]));
                    network.lastUrls = [];
                    null == b && (b = "");
                    var r = {
                        exception: d,
                        additional: b,
                        url: document.location.toString(),
                        stack: h,
                        navigator: t,
                        isIframe: iframe.isIframe,
                        keepaType: "website",
                        version: "29",
                        history: f
                    };
                    setTimeout(function() {
                        m(protocol + network.server[network.serverIndex] + ajaxPrefix + "service/bugreport/?user=" + storage.token + "&type=website&version=29", JSON.stringify(r))
                    }, 50)
                }
            }
        }
    } catch (p) {
        console.error(p, a)
    }
}
function getDebugInfos() {
    var a = document.location + "", b = [], d;
    for (d in network.lastUrls)
        /.*discuss.keepa.*/.test(network.lastUrls[d].url) || /.*js\/languages.*/.test(network.lastUrls[d].url) || "service/features" != network.lastUrls[d].path && "user/settings" != network.lastUrls[d].path && "user/session" != network.lastUrls[d].path && b.push(JSON.stringify(network.lastUrls[d]));
    network.lastUrls = [];
    return [a, "", b]
}
function prettyDate(a) {
    a = Math.floor(60 * a);
    var b = 3 === parseInt(storage.language) ? la._652 + " " : "";
    return 60 > a && b + la._112 || 120 > a && b + la._113 || 3600 > a && b + Math.floor(a / 60) + la._114 || 7200 > a && b + la._115 || 86400 > a && b + Math.floor(a / 3600) + la._116 || 172800 > a && b + la._117 || 5356800 > a && b + Math.floor(a / 86400) + la._118 || 114048E4 > a && b + Math.floor(a / 2678400) + la._120
}
function zeroToDash(a) {
    return 0 == a ? "-" : a
}
function greenOrRed(a) {
    if ("-" == a)
        return a;
    var b = 0 < parseFloat(a) ? "red" : "green"
      , d = 0 < parseFloat(a) ? "" : '&nbsp;<img src="' + imgCDNUrl + 'good.png" />';
    return '<span style="color: ' + b + '">' + a + d + "</span>"
}
function getValueAtTime(a, b, d) {
    if (null == a || 0 == a.length)
        return -1;
    for (var h = 0, m = d.isWithShipping ? 3 : 2; h < a.length && !(a[h] > b); h += m)
        ;
    return h > a.length ? getLast(a, d) : h < m ? -1 : d.isWithShipping ? (b = a[h - 2],
    a = a[h - 1],
    0 > b ? b : b + (0 > a ? 0 : a)) : a[h - 1]
}
function getValueAtTimeWithShipping(a, b) {
    if (null == a || 0 == a.length)
        return -1;
    for (var d = 0; d < a.length && !(a[d] > b); d += 3)
        ;
    return d > a.length ? getLastWithShipping(a, CsvType.BUY_BOX_SHIPPING) : 3 > d ? [-1, 1] : [a[d - 2], a[d - 1]]
}
function getValueAtTimeWithExactTime(a, b, d) {
    if (null == a || 0 == a.length)
        return -1;
    for (var h = 0, m = d.isWithShipping ? 3 : 2; h < a.length && !(a[h] > b); h += m)
        ;
    return h > a.length ? getLast(a, d) : h < m ? -1 : d.isWithShipping ? (b = a[h - 2],
    a = a[h - 1],
    0 > b ? b : b + (0 > a ? 0 : a)) : [a[h - 2], a[h - 1]]
}
function getBBEntryAtTimeWithExactTime(a, b) {
    if (null == a || 0 == a.length)
        return -1;
    for (var d = 0; d < a.length && !(a[d] > b); d += 2)
        ;
    return d > a.length ? getLast(a, type) : 2 > d ? -1 : a[d - 1]
}
function getAggregatedDrop(a, b, d) {
    if (null == a || 0 == a.length)
        return -1;
    for (var h = 0, m = -1, t = -1; h < a.length && !(a[h] > b); h += 2)
        ;
    for (1 < h && (h -= 2); h < a.length; h += 2) {
        b = a[h + 1];
        if (0 < t && 0 < b && b < t) {
            var f = t - b;
            !(f <= d && 0 != f % 100) || 2 < h && 10 == b && 2 < h && a[h - 3] == b && 9 < f && 0 == f % 10 || 0 == t % 100 && 0 == b % 100 && 49 < f || (m += f)
        }
        t = b
    }
    0 <= m && m++;
    return m
}
function getLastTime(a, b) {
    return null == a || 0 == a.length ? -1 : a[a.length - (b.isWithShipping ? 3 : 2)]
}
function splitRootSalesRank(a) {
    try {
        var b = CsvType.SALES.index;
        if (null != a.csv[b] && null != a.salesRankReferenceHistory && 2 < a.salesRankReferenceHistory.length) {
            4 <= a.salesRankReferenceHistory.length && -1 == a.salesRankReference && -1 == a.csv[b][a.csv[b].length - 1] && a.csv[b][a.csv[b].length - 2] == a.salesRankReferenceHistory[a.salesRankReferenceHistory.length - 2] && (a.salesRankReferenceHistory.pop(),
            a.salesRankReferenceHistory.pop(),
            a.salesRankReference = a.salesRankReferenceHistory[a.salesRankReferenceHistory.length - 1]);
            for (var d = {}, h = {}, m = a.salesRankReferenceHistory[1], t = a.salesRankReferenceHistory[0], f = 0; f < a.salesRankReferenceHistory.length; f += 2)
                d[a.salesRankReferenceHistory[f]] = a.salesRankReferenceHistory[f + 1];
            for (var n = f = -1, r = 0, p = 0; p < a.csv[b].length; p += 2) {
                var z = a.csv[b][p]
                  , F = a.csv[b][p + 1];
                if (z <= t)
                    n = m;
                else {
                    var I = d[z];
                    n = null != I ? I : getValueAtTime(a.salesRankReferenceHistory, z, CsvType.SALES)
                }
                f != n && (0 < p && 4320 < z - r && (h[f] = processCSV(h[f], -1, null, CsvType.SALES, z, a, !1)),
                f = n,
                r = z);
                h[n] = processCSV(h[n], F, null, CsvType.SALES, z, a, !1)
            }
            for (var E in h) {
                null == a.salesRanks && (a.salesRanks = {});
                var K = h[E];
                E != a.salesRankReference && 4320 < keepaTime.now() - K[K.length - 2] && (h[E] = processCSV(h[E], -1, null, CsvType.SALES, K[K.length - 2] + 1440, a, !1));
                var H = a.salesRanks[E];
                null == H && (a.salesRanks[E] = K);
                a.salesRanks[E] = mergeCSV(K, H, CsvType.SALES)
            }
            var V = a.salesRanks[a.salesRankReference];
            null != V && (a.csv[b] = V)
        }
        if (null != a.salesRanks)
            for (var S in a.salesRanks)
                "undefined" === typeof a.salesRankCategoryTrees || a.salesRankCategoryTrees[S] || (b = S,
                -2 == S && (b = "Launchpad"),
                a.salesRankCategoryTrees[S] = [{
                    catId: S,
                    name: b
                }],
                a.salesRankCategories[S] = {
                    catId: S,
                    name: b,
                    children: null,
                    contextFreeName: b,
                    domainId: a.domainId,
                    highestRank: -1,
                    lowestRank: -1,
                    parent: 0,
                    productCount: 0
                })
    } catch (aa) {
        console.log(aa)
    }
}
function processCSV(a, b, d, h, m, t, f) {
    if (null == a || 0 == a.length) {
        if (-1 == b && h.index > CsvType.SALES.index && !f)
            return null;
        h = h.isWithShipping ? [m, b, d] : [m, b]
    } else if (h.isWithShipping)
        if (f || a[a.length - 2] != b || a[a.length - 1] != d) {
            if (a[a.length - 3] > m)
                return a;
            if (a[a.length - 3] == m) {
                if (5 < a.length && 0 > a[a.length - 2] && (m = a[a.length - 4],
                a[a.length - 5] == b && m == d))
                    return a.slice(0, a.length - 3);
                h = a;
                h[a.length - 2] = b;
                h[a.length - 1] = d
            } else
                h = a,
                h.push(m),
                h.push(b),
                h.push(d)
        } else
            h = a;
    else if (f || a[a.length - 1] != b) {
        if (a[a.length - 2] > m)
            return a;
        if (a[a.length - 2] == m) {
            if (3 < a.length && 0 > a[a.length - 1] && a[a.length - 3] == b)
                return a.slice(0, a.length - 3);
            h = a;
            h[a.length - 1] = b
        } else
            h = a,
            h.push(m),
            h.push(b)
    } else
        h = a;
    return h
}
function mergeCSV(a, b, d) {
    var h = []
      , m = [];
    try {
        var t = d.isWithShipping ? 3 : 2
          , f = function(p) {
            for (var z = 0, F = p.length; z < F; z += t) {
                var I = p[z]
                  , E = p[z + 1];
                h[I] = d.isWithShipping ? {
                    d: I,
                    c: E,
                    s: p[z + 2]
                } : {
                    d: I,
                    c: E
                }
            }
        };
        f(a);
        f(b);
        for (var n in h) {
            var r = h[n];
            m.push(r.d);
            m.push(r.c);
            d.isWithShipping && m.push(r.s)
        }
    } catch (p) {
        return a
    }
    return m
}
function getWeightedMean(a, b, d, h) {
    return getWeightedMeanInInterval(a, b, b - 1440 * d, b, h)
}
function getWeightedMeanInInterval(a, b, d, h, m) {
    var t = -1;
    if (d >= h || null == a || 0 == a.length)
        return -1;
    var f = a.length
      , n = m.isWithShipping ? 3 : 2
      , r = getLastTime(a, m)
      , p = a[0];
    if (-1 == r || -1 == p || p > h)
        return -1;
    r = 0;
    p > d && (d = p);
    h > b && (h = b);
    p = m.isWithShipping ? 2 : 1;
    for (var z = 1; z < f; z += n) {
        var F = a[z]
          , I = a[z - 1];
        if (I >= h)
            break;
        if (-1 != F) {
            if (m.isWithShipping) {
                var E = a[z + 1];
                F += 0 > E ? 0 : E
            }
            if (I >= d) {
                if (1 == z && z + p == f)
                    return F;
                z + p == f ? E = b : (E = a[z + p],
                E > h && (E = h));
                I = Math.max(1, E - I);
                r += I;
                t += F * I
            } else {
                if (z == f - p)
                    return F;
                E = a[z + p];
                if (E >= h)
                    return F;
                E >= d && (r = Math.max(1, E - d),
                t = F * r)
            }
        }
    }
    -1 != t && (t = 0 != r ? parseInt(Math.floor(t / r)) : -1);
    return t
}
function getMergedBB(a, b, d, h) {
    var m = {};
    if (null == a)
        return {};
    for (var t = 1, f = a.length; t < f; t += 2) {
        var n = a[t]
          , r = Number(a[t - 1]);
        m[r] || (m[r] = {
            sellerId: n,
            price: -1,
            oc: -1
        })
    }
    if (null != b)
        for (a = 0,
        t = b.length; a < t; a += 3)
            f = b[a],
            n = -1,
            0 < b[a + 1] && (n = 0 < b[a + 2] ? b[a + 1] + b[a + 2] : b[a + 1]),
            m[f] ? m[f].price = n : m[f] = {
                sellerId: -1,
                price: n,
                oc: -1
            };
    if (null != d)
        for (b = 0,
        a = d.length; b < a; b += 2)
            t = d[b],
            f = d[b + 1],
            m[t] ? m[t].oc = f : m[t] = {
                sellerId: -1,
                price: -1,
                oc: f
            };
    a = b = d = -1;
    t = [];
    for (var p in m)
        if (f = m[p],
        0 > f.price ? -1 != f.sellerId && (f.price = b) : b = f.price,
        -1 != d && -1 == f.sellerId && (f.sellerId = d),
        -1 != a && -1 == f.oc && (f.oc = a),
        -1 != f.sellerId && (d = f.sellerId),
        -1 != f.oc && (a = f.oc),
        h || !(0 > f.price || -1 == f.sellerId || -2 == f.sellerId))
            p = Number(p),
            t.push(p),
            t.push(f);
    return t
}
function getWeightedMeanSellerInInterval(a, b, d, h) {
    var m = keepaTime.now()
      , t = m - 1440 * h;
    h = {};
    if (t >= m)
        return -1;
    if (null == a || 0 == a.length)
        return h;
    d = getMergedBB(a, b, d, !1);
    for (var f = m, n = b.length; 0 <= n; n -= 3) {
        var r = b[n - 3];
        if (0 > b[n - 2])
            f = r;
        else
            break
    }
    a = Number(a[0]);
    if (-1 == d[d.length - 2] || -1 == a || a > m)
        return h;
    a > t && (t = a);
    t < changeV5 && (t = changeV5);
    a = !0;
    b = 1;
    for (n = d.length; b < n; b += 2)
        if (r = d[b],
        !(0 > r.price || -1 == r.sellerId || -2 == r.sellerId)) {
            var p = d[b - 1]
              , z = h[r.sellerId];
            if (p >= m)
                break;
            if (p < changeV5 || p < t)
                if (b + 2 > d.length || d[b - 1 + 2] > t && d[b - 1 + 2] > changeV5)
                    p = t;
                else
                    continue;
            a && (t = p,
            a = !1);
            var F = b + 2 < n ? d[b + 2 - 1] : f;
            if (-1 != r.sellerId && -2 != r.sellerId)
                if (z ? z.lastSeen = F : z = h[r.sellerId] = {
                    pct: 0,
                    price: 0,
                    oc: 0,
                    lastSeen: F
                },
                p >= t) {
                    if (1 == b && b + 1 == n)
                        return z.pct = 100,
                        z.price = r.price,
                        z.oc = r.oc,
                        h;
                    b + 1 == n ? F = m : (F = d[b + 1],
                    F > m && (F = m));
                    p = Math.max(1, F - p);
                    z.pct += p;
                    z.price += r.price * p;
                    z.oc += r.oc * p
                } else {
                    if (b == n - 1)
                        return z.pct = 100,
                        z.price = r.price,
                        z.oc = r.oc,
                        h;
                    p = d[b + 1];
                    if (p >= m)
                        return z.pct = 100,
                        z.price = r.price,
                        z.oc = r.oc,
                        h;
                    p >= t && (z.pct = Math.max(1, p - t),
                    z.price = r.price * z.pct,
                    z.oc = r.oc * z.pct)
                }
        }
    m -= t;
    for (var I in h)
        t = h[I],
        t.price = 0 == t.price ? -1 : parseInt(Math.floor(t.price / t.pct)),
        t.oc = 0 == t.oc ? -1 : parseInt(Math.floor(t.oc / t.pct)),
        t.pct = t.pct / m * 100,
        0 == t.pct && delete h[I];
    return h
}
function getClosestValueAtTime(a, b, d) {
    if (null == a || 0 == a.length)
        return -1;
    for (var h = 0, m = d.isWithShipping ? 3 : 2; h < a.length && !(a[h] > b); h += m)
        ;
    if (h > a.length)
        return getLast(a, d);
    if (h < m)
        if (d.isWithShipping) {
            if (4 > a.length)
                return b = a[2],
                a = a[1],
                0 > b ? b : b + (0 > a ? 0 : a);
            h += 3
        } else {
            if (3 > a.length)
                return a[1];
            h += 2
        }
    if (d.isWithShipping) {
        if (-1 == a[h - 2]) {
            for (; h < a.length && -1 == a[h - 2]; h += m)
                ;
            if (h > a.length)
                return getLast(a, d);
            if (3 > h)
                return -1
        }
        b = a[h - 2];
        a = a[h - 1];
        return 0 > b ? b : b + (0 > a ? 0 : a)
    }
    if (-1 != a[h - 1])
        return a[h - 1];
    for (; h < a.length && -1 == a[h - 1]; h += 2)
        ;
    return h > a.length ? getLast(a, d) : 2 > h ? -1 : a[h - 1]
}
function getLast(a, b) {
    return null == a || 0 == a.length ? -1 : b.isWithShipping ? (b = a[a.length - 1],
    a = a[a.length - 2],
    0 > a ? a : a + (0 > b ? 0 : b)) : a[a.length - 1]
}
function getLastWithShipping(a, b) {
    return null == a || 0 == a.length ? -1 : b.isWithShipping ? [a[a.length - 2], a[a.length - 1]] : [a[a.length - 1], 0]
}
function getLastInStock(a, b) {
    if (null == a || 0 == a.length)
        return [-1, -1];
    if (b.isWithShipping) {
        if (-1 < a[a.length - 1]) {
            b = a[a.length - 1];
            var d = a[a.length - 2];
            a = a[a.length - 3]
        } else
            b = a[a.length - 4],
            d = a[a.length - 5],
            a = a[a.length - 6];
        return [a, 0 > d ? d : d + (0 > b ? 0 : b)]
    }
    return -1 < a[a.length - 1] ? [a[a.length - 2], a[a.length - 1]] : [a[a.length - 4], a[a.length - 3]]
}
function getSimpleTreeToString(a) {
    var b = "";
    a.forEach(function(d, h) {
        h < a.length - 1 ? (b += d.name,
        b += " \u203a ") : b += d.name + ""
    });
    return b
}
function getCategorySalesRanks(a, b, d) {
    var h = [], m = keepaTime.now(), t;
    for (t in a)
        if (null != a[t]) {
            var f = null != b ? b[t] : null
              , n = getLast(d[t], CsvType.SALES)
              , r = getWeightedMean(d[t], m, 30, CsvType.SALES);
            if (d[t]) {
                var p = m - d[t][0];
                h.push({
                    tree: getSimpleTreeToString(a[t]),
                    sublevel: a[t].length - 1,
                    rank: n,
                    avg30: r,
                    avg90: 43200 > p ? -1 : getWeightedMean(d[t], m, 90, CsvType.SALES),
                    avg365: 259200 > p ? -1 : getWeightedMean(d[t], m, 365, CsvType.SALES),
                    cr: f,
                    topPct: 0 == f.productCount || 0 >= r ? 108 : parseInt(Math.ceil(r / f.productCount * 100))
                })
            }
        }
    h.sort(function(z, F) {
        return z.sublevel == F.sublevel ? z.rank > F.rank ? -1 : 1 : z.sublevel < F.sublevel ? -1 : 1
    });
    return h
}
var supportsPassive = !1;
try {
    var opts = Object.defineProperty({}, "passive", {
        get: function() {
            supportsPassive = !0
        }
    });
    window.addEventListener("test", null, opts)
} catch (a) {}
var currencies = 0;
function exchangeCurrencyCSV(a, b, d, h) {
    if (null != a)
        for (var m = b.isWithShipping ? 3 : 2, t = 0; t < a.length; t += m)
            b.isWithShipping ? (a[t + 1] = Money.raw(a[t + 1], {
                sourceDomainId: d,
                targetDomainId: h,
                applyFloor: !0,
                keepUnit: !0
            }),
            a[t + 2] = Money.raw(a[t + 2], {
                sourceDomainId: d,
                targetDomainId: h,
                applyFloor: !0,
                keepUnit: !0
            })) : a[t + 1] = Money.raw(a[t + 1], {
                sourceDomainId: d,
                targetDomainId: h,
                applyFloor: !0,
                keepUnit: !0
            })
}
function imageToHtml(a, b, d, h) {
    var m = (a = imageToUrl(a, b)) ? "" : 'alt="No image available"';
    a || (a = imgCDNUrl + "no-photo-available.png",
    d = "");
    return "<img " + (h ? ' style="width:' + h + "px; height:" + h + 'px;"' : "") + ' class="active ' + d + '" src="' + a + '" width="' + b + '" height="' + b + '" ' + m + " />"
}
function imageToUrl(a, b) {
    "string" == typeof a && (a = a.split(","));
    if (null == a || 0 === a.length || "" === a[0])
        return !1;
    if (!b)
        return "" + imageServer + a[0];
    var d = a[0].substring(a[0].length - 4, a[0].length);
    ".gif" === d || ".jpg" === d || ".png" === d ? a = a[0].substring(0, a[0].length - 4) : (a = a[0],
    d = ".jpg");
    return "" + imageServer + a + "._SS" + b + "_" + d
}
function replaceHtml(a, b) {
    if (a = document.getElementById(a)) {
        $(a).find("*").off();
        var d = a.cloneNode(!1);
        d.innerHTML = b;
        a.parentNode.replaceChild(d, a)
    }
}
function replaceHtmlEl(a, b) {
    if (a && a.parentNode) {
        $(a).find("*").off();
        var d = a.cloneNode(!1);
        d.innerHTML = b;
        a.parentNode.replaceChild(d, a);
        return d
    }
}
function replaceElement(a, b, d, h) {
    if (a && a.parentNode)
        return $(a).find("*").off(),
        b = document.createElement(b),
        b.innerHTML = d,
        h && b.setAttribute("style", h),
        a.parentNode.replaceChild(b, a),
        b
}
function floatHorizontalScroll(a) {
    var b = $(a)
      , d = "auto" !== b.css("left")
      , h = (d ? b.css("left") : b.css("right")).replace("px", "");
    $(window).scroll(function() {
        var m = jQuery(this).scrollLeft();
        d ? b.css({
            left: h + m + "px"
        }) : b.css({
            right: h - m + "px"
        })
    })
}
function toCamelCase(a) {
    return a.toLowerCase().replace(/[-_]+/g, " ").replace(/[^\w\s]/g, "").replace(/ (.)/g, function(b) {
        return b.toUpperCase()
    }).replace(/ /g, "")
}
function toSpecialCamelCase(a) {
    return a.toLowerCase().replace(/[-_]+/g, " ").replace(/[^\w\s]/g, "").replace(/(?: |^)(.)/g, function(b) {
        return b.toUpperCase()
    })
}
function longCodeToString(a, b) {
    if (1E4 > a)
        return "0";
    var d = "" + a
      , h = d.length
      , m = b ? 12 : 13;
    if (h == m)
        return d;
    if (h > m)
        return console.error("invalid product code: " + a + " isUPC: " + b),
        "0";
    a = m - h;
    b = "";
    for (h = 0; h < a; h++)
        b += "0";
    return b + d
}
function stripTags(a) {
    return a.replace(/<\/?[^>]+>/gi, "")
}
function stripHTML(a) {
    return stripTags($("<div/>").html(a).text())
}
function escapeHTML(a) {
    var b = document.createElement("div");
    a = document.createTextNode(a);
    b.appendChild(a);
    return b.innerHTML
}
function unescapeHTML(a) {
    var b = document.createElement("div");
    b.innerHTML = a.stripTags();
    return b.childNodes[0].nodeValue
}
function getLoaderFlip(a) {
    return '<div class="cssload-loader"><div class="cssload-flipper"><div class="cssload-front ' + a + '"></div><div class="cssload-back ' + a + '"></div></div></div>'
}
function getLoaderBox(a) {
    var b = newThemeColor;
    "#905246" === b && (b = "#ce6e6c");
    b = '<div style="position:relative;width:50px;display:block;margin-bottom:50px;"><div class="cssload-box-loading" style="--new-theme-color:' + (b + ';"></div></div>');
    a && (b = '<div class="loadingFlipper" style="display:flex;justify-content:center;margin:80px;flex-direction:column;align-content:center;align-items: center;">' + b + '<div class="loadingProgress"></div></div>');
    return b
}
(function(a) {
    function b(d, h) {
        this.content = d;
        this.shown = !1
    }
    a.fn.colorTip = function(d) {
        var h = "red green blue white yellow black".split(" ");
        d = a.extend({
            color: "red",
            timeout: 5
        }, d);
        return this.each(function() {
            var m = a(this)
              , t = m.attr("title");
            "INPUT" == m.get(0).nodeName && (m = m.parent());
            if (!t)
                return !0;
            var f = new b(t);
            m.append(f.generate()).addClass("colorTipContainer");
            t = !1;
            for (var n = 0; n < h.length; n++)
                if (m.hasClass(h[n])) {
                    t = !0;
                    break
                }
            t || m.addClass(d.color);
            m.hover(function() {
                f.show();
                f.tip.find(".colorTipContent").one("mouseenter", function() {
                    f.hide()
                })
            }, function() {
                f.hide()
            });
            m.removeAttr("title");
            a(this).removeAttr("title")
        })
    }
    ;
    b.prototype = {
        generate: function() {
            return this.tip || (this.tip = a('<span class="colorTip"><span class="colorTipContent">' + this.content + '</span><span class="pointyTipShadow"></span><span class="pointyTip"></span></span>'))
        },
        show: function() {
            if (!this.shown) {
                var d = -18 - this.tip.height();
                -40 > d && (d -= 3);
                this.tip.css({
                    marginLeft: -this.tip.outerWidth() / 2,
                    top: d
                }).show();
                this.shown = !0
            }
        },
        hide: function() {
            this.shown && (this.tip.hide(),
            this.shown = !1)
        }
    }
}
)(jQuery);
function float2int(a) {
    return a | 0
}
Date.DATE_ATOM = "Y-m-d%TH:i:sP";
Date.DATE_ISO8601 = "Y-m-d%TH:i:sO";
Date.DATE_RFC2822 = "D, d M Y H:i:s O";
Date.DATE_W3C = "Y-m-d%TH:i:sP";
Date.prototype.formatDate = function(a, b) {
    function d(p) {
        return void 0 != n[p] ? n[p]() : p
    }
    var h = la._77
      , m = la._78
      , t = la._79
      , f = la._80
      , n = {
        a: function() {
            return 11 < r.getHours() ? "pm" : "am"
        },
        A: function() {
            return this.a().toUpperCase()
        },
        B: function() {
            var p = 60 * (r.getTimezoneOffset() + 60);
            p = 3600 * r.getHours() + 60 * r.getMinutes() + r.getSeconds() + p;
            p = Math.floor(p / 86.4);
            1E3 < p && (p -= 1E3);
            0 > p && (p += 1E3);
            1 == String(p).length && (p = "00" + p);
            2 == String(p).length && (p = "0" + p);
            return p
        },
        c: function() {
            return this.Y() + "-" + this.m() + "-" + this.d() + "T" + this.H() + ":" + this.i() + ":" + this.s() + this.P()
        },
        d: function() {
            var p = String(this.j());
            return 1 == p.length ? "0" + p : p
        },
        D: function() {
            return m[r.getDay()]
        },
        F: function() {
            return f[r.getMonth()]
        },
        g: function() {
            return 0 == r.getHours() ? 12 : 12 < r.getHours() ? r.getHours() - 12 : r.getHours()
        },
        G: function() {
            return r.getHours()
        },
        h: function() {
            var p = String(this.g());
            return 1 == p.length ? "0" + p : p
        },
        H: function() {
            var p = String(this.G());
            return 1 == p.length ? "0" + p : p
        },
        i: function() {
            var p = String(r.getMinutes());
            return 1 == p.length ? "0" + p : p
        },
        I: function() {
            return (new Date("January 1 " + this.Y() + " 00:00:00")).getTimezoneOffset() == r.getTimezoneOffset() ? 0 : 1
        },
        j: function() {
            return r.getDate()
        },
        l: function() {
            return h[r.getDay()]
        },
        L: function() {
            var p = this.Y();
            return 0 == p % 4 && 0 != p % 100 || 0 == p % 4 && 0 == p % 100 && 0 == p % 400 ? 1 : 0
        },
        m: function() {
            var p = String(this.n());
            return 1 == p.length ? "0" + p : p
        },
        M: function() {
            return t[r.getMonth()]
        },
        n: function() {
            return r.getMonth() + 1
        },
        N: function() {
            var p = this.w();
            return 0 == p ? 7 : p
        },
        O: function() {
            var p = Math.abs(r.getTimezoneOffset())
              , z = String(Math.floor(p / 60));
            p = String(p % 60);
            1 == z.length && (z = "0" + z);
            1 == p.length && (p = "0" + p);
            return 0 > r.getTimezoneOffset() ? "+" + z + p : "-" + z + p
        },
        P: function() {
            var p = this.O();
            return p.substr(0, 3) + ":" + p.substr(3, 2)
        },
        r: function() {
            return this.D() + ", " + this.d() + " " + this.M() + " " + this.Y() + " " + this.H() + ":" + this.i() + ":" + this.s() + " " + this.O()
        },
        s: function() {
            var p = String(r.getSeconds());
            return 1 == p.length ? "0" + p : p
        },
        S: function() {
            switch (r.getDate()) {
            case 1:
                return "st";
            case 2:
                return "nd";
            case 3:
                return "rd";
            case 21:
                return "st";
            case 22:
                return "nd";
            case 23:
                return "rd";
            case 31:
                return "st";
            default:
                return "th"
            }
        },
        t: function() {
            return 1 == this.L() && 2 == this.n() ? 29 : [null, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][this.n()]
        },
        U: function() {
            return Math.round(r.getTime() / 1E3)
        },
        w: function() {
            return r.getDay()
        },
        W: function() {
            var p = this.N()
              , z = this.z()
              , F = 364 + this.L() - z;
            if (2 >= F && p <= 3 - F)
                return 1;
            if (2 >= z && 5 <= p)
                return (new Date(this.Y() - 1,11,31)).formatDate("W");
            p = (new Date(this.Y(),0,1)).getDay();
            p = 0 != p ? p - 1 : 6;
            return 3 >= p ? 1 + Math.floor((z + p) / 7) : 1 + Math.floor((z - (7 - p)) / 7)
        },
        y: function() {
            var p = String(this.Y());
            return p.substring(p.length - 2, p.length)
        },
        Y: function() {
            if (r.getFullYear) {
                var p = (new Date("January 1 2001 00:00:00 +0000")).getFullYear();
                if (2001 == p)
                    return r.getFullYear()
            }
            p = r.getYear();
            p %= 100;
            return p + (38 > p ? 2E3 : 1900)
        },
        z: function() {
            var p = "January 1 " + this.Y() + " 00:00:00 GMT" + this.O();
            p = new Date(p);
            p = r.getTime() - p.getTime();
            return Math.floor(p / 1E3 / 60 / 60 / 24)
        },
        Z: function() {
            return -60 * r.getTimezoneOffset()
        }
    };
    var r = b ? new Date(b) : this;
    a = a.split("");
    for (b = 0; b < a.length; )
        "%" == a[b] ? a.splice(b, 1) : a[b] = d(a[b]),
        b++;
    return a.join("")
}
;
function drawLine(a, b, d, h, m) {
    try {
        if (!$(a).next().hasClass("drawLine")) {
            var t = getOffset(a)
              , f = getOffset(b)
              , n = t.left
              , r = t.top + t.height
              , p = f.left + f.width / 2 - 5
              , z = f.top
              , F = Math.sqrt((p - n) * (p - n) + (z - r) * (z - r));
            b = (n + p) / 2 - F / 2;
            f = (r + z) / 2 - h / 2;
            var I = 180 / Math.PI * Math.atan2(r - z, n - p)
              , E = f + t.height / 2 + 4;
            t = b + 19;
            iframe.isIframe && (E = f,
            t = b + 7);
            d = "<div class='drawLine' style='opacity: " + m + "; height:" + h + "px; background-color:" + d + "; left:" + t + "px; top:" + E + "px; width:" + F + "px; -moz-transform:rotate(" + I + "deg); -webkit-transform:rotate(" + I + "deg); -o-transform:rotate(" + I + "deg); -ms-transform:rotate(" + I + "deg); transform:rotate(" + I + "deg);' />";
            $(a).after(d)
        }
    } catch (K) {}
}
function getOffset(a) {
    for (var b = 0, d = 0, h = a.offsetWidth | 0, m = a.offsetHeight | 0, t = 2; 0 != t && a && !isNaN(a.offsetLeft) && !isNaN(a.offsetTop); )
        b += a.offsetLeft - a.scrollLeft,
        d += a.offsetTop - a.scrollTop,
        a = a.offsetParent,
        t--;
    return {
        top: d,
        left: b,
        width: h,
        height: m
    }
}
Array.prototype.includes || (Array.prototype.includes = function(a, b) {
    if (null == this)
        throw new TypeError("Array.prototype.includes called on null or undefined");
    var d = Object(this)
      , h = parseInt(d.length, 10) || 0;
    if (0 === h)
        return !1;
    b = parseInt(b, 10) || 0;
    0 <= b || (b = h + b,
    0 > b && (b = 0));
    for (var m; b < h; ) {
        m = d[b];
        if (a === m || a !== a && m !== m)
            return !0;
        b++
    }
    return !1
}
);
function addDataUpdateHandler() {
    $(".link--data-update").on("click", function(a) {
        a.preventDefault();
        SettingsSubscription.initUpdateData(!1)
    })
}
function removeToolTip(a, b, d) {
    a.removeClass("colorTipContainer");
    var h = a.children(".colorTip");
    d ? a.attr("title", d) : a.attr("title", h.text());
    h.remove();
    b && a.removeClass(b)
}
function isStockMax(a, b) {
    return [999, 1E3, 99999].includes(a) ? !0 : a && b ? 1 === b[b.length - 1] : !1
}
function getAppLinksAndBadges() {
    switch (storage.language) {
    case "3":
        var a = '<img alt="" src="' + imgCDNUrl + 'app-store/Download_on_the_App_Store_Badge_DE_RGB_blk_092917.svg"/>';
        var b = '<img alt="Jetzt bei Google Play" src="' + imgCDNUrl + 'app-store/de_badge_web_generic.png"/>';
        break;
    case "4":
        a = '<img alt="" src="' + imgCDNUrl + 'app-store/Download_on_the_App_Store_Badge_FR_RGB_blk_100517.svg"/>';
        b = '<img alt="Disponible sur Google Play" src="' + imgCDNUrl + 'app-store/fr_badge_web_generic.png"/>';
        break;
    case "5":
        a = '<img alt="" src="' + imgCDNUrl + 'app-store/Download_on_the_App_Store_Badge_JP_RGB_blk_100317.svg"/>';
        b = '<img alt="Google Play \u3067\u624b\u306b\u5165\u308c\u3088\u3046" src="' + imgCDNUrl + 'app-store/ja_badge_web_generic.png"/>';
        break;
    case "7":
        a = '<img alt="" src="' + imgCDNUrl + 'app-store/Download_on_the_App_Store_Badge_CNSC_RGB_blk_092917.svg"/>';
        b = '<img alt="\u4e0b\u8f7d\u5e94\u7528\uff0c\u8bf7\u5230 Google Play" src="' + imgCDNUrl + 'app-store/zh-cn_badge_web_generic.png"/>';
        break;
    case "8":
        a = '<img alt="" src="' + imgCDNUrl + 'app-store/Download_on_the_App_Store_Badge_IT_RGB_blk_100317.svg"/>';
        b = '<img alt="Disponibile su Google Play" src="' + imgCDNUrl + 'app-store/it_badge_web_generic.png"/>';
        break;
    case "9":
        a = '<img alt="" src="' + imgCDNUrl + 'app-store/Download_on_the_App_Store_Badge_ES_RGB_blk_100217.svg"/>';
        b = '<img alt="Disponible en Google Play" src="' + imgCDNUrl + 'app-store/es_badge_web_generic.png"/>';
        break;
    default:
        a = '<img alt="" src="' + imgCDNUrl + 'app-store/Download_on_the_App_Store_Badge_US-UK_RGB_blk_092917.svg"/>',
        b = '<img alt="Get it on Google Play" src="' + imgCDNUrl + 'app-store/en_badge_web_generic.png"/>'
    }
    return {
        linkAppStore: "https://apps.apple.com/app/keepa-price-tracker/id1518541385",
        badgeAppStore: a,
        linkGooglePlay: "https://play.google.com/store/apps/details?id=com.keepa.mobile",
        badgeGooglePlay: b
    }
}
var showReferencePrice = function(a) {
    return "#!deals" === window.location.hash.split("/")[0] ? !1 : 0 < currencyDomainId && currencyDomainId != a && 0 != currencies && currencies[a] != currencies[currencyDomainId]
}
  , Money = function() {
    var a = {}, b = 0, d, h, m, t = function(f, n) {
        !0 === n.isDivided && 5 != n.sourceDomainId && (f *= 100);
        n.absolute && 0 > f && (-1 != f || -1 == f && n.acceptMinusOne) && null != f && (f *= -1);
        b = f;
        "undefined" === typeof n.targetDomainId && (n.targetDomainId = 0 < currencyDomainId ? currencyDomainId : n.sourceDomainId);
        a = n;
        d = Number(a.sourceDomainId);
        h = Number(a.targetDomainId);
        m = 5 != h ? 2 : 0;
        !0 === a.noDigits && (m = 0);
        0 != h && d != h && 0 != currencies && currencies[d] != currencies[h] && -1 != b && null != b && (b = 1 / currencies[d] * b * currencies[h] / (5 == h ? 100 : 5 == d ? .01 : 1),
        b = +accounting.toFixed(b, a.keepUnit ? m : 0));
        !0 !== a.keepUnit && 5 != h && (b = 100 == h ? b / 10 : b / 100);
        a.applyFloor && (b = Math.floor(b))
    };
    return {
        format: function(f, n) {
            try {
                t(f, n);
                if (null == f || -1 == f && !a.acceptMinusOne)
                    return "-";
                var r = !0 === a.forceEuropeanStyle
                  , p = a.preValueModifier ? a.preValueModifier + "%v" : "%v"
                  , z = a.skipSymbol ? p : r ? p + " %s" : "%s " + p;
                return accounting.formatMoney(b, {
                    symbol: getCurrencyByDomain(h),
                    precision: m,
                    thousand: r ? "." : ",",
                    decimal: r ? "," : ".",
                    format: z
                })
            } catch (F) {
                return reportBug(F),
                ""
            }
        },
        raw: function(f, n) {
            try {
                return t(f, n),
                b
            } catch (r) {
                return reportBug(r),
                ""
            }
        },
        unformat: function(f) {
            return accounting.unformat(f)
        }
    }
}()
  , NumberUtil = function() {
    return {
        format: function(a, b) {
            return accounting.formatNumber(a, {
                precision: b || 0,
                thousand: ",",
                decimal: "."
            })
        }
    }
}()
  , CurrencySwitch = function() {
    var a = function() {
        var b = $.Deferred()
          , d = material.getButton("submitCurrency", la._225, null, "money")
          , h = []
          , m = [];
        continents.forEach(function(f, n) {
            f.forEach(function(r) {
                var p = getCurrencyCodeByDomain(r)
                  , z = getCurrencyByDomain(r);
                h[n] || (h[n] = []);
                m.includes(p) || (m.push(p),
                r = material.getRadio(r + "currency", z + " " + p, r == currencyDomainId),
                h[n].push(r))
            })
        });
        var t = material.getRadio("0currency", la._954, 0 == currencyDomainId);
        d = '<div style="width:400px;margin-bottom:10px;">' + la._952 + "<br>" + la._953 + '*</div>\n\t\t\t<form name="loadForm" id="formCurrency">\n\t\t\t<section id="currencyRadio" style="margin: 10px 0">\n\t\t\t\t' + t + '\n\t\t\t\t<div class="mdc-typography--caption">' + la._664 + " / " + la._665 + "</div>\n\t\t\t\t" + h[0].join("") + h[1].join("") + '\n\t\t\t\t<div class="mdc-typography--caption">' + la._353 + "</div>\n\t\t\t\t" + h[2].join("") + '\n\t\t\t\t<div class="mdc-typography--caption">' + la._354 + "</div>\n\t\t\t\t" + h[3].join("") + '\n\t\t\t\t<div class="mdc-typography--caption">' + la._663 + "</div>\n\t\t\t\t" + h[4].join("") + "\n\t\t\t</section>\n\t\t\t" + d + '\n\t\t\t</form>\n\t\t\t<div style="width: 400px;margin-top: 10px;font-size: 11px;text-align: justify;">\n\t\t\t* ' + la._955 + "\n\t\t\t</div>";
        material.init("#formCurrency");
        setTimeout(function() {
            $("#formCurrency").on("submit", function(f) {
                var n = Number($("#currencyRadio").find(":checked")[0].id.replace("currency-radio", ""));
                b.resolve({
                    currency: n
                });
                f.preventDefault()
            })
        }, 0);
        return {
            onSubmit: b.promise(),
            html: d
        }
    };
    return {
        init: function() {
            var b = a()
              , d = showPopup(la._951, b.html, !0);
            b.onSubmit.done(function(h) {
                h = Number(h.currency);
                0 < h && "undefined" === typeof currencies[h] && (h = 0);
                storage.currencyDomainId = h;
                settings.send();
                settings.refresh();
                d.close()
            })
        }
    }
}()
  , LoaderUtil = function() {
    var a = []
      , b = function(d, h) {
        var m = $.Deferred();
        if (a.includes(h))
            return m.resolve();
        a.push(h);
        var t = document.createElement(d);
        switch (d) {
        case "script":
            var f = "body";
            d = "src";
            t.async = !0;
            t.crossOrigin = "anonymous";
            break;
        case "link":
            f = "head";
            d = "href";
            t.type = "text/css";
            t.rel = "stylesheet";
            break;
        default:
            throw Error("Unsupported tag.");
        }
        t.onload = m.resolve;
        t.onerror = m.reject;
        t[d] = h;
        document[f].appendChild(t);
        return m.promise()
    };
    return {
        css: function(d) {
            return b("link", d)
        },
        js: function(d) {
            return b("script", d)
        }
    }
}()
  , GraphService = function() {
    return {
        getAvailableGraphTypes: function() {
            return [CsvType.AMAZON.index, CsvType.NEW.index, CsvType.USED.index, CsvType.SALES.index, CsvType.NEW_FBM_SHIPPING.index, CsvType.LIGHTNING_DEAL.index, CsvType.WAREHOUSE.index, CsvType.NEW_FBA.index, CsvType.BUY_BOX_SHIPPING.index]
        },
        getDefaultWebGraphRange: function() {
            return 365
        },
        getDefaultWebGraphType: function() {
            var a = Array(CsvType.length).fill(0);
            a[CsvType.AMAZON.index] = 1;
            a[CsvType.NEW.index] = 1;
            a[CsvType.USED.index] = 1;
            a[CsvType.SALES.index] = 1;
            a[CsvType.WAREHOUSE.index] = 1;
            a[CsvType.LIGHTNING_DEAL.index] = 1;
            return a
        },
        getShareUrl: function(a, b) {
            var d = "" + graphBaseUrl + graphBaseFileName;
            return d += "?asin=" + a + "&domain=" + getTldByDomain(b)
        },
        getUrl: function(a, b, d, h, m, t, f) {
            var n = "" + graphBaseUrl + graphBaseFileName;
            n += "?asin=" + a + "&domain=" + getTldByDomain(b);
            m = m || JSON.parse(get("webGraphType"));
            t = t || JSON.parse(get("webGraphRange"));
            n += "&amazon=" + m[CsvType.AMAZON.index];
            n += "&new=" + m[CsvType.NEW.index];
            n += "&used=" + m[CsvType.USED.index];
            n += "&salesrank=" + m[CsvType.SALES.index];
            n += "&bb=" + m[CsvType.BUY_BOX_SHIPPING.index];
            n += "&fbm=" + m[CsvType.NEW_FBM_SHIPPING.index];
            n += "&fba=" + m[CsvType.NEW_FBA.index];
            n += "&ld=" + m[CsvType.LIGHTNING_DEAL.index];
            n += "&wd=" + m[CsvType.WAREHOUSE.index];
            n = n + ("&range=" + t) + ("&width=" + (d || 500) + "&height=" + (h || 200));
            f && 1 === f && (n += "&type=1");
            return n
        },
        getWebGraphTypeAllOff: function() {
            return Array(CsvType.length).fill(0)
        }
    }
}();
function sendHelloGraph(a) {
    if (!isTest && (0 != storage.accountType && 1 != storage.accountType || a)) {
        var b = "?token=" + storage.token;
        a && (b = "");
        a = new XMLHttpRequest;
        a.open("HEAD", "https://graph.keepa.com/hello.graph" + b, !0);
        a.withCredentials = !0;
        a.send(null)
    }
}
function getBaseUrl() {
    var a = protocol + document.location.hostname;
    /localhost:63342\/web/.test(document.location.href) && (a = "http://" + document.location.host + "/web/index_local.html" + document.location.search.replace(/\/$/, ""));
    return a + "/"
}
function encodeHTML(a) {
    return a ? a.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;").split("'").join("&#39;") : ""
}
function getCasinLocalesFromStorage() {
    var a = storage.casinLocales ? tryParseJSON(storage.casinLocales) : null;
    Array.isArray(a) && a.length === LocaleType.length && "boolean" === typeof a[0] || (a = Array(LocaleType.length).fill(!1),
    a[0] = !0);
    return a
}
;(function(a) {
    a.color = {};
    a.color.make = function(d, h, m, t) {
        var f = {};
        f.r = d || 0;
        f.g = h || 0;
        f.b = m || 0;
        f.a = null != t ? t : 1;
        f.add = function(n, r) {
            for (var p = 0; p < n.length; ++p)
                f[n.charAt(p)] += r;
            return f.normalize()
        }
        ;
        f.scale = function(n, r) {
            for (var p = 0; p < n.length; ++p)
                f[n.charAt(p)] *= r;
            return f.normalize()
        }
        ;
        f.toString = function() {
            return 1 <= f.a ? "rgb(" + [f.r, f.g, f.b].join() + ")" : "rgba(" + [f.r, f.g, f.b, f.a].join() + ")"
        }
        ;
        f.normalize = function() {
            function n(r, p, z) {
                return p < r ? r : p > z ? z : p
            }
            f.r = n(0, parseInt(f.r), 255);
            f.g = n(0, parseInt(f.g), 255);
            f.b = n(0, parseInt(f.b), 255);
            f.a = n(0, f.a, 1);
            return f
        }
        ;
        f.clone = function() {
            return a.color.make(f.r, f.b, f.g, f.a)
        }
        ;
        return f.normalize()
    }
    ;
    a.color.extract = function(d, h) {
        do {
            var m = d.css(h).toLowerCase();
            if ("" != m && "transparent" != m)
                break;
            d = d.parent()
        } while (d.length && !a.nodeName(d.get(0), "body"));
        "rgba(0, 0, 0, 0)" == m && (m = "transparent");
        return a.color.parse(m)
    }
    ;
    a.color.parse = function(d) {
        var h, m = a.color.make;
        if (h = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(d))
            return m(parseInt(h[1], 10), parseInt(h[2], 10), parseInt(h[3], 10));
        if (h = /rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(d))
            return m(parseInt(h[1], 10), parseInt(h[2], 10), parseInt(h[3], 10), parseFloat(h[4]));
        if (h = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)%\s*,\s*([0-9]+(?:\.[0-9]+)?)%\s*,\s*([0-9]+(?:\.[0-9]+)?)%\s*\)/.exec(d))
            return m(2.55 * parseFloat(h[1]), 2.55 * parseFloat(h[2]), 2.55 * parseFloat(h[3]));
        if (h = /rgba\(\s*([0-9]+(?:\.[0-9]+)?)%\s*,\s*([0-9]+(?:\.[0-9]+)?)%\s*,\s*([0-9]+(?:\.[0-9]+)?)%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(d))
            return m(2.55 * parseFloat(h[1]), 2.55 * parseFloat(h[2]), 2.55 * parseFloat(h[3]), parseFloat(h[4]));
        if (h = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(d))
            return m(parseInt(h[1], 16), parseInt(h[2], 16), parseInt(h[3], 16));
        if (h = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(d))
            return m(parseInt(h[1] + h[1], 16), parseInt(h[2] + h[2], 16), parseInt(h[3] + h[3], 16));
        d = a.trim(d).toLowerCase();
        if ("transparent" == d)
            return m(255, 255, 255, 0);
        h = b[d] || [0, 0, 0];
        return m(h[0], h[1], h[2])
    }
    ;
    var b = {
        aqua: [0, 255, 255],
        azure: [240, 255, 255],
        beige: [245, 245, 220],
        black: [0, 0, 0],
        blue: [0, 0, 255],
        brown: [165, 42, 42],
        cyan: [0, 255, 255],
        darkblue: [0, 0, 139],
        darkcyan: [0, 139, 139],
        darkgrey: [169, 169, 169],
        darkgreen: [0, 100, 0],
        darkkhaki: [189, 183, 107],
        darkmagenta: [139, 0, 139],
        darkolivegreen: [85, 107, 47],
        darkorange: [255, 140, 0],
        darkorchid: [153, 50, 204],
        darkred: [139, 0, 0],
        darksalmon: [233, 150, 122],
        darkviolet: [148, 0, 211],
        fuchsia: [255, 0, 255],
        gold: [255, 215, 0],
        green: [0, 128, 0],
        indigo: [75, 0, 130],
        khaki: [240, 230, 140],
        lightblue: [173, 216, 230],
        lightcyan: [224, 255, 255],
        lightgreen: [144, 238, 144],
        lightgrey: [211, 211, 211],
        lightpink: [255, 182, 193],
        lightyellow: [255, 255, 224],
        lime: [0, 255, 0],
        magenta: [255, 0, 255],
        maroon: [128, 0, 0],
        navy: [0, 0, 128],
        olive: [128, 128, 0],
        orange: [255, 165, 0],
        pink: [255, 192, 203],
        purple: [128, 0, 128],
        violet: [128, 0, 128],
        red: [255, 0, 0],
        silver: [192, 192, 192],
        white: [255, 255, 255],
        yellow: [255, 255, 0]
    }
}
)(jQuery);
(function(a) {
    function b(t, f) {
        var n = f.children("." + t)[0];
        if (null == n && (n = document.createElement("canvas"),
        n.className = t,
        a(n).css({
            direction: "ltr",
            position: "absolute",
            left: 0,
            top: 0
        }).appendTo(f),
        !n.getContext))
            if (window.G_vmlCanvasManager)
                n = window.G_vmlCanvasManager.initElement(n);
            else
                throw Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");
        this.element = n;
        t = this.context = n.getContext("2d");
        this.pixelRatio = (window.devicePixelRatio || 1) / (t.webkitBackingStorePixelRatio || t.mozBackingStorePixelRatio || t.msBackingStorePixelRatio || t.oBackingStorePixelRatio || t.backingStorePixelRatio || 1);
        try {
            this.resize(float2int(f.width()), float2int(f.height()))
        } catch (r) {
            reportBug(r),
            console.log(f, r),
            this.resize(f.width(), f.height())
        }
        this.textContainer = null;
        this.text = {};
        this._textCache = {}
    }
    function d(t, f, n, r) {
        function p(C, U) {
            U = [Y].concat(U);
            for (var ia in C)
                C[ia].apply(this, U)
        }
        function z(C) {
            for (var U = [], ia = 0; ia < C.length; ++ia) {
                var X = a.extend(!0, {}, T.series);
                null != C[ia].data ? (X.data = C[ia].data,
                delete C[ia].data,
                a.extend(!0, X, C[ia]),
                C[ia].data = X.data) : X.data = C[ia];
                U.push(X)
            }
            R = U;
            ia = R.length;
            U = -1;
            for (C = 0; C < R.length; ++C)
                X = R[C].color,
                null != X && (ia--,
                "number" == typeof X && X > U && (U = X));
            ia <= U && (ia = U + 1);
            U = [];
            var sa = T.colors
              , wa = sa.length
              , xa = 0;
            for (C = 0; C < ia; C++)
                X = a.color.parse(sa[C % wa] || "#666"),
                0 == C % wa && C && (xa = 0 <= xa ? .5 > xa ? -xa - .2 : 0 : -xa),
                U[C] = X.scale("rgb", 1 + xa);
            for (C = ia = 0; C < R.length; ++C) {
                X = R[C];
                null == X.color ? (X.color = U[ia].toString(),
                ++ia) : "number" == typeof X.color && (X.color = U[X.color].toString());
                if (null == X.lines.show) {
                    var Ia;
                    sa = !0;
                    for (Ia in X)
                        if (X[Ia] && X[Ia].show) {
                            sa = !1;
                            break
                        }
                    sa && (X.lines.show = !0)
                }
                null == X.lines.zero && (X.lines.zero = !!X.lines.fill);
                X.xaxis = H(Ca, F(X, "x"));
                X.yaxis = H(Ba, F(X, "y"))
            }
            V()
        }
        function F(C, U) {
            C = C[U + "axis"];
            "object" == typeof C && (C = C.n);
            "number" != typeof C && (C = 1);
            return C
        }
        function I() {
            return a.grep(Ca.concat(Ba), function(C) {
                return C
            })
        }
        function E(C) {
            var U = {}, ia, X;
            for (ia = 0; ia < Ca.length; ++ia)
                (X = Ca[ia]) && X.used && (U["x" + X.n] = X.c2p(C.left));
            for (ia = 0; ia < Ba.length; ++ia)
                (X = Ba[ia]) && X.used && (U["y" + X.n] = X.c2p(C.top));
            void 0 !== U.x1 && (U.x = U.x1);
            void 0 !== U.y1 && (U.y = U.y1);
            return U
        }
        function K() {
            var C = [], U, ia;
            for (U = 0; U < Ca.length; ++U)
                (ia = Ca[U]) && ia.used && C.push(ia);
            for (U = 0; U < Ba.length; ++U)
                (ia = Ba[U]) && ia.used && C.push(ia);
            return C
        }
        function H(C, U) {
            C[U - 1] || (C[U - 1] = {
                n: U,
                direction: C == Ca ? "x" : "y",
                options: a.extend(!0, {}, C == Ca ? T.xaxis : T.yaxis)
            });
            return C[U - 1]
        }
        function V() {
            function C(Na, La, Sa) {
                La < Na.datamin && La != -X && (Na.datamin = La);
                Sa > Na.datamax && Sa != X && (Na.datamax = Sa)
            }
            var U = Number.POSITIVE_INFINITY, ia = Number.NEGATIVE_INFINITY, X = Number.MAX_VALUE, sa, wa, xa, Ia, Fa;
            a.each(I(), function(Na, La) {
                La.datamin = U;
                La.datamax = ia;
                La.used = !1
            });
            for (sa = 0; sa < R.length; ++sa) {
                var Ga = R[sa];
                Ga.datapoints = {
                    points: []
                };
                p(da.processRawData, [Ga, Ga.data, Ga.datapoints])
            }
            for (sa = 0; sa < R.length; ++sa) {
                Ga = R[sa];
                var Da = Ga.data;
                var Ma = Ga.datapoints.format;
                if (!Ma) {
                    Ma = [];
                    Ma.push({
                        x: !0,
                        number: !0,
                        required: !0
                    });
                    Ma.push({
                        y: !0,
                        number: !0,
                        required: !0
                    });
                    if (Ga.bars.show || Ga.lines.show && Ga.lines.fill)
                        Ma.push({
                            y: !0,
                            number: !0,
                            required: !1,
                            defaultValue: 0,
                            autoscale: !!(Ga.bars.show && Ga.bars.zero || Ga.lines.show && Ga.lines.zero)
                        }),
                        Ga.bars.horizontal && (delete Ma[Ma.length - 1].y,
                        Ma[Ma.length - 1].x = !0);
                    Ga.datapoints.format = Ma
                }
                if (null == Ga.datapoints.pointsize) {
                    Ga.datapoints.pointsize = Ma.length;
                    var Qa = Ga.datapoints.pointsize;
                    var Ja = Ga.datapoints.points;
                    var Pa = Ga.lines.show && Ga.lines.steps || Ga.dashes.show && Ga.dashes.steps;
                    Ga.xaxis.used = Ga.yaxis.used = !0;
                    for (wa = xa = 0; wa < Da.length; ++wa,
                    xa += Qa) {
                        var Oa = Da[wa];
                        var Ha = null == Oa;
                        if (!Ha)
                            for (Ia = 0; Ia < Qa; ++Ia) {
                                var ya = Oa[Ia];
                                if (Fa = Ma[Ia])
                                    Fa.number && null != ya && (ya = +ya,
                                    isNaN(ya) ? ya = null : Infinity == ya ? ya = X : -Infinity == ya && (ya = -X)),
                                    null == ya && (Fa.required && (Ha = !0),
                                    null != Fa.defaultValue && (ya = Fa.defaultValue));
                                Ja[xa + Ia] = ya
                            }
                        if (Ha)
                            for (Ia = 0; Ia < Qa; ++Ia)
                                ya = Ja[xa + Ia],
                                null == ya || Ga.Yignore || (Fa = Ma[Ia],
                                !1 !== Fa.autoscale && (Fa.x && C(Ga.xaxis, ya, ya),
                                Fa.y && C(Ga.yaxis, ya, ya))),
                                Ja[xa + Ia] = null;
                        else if (Pa && 0 < xa && null != Ja[xa - Qa] && Ja[xa - Qa] != Ja[xa] && Ja[xa - Qa + 1] != Ja[xa + 1]) {
                            for (Ia = 0; Ia < Qa; ++Ia)
                                Ja[xa + Qa + Ia] = Ja[xa + Ia];
                            Ja[xa + 1] = Ja[xa - Qa + 1];
                            xa += Qa
                        }
                    }
                }
            }
            for (sa = 0; sa < R.length; ++sa)
                Ga = R[sa],
                p(da.processDatapoints, [Ga, Ga.datapoints]);
            for (sa = 0; sa < R.length; ++sa)
                if (Ga = R[sa],
                Ja = Ga.datapoints.points,
                Qa = Ga.datapoints.pointsize,
                Ma = Ga.datapoints.format,
                !Ga.Yignore) {
                    Oa = xa = U;
                    Pa = Da = ia;
                    for (wa = 0; wa < Ja.length; wa += Qa)
                        if (null != Ja[wa])
                            for (Ia = 0; Ia < Qa; ++Ia)
                                ya = Ja[wa + Ia],
                                (Fa = Ma[Ia]) && !1 !== Fa.autoscale && ya != X && ya != -X && (Fa.x && (ya < xa && (xa = ya),
                                ya > Da && (Da = ya)),
                                !Fa.y || void 0 !== Ga.xaxis.options.min && Ja[wa] < Ga.xaxis.options.min || void 0 !== Ga.xaxis.options.max && Ja[wa] > Ga.xaxis.options.max || (ya < Oa && (Oa = ya),
                                ya > Pa && (Pa = ya)));
                    if (Ga.bars.show) {
                        switch (Ga.bars.align) {
                        case "left":
                            wa = 0;
                            break;
                        case "right":
                            wa = -Ga.bars.barWidth;
                            break;
                        default:
                            wa = -Ga.bars.barWidth / 2
                        }
                        Ga.bars.horizontal ? (Oa += wa,
                        Pa += wa + Ga.bars.barWidth) : (xa += wa,
                        Da += wa + Ga.bars.barWidth)
                    }
                    C(Ga.xaxis, xa, Da);
                    C(Ga.yaxis, Oa, Pa)
                }
            a.each(I(), function(Na, La) {
                La.datamin == U && (La.datamin = null);
                La.datamax == ia && (La.datamax = null)
            })
        }
        function S() {
            ha && clearTimeout(ha);
            ja.off("mousemove", M);
            ja.off("mouseleave", u);
            ja.off("click", v);
            p(da.shutdown, [ja])
        }
        function aa(C) {
            function U(xa) {
                return xa
            }
            var ia = C.options.transform || U
              , X = C.options.inverseTransform;
            if ("x" == C.direction) {
                var sa = C.scale = Ea / Math.abs(ia(C.max) - ia(C.min));
                var wa = Math.min(ia(C.max), ia(C.min))
            } else
                sa = C.scale = va / Math.abs(ia(C.max) - ia(C.min)),
                sa = -sa,
                wa = Math.max(ia(C.max), ia(C.min));
            C.p2c = ia == U ? function(xa) {
                return (xa - wa) * sa
            }
            : function(xa) {
                return (ia(xa) - wa) * sa
            }
            ;
            C.c2p = X ? function(xa) {
                return X(wa + xa / sa)
            }
            : function(xa) {
                return wa + xa / sa
            }
        }
        function ea(C, U, ia) {
            if (!ia)
                return {};
            var X = ia * Math.PI / 180
              , sa = Math.sin(X);
            X = Math.cos(X);
            var wa = X * C
              , xa = sa * C
              , Ia = -sa * U
              , Fa = X * U
              , Ga = X * C - sa * U
              , Da = sa * C + X * U
              , Ma = Math.min(0, wa, Ia, Ga);
            Ia = Math.max(0, wa, Ia, Ga);
            Ga = Math.min(0, xa, Fa, Da);
            Fa = Math.max(0, xa, Fa, Da);
            Da = {
                x: U / 2 * sa,
                y: U / 2 * X
            };
            var Qa = {
                x: C * X + U / 2 * sa,
                y: C * sa - U / 2 * X
            };
            if (0 > ia) {
                C = {
                    x: C * X + U * sa,
                    y: C * sa - U * X
                };
                var Ja = {
                    x: U * sa,
                    y: U * X
                }
            } else {
                var Pa = {
                    x: wa,
                    y: xa
                };
                C = {
                    x: U * sa,
                    y: -U * X
                }
            }
            return {
                width: Ia - Ma,
                height: Fa - Ga,
                a_left: Da,
                a_right: Qa,
                topmost: Pa,
                bottommost: C,
                leftmost: Ja
            }
        }
        function ra(C) {
            var U = C.options.labelAngle;
            if (void 0 == U || 0 == U)
                return {};
            var ia = C.box
              , X = ea(C.options.origWidth, C.options.origHeight, U)
              , sa = "left"
              , wa = 0
              , xa = 0;
            if ("bottom" == C.position) {
                var Ia = ia.top + ia.padding;
                0 > U ? wa = ma ? -X.a_left.x : X.a_left.x : (sa = "right",
                wa = -X.a_right.x,
                ma && (Ia += X.topmost.y))
            } else if ("top" == C.position)
                Ia = ia.top,
                ma && 0 < U && (Ia += ia.height - ia.padding + X.bottommost.y),
                0 > U && (sa = "right"),
                wa = !ma && 0 > U ? -X.width - X.a_left.x : 0 > U ? -X.a_right.x : -X.a_left.x;
            else if ("left" == C.position) {
                sa = "right";
                var Fa = ia.left;
                0 > U ? (xa = X.a_right.y,
                ma && (Fa -= X.leftmost.x)) : xa = ma ? X.a_right.y : -X.a_left.y
            } else
                "right" == C.position && (sa = "left",
                Fa = ia.left + ia.padding,
                0 > U ? (ma && (Fa -= X.leftmost.x),
                xa = -X.a_left.y) : xa = ma ? -X.a_left.y : -X.height + X.a_left.y);
            return {
                top: Ia,
                left: Fa,
                oTop: xa,
                oLeft: wa,
                align: sa
            }
        }
        function pa(C) {
            function U(Fa, Ga) {
                return a('<div style="position:absolute;top:-10000px;' + Ga + 'font-size:smaller"><div class="' + C.direction + "Axis " + C.direction + C.n + 'Axis">' + Fa.join("") + "</div></div>").appendTo(t)
            }
            var ia = C.options, X, sa = C.ticks || [], wa = [], xa, Ia = ia.labelWidth;
            ia = ia.labelHeight;
            if ("x" == C.direction && 0 == C.options.labelAngle) {
                if (null == Ia && (Ia = Math.floor(oa.width / (0 < sa.length ? sa.length : 1))),
                null == ia) {
                    wa = [];
                    for (X = 0; X < sa.length; ++X)
                        (xa = sa[X].label) && wa.push('<div class="tickLabel" style="float:left;width:' + Ia + 'px">' + xa + "</div>");
                    0 < wa.length && (wa.push('<div style="clear:left"></div>'),
                    sa = U(wa, "width:10000px;"),
                    ia = float2int(sa.height()),
                    sa.remove())
                }
            } else if (null == Ia || null == ia) {
                for (X = 0; X < sa.length; ++X)
                    (xa = sa[X].label) && wa.push('<div class="tickLabel">' + xa + "</div>");
                0 < wa.length && (sa = U(wa, ""),
                0 != C.options.labelAngle ? (wa = ea(float2int(sa.children().width()), float2int(sa.find("div.tickLabel").height()), C.options.labelAngle),
                C.options.origHeight = float2int(sa.find("div.tickLabel").height()),
                C.options.origWidth = float2int(sa.children().width()),
                null == ia && (ia = wa.height),
                null == Ia && (Ia = wa.width)) : (null == Ia && (Ia = float2int(sa.children().width())),
                null == ia && (ia = float2int(sa.find("div.tickLabel").height()))),
                sa.remove())
            }
            null == Ia && (Ia = 0);
            null == ia && (ia = 0);
            C.labelWidth = Ia;
            5 == Y.getOptions().graphIndex && 3 == C.n && (C.labelWidth = 13);
            C.labelHeight = ia
        }
        function ua(C) {
            var U = C.labelWidth
              , ia = C.labelHeight
              , X = C.options.position
              , sa = "x" === C.direction
              , wa = C.options.tickLength
              , xa = T.grid.axisMargin
              , Ia = T.grid.labelMargin
              , Fa = !0
              , Ga = !0
              , Da = !0
              , Ma = !1;
            a.each(sa ? Ca : Ba, function(Qa, Ja) {
                Ja && (Ja.show || Ja.reserveSpace) && (Ja === C ? Ma = !0 : Ja.options.position === X && (Ma ? Ga = !1 : Fa = !1),
                Ma || (Da = !1))
            });
            Ga && (xa = 0);
            null == wa && (wa = Da ? "full" : 5);
            sa ? (ia += Ia,
            "bottom" == X ? (ta.bottom += ia + xa,
            C.box = {
                top: oa.height - ta.bottom,
                height: ia
            }) : (C.box = {
                top: ta.top + xa,
                height: ia
            },
            ta.top += ia + xa)) : (U += Ia,
            "left" == X ? (C.box = {
                left: ta.left + xa,
                width: U
            },
            ta.left += U + xa) : (ta.right += U + xa,
            C.box = {
                left: oa.width - ta.right,
                width: U
            }));
            C.position = X;
            C.tickLength = wa;
            C.box.padding = Ia;
            C.innermost = Fa
        }
        function na(C) {
            var U, ia = I(), X = T.grid.show;
            a.each(ia, function(Ia, Fa) {
                Fa.show = Fa.options.show;
                null == Fa.show && (Fa.show = Fa.used);
                Fa.reserveSpace = Fa.show || Fa.options.reserveSpace;
                qa(Fa)
            });
            var sa = a.grep(ia, function(Ia) {
                return Ia.reserveSpace
            });
            ta.left = ta.right = ta.top = ta.bottom = 0;
            if (T.grid.show) {
                a.each(sa, function(Ia, Fa) {
                    ka(Fa);
                    za(Fa);
                    J(Fa, Fa.ticks);
                    pa(Fa)
                });
                for (U = sa.length - 1; 0 <= U; --U)
                    ua(sa[U]);
                var wa = T.grid.minBorderMargin;
                if (null == wa)
                    for (U = wa = 0; U < R.length; ++U)
                        wa = Math.max(wa, R[U].points.radius + R[U].points.lineWidth / 2);
                for (var xa in ta)
                    ta[xa] += T.grid.borderWidth,
                    ta[xa] = Math.max(wa, ta[xa])
            }
            Ea = oa.width - ta.left - ta.right;
            va = oa.height - ta.bottom - ta.top;
            a.each(ia, function(Ia, Fa) {
                aa(Fa)
            });
            X && (a.each(sa, function(Ia, Fa) {
                "x" == Fa.direction ? (Fa.box.left = ta.left - Fa.labelWidth / 2,
                Fa.box.width = oa.width - ta.left - ta.right + Fa.labelWidth) : (Fa.box.top = ta.top - Fa.labelHeight / 2,
                Fa.box.height = oa.height - ta.bottom - ta.top + Fa.labelHeight)
            }),
            ba());
            C || P()
        }
        function qa(C) {
            var U = C.options
              , ia = +(null != U.min ? U.min : C.datamin)
              , X = +(null != U.max ? U.max : C.datamax)
              , sa = X - ia;
            if (0 == sa) {
                if (sa = 0 == X ? 1 : .01,
                null == U.min && (ia -= sa),
                null == U.max || null != U.min)
                    X += sa
            } else {
                var wa = U.autoscaleMargin;
                null != wa && (null == U.min && (ia -= sa * wa,
                0 > ia && null != C.datamin && 0 <= C.datamin && (ia = 0)),
                null == U.max && (X += sa * wa,
                0 < X && null != C.datamax && 0 >= C.datamax && (X = 0)))
            }
            C.min = ia;
            C.max = X
        }
        function ka(C) {
            var U = C.options;
            var ia = "number" == typeof U.ticks && 0 < U.ticks ? U.ticks : .3 * Math.sqrt("x" == C.direction ? oa.width : oa.height);
            ia = (C.max - C.min) / ia;
            var X;
            if ("time" == U.mode) {
                var sa = {
                    second: 1E3,
                    minute: 6E4,
                    hour: 36E5,
                    day: 864E5,
                    month: 2592E6,
                    year: 525949.2 * 6E4
                };
                var wa = [[1, "second"], [2, "second"], [5, "second"], [10, "second"], [30, "second"], [1, "minute"], [2, "minute"], [5, "minute"], [10, "minute"], [30, "minute"], [1, "hour"], [2, "hour"], [4, "hour"], [8, "hour"], [12, "hour"], [1, "day"], [2, "day"], [3, "day"], [.25, "month"], [.5, "month"], [1, "month"], [2, "month"], [3, "month"], [6, "month"], [1, "year"]];
                var xa = 0;
                null != U.minTickSize && (xa = "number" == typeof U.tickSize ? U.tickSize : U.minTickSize[0] * sa[U.minTickSize[1]]);
                for (X = 0; X < wa.length - 1 && !(ia < (wa[X][0] * sa[wa[X][1]] + wa[X + 1][0] * sa[wa[X + 1][1]]) / 2 && wa[X][0] * sa[wa[X][1]] >= xa); ++X)
                    ;
                xa = wa[X][0];
                var Ia = wa[X][1];
                "year" == Ia && (X = Math.pow(10, Math.floor(Math.log(ia / sa.year) / Math.LN10)),
                wa = ia / sa.year / X,
                xa = (1.5 > wa ? 1 : 3 > wa ? 2 : 7.5 > wa ? 5 : 10) * X);
                C.tickSize = U.tickSize || [xa, Ia];
                X = function(Da) {
                    var Ma = []
                      , Qa = Da.tickSize[0]
                      , Ja = Da.tickSize[1]
                      , Pa = new Date(Da.min)
                      , Oa = Qa * sa[Ja];
                    "second" == Ja && Pa.setUTCSeconds(h(Pa.getUTCSeconds(), Qa));
                    "minute" == Ja && Pa.setUTCMinutes(h(Pa.getUTCMinutes(), Qa));
                    "hour" == Ja && Pa.setUTCHours(h(Pa.getUTCHours(), Qa));
                    "month" == Ja && Pa.setUTCMonth(h(Pa.getUTCMonth(), Qa));
                    "year" == Ja && Pa.setUTCFullYear(h(Pa.getUTCFullYear(), Qa));
                    Pa.setUTCMilliseconds(0);
                    Oa >= sa.minute && Pa.setUTCSeconds(0);
                    Oa >= sa.hour && Pa.setUTCMinutes(0);
                    Oa >= sa.day && Pa.setUTCHours(0);
                    Oa >= 4 * sa.day && Pa.setUTCDate(1);
                    Oa >= sa.year && Pa.setUTCMonth(0);
                    var Ha = 0
                      , ya = Number.NaN;
                    do {
                        var Na = ya;
                        ya = Pa.getTime();
                        Ma.push(ya);
                        if ("month" == Ja)
                            if (1 > Qa) {
                                Pa.setUTCDate(1);
                                var La = Pa.getTime();
                                Pa.setUTCMonth(Pa.getUTCMonth() + 1);
                                var Sa = Pa.getTime();
                                Pa.setTime(ya + Ha * sa.hour + (Sa - La) * Qa);
                                Ha = Pa.getUTCHours();
                                Pa.setUTCHours(0)
                            } else
                                Pa.setUTCMonth(Pa.getUTCMonth() + Qa);
                        else
                            "year" == Ja ? Pa.setUTCFullYear(Pa.getUTCFullYear() + Qa) : Pa.setTime(ya + Oa)
                    } while (ya < Da.max && ya != Na);
                    return Ma
                }
                ;
                xa = function(Da, Ma) {
                    Da = new Date(Da);
                    if (null != U.timeformat)
                        return a.plot.formatDate(Da, U.timeformat, U.monthNames);
                    var Qa = Ma.tickSize[0] * sa[Ma.tickSize[1]];
                    Ma = Ma.max - Ma.min;
                    var Ja = U.twelveHourClock ? " %p" : "";
                    return a.plot.formatDate(Da, Qa < sa.minute ? "%h:%M:%S" + Ja : Qa < sa.day ? Ma < 2 * sa.day ? "%h:%M" + Ja : "%b %d %h:%M" + Ja : Qa < sa.month ? "%b %d" : Qa < sa.year ? Ma < sa.year ? "%b" : "%b %y" : "%y", U.monthNames)
                }
            } else {
                Ia = U.tickDecimals;
                var Fa = -Math.floor(Math.log(ia) / Math.LN10);
                null != Ia && Fa > Ia && (Fa = Ia);
                X = Math.pow(10, -Fa);
                wa = ia / X;
                1.5 > wa ? xa = 1 : 3 > wa ? (xa = 2,
                2.25 < wa && (null == Ia || Fa + 1 <= Ia) && (xa = 2.5,
                ++Fa)) : xa = 7.5 > wa ? 5 : 10;
                xa *= X;
                null != U.minTickSize && xa < U.minTickSize && (xa = U.minTickSize);
                C.delta = ia;
                C.tickDecimals = Math.max(0, null != Ia ? Ia : Fa);
                C.tickSize = U.tickSize || xa;
                X = function(Da) {
                    var Ma = []
                      , Qa = h(Da.min, Da.tickSize)
                      , Ja = 0
                      , Pa = Number.NaN;
                    do {
                        var Oa = Pa;
                        Pa = Qa + Ja * Da.tickSize;
                        Ma.push(Pa);
                        ++Ja
                    } while (Pa < Da.max && Pa != Oa);
                    return Ma
                }
                ;
                xa = function(Da, Ma) {
                    return Da.toFixed(Ma.tickDecimals)
                }
            }
            if (null != U.alignTicksWithAxis) {
                var Ga = ("x" == C.direction ? Ca : Ba)[U.alignTicksWithAxis - 1];
                Ga && Ga.used && Ga != C && (X = X(C),
                0 < X.length && (null == U.min && (C.min = Math.min(C.min, X[0])),
                null == U.max && 1 < X.length && (C.max = Math.max(C.max, X[X.length - 1]))),
                X = function(Da) {
                    var Ma = [], Qa;
                    for (Qa = 0; Qa < Ga.ticks.length; ++Qa) {
                        var Ja = (Ga.ticks[Qa].v - Ga.min) / (Ga.max - Ga.min);
                        Ja = Da.min + Ja * (Da.max - Da.min);
                        Ma.push(Ja)
                    }
                    return Ma
                }
                ,
                "time" != C.mode && null == U.tickDecimals && (ia = Math.max(0, -Math.floor(Math.log(ia) / Math.LN10) + 1),
                wa = X(C),
                1 < wa.length && /\..*0$/.test((wa[1] - wa[0]).toFixed(ia)) || (C.tickDecimals = ia)))
            }
            C.tickGenerator = X;
            a.isFunction(U.tickFormatter) ? C.tickFormatter = function(Da, Ma) {
                return "" + U.tickFormatter(Da, Ma)
            }
            : C.tickFormatter = xa
        }
        function za(C) {
            var U = C.options.ticks
              , ia = [];
            null == U || "number" == typeof U && 0 < U ? ia = C.tickGenerator(C) : U && (ia = a.isFunction(U) ? U(C) : U);
            C.ticks = [];
            for (U = 0; U < ia.length; ++U) {
                var X = null
                  , sa = ia[U];
                if ("object" == typeof sa) {
                    var wa = +sa[0];
                    1 < sa.length && (X = sa[1])
                } else
                    wa = +sa;
                null == X && (X = C.tickFormatter(wa, C));
                isNaN(wa) || C.ticks.push({
                    v: wa,
                    label: X
                })
            }
        }
        function J(C, U) {
            C.options.autoscaleMargin && 0 < U.length && (null == C.options.min && (C.min = Math.min(C.min, U[0].v)),
            null == C.options.max && 1 < U.length && (C.max = Math.max(C.max, U[U.length - 1].v)))
        }
        function g() {
            oa.clear();
            p(da.drawBackground, [W]);
            var C = T.grid;
            C.show && C.backgroundColor && (W.save(),
            W.translate(ta.left, ta.top),
            W.fillStyle = fa(T.grid.backgroundColor, va, 0, "rgba(255, 255, 255, 0)"),
            W.fillRect(0, 0, Ea, va),
            W.restore());
            C.show && !C.aboveData && N();
            for (var U = 0; U < R.length; ++U) {
                p(da.drawSeries, [W, R[U]]);
                var ia = R[U];
                ia.lines.show && q(ia);
                ia.bars.show && A(ia);
                ia.points.show && L(ia)
            }
            p(da.draw, [W]);
            C.show && C.aboveData && N();
            oa.render();
            w()
        }
        function D(C, U) {
            for (var ia, X, sa, wa, xa = I(), Ia = 0; Ia < xa.length; ++Ia)
                if (ia = xa[Ia],
                ia.direction == U && (wa = U + ia.n + "axis",
                C[wa] || 1 != ia.n || (wa = U + "axis"),
                C[wa])) {
                    X = C[wa].from;
                    sa = C[wa].to;
                    break
                }
            C[wa] || (ia = "x" == U ? Ca[0] : Ba[0],
            X = C[U + "1"],
            sa = C[U + "2"]);
            null != X && null != sa && X > sa && (C = X,
            X = sa,
            sa = C);
            return {
                from: X,
                to: sa,
                axis: ia
            }
        }
        function N() {
            W.save();
            W.translate(ta.left, ta.top);
            var C = T.grid.markings;
            if (C) {
                if (a.isFunction(C)) {
                    var U = Y.getAxes();
                    U.xmin = U.xaxis.min;
                    U.xmax = U.xaxis.max;
                    U.ymin = U.yaxis.min;
                    U.ymax = U.yaxis.max;
                    C = C(U)
                }
                var ia = 0;
                a: for (; ia < C.length; ++ia) {
                    U = C[ia];
                    var X = D(U, "x")
                      , sa = D(U, "y");
                    null == X.from && (X.from = X.axis.min);
                    null == X.to && (X.to = X.axis.max);
                    null == sa.from && (sa.from = sa.axis.min);
                    null == sa.to && (sa.to = sa.axis.max);
                    if (!(X.to < X.axis.min || X.from > X.axis.max || sa.to < sa.axis.min || sa.from > sa.axis.max)) {
                        X.from = Math.max(X.from, X.axis.min);
                        X.to = Math.min(X.to, X.axis.max);
                        sa.from = Math.max(sa.from, sa.axis.min);
                        sa.to = Math.min(sa.to, sa.axis.max);
                        var wa = X.from === X.to
                          , xa = sa.from === sa.to;
                        if (!wa || !xa) {
                            X.from = Math.floor(X.axis.p2c(X.from));
                            X.to = Math.floor(X.axis.p2c(X.to));
                            sa.from = Math.floor(sa.axis.p2c(sa.from));
                            sa.to = Math.floor(sa.axis.p2c(sa.to));
                            U.isUpdateMarker && (sa.to -= 5,
                            sa.from = 0);
                            if (U.isSalesRankMaker)
                                try {
                                    for (var Ia = Y.getData(), Fa = !1, Ga = 0; Ga < Ia.length; Ga++) {
                                        var Da = Ia[Ga];
                                        if (Da.color == CsvType.SALES.color) {
                                            if (!Da.lines.show)
                                                continue a;
                                            Fa = !0;
                                            break
                                        }
                                    }
                                    if (!Fa)
                                        continue;
                                    sa.to -= 5;
                                    sa.from = 20
                                } catch (Ja) {
                                    reportBug(Ja)
                                }
                            if (U.isBuyBoxMarker)
                                try {
                                    var Ma = Y.getData();
                                    Fa = !1;
                                    for (Ga = 0; Ga < Ma.length; Ga++) {
                                        var Qa = Ma[Ga];
                                        if (Qa.color == CsvType.BUY_BOX_SHIPPING.color) {
                                            if (!Qa.lines.show)
                                                continue a;
                                            Fa = !0;
                                            break
                                        }
                                    }
                                    if (!Fa)
                                        continue;
                                    sa.from = U.xaxis.from >= changeV5Epoch ? 8 : 20
                                } catch (Ja) {
                                    reportBug(Ja)
                                }
                            wa || xa ? (xa = U.lineWidth || T.grid.markingsLineWidth,
                            Fa = xa % 2 ? .5 : 0,
                            W.beginPath(),
                            W.strokeStyle = U.color || T.grid.markingsColor,
                            W.lineWidth = xa,
                            wa ? (W.moveTo(X.to + Fa, sa.from),
                            W.lineTo(X.to + Fa, sa.to)) : (W.moveTo(X.from, sa.to + Fa),
                            W.lineTo(X.to, sa.to + Fa)),
                            W.stroke()) : (W.fillStyle = U.color || T.grid.markingsColor,
                            W.fillRect(X.from, sa.to, X.to - X.from, sa.from - sa.to))
                        }
                    }
                }
            }
            U = I();
            C = T.grid.borderWidth;
            for (Ia = 0; Ia < U.length; ++Ia)
                if (Da = U[Ia],
                ia = Da.box,
                Ma = Da.tickLength,
                Da.show && 0 != Da.ticks.length) {
                    W.strokeStyle = Da.options.tickColor || a.color.parse(Da.options.color).scale("a", .22).toString();
                    W.lineWidth = 1;
                    "x" == Da.direction ? (Qa = 0,
                    X = "full" == Ma ? "top" == Da.position ? 0 : va : ia.top - ta.top + ("top" == Da.position ? ia.height : 0)) : (X = 0,
                    Qa = "full" == Ma ? "left" == Da.position ? 0 : Ea : ia.left - ta.left + ("left" == Da.position ? ia.width : 0));
                    W.beginPath();
                    for (ia = 0; ia < Da.ticks.length; ++ia)
                        xa = Da.ticks[ia].v,
                        sa = wa = 0,
                        xa < Da.min || xa > Da.max || "full" == Ma && 0 < C && (xa == Da.min || xa == Da.max) || ("x" == Da.direction ? (Qa = Da.p2c(xa),
                        wa = "full" == Ma ? -va : Ma,
                        "top" == Da.position && (wa = -wa)) : (X = Da.p2c(xa),
                        sa = "full" == Ma ? -Ea : Ma,
                        "left" == Da.position && (sa = -sa)),
                        1 == W.lineWidth && ("x" == Da.direction ? Qa = Math.floor(Qa) + .5 : X = Math.floor(X) + .5),
                        W.moveTo(Qa, X),
                        W.lineTo(Qa + sa, X + wa));
                    W.stroke()
                }
            C && (ia = T.grid.borderColor,
            "object" == typeof C || "object" == typeof ia ? ("object" !== typeof C && (C = {
                top: C,
                right: C,
                bottom: C,
                left: C
            }),
            "object" !== typeof ia && (ia = {
                top: ia,
                right: ia,
                bottom: ia,
                left: ia
            }),
            0 < C.top && (W.strokeStyle = ia.top,
            W.lineWidth = C.top,
            W.beginPath(),
            W.moveTo(0 - C.left, -(C.top / 2)),
            W.lineTo(Ea, -(C.top / 2)),
            W.stroke()),
            0 < C.right && (W.strokeStyle = ia.right,
            W.lineWidth = C.right,
            W.beginPath(),
            W.moveTo(Ea + C.right / 2, 0 - C.top),
            W.lineTo(Ea + C.right / 2, va),
            W.stroke()),
            0 < C.bottom && (W.strokeStyle = ia.bottom,
            W.lineWidth = C.bottom,
            W.beginPath(),
            W.moveTo(Ea + C.right, va + C.bottom / 2),
            W.lineTo(0, va + C.bottom / 2),
            W.stroke()),
            0 < C.left && (W.strokeStyle = ia.left,
            W.lineWidth = C.left,
            W.beginPath(),
            W.moveTo(-(C.left / 2), va + C.bottom),
            W.lineTo(-(C.left / 2), 0),
            W.stroke())) : (W.lineWidth = C,
            W.strokeStyle = T.grid.borderColor,
            W.strokeRect(-C / 2, -C / 2, Ea + C, va + C)));
            W.restore()
        }
        function ba() {
            var C = void 0, U = function() {}, ia = ["transform", "WebkitTransform", "MozTransform", "OTransform", "msTransform"], X = ["", "-webkit-", "-moz-", "-o-", "-ms-"], sa = document.createElement("flotelement"), wa;
            for (wa in ia)
                if (void 0 !== sa.style[ia[wa]]) {
                    C = X[wa];
                    break
                }
            if (void 0 != C)
                ma = !0,
                U = function(Ja, Pa) {
                    Ja.push(C + "transform:rotate(" + -Pa.options.labelAngle + "deg)");
                    Ja.push(C + "transform-origin:top left")
                }
                ;
            else if ("string" == typeof sa.style.filter || "object" == typeof sa.style.filters)
                U = function(Ja, Pa) {
                    var Oa = Pa.options.labelAngle * Math.PI / 180;
                    Pa = Math.cos(Oa);
                    Oa = Math.sin(Oa);
                    Ja.push("filter:progid:DXImageTransform.Microsoft.Matrix(M11=" + Pa + ", M12=" + Oa + ", M21=" + -Oa + ", M22=" + Pa + ",sizingMethod='auto expand'")
                }
                ;
            t.find(".tickLabels").remove();
            ia = ['<div class="tickLabels" style="font-size:smaller">'];
            X = K();
            for (sa = 0; sa < X.length; ++sa) {
                var xa = X[sa]
                  , Ia = xa.box;
                if (xa.show) {
                    var Fa = ra(xa);
                    ia.push('<div class="' + xa.direction + "Axis " + xa.direction + xa.n + 'Axis" style="color:' + xa.options.color + '">');
                    for (wa = 0; wa < xa.ticks.length; ++wa) {
                        var Ga = xa.ticks[wa];
                        if (!(!Ga.label || Ga.v < xa.min || Ga.v > xa.max)) {
                            var Da = {};
                            if ("x" == xa.direction)
                                if (0 != xa.options.labelAngle) {
                                    var Ma = Fa.align;
                                    Da.left = Math.round(ta.left + xa.p2c(Ga.v));
                                    Da.left += Fa.oLeft;
                                    Da.top = Fa.top
                                } else
                                    Ma = "center",
                                    Da.left = Math.round(ta.left + xa.p2c(Ga.v) - xa.labelWidth / 2),
                                    "bottom" == xa.position ? Da.top = Ia.top + Ia.padding : Da.bottom = oa.height - (Ia.top + Ia.height - Ia.padding);
                            else
                                0 != xa.options.labelAngle ? (Ma = Fa.align,
                                Da.top = Math.round(ta.top + xa.p2c(Ga.v)),
                                Da.top += Fa.oTop,
                                Da.left = Fa.left) : (Da.top = Math.round(ta.top + xa.p2c(Ga.v) - xa.labelHeight / 2),
                                "left" == xa.position ? (Da.right = oa.width - (Ia.left + Ia.width - Ia.padding),
                                Ma = "right") : (Da.left = Ia.left + Ia.padding,
                                Ma = "left"));
                            Da.width = 0 != xa.options.labelAngle ? xa.options.origWidth : xa.labelWidth;
                            Ma = ["position:absolute", "text-align:" + Ma];
                            for (var Qa in Da)
                                Ma.push(Qa + ":" + Da[Qa] + "px");
                            0 != xa.options.labelAngle && U(Ma, xa);
                            ia.push('<div class="tickLabel" style="' + Ma.join(";") + '">' + Ga.label + "</div>")
                        }
                    }
                    ia.push("</div>")
                }
            }
            ia.push("</div>");
            t.append(ia.join(""))
        }
        function q(C) {
            function U(xa, Ia, Fa, Ga, Da, Ma) {
                var Qa = xa.points;
                xa = xa.pointsize;
                var Ja = null
                  , Pa = null;
                W.beginPath();
                for (var Oa = xa; Oa < Qa.length; Oa += xa) {
                    var Ha = Qa[Oa - xa]
                      , ya = Qa[Oa - xa + 1]
                      , Na = Qa[Oa]
                      , La = Qa[Oa + 1];
                    if (null != Ha && null != Na) {
                        if (ya <= La && ya < Da.min) {
                            if (La < Da.min)
                                continue;
                            Ha = (Da.min - ya) / (La - ya) * (Na - Ha) + Ha;
                            ya = Da.min
                        } else if (La <= ya && La < Da.min) {
                            if (ya < Da.min)
                                continue;
                            Na = (Da.min - ya) / (La - ya) * (Na - Ha) + Ha;
                            La = Da.min
                        }
                        if (ya >= La && ya > Da.max) {
                            if (La > Da.max)
                                continue;
                            Ha = (Da.max - ya) / (La - ya) * (Na - Ha) + Ha;
                            ya = Da.max
                        } else if (La >= ya && La > Da.max) {
                            if (ya > Da.max)
                                continue;
                            Na = (Da.max - ya) / (La - ya) * (Na - Ha) + Ha;
                            La = Da.max
                        }
                        if (Ha <= Na && Ha < Ga.min) {
                            if (Na < Ga.min)
                                continue;
                            ya = (Ga.min - Ha) / (Na - Ha) * (La - ya) + ya;
                            Ha = Ga.min
                        } else if (Na <= Ha && Na < Ga.min) {
                            if (Ha < Ga.min)
                                continue;
                            La = (Ga.min - Ha) / (Na - Ha) * (La - ya) + ya;
                            Na = Ga.min
                        }
                        if (Ha >= Na && Ha > Ga.max) {
                            if (Na > Ga.max)
                                continue;
                            ya = (Ga.max - Ha) / (Na - Ha) * (La - ya) + ya;
                            Ha = Ga.max
                        } else if (Na >= Ha && Na > Ga.max) {
                            if (Ha > Ga.max)
                                continue;
                            La = (Ga.max - Ha) / (Na - Ha) * (La - ya) + ya;
                            Na = Ga.max
                        }
                        Ha == Ja && ya == Pa || W.moveTo(Ga.p2c(Ha) + Ia, Da.p2c(ya) + Fa);
                        Ja = Na;
                        Pa = La;
                        1 == Ma ? W.lineTo(Math.round(Ga.p2c(Na) + Ia) + .5, Math.round(Da.p2c(La) + Fa) + .5) : W.lineTo(Ga.p2c(Na) + Ia, Da.p2c(La) + Fa)
                    }
                }
                W.stroke()
            }
            function ia(xa, Ia, Fa) {
                var Ga = xa.points;
                xa = xa.pointsize;
                for (var Da = Math.min(Math.max(0, Fa.min), Fa.max), Ma = 0, Qa = !1, Ja = 1, Pa = 0, Oa = 0; !(0 < xa && Ma > Ga.length + xa); ) {
                    Ma += xa;
                    var Ha = Ga[Ma - xa]
                      , ya = Ga[Ma - xa + Ja]
                      , Na = Ga[Ma]
                      , La = Ga[Ma + Ja];
                    if (Qa) {
                        if (0 < xa && null != Ha && null == Na) {
                            Oa = Ma;
                            xa = -xa;
                            Ja = 2;
                            continue
                        }
                        if (0 > xa && Ma == Pa + xa) {
                            W.fill();
                            Qa = !1;
                            xa = -xa;
                            Ja = 1;
                            Ma = Pa = Oa + xa;
                            continue
                        }
                    }
                    if (null != Ha && null != Na) {
                        if (Ha <= Na && Ha < Ia.min) {
                            if (Na < Ia.min)
                                continue;
                            ya = (Ia.min - Ha) / (Na - Ha) * (La - ya) + ya;
                            Ha = Ia.min
                        } else if (Na <= Ha && Na < Ia.min) {
                            if (Ha < Ia.min)
                                continue;
                            La = (Ia.min - Ha) / (Na - Ha) * (La - ya) + ya;
                            Na = Ia.min
                        }
                        if (Ha >= Na && Ha > Ia.max) {
                            if (Na > Ia.max)
                                continue;
                            ya = (Ia.max - Ha) / (Na - Ha) * (La - ya) + ya;
                            Ha = Ia.max
                        } else if (Na >= Ha && Na > Ia.max) {
                            if (Ha > Ia.max)
                                continue;
                            La = (Ia.max - Ha) / (Na - Ha) * (La - ya) + ya;
                            Na = Ia.max
                        }
                        Qa || (W.beginPath(),
                        W.moveTo(Ia.p2c(Ha), Fa.p2c(Da)),
                        Qa = !0);
                        if (ya >= Fa.max && La >= Fa.max)
                            W.lineTo(Ia.p2c(Ha), Fa.p2c(Fa.max)),
                            W.lineTo(Ia.p2c(Na), Fa.p2c(Fa.max));
                        else if (ya <= Fa.min && La <= Fa.min)
                            W.lineTo(Ia.p2c(Ha), Fa.p2c(Fa.min)),
                            W.lineTo(Ia.p2c(Na), Fa.p2c(Fa.min));
                        else {
                            var Sa = Ha
                              , Ka = Na;
                            ya <= La && ya < Fa.min && La >= Fa.min ? (Ha = (Fa.min - ya) / (La - ya) * (Na - Ha) + Ha,
                            ya = Fa.min) : La <= ya && La < Fa.min && ya >= Fa.min && (Na = (Fa.min - ya) / (La - ya) * (Na - Ha) + Ha,
                            La = Fa.min);
                            ya >= La && ya > Fa.max && La <= Fa.max ? (Ha = (Fa.max - ya) / (La - ya) * (Na - Ha) + Ha,
                            ya = Fa.max) : La >= ya && La > Fa.max && ya <= Fa.max && (Na = (Fa.max - ya) / (La - ya) * (Na - Ha) + Ha,
                            La = Fa.max);
                            Ha != Sa && W.lineTo(Ia.p2c(Sa), Fa.p2c(ya));
                            W.lineTo(Ia.p2c(Ha), Fa.p2c(ya));
                            W.lineTo(Ia.p2c(Na), Fa.p2c(La));
                            Na != Ka && (W.lineTo(Ia.p2c(Na), Fa.p2c(La)),
                            W.lineTo(Ia.p2c(Ka), Fa.p2c(La)))
                        }
                    }
                }
            }
            W.save();
            W.translate(ta.left, ta.top);
            W.lineJoin = "round";
            var X = C.lines.lineWidth
              , sa = C.shadowSize;
            if (0 < X && 0 < sa) {
                W.lineWidth = sa;
                W.strokeStyle = "rgba(0,0,0,0.1)";
                var wa = Math.PI / 18;
                U(C.datapoints, Math.sin(wa) * (X / 2 + sa / 2), Math.cos(wa) * (X / 2 + sa / 2), C.xaxis, C.yaxis, X);
                W.lineWidth = sa / 2;
                U(C.datapoints, Math.sin(wa) * (X / 2 + sa / 4), Math.cos(wa) * (X / 2 + sa / 4), C.xaxis, C.yaxis, X)
            }
            W.lineWidth = X;
            W.strokeStyle = C.color;
            if (sa = O(C.lines, C.color, 0, va))
                W.fillStyle = sa,
                ia(C.datapoints, C.xaxis, C.yaxis);
            0 < X && U(C.datapoints, 0, 0, C.xaxis, C.yaxis, X);
            W.restore()
        }
        function L(C) {
            function U(xa, Ia, Fa, Ga, Da, Ma, Qa, Ja) {
                var Pa = xa.points;
                xa = xa.pointsize;
                for (var Oa = 18 == C.index, Ha = 0; Ha < Pa.length; Ha += xa) {
                    var ya = Pa[Ha]
                      , Na = Pa[Ha + 1];
                    if (!(null == ya || ya < Ma.min || ya > Ma.max || Na < Qa.min || Na > Qa.max)) {
                        if (Oa && ya > changeV5Epoch)
                            break;
                        W.beginPath();
                        ya = Ma.p2c(ya);
                        Na = Qa.p2c(Na) + Ga;
                        "circle" == Ja ? W.arc(ya, Na, Ia, 0, Da ? Math.PI : 2 * Math.PI, !1) : Ja(W, ya, Na, Ia, Da, Ha == Pa.length - 2 || Ha == Pa.length - 3);
                        W.closePath();
                        Fa && (W.fillStyle = Fa,
                        W.fill());
                        W.stroke()
                    }
                }
            }
            W.save();
            W.translate(ta.left, ta.top);
            var ia = C.points.lineWidth
              , X = C.shadowSize
              , sa = C.points.radius
              , wa = C.points.symbol;
            0 < ia && 0 < X && (X /= 2,
            W.lineWidth = X,
            W.strokeStyle = "rgba(0,0,0,0.1)",
            U(C.datapoints, sa, null, X + X / 2, !0, C.xaxis, C.yaxis, wa),
            W.strokeStyle = "rgba(0,0,0,0.2)",
            U(C.datapoints, sa, null, X / 2, !0, C.xaxis, C.yaxis, wa));
            W.lineWidth = ia;
            W.strokeStyle = C.color;
            U(C.datapoints, sa, O(C.points, C.color), 0, !1, C.xaxis, C.yaxis, wa);
            W.restore()
        }
        function A(C) {
            W.save();
            W.translate(ta.left, ta.top);
            W.lineWidth = C.bars.lineWidth;
            W.strokeStyle = C.color;
            var U = "left" == C.bars.align ? 0 : -C.bars.barWidth / 2;
            (function(ia, X, sa, wa, xa, Ia, Fa) {
                var Ga = ia.points;
                ia = ia.pointsize;
                for (var Da = 0; Da < Ga.length; Da += ia)
                    if (null != Ga[Da]) {
                        var Ma, Qa;
                        var Ja = Ga[Da];
                        var Pa = Ga[Da + 1];
                        var Oa = Ga[Da + 2];
                        var Ha = wa
                          , ya = xa
                          , Na = Ia
                          , La = Fa
                          , Sa = W
                          , Ka = C.bars.lineWidth;
                        if (C.bars.horizontal) {
                            var Ra = Qa = Ma = !0;
                            var Ua = !1;
                            var Va = Oa;
                            Oa = Pa + X;
                            var Wa = Pa + sa;
                            Ja < Va && (Pa = Ja,
                            Ja = Va,
                            Va = Pa,
                            Ua = !0,
                            Qa = !1)
                        } else
                            Ua = Qa = Ma = !0,
                            Ra = !1,
                            Va = Ja + X,
                            Ja += sa,
                            Wa = Oa,
                            Oa = Pa,
                            Oa < Wa && (Pa = Oa,
                            Oa = Wa,
                            Wa = Pa,
                            Ra = !0,
                            Ma = !1);
                        Ja < Na.min || Va > Na.max || Oa < La.min || Wa > La.max || (Va < Na.min && (Va = Na.min,
                        Ua = !1),
                        Ja > Na.max && (Ja = Na.max,
                        Qa = !1),
                        Wa < La.min && (Wa = La.min,
                        Ra = !1),
                        Oa > La.max && (Oa = La.max,
                        Ma = !1),
                        Va = Na.p2c(Va),
                        Wa = La.p2c(Wa),
                        Ja = Na.p2c(Ja),
                        Oa = La.p2c(Oa),
                        ya && (Sa.beginPath(),
                        Sa.moveTo(Va, Wa),
                        Sa.lineTo(Va, Oa),
                        Sa.lineTo(Ja, Oa),
                        Sa.lineTo(Ja, Wa),
                        Sa.fillStyle = ya(Wa, Oa),
                        Sa.fill()),
                        0 < Ka && (Ua || Qa || Ma || Ra) && (Sa.beginPath(),
                        Sa.moveTo(Va, Wa + Ha),
                        Ua ? Sa.lineTo(Va, Oa + Ha) : Sa.moveTo(Va, Oa + Ha),
                        Ma ? Sa.lineTo(Ja, Oa + Ha) : Sa.moveTo(Ja, Oa + Ha),
                        Qa ? Sa.lineTo(Ja, Wa + Ha) : Sa.moveTo(Ja, Wa + Ha),
                        Ra ? Sa.lineTo(Va, Wa + Ha) : Sa.moveTo(Va, Wa + Ha),
                        Sa.stroke()))
                    }
            }
            )(C.datapoints, U, U + C.bars.barWidth, 0, C.bars.fill ? function(ia, X) {
                return O(C.bars, C.color, ia, X)
            }
            : null, C.xaxis, C.yaxis);
            W.restore()
        }
        function O(C, U, ia, X) {
            var sa = C.fill;
            if (!sa)
                return null;
            if (C.fillColor)
                return fa(C.fillColor, ia, X, U);
            C = a.color.parse(U);
            C.a = "number" == typeof sa ? sa : .4;
            C.normalize();
            return C.toString()
        }
        function P() {
            t.find(".legend").remove();
            if (T.legend.show) {
                var C = [], U = !1, ia = T.legend.labelFormatter, X;
                if (!T.legend.noLegend) {
                    for (var sa = 0; sa < R.length; ++sa) {
                        var wa = R[sa];
                        if (X = wa.label)
                            0 == sa % T.legend.noColumns && (U && C.push("</tr>"),
                            C.push("<tr>"),
                            U = !0),
                            ia && (X = ia(X, wa)),
                            C.push('<td class="legendColorBox"><div><div class="legendColorBoxCircle" style="background:' + wa.color + "; border:" + (wa.lines.show ? 6 : 1) + "px solid " + (wa.lines.show ? wa.color : "#ccc") + ';"></div></div></td><td class="legendLabel" data-type="' + wa.index + '">' + X + '<span class="flotLegendHover" style="color:' + wa.color + '"></span></td>')
                    }
                    U && C.push("</tr>");
                    if (0 == C.length)
                        return
                }
                C = '<table class="legendTable" style="font-size:smaller;color:' + T.grid.color + '">' + C.join("") + "</table>";
                null != T.legend.container ? a(T.legend.container).html(C) : a('<div class="legend">' + C.replace('style="', 'style="position:absolute;') + "</div>").appendTo(t)
            }
        }
        function M(C, U) {
            T.grid.hoverable && G("plothover", U || C, function(ia) {
                return 0 != ia.hoverable
            })
        }
        function u(C) {
            T.grid.hoverable && G("plothover", C, function(U) {
                return !1
            })
        }
        function v(C) {
            G("plotclick", C, function(U) {
                return 0 != U.clickable
            })
        }
        function G(C, U, ia) {
            var X = ja.offset()
              , sa = U.pageX - X.left - ta.left
              , wa = U.pageY - X.top - ta.top
              , xa = E({
                left: sa,
                top: wa
            });
            xa.pageX = U.pageX;
            xa.pageY = U.pageY;
            if ("plotclick" == C) {
                var Ia = T.grid.mouseActiveRadius, Fa = Ia * Ia + 1, Ga, Da;
                U = [];
                for (Ga = R.length - 1; 0 <= Ga; --Ga) {
                    var Ma = null;
                    if (ia(R[Ga])) {
                        var Qa = R[Ga]
                          , Ja = Qa.xaxis
                          , Pa = Qa.yaxis
                          , Oa = Qa.datapoints.points
                          , Ha = Qa.datapoints.pointsize
                          , ya = Ja.c2p(sa)
                          , Na = Pa.c2p(wa)
                          , La = Ia / Ja.scale
                          , Sa = Ia / Pa.scale;
                        Ja.options.inverseTransform && (La = Number.MAX_VALUE);
                        Pa.options.inverseTransform && (Sa = Number.MAX_VALUE);
                        if (Qa.lines.show || Qa.points.show)
                            if (18 == Qa.index && ya > changeV5Epoch) {
                                var Ka = Oa.length - 2;
                                for (Da = 0; Da < Ka; Da += Ha)
                                    if (La = Oa[Da + 1],
                                    null != Oa[Da] && !((Da + Ha >= Ka ? 1E14 : Oa[Da + Ha]) < ya || La - Na > Sa || La - Na < -Sa)) {
                                        La = Oa[Da + 1];
                                        var Ra = Math.abs(Ja.p2c(ya) - sa);
                                        La = Math.abs(Pa.p2c(La) - wa);
                                        if (Ra * Ra + La * La < Fa) {
                                            Ma = [Ga, Da / Ha];
                                            break
                                        }
                                    }
                            } else
                                for (Da = 0; Da < Oa.length; Da += Ha)
                                    if (Ra = Oa[Da],
                                    Ka = Oa[Da + 1],
                                    null != Ra && !(Ra - ya > La || Ra - ya < -La || Ka - Na > Sa || Ka - Na < -Sa) && (Ra = Math.abs(Ja.p2c(Ra) - sa),
                                    Ka = Math.abs(Pa.p2c(Ka) - wa),
                                    Ra * Ra + Ka * Ka < Fa)) {
                                        Ma = [Ga, Da / Ha];
                                        break
                                    }
                        if (Qa.bars.show && !Ma)
                            for (Ja = "left" == Qa.bars.align ? 0 : -Qa.bars.barWidth / 2,
                            Qa = Ja + Qa.bars.barWidth,
                            Da = 0; Da < Oa.length; Da += Ha)
                                Ra = Oa[Da],
                                Ka = Oa[Da + 1],
                                Pa = Oa[Da + 2],
                                null != Ra && (R[Ga].bars.horizontal ? ya <= Math.max(Pa, Ra) && ya >= Math.min(Pa, Ra) && Na >= Ka + Ja && Na <= Ka + Qa : ya >= Ra + Ja && ya <= Ra + Qa && Na >= Math.min(Pa, Ka) && Na <= Math.max(Pa, Ka)) && (Ma = [Ga, Da / Ha]);
                        Ma && (Ga = Ma[0],
                        Da = Ma[1],
                        Ha = R[Ga].datapoints.pointsize,
                        U.push({
                            datapoint: R[Ga].datapoints.points.slice(Da * Ha, (Da + 1) * Ha),
                            dataIndex: Da,
                            series: R[Ga],
                            seriesIndex: Ga
                        }))
                    }
                }
                if (0 < U.length)
                    for (var Ua in U)
                        ia = U[Ua],
                        ia.pageX = parseInt(ia.series.xaxis.p2c(ia.datapoint[0]) + X.left + ta.left),
                        ia.pageY = parseInt(ia.series.yaxis.p2c(ia.datapoint[1]) + X.top + ta.top);
                t.trigger(C, [xa, U])
            } else {
                Ua = T.grid.mouseActiveRadius;
                U = Ua * Ua + 1;
                Ia = null;
                for (Fa = R.length - 1; 0 <= Fa; --Fa)
                    if (ia(R[Fa])) {
                        ya = R[Fa];
                        Qa = ya.xaxis;
                        Ja = ya.yaxis;
                        Da = ya.datapoints.points;
                        Ma = ya.datapoints.pointsize;
                        Oa = Qa.c2p(sa);
                        Ha = Ja.c2p(wa);
                        Pa = Ua / Qa.scale;
                        Sa = Ua / Ja.scale;
                        Qa.options.inverseTransform && (Pa = Number.MAX_VALUE);
                        Ja.options.inverseTransform && (Sa = Number.MAX_VALUE);
                        if (ya.lines.show || ya.points.show)
                            for (Ga = 0; Ga < Da.length; Ga += Ma)
                                Ka = Da[Ga],
                                Na = Da[Ga + 1],
                                null == Ka || Ka - Oa > Pa || Ka - Oa < -Pa || Na - Ha > Sa || Na - Ha < -Sa || (Ka = Math.abs(Qa.p2c(Ka) - sa),
                                Na = Math.abs(Ja.p2c(Na) - wa),
                                Na = Ka * Ka + Na * Na,
                                Na < U && (U = Na,
                                Ia = [Fa, Ga / Ma]));
                        if (ya.bars.show && !Ia)
                            for (Qa = "left" == ya.bars.align ? 0 : -ya.bars.barWidth / 2,
                            ya = Qa + ya.bars.barWidth,
                            Ga = 0; Ga < Da.length; Ga += Ma)
                                Ka = Da[Ga],
                                Na = Da[Ga + 1],
                                Ja = Da[Ga + 2],
                                null != Ka && (R[Fa].bars.horizontal ? Oa <= Math.max(Ja, Ka) && Oa >= Math.min(Ja, Ka) && Ha >= Na + Qa && Ha <= Na + ya : Oa >= Ka + Qa && Oa <= Ka + ya && Ha >= Math.min(Ja, Na) && Ha <= Math.max(Ja, Na)) && (Ia = [Fa, Ga / Ma])
                    }
                Ia ? (Fa = Ia[0],
                Ga = Ia[1],
                Ma = R[Fa].datapoints.pointsize,
                ia = {
                    datapoint: R[Fa].datapoints.points.slice(Ga * Ma, (Ga + 1) * Ma),
                    dataIndex: Ga,
                    series: R[Fa],
                    seriesIndex: Fa
                }) : ia = null;
                ia && (ia.pageX = parseInt(ia.series.xaxis.p2c(ia.datapoint[0]) + X.left + ta.left),
                ia.pageY = parseInt(ia.series.yaxis.p2c(ia.datapoint[1]) + X.top + ta.top));
                t.trigger(C, [xa, ia])
            }
        }
        function w() {
            var C = T.interaction.redrawOverlayInterval;
            -1 == C ? B() : ha || (ha = setTimeout(B, C))
        }
        function B() {
            ha = null;
            Aa.save();
            Z.clear();
            Aa.translate(ta.left, ta.top);
            var C;
            for (C = 0; C < ca.length; ++C) {
                var U = ca[C];
                if (U.series.points.show) {
                    var ia = U.series
                      , X = U.point
                      , sa = X[0]
                      , wa = X[1]
                      , xa = ia.xaxis
                      , Ia = ia.yaxis;
                    if (!(sa < xa.min || sa > xa.max || wa < Ia.min || wa > Ia.max)) {
                        var Fa = ia.points.radius + ia.points.lineWidth / 2;
                        Aa.lineWidth = Fa;
                        Aa.strokeStyle = a.color.parse(ia.color).scale("a", .5).toString();
                        Fa *= 1.5;
                        sa = xa.p2c(sa);
                        wa = Ia.p2c(wa);
                        18 == ia.index && X[0] > changeV5Epoch || (Aa.beginPath(),
                        "circle" == ia.points.symbol ? Aa.arc(sa, wa, Fa, 0, 2 * Math.PI, !1) : ia.points.symbol(Aa, sa, wa, Fa, !1),
                        Aa.closePath(),
                        Aa.stroke())
                    }
                }
                if (U.point[0] != U.point[2]) {
                    sa = U.series;
                    X = U.point;
                    var Ga = X[0];
                    U = sa.color;
                    ia = sa.xaxis;
                    Fa = sa.yaxis;
                    var Da = Aa;
                    xa = wa = sa = !0;
                    Ia = Ga + 0;
                    var Ma = Ga + (X[2] - X[0]);
                    Ga = 0;
                    X = X[1];
                    !(Ma < ia.min || Ia > ia.max || X < Fa.min || Ga > Fa.max) && (Ia < ia.min && (Ia = ia.min),
                    Ma > ia.max && (Ma = ia.max),
                    Ga < Fa.min && (Ga = Fa.min),
                    X > Fa.max && (X = Fa.max,
                    sa = !1),
                    Ia = ia.p2c(Ia),
                    Fa.p2c(Ga),
                    Ma = ia.p2c(Ma),
                    X = Fa.p2c(X),
                    Da.lineWidth = 2.5,
                    Da.strokeStyle = U,
                    xa || wa || sa) && (Da.beginPath(),
                    Da.moveTo(Math.round(Ia) + .5, Math.round(X + 0) + .5),
                    sa && Da.lineTo(Math.round(Ma) + .5, Math.round(X + 0) + .5),
                    Da.stroke())
                }
            }
            Aa.restore();
            p(da.drawOverlay, [Aa])
        }
        function Q(C, U) {
            for (var ia = 0; ia < ca.length; ++ia) {
                var X = ca[ia];
                if (X.series == C && X.point[0] == U[0] && X.point[1] == U[1])
                    return ia
            }
            return -1
        }
        function fa(C, U, ia, X) {
            if ("string" == typeof C)
                return C;
            U = W.createLinearGradient(0, ia, 0, U);
            ia = 0;
            for (var sa = C.colors.length; ia < sa; ++ia) {
                var wa = C.colors[ia];
                if ("string" != typeof wa) {
                    var xa = a.color.parse(X);
                    null != wa.brightness && (xa = xa.scale("rgb", wa.brightness));
                    null != wa.opacity && (xa.a *= wa.opacity);
                    wa = xa.toString()
                }
                U.addColorStop(ia / (sa - 1), wa)
            }
            return U
        }
        var R = []
          , T = {
            colors: ["#edc240", "#afd8f8", "#cb4b4b", "#4da74d", "#9440ed"],
            legend: {
                show: !0,
                noColumns: 1,
                labelFormatter: null,
                labelBoxBorderColor: "#ccc",
                container: null,
                position: "ne",
                margin: 5,
                backgroundColor: null,
                backgroundOpacity: .85,
                sorted: null
            },
            xaxis: {
                show: null,
                position: "bottom",
                mode: null,
                font: null,
                color: null,
                tickColor: null,
                transform: null,
                inverseTransform: null,
                min: null,
                max: null,
                autoscaleMargin: null,
                ticks: null,
                tickFormatter: null,
                labelWidth: null,
                labelHeight: null,
                labelAngle: 0,
                reserveSpace: null,
                tickLength: null,
                alignTicksWithAxis: null,
                tickDecimals: null,
                tickSize: null,
                minTickSize: null,
                monthNames: null,
                timeformat: null,
                twelveHourClock: !1
            },
            yaxis: {
                autoscaleMargin: .02,
                labelAngle: 0,
                position: "left"
            },
            xaxes: [],
            yaxes: [],
            series: {
                points: {
                    show: !1,
                    radius: 3,
                    lineWidth: 2,
                    fill: !0,
                    fillColor: "#ffffff",
                    symbol: "circle"
                },
                lines: {
                    lineWidth: 2,
                    fill: !1,
                    fillColor: null,
                    steps: !1
                },
                bars: {
                    show: !1,
                    lineWidth: 2,
                    barWidth: 1,
                    fill: !0,
                    fillColor: null,
                    align: "left",
                    horizontal: !1,
                    zero: !0
                },
                shadowSize: 0,
                highlightColor: null
            },
            grid: {
                show: !0,
                aboveData: !1,
                color: "#545454",
                backgroundColor: null,
                borderColor: null,
                tickColor: null,
                margin: 0,
                labelMargin: 5,
                axisMargin: 8,
                borderWidth: 2,
                minBorderMargin: null,
                markings: null,
                markingsColor: "#f4f4f4",
                markingsLineWidth: 2,
                clickable: !1,
                hoverable: !1,
                autoHighlight: !1,
                mouseActiveRadius: 10
            },
            interaction: {
                redrawOverlayInterval: 1E3 / 60
            },
            hooks: {}
        }
          , oa = null
          , Z = null
          , ja = null
          , W = null
          , Aa = null
          , Ca = []
          , Ba = []
          , ta = {
            left: 0,
            right: 0,
            top: 0,
            bottom: 0
        }
          , Ea = 0
          , va = 0
          , da = {
            processOptions: [],
            processRawData: [],
            processDatapoints: [],
            processOffset: [],
            drawBackground: [],
            drawSeries: [],
            draw: [],
            bindEvents: [],
            drawOverlay: [],
            shutdown: []
        }
          , Y = this;
        Y.setData = z;
        Y.setupGrid = na;
        Y.draw = g;
        Y.setupTickGeneration = ka;
        Y.setTicks = za;
        Y.setRange = qa;
        Y.snapRangeToTicks = J;
        Y.syncedMouseMove = null;
        Y.getPlaceholder = function() {
            return t
        }
        ;
        Y.getEventHolder = function() {
            return ja
        }
        ;
        Y.getCanvas = function() {
            return canvas
        }
        ;
        Y.getPlotOffset = function() {
            return ta
        }
        ;
        Y.width = function() {
            return Ea
        }
        ;
        Y.height = function() {
            return va
        }
        ;
        Y.offset = function() {
            var C = ja.offset();
            C.left += ta.left;
            C.top += ta.top;
            return C
        }
        ;
        Y.getData = function() {
            return R
        }
        ;
        Y.getAxes = function() {
            var C = {};
            a.each(Ca.concat(Ba), function(U, ia) {
                ia && (C[ia.direction + (1 != ia.n ? ia.n : "") + "axis"] = ia)
            });
            return C
        }
        ;
        Y.getXAxes = function() {
            return Ca
        }
        ;
        Y.getYAxes = function() {
            return Ba
        }
        ;
        Y.c2p = E;
        Y.p2c = function(C) {
            var U = {}, ia, X;
            for (ia = 0; ia < Ca.length; ++ia)
                if ((X = Ca[ia]) && X.used) {
                    var sa = "x" + X.n;
                    null == C[sa] && 1 == X.n && (sa = "x");
                    if (null != C[sa]) {
                        U.left = X.p2c(C[sa]);
                        break
                    }
                }
            for (ia = 0; ia < Ba.length; ++ia)
                if ((X = Ba[ia]) && X.used && (sa = "y" + X.n,
                null == C[sa] && 1 == X.n && (sa = "y"),
                null != C[sa])) {
                    U.top = X.p2c(C[sa]);
                    break
                }
            return U
        }
        ;
        Y.getOptions = function() {
            return T
        }
        ;
        Y.highlight = function(C, U, ia) {
            "number" == typeof C && (C = R[C]);
            if ("number" == typeof U) {
                var X = C.datapoints.pointsize;
                U = C.datapoints.points.slice(X * U, X * (U + 2))
            }
            X = Q(C, U);
            -1 == X ? (ca.push({
                series: C,
                point: U,
                auto: ia
            }),
            w()) : ia || (ca[X].auto = !1)
        }
        ;
        Y.getHighlights = function() {
            return ca
        }
        ;
        Y.setHighlights = function(C) {
            ca = C
        }
        ;
        Y.unhighlight = function(C, U) {
            null == C && null == U && (ca = [],
            w());
            "number" == typeof C && (C = R[C]);
            "number" == typeof U && (U = C.data[U]);
            C = Q(C, U);
            -1 != C && (ca.splice(C, 1),
            w())
        }
        ;
        Y.triggerRedrawOverlay = w;
        Y.drawOverlay = B;
        Y.pointOffset = function(C) {
            return {
                left: parseInt(Ca[F(C, "x") - 1].p2c(+C.x) + ta.left),
                top: parseInt(Ba[F(C, "y") - 1].p2c(+C.y) + ta.top)
            }
        }
        ;
        Y.shutdown = S;
        Y.destroy = function() {
            S();
            t.removeData("plot").empty();
            R = [];
            Aa = W = ja = Z = oa = T = null;
            Ca = [];
            Ba = [];
            da = null;
            ca = [];
            Y = null
        }
        ;
        Y.resize = function() {
            var C = float2int(t.width())
              , U = float2int(t.height());
            oa.resize(C, U);
            Z.resize(C, U)
        }
        ;
        Y.hooks = da;
        (function() {
            for (var C = {
                Canvas: b
            }, U = 0; U < r.length; ++U) {
                var ia = r[U];
                ia.init(Y, C);
                ia.options && a.extend(!0, T, ia.options)
            }
        }
        )(Y);
        (function(C) {
            a.extend(!0, T, C);
            C && C.colors && (T.colors = C.colors);
            null == T.xaxis.color && (T.xaxis.color = T.grid.color);
            null == T.yaxis.color && (T.yaxis.color = T.grid.color);
            null == T.xaxis.tickColor && (T.xaxis.tickColor = T.grid.tickColor || T.xaxis.color);
            null == T.yaxis.tickColor && (T.yaxis.tickColor = T.grid.tickColor || T.yaxis.color);
            null == T.grid.borderColor && (T.grid.borderColor = T.grid.color);
            null == T.grid.tickColor && (T.grid.tickColor = a.color.parse(T.grid.color).scale("a", .22).toString());
            var U;
            C = (C = t.css("fontSize")) ? +C.replace("px", "") : 13;
            var ia = {
                style: t.css("fontStyle"),
                size: Math.round(.8 * C),
                variant: t.css("fontVariant"),
                weight: t.css("fontWeight"),
                family: t.css("fontFamily")
            };
            var X = T.xaxes.length || 1;
            for (C = 0; C < X; ++C)
                (U = T.xaxes[C]) && !U.tickColor && (U.tickColor = U.color),
                U = a.extend(!0, {}, T.xaxis, U),
                T.xaxes[C] = U,
                U.font && (U.font = a.extend({}, ia, U.font),
                U.font.color || (U.font.color = U.color),
                U.font.lineHeight || (U.font.lineHeight = Math.round(1.15 * U.font.size)));
            X = T.yaxes.length || 1;
            for (C = 0; C < X; ++C)
                (U = T.yaxes[C]) && !U.tickColor && (U.tickColor = U.color),
                U = a.extend(!0, {}, T.yaxis, U),
                T.yaxes[C] = U,
                U.font && (U.font = a.extend({}, ia, U.font),
                U.font.color || (U.font.color = U.color),
                U.font.lineHeight || (U.font.lineHeight = Math.round(1.15 * U.font.size)));
            T.xaxis.noTicks && null == T.xaxis.ticks && (T.xaxis.ticks = T.xaxis.noTicks);
            T.yaxis.noTicks && null == T.yaxis.ticks && (T.yaxis.ticks = T.yaxis.noTicks);
            T.grid.coloredAreas && (T.grid.markings = T.grid.coloredAreas);
            T.grid.coloredAreasColor && (T.grid.markingsColor = T.grid.coloredAreasColor);
            T.lines && a.extend(!0, T.series.lines, T.lines);
            T.points && a.extend(!0, T.series.points, T.points);
            T.bars && a.extend(!0, T.series.bars, T.bars);
            null != T.shadowSize && (T.series.shadowSize = T.shadowSize);
            null != T.highlightColor && (T.series.highlightColor = T.highlightColor);
            for (C = 0; C < T.xaxes.length; ++C)
                H(Ca, C + 1).options = T.xaxes[C];
            for (C = 0; C < T.yaxes.length; ++C)
                H(Ba, C + 1).options = T.yaxes[C];
            for (var sa in da)
                T.hooks[sa] && T.hooks[sa].length && (da[sa] = da[sa].concat(T.hooks[sa]));
            p(da.processOptions, [T])
        }
        )(n);
        (function() {
            t.css("padding", 0).children().filter(function() {
                return !a(this).hasClass("flot-overlay") && !a(this).hasClass("flot-base")
            }).remove();
            "static" == t.css("position") && t.css("position", "relative");
            oa = new b("flot-base",t);
            Z = new b("flot-overlay",t);
            W = oa.context;
            Aa = Z.context;
            ja = a(Z.element).off();
            var C = t.data("plot");
            C && (C.shutdown(),
            Z.clear());
            t.data("plot", Y)
        }
        )();
        z(f);
        na(!1);
        g();
        (function() {
            T.grid.hoverable && (ja.mousemove(M),
            ja.mouseleave(u),
            ja.on("touchmove", function(C) {
                C.pageX = C.originalEvent.touches[0].pageX;
                C.pageY = C.originalEvent.touches[0].pageY;
                M(C)
            }));
            T.grid.clickable && ja.click(v);
            p(da.bindEvents, [ja])
        }
        )();
        var ma, ca = [], ha = null
    }
    function h(t, f) {
        return f * Math.floor(t / f)
    }
    var m = Object.prototype.hasOwnProperty;
    a.fn.detach || (a.fn.detach = function() {
        return this.each(function() {
            this.parentNode && this.parentNode.removeChild(this)
        })
    }
    );
    b.prototype.resize = function(t, f) {
        if (0 >= t || 0 >= f) {
            0 == t && (t = 400);
            if (0 >= f)
                throw Error("Invalid dimensions for plot, width = " + t + ", height = " + f);
            console.error("Invalid dimensions for plot, width = " + t + ", height = " + f)
        }
        var n = this.element
          , r = this.context
          , p = this.pixelRatio;
        this.width != t && (n.width = t * p,
        n.style.width = t + "px",
        this.width = t);
        this.height != f && (n.height = f * p,
        n.style.height = f + "px",
        this.height = f);
        r.restore();
        r.save();
        r.scale(p, p)
    }
    ;
    b.prototype.clear = function() {
        this.context.clearRect(0, 0, this.width, this.height)
    }
    ;
    b.prototype.render = function() {
        var t = this._textCache, f;
        for (f in t)
            if (m.call(t, f)) {
                var n = this.getTextLayer(f)
                  , r = t[f];
                n.hide();
                for (var p in r)
                    if (m.call(r, p)) {
                        var z = r[p], F;
                        for (F in z)
                            if (m.call(z, F)) {
                                for (var I = z[F].positions, E = 0, K; K = I[E]; E++)
                                    K.active ? K.rendered || (n.append(K.element),
                                    K.rendered = !0) : (I.splice(E--, 1),
                                    K.rendered && K.element.detach());
                                0 == I.length && delete z[F]
                            }
                    }
                n.show()
            }
    }
    ;
    b.prototype.getTextLayer = function(t) {
        var f = this.text[t];
        null == f && (null == this.textContainer && (this.textContainer = a("<div class='flot-text'></div>").css({
            position: "absolute",
            top: 0,
            left: 0,
            bottom: 0,
            right: 0,
            fontSize: "smaller",
            color: "#545454"
        }).insertAfter(this.element)),
        f = this.text[t] = a("<div></div>").addClass(t).css({
            position: "absolute",
            top: 0,
            left: 0,
            bottom: 0,
            right: 0
        }).appendTo(this.textContainer));
        return f
    }
    ;
    b.prototype.getTextInfo = function(t, f, n, r, p) {
        f = "" + f;
        r = "object" === typeof n ? n.style + " " + n.variant + " " + n.weight + " " + n.size + "px/" + n.lineHeight + "px " + n.family : n;
        var z = this._textCache[t];
        null == z && (z = this._textCache[t] = {});
        var F = z[r];
        null == F && (F = z[r] = {});
        z = F[f];
        null == z && (t = a("<div></div>").html(f).css({
            position: "absolute",
            maxWidth: p,
            top: -9999
        }).appendTo(this.getTextLayer(t)),
        "object" === typeof n ? t.css({
            font: r,
            color: n.color
        }) : "string" === typeof n && t.addClass(n),
        z = F[f] = {
            width: t.outerWidth(!0),
            height: t.outerHeight(!0),
            element: t,
            positions: []
        },
        t.detach());
        return z
    }
    ;
    b.prototype.addText = function(t, f, n, r, p, z, F, I, E) {
        t = this.getTextInfo(t, r, p, z, F);
        r = t.positions;
        "center" == I ? f -= t.width / 2 : "right" == I && (f -= t.width);
        "middle" == E ? n -= t.height / 2 : "bottom" == E && (n -= t.height);
        for (E = 0; p = r[E]; E++)
            if (p.x == f && p.y == n) {
                p.active = !0;
                return
            }
        p = {
            active: !0,
            rendered: !1,
            element: r.length ? t.element.clone() : t.element,
            x: f,
            y: n
        };
        r.push(p);
        p.element.css({
            top: Math.round(n),
            left: Math.round(f),
            "text-align": I
        })
    }
    ;
    b.prototype.removeText = function(t, f, n, r, p, z) {
        if (null == r) {
            if (f = this._textCache[t],
            null != f)
                for (var F in f)
                    if (m.call(f, F)) {
                        n = f[F];
                        for (var I in n)
                            if (m.call(n, I))
                                for (t = n[I].positions,
                                r = 0; p = t[r]; r++)
                                    p.active = !1
                    }
        } else
            for (t = this.getTextInfo(t, r, p, z).positions,
            r = 0; p = t[r]; r++)
                p.x == f && p.y == n && (p.active = !1)
    }
    ;
    a.plot = function(t, f, n) {
        return new d(a(t),f,n,a.plot.plugins)
    }
    ;
    a.plot.version = "0.7";
    a.plot.plugins = [];
    a.plot.formatDate = function(t, f, n) {
        var r = function(S) {
            S = "" + S;
            return 1 == S.length ? "0" + S : S
        }
          , p = []
          , z = !1
          , F = !1
          , I = t.getUTCHours()
          , E = 12 > I;
        null == n && (n = la._79);
        -1 != f.search(/%p|%P/) && (12 < I ? I -= 12 : 0 == I && (I = 12));
        for (var K = 0; K < f.length; ++K) {
            var H = f.charAt(K)
              , V = 5 == storage.language ? "\u65e5" : "";
            if (z) {
                switch (H) {
                case "h":
                    H = "" + I;
                    break;
                case "H":
                    H = r(I);
                    break;
                case "M":
                    H = r(t.getUTCMinutes());
                    break;
                case "S":
                    H = r(t.getUTCSeconds());
                    break;
                case "d":
                    H = "" + t.getUTCDate() + V;
                    break;
                case "m":
                    H = "" + (t.getUTCMonth() + 1);
                    break;
                case "y":
                    H = "" + t.getUTCFullYear();
                    break;
                case "b":
                    H = "" + n[t.getUTCMonth()];
                    break;
                case "p":
                    H = E ? "am" : "pm";
                    break;
                case "P":
                    H = E ? "AM" : "PM";
                    break;
                case "0":
                    H = "",
                    F = !0
                }
                H && F && (H = r(H),
                F = !1);
                p.push(H);
                F || (z = !1)
            } else
                "%" == H ? z = !0 : p.push(H)
        }
        return p.join("")
    }
}
)(jQuery);
/*
 Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 Thanks to: Seamus Leahy for adding deltaX and deltaY

 Version: 3.0.6

 Requires: 1.2.2+
*/
(function(a) {
    a.plot.plugins.push({
        init: function(b) {
            var d, h;
            function m(E, K) {
                if ("undefined" != typeof b.getOptions().$isSyncedWith && 1 < b.getOptions().$isSyncedWith.length)
                    for (var H = 0; H < b.getOptions().$isSyncedWith.length; H++) {
                        var V = b.getOptions().$isSyncedWith[H].$container;
                        z = !!K || V && V.is(":visible")
                    }
                K && (E = K);
                H = b.offset();
                V = a(b.getPlaceholder()).offset();
                K = H.left - V.left;
                V = H.top - V.top;
                var S = E.pageX - H.left;
                E = E.pageY - H.top;
                r = K;
                p = S > float2int(b.width()) || 0 > S || !z && (E > float2int(b.height()) || 0 > E);
                d = K + Math.max(0, Math.min(S, float2int(b.width())));
                f = V + Math.max(0, Math.min(E, float2int(b.height())));
                h = d + n.x
            }
            function t(E) {
                I || (I = !0,
                setTimeout(function() {
                    var K = b.getPlaceholder();
                    if ("undefined" != typeof b.getOptions().$isSyncedWith)
                        for (var H = 0; H < b.getOptions().$isSyncedWith.length; H++) {
                            var V = b.getOptions().$isSyncedWith[H].$container;
                            V.find(".flotToolTipsPlaceholder").hide();
                            V.find("#flotTipDate").hide();
                            K.find(".flotLegendHover").hide()
                        }
                    K.find(".flotToolTipsPlaceholder").hide();
                    K.find(".flotLegendHover").hide();
                    K.find("#flotTipDate").hide();
                    b.unhighlight();
                    I = !1;
                    K.css("cursor", "")
                }, 0))
            }
            if ("undefined" == typeof isSnapshotPage) {
                var f = d = h = 0;
                var n = {
                    x: 14,
                    y: 25
                };
                var r = 0;
                var p = !1
                  , z = !1;
                var F = graphDateFormatIFrame ? graphDateFormatIFrame : "D, M j Y, G:i ";
                b.hooks.bindEvents.push(function(E, K) {
                    K.mouseout(t);
                    K.mousemove(m);
                    K.on("touchmove", function(H) {
                        H.pageX = H.originalEvent.touches[0].pageX;
                        H.pageY = H.originalEvent.touches[0].pageY;
                        1 == H.touches.length && m(H)
                    });
                    K.on("touchstart", function(H) {
                        1 < H.touches.length && t(H)
                    });
                    K.on("touchstart", function(H) {
                        1 < H.touches.length && t(H)
                    })
                });
                var I = !1;
                b.hooks.bindEvents.push(function(E, K) {
                    var H = E.getOptions()
                      , V = H.timeShiftOffset
                      , S = E.getPlaceholder()
                      , aa = a("<div></div>").attr("class", "flotToolTipsPlaceholder").appendTo(S)
                      , ea = S.find(".flotLegendHover").hide();
                    aa = S.find(".flotToolTipsPlaceholder");
                    for (var ra = a("<div></div>").attr("id", "flotTipVerticalLine"), pa = a("<div />").attr("id", "flotTipDate"), ua = a("<div />").attr("id", "flotTipHorizontalLine"), na = [], qa = [], ka = E.getData(), za = 5 == H.graphIndex, J = H.showOnlyTracked, g = 0; g < ka.length; g++) {
                        var D = a("<div />").attr("class", "flotTip").attr("id", "flotTip" + ka[g].index).attr("style", "border: 1px solid " + a.color.parse(ka[g].color).scale("a", .7).toString() + ";background: " + ka[g].backgroundColor + ";");
                        na.push(D);
                        qa.push(a("<div />").attr("class", "flotTipAngularLine" + (za ? 3 : ka[g].index % 4)).attr("id", "flotTipAngularLine" + ka[g].index))
                    }
                    for (g = ka.length - 1; 0 <= g; g--)
                        na[g].appendTo(aa)[0] && (na[g].appendTo(aa)[0].style.display = "none");
                    if ("undefined" != typeof pa.appendTo(aa)[0]) {
                        pa.appendTo(aa)[0].style.display = "none";
                        ra.appendTo(aa)[0].style.display = "none";
                        ua.appendTo(aa)[0].style.display = "none";
                        for (g = ka.length - 1; 0 <= g; g--)
                            ra.append(qa[g].hide());
                        var N = !1;
                        a(S).on("mouseout", function(q, L) {
                            p = !0;
                            E.getPlaceholder().find(".flotToolTipsPlaceholder").hide()
                        });
                        var ba = H.domain;
                        a(S).on("plothover", function(q, L) {
                            p ? E.getPlaceholder().find(".flotToolTipsPlaceholder").hide() : N || (N = !0,
                            setTimeout(function() {
                                if (p)
                                    E.getPlaceholder().find(".flotToolTipsPlaceholder").hide(),
                                    N = !1;
                                else {
                                    var A = [], O = [], P = [], M = !1, u, v, G = E.getData();
                                    if ("undefined" !== typeof L.x) {
                                        var w = 0
                                          , B = 0;
                                        for (u = 0; u < G.length; u++) {
                                            var Q = G[u];
                                            if (Q.lines.show || Q.dashes.show)
                                                if (null == Q.data.length)
                                                    w++;
                                                else {
                                                    for (v = 0; v < Q.data.length && !(null != Q.data[v] && Q.data[v][0] > L.x); v++)
                                                        ;
                                                    if (null == Q.data[v - 1]) {
                                                        var fa = Q.data[v - 2]
                                                          , R = Q.data[v];
                                                        null == fa && v == Q.data.length && (v--,
                                                        fa = Q.data[v - 2]);
                                                        fa = null == fa ? 0 : fa[0];
                                                        R = null == R ? 9999999999999 : R[0];
                                                        var T = Math.abs(L.x - fa);
                                                        fa = Math.abs(L.x - fa);
                                                        R = Math.abs(L.x - R);
                                                        fa >= R ? T = R : (T = fa,
                                                        v -= 2);
                                                        if (T / (Q.xaxis.max - Q.xaxis.min) > (5 == H.graphIndex ? .025 : .003))
                                                            continue
                                                    }
                                                    var oa = void 0;
                                                    fa = void 0;
                                                    R = Q.data[v - 1];
                                                    v = Q.data[v];
                                                    null == R ? (fa = v[1],
                                                    oa = v[0],
                                                    Q.points.show && (R = v)) : (fa = R[1],
                                                    oa = R[0]);
                                                    if (null != fa && "u" != fa) {
                                                        var Z = NumberUtil.format(fa);
                                                        if (Q.formatter)
                                                            A[u] = Q.formatter(fa);
                                                        else if (Q.index == CsvType.RATING.index || Q.index - 100 == CsvType.RATING.index)
                                                            A[u] = "<span>" + Q.labelText + "</span><br>" + fa,
                                                            Z = fa;
                                                        else if (Q.isCurrency) {
                                                            var ja = "";
                                                            T = "" + Money.format(fa, {
                                                                sourceDomainId: ba,
                                                                targetDomainId: ba,
                                                                isDivided: !0
                                                            });
                                                            if (Q.index == CsvType.BUY_BOX_SHIPPING.index && (oa = keepaTime.epochToMinutes(oa) - keepaTime.timeShiftOffset,
                                                            Z = getBBEntryAtTimeWithExactTime(Q.bbHistory, oa, CsvType.AMAZON),
                                                            -1 != Z)) {
                                                                ja = "Amazon";
                                                                if (!isSellerIdAmazon(Z.sellerId, ba) && (ja = "3rd Party",
                                                                null != Q.offers))
                                                                    for (var W = $jscomp.makeIterator(Q.offers), Aa = W.next(); !Aa.done; Aa = W.next())
                                                                        if (Aa = Aa.value,
                                                                        Aa.sellerId === Z.sellerId) {
                                                                            var Ca = getValueAtTimeWithShipping(Aa.offerCSV, oa);
                                                                            if ("" + Money.format(Ca[0] + Ca[1], {
                                                                                sourceDomainId: ba,
                                                                                targetDomainId: ba,
                                                                                isDivided: !1
                                                                            }) === T) {
                                                                                ja = '3rd Party <span style="color: ' + (Aa.isFBA ? CsvType.NEW_FBA.color : CsvType.NEW_FBM_SHIPPING.color) + '">' + (Aa.isFBA ? "FBA" : "FBM") + "</span>";
                                                                                break
                                                                            }
                                                                        }
                                                                ja = '<br><span>by <span style="font-weight: bold">' + ja + "</span></span>"
                                                            }
                                                            Z = T;
                                                            showReferencePrice(ba) && (T += '&ensp;<span style="color:#444;">' + Money.format(fa, {
                                                                sourceDomainId: ba,
                                                                isDivided: !0
                                                            }) + "</span>");
                                                            A[u] = "<span>" + Q.labelText + "</span><br>" + T + ja
                                                        } else
                                                            null != Q.labelReferenceHistory ? (T = keepaTime.epochToMinutes(oa) - keepaTime.timeShiftOffset,
                                                            A[u] = "<span>" + Q.getLabelText(T) + "</span><br>" + Z) : A[u] = "<span>" + Q.labelText + "</span><br>" + Z;
                                                        O[u] = fa;
                                                        oa = Q.yaxis.max;
                                                        T = Q.yaxis.min;
                                                        Q.index != CsvType.SALES.index && 2 != Q.yaxis.n || "1" != storage.salesRankInverse || (oa = Q.yaxis.min,
                                                        T = Q.yaxis.max);
                                                        T = oa - T;
                                                        fa = 1 - (oa - fa) / T;
                                                        T = 1 - (oa - L.y) / T;
                                                        oa = fa * float2int(E.height());
                                                        B = Math.max(oa, B);
                                                        (oa = CsvType.getObject(Q.index)) && Q.points.show && oa.isOfferData && .02 > Math.abs(fa - T) && (M = !0)
                                                    }
                                                    if (!(99 < Q.index && 200 > Q.index))
                                                        try {
                                                            P.push({
                                                                auto: void 0,
                                                                point: [R[0], Number(R[1]), v[0], Number(v[1])],
                                                                series: Q,
                                                                seriesIndex: u
                                                            })
                                                        } catch (ia) {}
                                                }
                                            else
                                                na[u].hide(),
                                                qa[u].hide()
                                        }
                                        a(E.getPlaceholder()).css("cursor", M ? "pointer" : "");
                                        aa.show();
                                        ea.show();
                                        try {
                                            var Ba = E.getHighlights();
                                            M = [];
                                            u = !1;
                                            for (w = 0; w < Ba.length; w++) {
                                                for (var ta = Ba[w], Ea = !1, va = 0; va < P.length; va++) {
                                                    var da = P[va];
                                                    if (ta.seriesIndex == da.seriesIndex) {
                                                        ta.point[0] == da.point[0] ? Ea = !0 : (M.push(da),
                                                        u = !0);
                                                        break
                                                    }
                                                }
                                                Ea ? M.push(ta) : u = !0
                                            }
                                            for (va = 0; va < P.length; va++) {
                                                da = P[va];
                                                Ea = !1;
                                                for (w = 0; w < M.length; w++)
                                                    if (ta = M[w],
                                                    ta.seriesIndex == da.seriesIndex) {
                                                        ta.point[0] == da.point[0] ? Ea = !0 : (M.push(ta),
                                                        u = !0);
                                                        break
                                                    }
                                                Ea || (u = !0,
                                                M.push(da))
                                            }
                                            u && (E.setHighlights(M),
                                            E.drawOverlay())
                                        } catch (ia) {}
                                        va = da = 0;
                                        P = !0;
                                        z && (0 == H.graphIndex && (P = !1),
                                        H.graphIndex != H.$isSyncedWith[E.getOptions().$isSyncedWith.length - 1].graphIndex && (P = !1));
                                        Ea = "none" != a("#moreDataGraph").css("display");
                                        Ba = float2int(E.height());
                                        ta = float2int(E.width());
                                        va = !1;
                                        if (5 == H.graphIndex)
                                            try {
                                                var Y = E.getPlaceholder().parent().parent();
                                                if (Y && 0 < Y.length && null != Y[0].className && Y[0].className.startsWith("ag-row")) {
                                                    var ma = Y[0].getAttribute("row-index")
                                                      , ca = Y.siblings().length;
                                                    va = ma == ca
                                                }
                                            } catch (ia) {
                                                console.error(ia)
                                            }
                                        if (P) {
                                            var ha = "";
                                            ma = va ? null : H.grid.markings;
                                            Y = function(ia) {
                                                ia.text && (-1 < ia.text.indexOf("offer data") && "" != ha || .003 < Math.abs(L.x - ia.xaxis.from) / (G[0].xaxis.max - G[0].xaxis.min) || (ha += "<br>" + ia.text))
                                            }
                                            ;
                                            if (null != ma)
                                                for (var C in ma)
                                                    Y(ma[C]);
                                            if ("undefined" != typeof E.getOptions().$isSyncedWith)
                                                for (C = 0; C < E.getOptions().$isSyncedWith.length; C++)
                                                    if (H.graphIndex != H.$isSyncedWith[C].graphIndex && (ma = E.getOptions().$isSyncedWith[C].grid.markings,
                                                    null != ma))
                                                        for (var U in ma)
                                                            Y(ma[U]);
                                            "" != ha && (ha = '<span class="markingsText">' + ha + "</span>");
                                            try {
                                                pa[0] = L.x ? replaceHtmlEl(pa[0], (new Date(Math.floor(L.x) - 6E4 * V)).formatDate(F) + ha) : ""
                                            } catch (ia) {
                                                reportBug(ia, "plothover");
                                                return
                                            }
                                            try {
                                                pa.css({
                                                    left: h - 14,
                                                    top: J ? Ba : Ba + (va ? 15 : 30),
                                                    display: "block"
                                                })
                                            } catch (ia) {}
                                        }
                                        U = !0;
                                        if (2 == E.getOptions().graphIndex) {
                                            O = "";
                                            for (v = 0; v < G.length; v++)
                                                null == A[v] ? (null != na[v] && (na[v][0].style.display = "none"),
                                                null != qa[v] && (qa[v][0].style.display = "none")) : "undefined" != typeof A[v] && "" != A[v] && (O += A[v],
                                                v != G.length - 1 && (O += "<br>"));
                                            0 < O.length && na[0].html(O).css({
                                                left: h,
                                                top: 10,
                                                display: "block"
                                            })
                                        } else
                                            for (v = 0; v < G.length; v++)
                                                null == A[v] ? (null != na[v] && (na[v][0].style.display = "none"),
                                                null != qa[v] && (qa[v][0].style.display = "none")) : (U = !1,
                                                C = G[v],
                                                100 <= C.index && "#!manage" == lastUrl && 0 == storage.manageGridView || (Y = C.yaxis,
                                                da = Y.min,
                                                va = Y.max,
                                                T = va - da,
                                                (0 <= A[v].indexOf(CsvType.getName(CsvType.SALES.index)) || 2 == Y.n) && "1" == storage.salesRankInverse && (da = Y.max,
                                                va = Y.min,
                                                T = va - da),
                                                ra[0].style.display = "block",
                                                ua[0].style.display = "block",
                                                Y = (1 - (va - O[v]) / T) * Ba,
                                                na[v][0] = replaceHtmlEl(na[v][0], A[v]),
                                                ma = float2int(na[v].height()) + 2,
                                                ca = Ba - Y,
                                                C = C.index % 4,
                                                za && (C = 3),
                                                0 == C ? (na[v].css({
                                                    left: h,
                                                    top: ca - ma - 14,
                                                    display: "block"
                                                }),
                                                qa[v].css({
                                                    marginTop: -14 + B - Y,
                                                    display: "block"
                                                })) : 1 == C || 3 == C ? (na[v].html(A[v]).css({
                                                    left: h - float2int(na[v].width()) - 33,
                                                    top: 1 == C ? ca - ma - 14 : ca + ma - 14 + 6,
                                                    display: "block"
                                                }),
                                                1 == C ? qa[v].css({
                                                    marginTop: -14 + B - Y,
                                                    display: "block"
                                                }) : qa[v].css({
                                                    marginTop: B - Y - 1,
                                                    display: "block"
                                                })) : (na[v].css({
                                                    left: h,
                                                    top: ca + ma - 14 + 6,
                                                    display: "block"
                                                }),
                                                qa[v].css({
                                                    "margin-top": B - Y,
                                                    display: "block"
                                                }))));
                                        A = !0;
                                        if (z || !Ea || keepaApp) {
                                            O = [];
                                            C = [];
                                            for (Y = 0; Y < CsvType.length; Y++)
                                                ma = a("#flotTip" + Y),
                                                0 != ma.length && (O[Y] = ma,
                                                C[Y] = a("#flotTipAngularLine" + Y));
                                            for (Y = 100; Y < 100 + CsvType.length; Y++)
                                                ma = a("#flotTip" + Y),
                                                0 != ma.length && (O[Y] = ma,
                                                C[Y] = a("#flotTipAngularLine" + Y));
                                            for (Y = 0; 3 > Y && A; Y++)
                                                for (A = !1,
                                                ma = [],
                                                ca = 0; ca < O.length; ca++)
                                                    if (null != O[ca])
                                                        for (Ea = 0; Ea < O.length; Ea++)
                                                            if (ca != Ea && null != O[Ea] && !ma[Ea + "." + ca] && (ma[Ea + "." + ca] = !0,
                                                            ma[ca + "." + Ea] = !0,
                                                            va = ca % 4,
                                                            da = Ea % 4,
                                                            va = 1 == va || 3 == va,
                                                            da = 1 == da || 3 == da,
                                                            va == da && (va = O[ca],
                                                            da = O[Ea],
                                                            "none" != va.css("display") && "none" != da.css("display") && (u = va.collision(da, {
                                                                relative: "collider",
                                                                directionData: "ddata",
                                                                as: "<div/>"
                                                            }),
                                                            0 < u.length)))) {
                                                                A = !0;
                                                                M = a(u[0]).data("ddata");
                                                                u = parseInt(a(u[0]).css("height")) + 5;
                                                                0 == M.indexOf("S") && (da.css("top", "+=" + u),
                                                                C[Ea].hide());
                                                                if (0 == M.indexOf("N") || 0 == M.indexOf("Inside"))
                                                                    va.css("top", "+=" + u),
                                                                    C[ca].hide();
                                                                break
                                                            }
                                        }
                                        A = J ? -35 : 0;
                                        O = float2int(S.height());
                                        float2int(S.width());
                                        U ? ra.css({
                                            left: d,
                                            top: Ba + 5,
                                            height: O - Ba + 1 + (P ? 0 : 200) + A,
                                            display: "block"
                                        }) : ra.css({
                                            left: d,
                                            top: Ba - B + 5,
                                            height: O - (Ba - B) + 1 + (P ? 0 : 150) + 20 + A,
                                            display: "block"
                                        });
                                        ua.css({
                                            left: r,
                                            top: f,
                                            width: ta,
                                            display: "block"
                                        });
                                        N = !1
                                    }
                                }
                            }, 0))
                        });
                        K.mousemove(m);
                        K.mouseout(t);
                        E.hooks.shutdown.push(function(q, L) {
                            L.off("mouseout", t);
                            L.off("mousemove", m)
                        })
                    }
                })
            }
        },
        name: "tooltip",
        version: "0.5"
    })
}
)(jQuery);
(function(a) {
    a.plot.plugins.push({
        init: function(b) {
            b.hooks.processDatapoints.push(function(d, h, m) {
                d.hooks.draw[h.index] = function(t, f) {
                    function n(I, E) {
                        var K = m.points
                          , H = m.pointsize
                          , V = null
                          , S = null
                          , aa = 0
                          , ea = !0;
                        if (h.dashes.dashLength[0]) {
                            var ra = h.dashes.dashLength[0];
                            var pa = h.dashes.dashLength[1] ? h.dashes.dashLength[1] : ra
                        } else
                            pa = ra = h.dashes.dashLength;
                        f.beginPath();
                        for (var ua = {}, na = H; na < K.length; ua = {
                            $jscomp$loop$prop$ax2$664: ua.$jscomp$loop$prop$ax2$664,
                            $jscomp$loop$prop$ax1$665: ua.$jscomp$loop$prop$ax1$665,
                            $jscomp$loop$prop$ay2$666: ua.$jscomp$loop$prop$ay2$666,
                            $jscomp$loop$prop$ay1$667: ua.$jscomp$loop$prop$ay1$667
                        },
                        na += H) {
                            var qa = K[na - H]
                              , ka = K[na - H + 1]
                              , za = K[na]
                              , J = K[na + 1];
                            if (null != qa && null != za) {
                                if (ka <= J && ka < p.min) {
                                    if (J < p.min)
                                        continue;
                                    qa = (p.min - ka) / (J - ka) * (za - qa) + qa;
                                    ka = p.min
                                } else if (J <= ka && J < p.min) {
                                    if (ka < p.min)
                                        continue;
                                    za = (p.min - ka) / (J - ka) * (za - qa) + qa;
                                    J = p.min
                                }
                                if (ka >= J && ka > p.max) {
                                    if (J > p.max)
                                        continue;
                                    qa = (p.max - ka) / (J - ka) * (za - qa) + qa;
                                    ka = p.max
                                } else if (J >= ka && J > p.max) {
                                    if (ka > p.max)
                                        continue;
                                    za = (p.max - ka) / (J - ka) * (za - qa) + qa;
                                    J = p.max
                                }
                                if (qa <= za && qa < r.min) {
                                    if (za < r.min)
                                        continue;
                                    ka = (r.min - qa) / (za - qa) * (J - ka) + ka;
                                    qa = r.min
                                } else if (za <= qa && za < r.min) {
                                    if (qa < r.min)
                                        continue;
                                    J = (r.min - qa) / (za - qa) * (J - ka) + ka;
                                    za = r.min
                                }
                                if (qa >= za && qa > r.max) {
                                    if (za > r.max)
                                        continue;
                                    ka = (r.max - qa) / (za - qa) * (J - ka) + ka;
                                    qa = r.max
                                } else if (za >= qa && za > r.max) {
                                    if (qa > r.max)
                                        continue;
                                    J = (r.max - qa) / (za - qa) * (J - ka) + ka;
                                    za = r.max
                                }
                                qa == V && ka == S || f.moveTo(r.p2c(qa) + I, p.p2c(ka) + E);
                                ua.$jscomp$loop$prop$ax1$665 = r.p2c(qa) + I;
                                ua.$jscomp$loop$prop$ay1$667 = p.p2c(ka) + E;
                                ua.$jscomp$loop$prop$ax2$664 = r.p2c(za) + I;
                                ua.$jscomp$loop$prop$ay2$666 = p.p2c(J) + E;
                                V = void 0;
                                S = function(g) {
                                    return function(D) {
                                        var N = Math.sqrt(Math.pow(g.$jscomp$loop$prop$ax2$664 - g.$jscomp$loop$prop$ax1$665, 2) + Math.pow(g.$jscomp$loop$prop$ay2$666 - g.$jscomp$loop$prop$ay1$667, 2));
                                        return N <= D ? {
                                            deltaX: g.$jscomp$loop$prop$ax2$664 - g.$jscomp$loop$prop$ax1$665,
                                            deltaY: g.$jscomp$loop$prop$ay2$666 - g.$jscomp$loop$prop$ay1$667,
                                            distance: N,
                                            remainder: D - N
                                        } : {
                                            deltaX: (g.$jscomp$loop$prop$ax2$664 > g.$jscomp$loop$prop$ax1$665 ? 1 : -1) * Math.sqrt(Math.pow(D, 2) / (1 + Math.pow((g.$jscomp$loop$prop$ay2$666 - g.$jscomp$loop$prop$ay1$667) / (g.$jscomp$loop$prop$ax2$664 - g.$jscomp$loop$prop$ax1$665), 2))),
                                            deltaY: (g.$jscomp$loop$prop$ay2$666 > g.$jscomp$loop$prop$ay1$667 ? 1 : -1) * Math.sqrt(Math.pow(D, 2) - Math.pow(D, 2) / (1 + Math.pow((g.$jscomp$loop$prop$ay2$666 - g.$jscomp$loop$prop$ay1$667) / (g.$jscomp$loop$prop$ax2$664 - g.$jscomp$loop$prop$ax1$665), 2))),
                                            distance: D,
                                            remainder: 0
                                        }
                                    }
                                }(ua);
                                qa = 500;
                                do {
                                    qa--;
                                    V = S(0 < aa ? aa : ea ? ra : pa);
                                    if (0 != V.deltaX || 0 != V.deltaY)
                                        ea ? f.lineTo(ua.$jscomp$loop$prop$ax1$665 + V.deltaX, ua.$jscomp$loop$prop$ay1$667 + V.deltaY) : f.moveTo(ua.$jscomp$loop$prop$ax1$665 + V.deltaX, ua.$jscomp$loop$prop$ay1$667 + V.deltaY);
                                    ea = !ea;
                                    aa = V.remainder;
                                    ua.$jscomp$loop$prop$ax1$665 += V.deltaX;
                                    ua.$jscomp$loop$prop$ay1$667 += V.deltaY
                                } while (0 < V.distance && 0 < qa);
                                V = za;
                                S = J
                            }
                        }
                        f.stroke()
                    }
                    if (h.dashes.show) {
                        t = t.getPlotOffset();
                        var r = h.xaxis
                          , p = h.yaxis;
                        f.save();
                        f.translate(t.left, t.top);
                        f.lineJoin = "round";
                        t = h.dashes.lineWidth;
                        var z = h.shadowSize;
                        if (0 < t && 0 < z) {
                            f.lineWidth = z;
                            f.strokeStyle = "rgba(0,0,0,0.1)";
                            var F = Math.PI / 18;
                            n(Math.sin(F) * (t / 2 + z / 2), Math.cos(F) * (t / 2 + z / 2));
                            f.lineWidth = z / 2;
                            n(Math.sin(F) * (t / 2 + z / 4), Math.cos(F) * (t / 2 + z / 4))
                        }
                        f.lineWidth = t;
                        f.strokeStyle = h.color;
                        0 < t && n(0, 0);
                        f.restore()
                    }
                }
            })
        },
        options: {
            series: {
                dashes: {
                    show: !1,
                    lineWidth: 1,
                    dashLength: 10
                }
            }
        },
        name: "dashes",
        version: "0.1"
    })
}
)(jQuery);
(function(a, b) {
    function d(S) {
        return !!("" === S || S && S.charCodeAt && S.substr)
    }
    function h(S) {
        return F ? F(S) : "[object Array]" === I.call(S)
    }
    function m(S) {
        return "[object Object]" === I.call(S)
    }
    function t(S, aa) {
        var ea;
        S = S || {};
        aa = aa || {};
        for (ea in aa)
            aa.hasOwnProperty(ea) && null == S[ea] && (S[ea] = aa[ea]);
        return S
    }
    function f(S, aa, ea) {
        var ra = [], pa;
        if (!S)
            return ra;
        if (z && S.map === z)
            return S.map(aa, ea);
        var ua = 0;
        for (pa = S.length; ua < pa; ua++)
            ra[ua] = aa.call(ea, S[ua], ua, S);
        return ra
    }
    function n(S, aa) {
        S = Math.round(Math.abs(S));
        return isNaN(S) ? aa : S
    }
    function r(S) {
        var aa = p.settings.currency.format;
        "function" === typeof S && (S = S());
        return d(S) && S.match("%v") ? {
            pos: S,
            neg: S.replace("-", "").replace("%v", "-%v"),
            zero: S
        } : S && S.pos && S.pos.match("%v") ? S : d(aa) ? p.settings.currency.format = {
            pos: aa,
            neg: aa.replace("%v", "-%v"),
            zero: aa
        } : aa
    }
    var p = {
        version: "0.4.1",
        settings: {
            currency: {
                symbol: "$",
                format: "%s%v",
                decimal: ".",
                thousand: ",",
                precision: 2,
                grouping: 3
            },
            number: {
                precision: 0,
                grouping: 3,
                thousand: ",",
                decimal: "."
            }
        }
    }
      , z = Array.prototype.map
      , F = Array.isArray
      , I = Object.prototype.toString
      , E = p.unformat = p.parse = function(S, aa) {
        if (h(S))
            return f(S, function(ra) {
                return E(ra, aa)
            });
        S = S || 0;
        if ("number" === typeof S)
            return S;
        aa = aa || ".";
        var ea = RegExp("[^0-9-" + aa + "]", ["g"]);
        ea = parseFloat(("" + S).replace(/\((.*)\)/, "-$1").replace(ea, "").replace(aa, "."));
        return isNaN(ea) ? 0 : ea
    }
      , K = p.toFixed = function(S, aa) {
        aa = n(aa, p.settings.number.precision);
        var ea = Math.pow(10, aa);
        return (Math.round(p.unformat(S) * ea) / ea).toFixed(aa)
    }
      , H = p.formatNumber = p.format = function(S, aa, ea, ra) {
        if (h(S))
            return f(S, function(za) {
                return H(za, aa, ea, ra)
            });
        S = E(S);
        var pa = t(m(aa) ? aa : {
            precision: aa,
            thousand: ea,
            decimal: ra
        }, p.settings.number)
          , ua = n(pa.precision)
          , na = 0 > S ? "-" : ""
          , qa = parseInt(K(Math.abs(S || 0), ua), 10) + ""
          , ka = 3 < qa.length ? qa.length % 3 : 0;
        return na + (ka ? qa.substr(0, ka) + pa.thousand : "") + qa.substr(ka).replace(/(\d{3})(?=\d)/g, "$1" + pa.thousand) + (ua ? pa.decimal + K(Math.abs(S), ua).split(".")[1] : "")
    }
      , V = p.formatMoney = function(S, aa, ea, ra, pa, ua) {
        if (h(S))
            return f(S, function(ka) {
                return V(ka, aa, ea, ra, pa, ua)
            });
        S = E(S);
        var na = t(m(aa) ? aa : {
            symbol: aa,
            precision: ea,
            thousand: ra,
            decimal: pa,
            format: ua
        }, p.settings.currency)
          , qa = r(na.format);
        return (0 < S ? qa.pos : 0 > S ? qa.neg : qa.zero).replace("%s", na.symbol).replace("%v", H(Math.abs(S), n(na.precision), na.thousand, na.decimal))
    }
    ;
    p.formatColumn = function(S, aa, ea, ra, pa, ua) {
        if (!S)
            return [];
        var na = t(m(aa) ? aa : {
            symbol: aa,
            precision: ea,
            thousand: ra,
            decimal: pa,
            format: ua
        }, p.settings.currency)
          , qa = r(na.format)
          , ka = qa.pos.indexOf("%s") < qa.pos.indexOf("%v") ? !0 : !1
          , za = 0;
        S = f(S, function(J) {
            if (h(J))
                return p.formatColumn(J, na);
            J = E(J);
            J = (0 < J ? qa.pos : 0 > J ? qa.neg : qa.zero).replace("%s", na.symbol).replace("%v", H(Math.abs(J), n(na.precision), na.thousand, na.decimal));
            J.length > za && (za = J.length);
            return J
        });
        return f(S, function(J) {
            return d(J) && J.length < za ? ka ? J.replace(na.symbol, na.symbol + Array(za - J.length + 1).join(" ")) : Array(za - J.length + 1).join(" ") + J : J
        })
    }
    ;
    "undefined" !== typeof exports ? ("undefined" !== typeof module && module.exports && (exports = module.exports = p),
    exports.accounting = p) : "function" === typeof define && define.amd ? define([], function() {
        return p
    }) : (p.noConflict = function(S) {
        return function() {
            a.accounting = S;
            p.noConflict = b;
            return p
        }
    }(a.accounting),
    a.accounting = p)
}
)(this);
(function(a) {
    a.plot.plugins.push({
        init: function(b) {
            function d(K) {
                F.active && (n(K),
                b.getPlaceholder().trigger("plotselecting", [m()]))
            }
            function h(K) {
                1 == K.which && (document.body.focus(),
                void 0 !== document.onselectstart && null == I.onselectstart && (I.onselectstart = document.onselectstart,
                document.onselectstart = function() {
                    return !1
                }
                ),
                void 0 !== document.ondrag && null == I.ondrag && (I.ondrag = document.ondrag,
                document.ondrag = function() {
                    return !1
                }
                ),
                f(F.first, K),
                F.active = !0,
                E = function(H) {
                    E = null;
                    void 0 !== document.onselectstart && (document.onselectstart = I.onselectstart);
                    void 0 !== document.ondrag && (document.ondrag = I.ondrag);
                    F.active = !1;
                    n(H);
                    z() ? t() : (b.getPlaceholder().trigger("plotunselected", []),
                    b.getPlaceholder().trigger("plotselecting", [null]))
                }
                ,
                a(document).one("mouseup", E))
            }
            function m() {
                if (!z() || !F.show)
                    return null;
                var K = {}
                  , H = F.first
                  , V = F.second;
                a.each(b.getAxes(), function(S, aa) {
                    if (aa.used) {
                        var ea = aa.c2p(H[aa.direction]);
                        aa = aa.c2p(V[aa.direction]);
                        K[S] = {
                            from: Math.min(ea, aa),
                            to: Math.max(ea, aa)
                        }
                    }
                });
                return K
            }
            function t() {
                var K = m();
                b.getPlaceholder().trigger("plotselected", [K]);
                K.xaxis && K.yaxis && b.getPlaceholder().trigger("selected", [{
                    x1: K.xaxis.from,
                    y1: K.yaxis.from,
                    x2: K.xaxis.to,
                    y2: K.yaxis.to
                }])
            }
            function f(K, H) {
                var V = b.getOptions()
                  , S = b.getPlaceholder().offset()
                  , aa = b.getPlotOffset()
                  , ea = H.pageX - S.left - aa.left
                  , ra = float2int(b.width());
                K.x = 0 > ea ? 0 : ea > ra ? ra : ea;
                H = H.pageY - S.top - aa.top;
                S = float2int(b.height());
                K.y = 0 > H ? 0 : H > S ? S : H;
                "y" == V.selection.mode && (K.x = K == F.first ? 0 : float2int(b.width()));
                "x" == V.selection.mode && (K.y = K == F.first ? 0 : float2int(b.height()))
            }
            function n(K) {
                null != K.pageX && (f(F.second, K),
                z() ? (F.show = !0,
                b.triggerRedrawOverlay()) : r(!0))
            }
            function r(K) {
                F.show && (F.show = !1,
                b.triggerRedrawOverlay(),
                K || b.getPlaceholder().trigger("plotunselected", []))
            }
            function p(K, H) {
                var V = b.getAxes(), S;
                for (S in V) {
                    var aa = V[S];
                    if (aa.direction == H) {
                        var ea = H + aa.n + "axis";
                        K[ea] || 1 != aa.n || (ea = H + "axis");
                        if (K[ea]) {
                            var ra = K[ea].from;
                            var pa = K[ea].to;
                            break
                        }
                    }
                }
                K[ea] || (aa = "x" == H ? b.getXAxes()[0] : b.getYAxes()[0],
                ra = K[H + "1"],
                pa = K[H + "2"]);
                null != ra && null != pa && ra > pa && (K = ra,
                ra = pa,
                pa = K);
                return {
                    from: ra,
                    to: pa,
                    axis: aa
                }
            }
            function z() {
                var K = b.getOptions().selection.minSize;
                return Math.abs(F.second.x - F.first.x) >= K && Math.abs(F.second.y - F.first.y) >= K
            }
            var F = {
                first: {
                    x: -1,
                    y: -1
                },
                second: {
                    x: -1,
                    y: -1
                },
                show: !1,
                active: !1
            }
              , I = {}
              , E = null;
            b.clearSelection = r;
            b.setSelection = function(K, H) {
                var V = b.getOptions();
                if ("y" == V.selection.mode)
                    F.first.x = 0,
                    F.second.x = float2int(b.width());
                else {
                    var S = p(K, "x");
                    F.first.x = S.axis.p2c(S.from);
                    F.second.x = S.axis.p2c(S.to)
                }
                "x" == V.selection.mode ? (F.first.y = 0,
                F.second.y = float2int(b.height())) : (S = p(K, "y"),
                F.first.y = S.axis.p2c(S.from),
                F.second.y = S.axis.p2c(S.to));
                F.show = !0;
                b.triggerRedrawOverlay();
                !H && z() && t()
            }
            ;
            b.getSelection = m;
            b.hooks.bindEvents.push(function(K, H) {
                null != K.getOptions().selection.mode && (H.mousemove(d),
                H.mousedown(h))
            });
            b.hooks.drawOverlay.push(function(K, H) {
                if (F.show && z()) {
                    var V = K.getPlotOffset();
                    K = K.getOptions();
                    H.save();
                    H.translate(V.left, V.top);
                    V = a.color.parse(K.selection.color);
                    H.strokeStyle = V.scale("a", .8).toString();
                    H.lineWidth = 1;
                    H.lineJoin = K.selection.shape;
                    H.fillStyle = V.scale("a", .4).toString();
                    V = Math.min(F.first.x, F.second.x) + .5;
                    K = Math.min(F.first.y, F.second.y) + .5;
                    var S = Math.abs(F.second.x - F.first.x) - 1
                      , aa = Math.abs(F.second.y - F.first.y) - 1;
                    H.fillRect(V, K, S, aa);
                    H.strokeRect(V, K, S, aa);
                    H.restore()
                }
            });
            b.hooks.shutdown.push(function(K, H) {
                H.off("mousemove", d);
                H.off("mousedown", h);
                E && a(document).off("mouseup", E)
            })
        },
        options: {
            selection: {
                mode: null,
                color: "#e8cfac",
                shape: "round",
                minSize: 5
            }
        },
        name: "selection",
        version: "1.1"
    })
}
)(jQuery);
(function(a) {
    function b(f, n) {
        if (f)
            if ("offset"in f) {
                var r = f.data("jqueryCollisionCoordinates");
                r ? (this.x1 = r.x1,
                this.y1 = r.y1,
                this.x2 = r.x2,
                this.y2 = r.y2) : n && n.length && 4 <= n.length ? (this.x1 = n[0],
                this.y1 = n[1],
                this.x2 = n[2] + f.outerWidth(!0),
                this.y2 = n[3] + f.outerHeight(!0)) : 0 >= f.parent().length ? (this.x1 = parseInt(f.css("left")) || 0,
                this.y1 = parseInt(f.css("top")) || 0,
                this.x2 = parseInt(f.css("width")) || 0,
                this.y2 = parseInt(f.css("height")) || 0,
                this.x2 += this.x1,
                this.x2 += (parseInt(f.css("marginLeft")) || 0) + (parseInt(f.css("borderLeft")) || 0) + (parseInt(f.css("paddingLeft")) || 0) + (parseInt(f.css("paddingRight")) || 0) + (parseInt(f.css("borderRight")) || 0) + (parseInt(f.css("marginRight")) || 0),
                this.y2 += this.y1,
                this.y2 += (parseInt(f.css("marginTop")) || 0) + (parseInt(f.css("borderTop")) || 0) + (parseInt(f.css("paddingRop")) || 0) + (parseInt(f.css("paddingBottom")) || 0) + (parseInt(f.css("borderBottom")) || 0) + (parseInt(f.css("marginBottom")) || 0)) : (n = f.offset(),
                this.x1 = n.left - (parseInt(f.css("marginLeft")) || 0),
                this.y1 = n.top - (parseInt(f.css("marginTop")) || 0),
                this.x2 = this.x1 + f.outerWidth(!0),
                this.y2 = this.y1 + f.outerHeight(!0));
                this.proto = f
            } else
                "x1"in f && (this.x1 = f.x1,
                this.y1 = f.y1,
                this.x2 = f.x2,
                this.y2 = f.y2,
                this.proto = f);
        else
            this.x1 = this.y1 = this.x2 = this.y2 = 0,
            this.proto = null;
        "dir"in f && (this.dir = f.dir)
    }
    function d(f, n, r, p) {
        this.target = f;
        this.obstacle = n;
        this.overlap = r;
        this.overlapType = p
    }
    function h(f, n, r) {
        this.targets = f;
        this.obstacles = n;
        this.cache = this.collisions = null;
        this.containment = r ? r : null
    }
    function m(f) {
        return a(f).get().map(function(n, r, p) {
            return new b(a(n))
        })
    }
    function t(f) {
        for (var n = a(), r = 0; r < f.length; r++)
            n = n.add(f[r]);
        return n
    }
    b.prototype.innerContainer = function() {
        var f = new b(this);
        this.proto.css && (f.x1 += parseInt(this.proto.css("marginLeft")) || 0,
        f.x1 += parseInt(this.proto.css("borderLeft")) || 0,
        f.x1 += parseInt(this.proto.css("paddingLeft")) || 0,
        f.x2 -= parseInt(this.proto.css("paddingRight")) || 0,
        f.x2 -= parseInt(this.proto.css("borderRight")) || 0,
        f.x2 -= parseInt(this.proto.css("marginRight")) || 0,
        f.y1 += parseInt(this.proto.css("marginTop")) || 0,
        f.y1 += parseInt(this.proto.css("borderTop")) || 0,
        f.y1 += parseInt(this.proto.css("paddingTop")) || 0,
        f.y2 -= parseInt(this.proto.css("paddingBottom")) || 0,
        f.y2 -= parseInt(this.proto.css("borderBottom")) || 0,
        f.y2 -= parseInt(this.proto.css("marginBottom")) || 0);
        return f
    }
    ;
    b.prototype.move = function(f, n) {
        this.x1 += f;
        this.x2 += f;
        this.y1 += n;
        this.y2 += n;
        return this
    }
    ;
    b.prototype.update = function(f) {
        "x1"in f && (this.x1 = f.x1);
        "x2"in f && (this.x1 = f.x2);
        "y1"in f && (this.x1 = f.y1);
        "y2"in f && (this.x1 = f.y2);
        if ("left"in f) {
            var n = this.x2 - this.x1;
            this.x1 = f.left;
            this.x2 = this.x1 + n
        }
        "top"in f && (n = this.y2 - this.y1,
        this.y1 = f.top,
        this.y2 = this.y1 + n);
        "offset"in f && (n = f.offset(),
        this.update(n),
        this.x2 = this.x1 + float2int(f.width()),
        this.y2 = this.y1 + float2int(f.height()));
        "dir"in f && (this.x1 = f.dir);
        return this
    }
    ;
    b.prototype.width = function() {
        return this.x2 - this.x1
    }
    ;
    b.prototype.height = function() {
        return this.y2 - this.y1
    }
    ;
    b.prototype.centerx = function() {
        return (this.x1 + this.x2) / 2
    }
    ;
    b.prototype.centery = function() {
        return (this.y1 + this.y2) / 2
    }
    ;
    b.prototype.toString = function() {
        return (this.proto.get ? "#" + this.proto.get(0).id : "") + "[" + [this.x1, this.y1, this.x2, this.y2].join() + "]"
    }
    ;
    b.EPSILON = .001;
    b.prototype.containsPoint = function(f, n, r) {
        r || (r = !1);
        r = (r ? -1 : 1) * b.EPSILON;
        return f > this.x1 + r && f < this.x2 - r && n > this.y1 + r && n < this.y2 - r ? !0 : !1
    }
    ;
    b.prototype.overlaps = function(f, n) {
        var r = this._overlaps(f, n);
        if (0 < r.length)
            return r;
        r = f._overlaps(this, n);
        0 < r.length && (r[0].dir = "Inside" == r[0].dir ? "Outside" : "Outside" == r[0].dir ? "Inside" : "N" == r[0].dir ? "S" : "S" == r[0].dir ? "N" : "W" == r[0].dir ? "E" : "E" == r[0].dir ? "W" : "NE" == r[0].dir ? "SW" : "SW" == r[0].dir ? "NE" : "SE" == r[0].dir ? "NW" : "NW" == r[0].dir ? "SE" : void 0);
        return r || []
    }
    ;
    b.prototype._overlaps = function(f, n) {
        n || (n = !1);
        var r = f.centerx()
          , p = f.centery();
        r = [[f.x1, f.y1, "SE"], [f.x2, f.y1, "SW"], [f.x2, f.y2, "NW"], [f.x1, f.y2, "NE"], [r, f.y1, "S"], [f.x2, p, "W"], [r, f.y2, "N"], [f.x1, p, "E"], [r, p, void 0]];
        p = null;
        for (var z = {
            NW: !1,
            N: !1,
            NE: !1,
            E: !1,
            SE: !1,
            S: !1,
            SW: !1,
            W: !1
        }, F = 0; F < r.length; F++)
            this.containsPoint(r[F][0], r[F][1], n) && (r[F][2] && (z[r[F][2]] = !0),
            p || (p = [new b({
                x1: Math.max(f.x1, this.x1),
                y1: Math.max(f.y1, this.y1),
                x2: Math.min(f.x2, this.x2),
                y2: Math.min(f.y2, this.y2),
                dir: r[F][2]
            })]));
        p && (z.NW && z.NE && (p[0].dir = "N"),
        z.NE && z.SE && (p[0].dir = "E"),
        z.SE && z.SW && (p[0].dir = "S"),
        z.SW && z.NW && (p[0].dir = "W"),
        z.NW && z.NE && z.SE && z.SW && (p[0].dir = "Outside"),
        z.NW || z.NE || z.SE || z.SW || z.N || z.E || z.S || z.W || (p[0].dir = "Inside"));
        return p || []
    }
    ;
    b.prototype._protrusion = function(f, n, r) {
        f = this.overlaps(new b(f), !1);
        if (0 >= f.length)
            return r;
        f[0].dir = n;
        r.push(f[0]);
        return r
    }
    ;
    b.prototype.protrusions = function(f) {
        var n = []
          , r = Number.NEGATIVE_INFINITY
          , p = Number.POSITIVE_INFINITY
          , z = f.x1
          , F = f.x2
          , I = f.y1;
        f = f.y2;
        n = this._protrusion({
            x1: z,
            y1: r,
            x2: F,
            y2: I
        }, "N", n);
        n = this._protrusion({
            x1: F,
            y1: r,
            x2: p,
            y2: I
        }, "NE", n);
        n = this._protrusion({
            x1: F,
            y1: I,
            x2: p,
            y2: f
        }, "E", n);
        n = this._protrusion({
            x1: F,
            y1: f,
            x2: p,
            y2: p
        }, "SE", n);
        n = this._protrusion({
            x1: z,
            y1: f,
            x2: F,
            y2: p
        }, "S", n);
        n = this._protrusion({
            x1: r,
            y1: f,
            x2: z,
            y2: p
        }, "SW", n);
        n = this._protrusion({
            x1: r,
            y1: I,
            x2: z,
            y2: f
        }, "W", n);
        return n = this._protrusion({
            x1: r,
            y1: r,
            x2: z,
            y2: I
        }, "NW", n)
    }
    ;
    d.prototype.distance = function(f) {
        f = c.target;
        var n = c.overlap;
        return Math.sqrt((f.centerx() - n.centerx()) * (f.centerx() - n.centerx()) + (f.centery() - n.centery()) * (f.centery() - n.centery()))
    }
    ;
    h.prototype.getCollisions = function(f) {
        if (null !== this.collisions)
            return this.collisions;
        this.cache = {};
        this.collisions = [];
        f || (f = "collision");
        if ("collision" != f && "protrusion" != f)
            return [];
        for (var n = [], r = this.targets, p = this.obstacles, z = 0; z < r.length; z++)
            for (var F = r[z], I = 0; I < p.length; I++) {
                var E = p[I];
                E = "collision" == f ? F.overlaps(E) : F.protrusions(E.innerContainer());
                for (var K = 0; K < E.length; K++)
                    n.push(new d(r[z],p[I],E[K],f))
            }
        return this.collisions = n
    }
    ;
    a.fn.collision = function(f, n) {
        n || (n = {});
        var r = "collision"
          , p = null
          , z = null
          , F = null
          , I = null
          , E = "body";
        "protrusion" == n.mode && (r = n.mode);
        n.as && (p = n.as);
        n.colliderData && (z = n.colliderData);
        n.obstacleData && (F = n.obstacleData);
        n.directionData && (I = n.directionData);
        n.relative && (E = n.relative);
        f = (new h(m(this),m(f))).getCollisions(r);
        f = p ? a.map(f, function(K, H, V) {
            H = K.overlap.x1;
            V = K.overlap.y1;
            if (E && "body" != E) {
                var S = "collider" == E ? a(K.target.proto) : "obstacle" == E ? a(K.obstacle.proto) : a(E);
                0 < S.length && (S = S.offset(),
                H -= S.left,
                V -= S.top)
            }
            try {
                var aa = a(p);
                aa.offset({
                    left: H,
                    top: V
                });
                aa.width(float2int(K.overlap.width()));
                aa.height(float2int(K.overlap.height()))
            } catch (ea) {
                return
            }
            z && aa.data(z, a(K.target.proto));
            F && aa.data(F, a(K.obstacle.proto));
            I && K.overlap.dir && aa.data(I, K.overlap.dir);
            return aa
        }) : a.map(f, function(K, H, V) {
            return K.obstacle.proto
        });
        return t(f)
    }
}
)(jQuery);
(function(a) {
    a.fn.endlessScroll = function(b) {
        b = a.extend({
            bottomPixels: 50,
            fireOnce: !0,
            fireDelay: 150,
            data: "",
            insertAfter: "div:last",
            resetCounter: function() {
                return !1
            },
            callback: function() {
                return !0
            },
            ceaseFire: function() {
                return !1
            },
            eventName: "endless"
        }, b);
        var d = !0
          , h = !1
          , m = 0;
        !0 === b.ceaseFire.apply(this) && (d = !1);
        if (!0 === d)
            a(this).off("scroll." + b.eventName).on("scroll." + b.eventName, function() {
                if (this == document)
                    var t = a(document).height() - a(window).height() <= a(window).scrollTop() + b.bottomPixels;
                else
                    t = a(".endless_scroll_inner_wrap", this),
                    0 == t.length && a(this).wrapInner('<div class="endless_scroll_inner_wrap" />'),
                    t = 0 < t.length && t.height() - a(this).height() <= a(this).scrollTop() + b.bottomPixels;
                t && (0 == b.fireOnce || 1 == b.fireOnce && 1 != h) && (!0 === b.resetCounter.apply(this) && (m = 0),
                h = !0,
                m++,
                !1 !== ("function" == typeof b.data ? b.data.apply(this) : b.data) && (t = [],
                t[0] = m,
                b.callback.apply(this, t),
                !1 !== b.fireDelay || 0 !== b.fireDelay ? (a("body").after('<div id="endless_scroll_marker"></div>'),
                a("div#endless_scroll_marker").fadeTo(b.fireDelay, 1, function() {
                    a(this).remove();
                    h = !1
                })) : h = !1))
            })
    }
}
)(jQuery);
var $jscomp$this = this
  , enableListTrackingComponent = isTest && !1
  , enableSubcategorySalesRankFilter = isTest && !1
  , GridApi = function() {
    var a, b = $.Deferred();
    return {
        version: "16.0.1/1",
        load: function() {
            if (a)
                return b.promise();
            a = !0;
            var d = CDNUrl + "ag-grid-enterprise-21.1.0.min.js";
            isTest && (d = CDNUrl + "ag-grid-enterprise-21.1.0.js",
            console.info("%cLoaded \u27fc ", "color:pink;font-weight:bold;", "21.1.0"));
            var h = document.createElement("script");
            h.async = !0;
            h.src = d;
            h.onload = b.resolve;
            h.onerror = b.reject;
            h.crossOrigin = "anonymous";
            document.body.appendChild(h);
            return b.promise()
        },
        init: function(d) {
            agGrid.LicenseManager.setLicenseKey("Keepa_GmbH_Keepa_1Devs25_June_2019__MTU2MTQxNzIwMDAwMA==dab76dc13dd49d31c96996f22552f92d");
            var h = $("#" + d.gridId)[0];
            if ("undefined" === typeof h)
                return null;
            new agGrid.Grid(h,d.gridOptions);
            d.gridOptions.context = {};
            d.gridOptions.context.gridWrapperId = d.gridWrapperId;
            d.gridOptions.context.pageId = d.pageId;
            "undefined" === typeof d.gridOptions.onGridReady && (d.gridOptions.onGridReady = function(m) {
                GridHelper.addToggleUnitEvents(d.gridOptions);
                GridHelper.addCopyByKeyboard(d.gridOptions)
            }
            );
            d.gridOptions.onVirtualColumnsChanged = function(m) {
                GridHelper.addToggleUnitEvents(d.gridOptions);
                "finder" === d.gridOptions.context.pageId && GridFinder.handleSpecialFilters()
            }
            ;
            d.gridOptions.onRowDataChanged = function() {
                d.gridOptions.api && d.gridOptions.api.sizeColumnsToFit();
                iframe.isIframe && addon("resize", float2int($(document).height()))
            }
            ;
            "bestseller deals finder manage offer storefront viewer".split(" ").includes(d.pageId) && ("manage" !== d.pageId && GridState.restoreColumnState(d.gridOptions),
            d.gridOptions.onColumnVisible = function(m) {
                d.gridOptions.api && d.gridOptions.api.sizeColumnsToFit();
                if ("manage" !== d.pageId && m.column) {
                    var t = $('.grid-wrapper-tools [data-col-id="' + m.column.colId + '"]');
                    !1 === m.column.visible && !0 === t.prop("checked") ? t.prop("checked", !1) : !0 === m.column.visible && !1 === t.prop("checked") && t.prop("checked", !0)
                }
                "undefined" !== typeof m.visible && GridState.saveColumnState(d.gridOptions)
            }
            ,
            d.gridOptions.onDragStopped = function() {
                GridState.saveColumnState(d.gridOptions)
            }
            ,
            "manage" === d.pageId && (d.gridOptions.onSortChanged = function() {
                GridState.saveSortModel(d.gridOptions);
                GridManage.removeDeletedRows();
                GridManage.updateSortToolbar()
            }
            ));
            onPageNavigation.progress(function(m) {
                "#!product" != m && "undefined" != typeof d.gridOptions && null != d.gridOptions.api && d.gridOptions.api.destroy()
            });
            return d.gridOptions
        },
        setData: function(d, h, m) {
            GridHelper.addContextMenu(d);
            d.api.setRowData(h);
            m && m.length && (d.pinnedBottomRowData = m);
            !0 === d.pagination && 1 === d.api.paginationGetTotalPages() && $(".ag-paging-page-summary-panel").hide();
            "variation" !== d.context.pageId && "search" !== d.context.pageId && getBucketInformation()
        },
        getRowsPerPage: function(d) {
            if (d.context.config.perPage)
                return hasDataAccessSubscription ? d.context.config.perPage : GridConfig.maxRowsFreeUser;
            var h = d.context.config.type
              , m = GridConfig.getRowCountOptions(h);
            if ("undefined" === typeof m)
                return GridConfig.maxRowsFreeUser;
            m = m.values[hasDataAccessSubscription ? "asin" == h ? 2 : 1 : 0];
            if ("undefined" !== typeof storage.gridConfig) {
                var t = JSON.parse(storage.gridConfig);
                (t = t.perPage ? t.perPage : !1) && t[h] && (t = t[h],
                GridHelper.isValidRowsPerPage(h, t) && (m = t))
            }
            "asinFinder" == h ? 100 < m && (m = 100) : 1E3 < m && (m = 1E3);
            d.context.config.currentRowsPerPage = m;
            return d.context.config.perPage = m
        },
        setRowsPerPage: function(d, h) {
            var m = d.context.config.type;
            if (GridHelper.isValidRowsPerPage(m, h)) {
                d.context.config.currentRowsPerPage = h;
                d.context.config.perPage = h;
                var t = document.querySelector(".tool__row .trigger");
                $(t).find("span").replaceWith("<span>&ensp;" + h + " rows&emsp;</span>");
                t = storage.gridConfig ? JSON.parse(storage.gridConfig) : {};
                t.perPage = t.perPage ? t.perPage : {};
                t.perPage[m] = h;
                storage.gridConfig = JSON.stringify(t);
                settings.send();
                d.api.showLoadingOverlay();
                switch (d.context.pageId) {
                case "bestseller":
                    GridBestSeller.initData(d);
                    break;
                case "finder":
                    GridFinder.initDatasource();
                    break;
                case "storefront":
                    GridStorefront.initData(d);
                    break;
                case "topseller":
                    GridTopSeller.initData(d)
                }
            }
        },
        toggleUnit: function(d) {
            var h = GridHelper.getCurrentUnitSystem()
              , m = storage.gridConfig ? JSON.parse(storage.gridConfig) : {};
            delete m.units;
            m.unitSystem = "METRIC" === h ? "IMPERIAL" : "METRIC";
            storage.gridConfig = JSON.stringify(m);
            settings.send();
            var t = GridHelper.getCurrentUnits(!0);
            h = d.context.config.template;
            if ("asin" === h) {
                "infinite" == d.rowModelType ? d.api.refreshInfiniteCache() : d.api.updateRowData({});
                h = GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + t.measure + "</span>\u00b3)");
                m = GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + t.measure + "</span>)");
                t = GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + t.weight + "</span>)");
                var f = d.columnApi.getColumn("packageDimension")
                  , n = d.columnApi.getColumn("packageLength")
                  , r = d.columnApi.getColumn("packageWidth")
                  , p = d.columnApi.getColumn("packageHeight")
                  , z = d.columnApi.getColumn("packageWeight")
                  , F = d.columnApi.getColumn("itemDimension")
                  , I = d.columnApi.getColumn("itemLength")
                  , E = d.columnApi.getColumn("itemWidth")
                  , K = d.columnApi.getColumn("itemHeight")
                  , H = d.columnApi.getColumn("itemWeight");
                f.colDef.headerComponentParams.template = h;
                n.colDef.headerComponentParams.template = m;
                r.colDef.headerComponentParams.template = m;
                p.colDef.headerComponentParams.template = m;
                z.colDef.headerComponentParams.template = t;
                F.colDef.headerComponentParams.template = h;
                I.colDef.headerComponentParams.template = m;
                E.colDef.headerComponentParams.template = m;
                K.colDef.headerComponentParams.template = m;
                H.colDef.headerComponentParams.template = t;
                d.api.refreshHeader();
                GridHelper.addToggleUnitEvents(d)
            } else if ("productDetail" === h) {
                var V = {
                    packageDimension: 'Dimension (<span class="toggle-unit" title="Toggle unit">' + t.measure + "</span>\u00b3)",
                    packageWeight: 'Weight (<span class="toggle-unit" title="Toggle unit">' + t.weight + "</span>)",
                    itemDimension: 'Dimension (<span class="toggle-unit" title="Toggle unit">' + t.measure + "</span>\u00b3)",
                    itemWeight: 'Weight (<span class="toggle-unit" title="Toggle unit">' + t.weight + "</span>)"
                }
                  , S = [];
                d.api.forEachNode(function(aa) {
                    aa = aa.data;
                    if (["packageDimension", "packageWeight", "itemDimension", "itemWeight"].includes(aa.realField)) {
                        aa.productKey = (aa.realField.includes("package") ? "Package - " : "Item - ") + V[aa.realField];
                        switch (aa.realField) {
                        case "packageWeight":
                        case "itemWeight":
                            var ea = {
                                colDef: {
                                    field: aa.realField
                                },
                                data: {}
                            };
                            ea.data[aa.realField] = d.context.lookup[aa.realField];
                            aa.productValue = GridHelper.valueGetterWeight(ea);
                            ea.value = aa.productValue;
                            aa.productValueFormatted = GridHelper.valueFormatterWeight(ea);
                            break;
                        case "packageDimension":
                            ea = {
                                colDef: {
                                    field: aa.realField
                                },
                                data: {
                                    packageLength: d.context.lookup.packageLength,
                                    packageWidth: d.context.lookup.packageWidth,
                                    packageHeight: d.context.lookup.packageHeight
                                }
                            };
                            aa.productValue = GridHelper.valueGetterDimension(ea);
                            ea.value = aa.productValue;
                            aa.productValueFormatted = GridHelper.valueFormatterDimension(ea);
                            break;
                        case "itemDimension":
                            ea = {
                                colDef: {
                                    field: aa.realField
                                },
                                data: {
                                    itemLength: d.context.lookup.itemLength,
                                    itemWidth: d.context.lookup.itemWidth,
                                    itemHeight: d.context.lookup.itemHeight
                                }
                            };
                            aa.productValue = GridHelper.valueGetterDimension(ea);
                            ea.value = aa.productValue;
                            aa.productValueFormatted = GridHelper.valueFormatterDimension(ea);
                            break;
                        default:
                            ea = {
                                colDef: {
                                    field: aa.realField
                                },
                                data: {}
                            },
                            ea.data[aa.realField] = d.context.lookup[aa.realField],
                            aa.productValue = GridHelper.valueGetterMeasure(ea),
                            ea.value = aa.productValue,
                            aa.productValueFormatted = GridHelper.valueFormatterMeasure(ea)
                        }
                        S.push(aa)
                    }
                });
                GridHelper.addContextMenu(d);
                d.api.updateRowData({
                    update: S
                });
                GridHelper.addToggleUnitEvents(d)
            }
        },
        exportData: function(d, h) {
            var m = d.context.config.type
              , t = "manage" === m;
            return $.Deferred(function(f) {
                var n = document.title.replace(" - ", "_").replace(/ /g, "_") + "." + (new Date).formatDate("Y_m_j") + ".";
                "offer" === m && (n = (new Date).formatDate("Y_m_j") + ".");
                "variation" === m && (n = "Keepa_ASIN_Export." + (new Date).formatDate("Y_m_j") + ".");
                n += "seller" === m ? "sellers" : "offer" === m ? "offers" : "products";
                t && (n = "keepaTrackingData." + (new Date).formatDate("Y_m_j") + "." + storage.username.replace(/\s+/, ""));
                setTimeout(function() {
                    h = h || {};
                    h.processCellCallback = GridHelper.processCellCallback;
                    h.processHeaderCallback = GridHelper.processHeaderCallback;
                    h.columnGroups = !1;
                    h.fileName = n + ".csv";
                    h.shouldRowBeSkipped = function(r) {
                        return "asinFinder" === m ? "undefined" === typeof r.node.data || null === r.node.data.asin || r.node.rowPinned : r.node.rowPinned
                    }
                    ;
                    d.api.exportDataAsCsv(h);
                    f.resolve()
                }, 0)
            }).promise()
        }
    }
}()
  , GridState = function() {
    var a = function(E) {
        if (isTest)
            for (var K = {}, H = $jscomp.makeIterator(E), V = H.next(); !V.done; K = {
                $jscomp$loop$prop$c$231$669: K.$jscomp$loop$prop$c$231$669
            },
            V = H.next())
                K.$jscomp$loop$prop$c$231$669 = V.value,
                V = Object.keys(K.$jscomp$loop$prop$c$231$669).filter(function(S) {
                    return !"colId hide aggFunc width pivotIndex pinned rowGroupIndex".split(" ").includes(S)
                }),
                V.length && console.warn("columnState has unknownAttributes:", V, K.$jscomp$loop$prop$c$231$669),
                V = Object.keys(K.$jscomp$loop$prop$c$231$669).filter(function(S) {
                    return function(aa) {
                        return ["aggFunc", "pivotIndex", "rowGroupIndex"].includes(aa) && null !== S.$jscomp$loop$prop$c$231$669[aa]
                    }
                }(K)),
                V.length && console.warn("columnState has skippedAttributesNotNull:", V, K.$jscomp$loop$prop$c$231$669);
        return E.map(function(S) {
            return {
                c: S.colId,
                h: S.hide ? 1 : 0,
                p: S.pinned ? S.pinned.charAt(0) : "",
                w: S.width
            }
        })
    }
      , b = function(E) {
        return E[0].colId ? E : E.map(function(K) {
            return {
                colId: K.c,
                hide: 1 === K.h ? !0 : !1,
                pinned: "l" === K.p ? "left" : "r" === K.p ? "right" : null,
                width: K.w,
                aggFunc: null,
                pivotIndex: null,
                rowGroupIndex: null
            }
        })
    }
      , d = function(E, K, H, V) {
        H = K = h(E, K, H);
        K = [];
        H = $jscomp.makeIterator(H);
        for (var S = H.next(); !S.done; S = H.next())
            S = S.value,
            E.columnApi.getColumn(S.colId) && K.push(S);
        E = K;
        if (V && V.length)
            for (K = E,
            E = [],
            K = $jscomp.makeIterator(K),
            H = K.next(); !H.done; H = K.next())
                H = H.value,
                V.includes(H.colId) && E.push(H);
        return K = m(E)
    }
      , h = function(E, K, H) {
        var V = E.columnApi.getAllColumns()
          , S = [];
        if (H) {
            H = {};
            V = $jscomp.makeIterator(V);
            for (var aa = V.next(); !aa.done; H = {
                $jscomp$loop$prop$col$671: H.$jscomp$loop$prop$col$671
            },
            aa = V.next())
                H.$jscomp$loop$prop$col$671 = aa.value,
                K.find(function(ra) {
                    return function(pa) {
                        return pa.colId === ra.$jscomp$loop$prop$col$671.colId
                    }
                }(H)) || S.push({
                    colState: {
                        colId: H.$jscomp$loop$prop$col$671.colId,
                        hide: !0
                    }
                })
        } else
            S = GridConfig.getNewColumns(E.context.pageId);
        if (S && S.length && Array.prototype.findIndex) {
            H = {};
            for (var ea in S)
                H.$jscomp$loop$prop$column$674 = S[ea],
                V = -1 < K.findIndex(function(ra) {
                    return function(pa) {
                        return pa.colId === ra.$jscomp$loop$prop$column$674.colState.colId
                    }
                }(H)),
                aa = null != E.columnApi.getColumn(H.$jscomp$loop$prop$column$674.colState.colId),
                !V && aa && (!1 === H.$jscomp$loop$prop$column$674.insertAfterColId ? K.splice(0, 0, H.$jscomp$loop$prop$column$674.colState) : (V = K.findIndex(function(ra) {
                    return function(pa) {
                        return pa.colId === ra.$jscomp$loop$prop$column$674.insertAfterColId
                    }
                }(H)),
                -1 < V ? K.splice(V + 1, 0, H.$jscomp$loop$prop$column$674.colState) : K.push(H.$jscomp$loop$prop$column$674.colState))),
                H = {
                    $jscomp$loop$prop$column$674: H.$jscomp$loop$prop$column$674
                }
        }
        return K
    }
      , m = function(E) {
        if (Array.prototype.findIndex) {
            var K = E.findIndex(function(H) {
                return "checkboxSelection" === H.colId
            });
            -1 < K && (E[K].hide = !0)
        }
        return E
    }
      , t = function() {
        var E = $.Deferred()
          , K = material.getButton("savePreset", "Save", null, "floppy-o")
          , H = material.getInput(!0, ".{1,50}", "presetName", "Preset name", "off", "presetName", "", "", !0)
          , V = I().map(function(na, qa) {
            return na ? {
                name: na.name,
                idx: qa
            } : null
        }).filter(function(na) {
            return na
        }).sort(function(na, qa) {
            na = na && na.name ? na.name.toUpperCase() : "";
            qa = qa && qa.name ? qa.name.toUpperCase() : "";
            return na < qa ? -1 : na > qa ? 1 : 0
        });
        K = '<div style="width:500px;margin-bottom:10px;">\n                        <p>You can save up to 10 column presets which can be applied to any of our ASIN tables*.</p>\n                    </div>\n\t\t\t\t\t<form name="savePresetForm" id="savePresetForm">\n\t\t\t\t\t    <section' + (11 <= V.length ? ' style="display:none"' : "") + '>\n\t\t\t\t\t\t    <p class="mdc-typography--caption" style="margin-top:15px;">Save current column configuration as:</p>\n\t\t\t\t\t\t    \n\t\t\t\t\t\t    <div style="display:flex">\n                                <div style="width:340px;margin-top:-16px;margin-right:20px;">\n                                    ' + H + '\n                                    <p id="presetName-validation-msg" class="mdc-text-field-helper-text"></p>\n                                </div>\n                                <div>' + K + '</div>\n\t\t                    </div>\n                        </section>\n\t\t\t\t\t    <section id="presetTable">\n\t\t\t\t\t\t    <p class="mdc-typography--caption" style="margin:15px 0;">Load and apply one of the presets below:</p>\n                        </section>\n\t\t\t\t\t</form>\n\t\t\t\t\t<hr class="-purple">\n                    <p class="mdc-typography--caption" style="font-size:11px;">\n                        * Product Finder, Product Viewer, Product Best Sellers or Seller Storefront\n                    </p>';
        var S = document.createElement("table");
        S.className = "table";
        H = $jscomp.makeIterator(V);
        for (var aa = H.next(); !aa.done; aa = H.next()) {
            aa = aa.value;
            var ea = document.createElement("tr")
              , ra = document.createElement("td");
            ra.style = "width:340px;";
            ra.textContent = aa.name;
            var pa = document.createElement("td");
            pa.className = "action";
            pa.innerHTML = '<span data-action="load-' + aa.idx + '"><i class="fa fa-upload -green" title="Load"></i> Load</span>';
            var ua = document.createElement("td");
            ua.className = "action";
            ua.innerHTML = '<span data-action="delete-' + aa.idx + '"><i class="fa fa-trash -tomato"></i> Delete</span>';
            ea.append(ra, pa, ua);
            S.appendChild(ea)
        }
        material.init("#savePresetForm");
        setTimeout(function() {
            document.getElementById("presetTable").appendChild(S);
            var na = !1
              , qa = ""
              , ka = function(za, J) {
                za = void 0 === za ? !0 : za;
                $("#savePreset").prop("disabled", za || 11 <= V.length);
                na = !za;
                $("#presetName-validation-msg").html(J)
            };
            ka(11 <= V.length);
            $("#presetName").on("input", function() {
                qa = $(this).val().trim();
                1 > qa.length || 50 < qa.length ? ka(!0, "The name must be between 1 and 50 characters long.") : V.some(function(za) {
                    return za.name === qa
                }) ? ka(!0, "The name is already taken.") : ka(!1, "")
            });
            $("#savePresetForm").on("submit", function(za) {
                na && E.resolve({
                    action: "save",
                    presetName: qa
                });
                E.resolve();
                za.preventDefault()
            });
            $("#savePresetForm [data-action]").click(function() {
                var za = $jscomp.makeIterator($(this).data("action").split("-"))
                  , J = za.next().value
                  , g = za.next().value;
                "delete" === J ? (r(g),
                V = V.filter(function(D) {
                    return D.idx !== Number(g)
                }),
                $(this).closest("tr").remove()) : E.resolve({
                    action: J,
                    presetIdx: g
                })
            })
        }, 0);
        return {
            onSubmit: E.promise(),
            html: K
        }
    }
      , f = function(E, K) {
        K = I()[K];
        K.columnState && (K = b(K.columnState),
        K = d(E, K, !0, null),
        E.columnApi.setColumnState(K),
        GridState.saveColumnState(E),
        GridTools.init(E))
    }
      , n = function(E, K, H) {
        var V = E.columnApi.getColumnState();
        E = I();
        K = K ? K : E.findIndex(function(S) {
            return S && S.name === H
        });
        H = H ? H : E[K].name;
        V = {
            name: H,
            columnState: a(V)
        };
        0 <= K ? E[K] = V : E.push(V);
        E = E.filter(function(S) {
            return S
        });
        storage.gridPresets = JSON.stringify(E);
        settings.send()
    }
      , r = function(E) {
        var K = I();
        K[E] = null;
        storage.gridPresets = JSON.stringify(K);
        settings.send()
    }
      , p = function(E) {
        var K = E.context.pageId;
        "manage" === K && E.context.config.activeViewMode && E.context.config.activeViewMode === GridManage.viewModes.COMPACT && (K += E.context.config.activeViewMode);
        return K
    }
      , z = function(E) {
        var K = {};
        (storage.gridVersion ? JSON.parse(storage.gridVersion) : null) === GridApi.version && storage.gridState && (K = JSON.parse(storage.gridState));
        "undefined" === typeof K[E] && (K[E] = {});
        return K
    }
      , F = function(E) {
        storage.gridState = JSON.stringify(E);
        storage.gridVersion = JSON.stringify(GridApi.version);
        settings.send()
    }
      , I = function() {
        var E = [];
        storage.gridPresets && (E = JSON.parse(storage.gridPresets));
        return E
    };
    return {
        saveColumnState: function(E) {
            var K = p(E)
              , H = z(K);
            E = E.columnApi.getColumnState();
            H[K].columnState = a(E);
            F(H)
        },
        restoreColumnState: function(E, K) {
            if (null != E.api && null != E.columnApi && E.context) {
                var H = p(E);
                try {
                    var V = z(H);
                    if (V[H] && V[H].columnState) {
                        var S = b(V[H].columnState);
                        S = d(E, S, !1, K);
                        E.columnApi.setColumnState(S)
                    }
                } catch (aa) {
                    reportBug(aa)
                }
            }
        },
        openColumnPresetPopup: function(E) {
            var K = t()
              , H = showPopup("Load/save column presets", K.html, !0);
            K.onSubmit.done(function(V) {
                V ? ("load" === V.action && f(E, V.presetIdx),
                "save" === V.action && n(E, V.presetIdx, V.presetName),
                settings.send().done(function() {
                    H.close()
                }).fail(showErrorPopup)) : H.close()
            })
        },
        saveSortModel: function(E) {
            if (null != E.api && E.context) {
                var K = p(E)
                  , H = z(K);
                E = E.api.getSortModel();
                H[K].sortModel = E;
                F(H)
            }
        },
        restoreSortModel: function(E, K) {
            if (null != E.api && null != E.columnApi) {
                var H = p(E)
                  , V = z(H);
                V[H] && V[H].sortModel && (K = V[H].sortModel);
                E.api.setSortModel(K)
            }
        }
    }
}()
  , GridConfig = function() {
    var a = "AMAZON NEW USED SALES COLLECTIBLE REFURBISHED TRADE_IN NEW_FBA NEW_FBM_SHIPPING LIGHTNING_DEAL WAREHOUSE BUY_BOX_SHIPPING USED_NEW_SHIPPING USED_VERY_GOOD_SHIPPING USED_GOOD_SHIPPING USED_ACCEPTABLE_SHIPPING EBAY_NEW_SHIPPING EBAY_USED_SHIPPING RENT".split(" ")
      , b = "SALES AMAZON NEW USED COLLECTIBLE REFURBISHED TRADE_IN NEW_FBA NEW_FBM_SHIPPING WAREHOUSE BUY_BOX_SHIPPING USED_NEW_SHIPPING USED_VERY_GOOD_SHIPPING USED_GOOD_SHIPPING USED_ACCEPTABLE_SHIPPING EBAY_NEW_SHIPPING EBAY_USED_SHIPPING RENT".split(" ")
      , d = {
        balham: 24
    }
      , h = function() {
        var u = {
            default: {
                gridId: "grid",
                gridClass: "grid ag-theme-balham",
                gridWrapperId: "grid-wrapper",
                gridWrapperClass: "grid-wrapper",
                gridOptions: {
                    autoSizePadding: 16,
                    columnTypes: {
                        booleanColumn: {
                            cellClass: "cell-icon",
                            cellRenderer: GridHelper.cellRendererBoolean,
                            pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                            filter: !1,
                            suppressMenu: !0,
                            suppressSizeToFit: !0
                        },
                        dateColumn: {
                            cellRenderer: GridHelper.cellRendererDateKeepaTime,
                            comparator: GridHelper.comparatorNumberNullLast,
                            icons: GridHelper.getIconsSortNumeric(),
                            pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                            filter: !1,
                            suppressMenu: !0,
                            suppressSizeToFit: !0,
                            valueGetter: GridHelper.valueGetterDateKeepaTime,
                            width: 94
                        },
                        dateAgoColumn: {
                            cellRenderer: GridHelper.cellRendererDateAgo,
                            comparator: GridHelper.comparatorDateAgo,
                            icons: GridHelper.getIconsSortNumeric(),
                            pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                            filter: !1,
                            suppressMenu: !0,
                            suppressSizeToFit: !0,
                            width: 100
                        },
                        deltaColumn: {
                            cellClass: "cell-number",
                            comparator: GridHelper.comparatorNumberNullLast,
                            equals: function() {
                                return !1
                            },
                            filter: "agNumberColumnFilter",
                            icons: GridHelper.getIconsSortNumeric(),
                            suppressSizeToFit: !0,
                            width: 88
                        },
                        deltaPercentColumn: {
                            cellClass: "cell-number",
                            comparator: GridHelper.comparatorNumberNullLast,
                            equals: function() {
                                return !1
                            },
                            filter: "agNumberColumnFilter",
                            icons: GridHelper.getIconsSortNumeric(),
                            suppressSizeToFit: !0,
                            width: 98
                        },
                        graphColumn: {
                            cellClass: ["cell-overflow"],
                            pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                            filter: !1,
                            suppressMenu: !0,
                            suppressSizeToFit: !0,
                            sortable: !1,
                            width: 200
                        },
                        manageVariationColumn: {
                            cellRenderer: function(v) {
                                return v.data.isDeleted ? "" : "" + GridHelper.defaultTextClamp(v.value, Math.max(2, v.data.multiLocaleProductsReduced.length))
                            },
                            valueGetter: function(v) {
                                return v.data.isDeleted ? null : v.data.product[v.colDef.field]
                            },
                            suppressSizeToFit: !1,
                            minWidth: 80,
                            width: 120
                        },
                        measureColumn: {
                            cellClass: "cell-number",
                            comparator: GridHelper.comparatorNumberNullLast,
                            filter: "agNumberColumnFilter",
                            hide: !0,
                            icons: GridHelper.getIconsSortNumeric(),
                            suppressSizeToFit: !0,
                            valueFormatter: GridHelper.valueFormatterMeasure,
                            valueGetter: GridHelper.valueGetterMeasure,
                            width: 100
                        },
                        numberColumn: {
                            cellClass: "cell-number",
                            comparator: GridHelper.comparatorNumberNullLast,
                            equals: function() {
                                return !1
                            },
                            filter: "agNumberColumnFilter",
                            icons: GridHelper.getIconsSortNumeric(),
                            valueFormatter: function(v) {
                                return null == v.value ? "-" : NumberUtil.format(v.value)
                            }
                        },
                        numberSalesRankColumn: {
                            cellRenderer: function(v) {
                                return '<span style="color:' + CsvType.SALES.color + ';">' + v.valueFormatted + "</span>"
                            },
                            valueFormatter: function(v) {
                                return null == v.value ? "-" : CsvType.format("SALES", v.value)
                            }
                        },
                        offerCountColumn: {
                            cellClass: "cell-number",
                            cellRenderer: GridHelper.cellRendererCsvType,
                            comparator: GridHelper.comparatorNumberNullLast,
                            equals: function() {
                                return !1
                            },
                            filter: "agNumberColumnFilter",
                            icons: GridHelper.getIconsSortNumeric(),
                            suppressSizeToFit: !0,
                            valueFormatter: GridHelper.valueFormatterCsvType,
                            valueGetter: GridHelper.valueGetterNoNegative,
                            width: 88
                        },
                        priceColumn: {
                            cellClass: "cell-number",
                            cellRenderer: GridHelper.cellRendererCsvType,
                            comparator: GridHelper.comparatorNumberNullLast,
                            equals: function() {
                                return !1
                            },
                            filter: "agNumberColumnFilter",
                            filterParams: {
                                filterOptions: [{
                                    displayKey: "nullValue",
                                    displayName: la._666,
                                    hideFilterInput: !0,
                                    test: function(v, G) {
                                        return null == G
                                    }
                                }, "equals", "notEqual", "lessThan", "lessThanOrEqual", "greaterThan", "greaterThanOrEqual", "inRange"],
                                defaultOption: "equals",
                                suppressAndOrCondition: !0
                            },
                            icons: GridHelper.getIconsSortNumeric(),
                            suppressSizeToFit: !0,
                            valueFormatter: GridHelper.valueFormatterPrice,
                            valueGetter: GridHelper.valueGetterPrice,
                            width: 91
                        },
                        productCodeColumn: {
                            cellClass: "cell-id cell-wrap",
                            cellRenderer: GridHelper.cellRendererProductCodes,
                            suppressSizeToFit: !0,
                            sortable: !1,
                            width: 105
                        },
                        salesRankColumn: {
                            cellClass: "cell-number",
                            cellRenderer: GridHelper.cellRendererCsvType,
                            comparator: GridHelper.comparatorNumberNullLast,
                            equals: function() {
                                return !1
                            },
                            filter: "agNumberColumnFilter",
                            filterParams: {
                                filterOptions: [{
                                    displayKey: "nullValue",
                                    displayName: "No Sales Rank",
                                    hideFilterInput: !0,
                                    test: function(v, G) {
                                        return null == G
                                    }
                                }, "equals", "notEqual", "lessThan", "lessThanOrEqual", "greaterThan", "greaterThanOrEqual", "inRange"],
                                defaultOption: "equals",
                                suppressAndOrCondition: !0
                            },
                            icons: GridHelper.getIconsSortNumeric(),
                            suppressSizeToFit: !0,
                            valueFormatter: GridHelper.valueFormatterCsvType,
                            valueGetter: GridHelper.valueGetterSalesRank,
                            width: 91
                        },
                        stockSingleColumn: {
                            cellClass: "cell-number",
                            cellRenderer: GridHelper.cellRendererStockSingle,
                            comparator: GridHelper.comparatorNumberNullLast,
                            filter: "agNumberColumnFilter",
                            icons: GridHelper.getIconsSortNumeric(),
                            suppressSizeToFit: !0,
                            valueFormatter: GridHelper.valueFormatterStockSingle,
                            valueGetter: GridHelper.valueGetterStockSingle,
                            width: 76
                        },
                        trackingColumn: {
                            cellClass: "cell-number",
                            cellRenderer: GridHelper.cellRendererTracking,
                            comparator: GridHelper.comparatorNumberArrayNullLast,
                            getQuickFilterText: function(v) {
                                return ""
                            },
                            filter: "customNumberArrayColumnFilter",
                            filterParams: {
                                filterOptions: [{
                                    displayKey: "nullValue",
                                    displayName: "No value",
                                    hideFilterInput: !0,
                                    test: function(v, G) {
                                        return Array.isArray(G) ? G.some(function(w) {
                                            return null == w
                                        }) : null == G
                                    }
                                }, "equals", "notEqual", "lessThan", "lessThanOrEqual", "greaterThan", "greaterThanOrEqual", "inRange"],
                                defaultOption: "lessThanOrEqual",
                                suppressAndOrCondition: !0
                            },
                            icons: GridHelper.getIconsSortNumeric(),
                            lockPinned: !0,
                            minWidth: 50,
                            width: 110,
                            maxWidth: 190,
                            suppressSizeToFit: !0,
                            valueFormatter: GridHelper.valueFormatterTracking,
                            valueGetter: GridHelper.valueGetterTracking
                        },
                        hiddenColumn: {
                            getQuickFilterText: function(v) {
                                return null
                            },
                            headerNameGroup: "[hidden]",
                            hide: !0,
                            lockVisible: !0,
                            suppressToolPanel: !0
                        }
                    },
                    colWidth: 100,
                    defaultColDef: {
                        equals: GridHelper.valuesAreEqual,
                        filter: "agTextColumnFilter",
                        filterParams: {
                            suppressAndOrCondition: !0
                        },
                        resizable: !0,
                        sortable: !0
                    },
                    minColWidth: 30,
                    suppressMenuHide: !0,
                    accentedSort: !0,
                    enableRangeSelection: !1,
                    rowDeselection: !0,
                    rowSelection: "multiple",
                    headerHeight: d.balham,
                    rowData: null,
                    rowModelType: "clientSide",
                    pagination: !0,
                    paginationPageSize: 100,
                    icons: GridHelper.getIconsDefault(),
                    rowHeight: d.balham,
                    scrollbarWidth: isChrome ? 8 : 17,
                    overlayLoadingTemplate: getLoaderBox(!0),
                    overlayNoRowsTemplate: '<span class="grid-no-data">No data available</span>',
                    debug: !1,
                    rowBuffer: 1,
                    suppressContextMenu: !0,
                    suppressExcelExport: !0,
                    components: {
                        customAutocompleteColumnFilter: GridFilter.AutocompleteFilter,
                        customBooleanColumnFilter: GridFilter.BooleanFilter,
                        customDynamicColumnFilter: GridFilter.DynamicFilter,
                        customSingleChoiceColumnFilter: GridFilter.SingleChoiceFilter,
                        customSingleChoiceRadioColumnFilter: GridFilter.SingleChoiceRadioFilter
                    },
                    fullWidthCellRenderer: function(v) {
                        var G = document.createElement("div");
                        G.className = "ag-cell ag-cell-not-inline-editing ag-cell-no-focus ag-force-no-hover";
                        G.innerHTML = '<div class="row-free-access"><i class="fa fa-arrow-circle-o-right"></i>&ensp;' + v.data.message + "</div>";
                        return G
                    },
                    isFullWidthCell: function(v) {
                        return "undefined" === typeof v.data ? !1 : v.data.freeAccessRow
                    },
                    localeTextFunc: function(v, G) {
                        v = {
                            applyFilter: '<i class="fa fa-caret-right"></i> Apply',
                            autosizeAllColumns: la._682,
                            average: la._385,
                            blanks: la._809,
                            clearFilter: la._596,
                            contains: la._597,
                            copy: la._677,
                            copyWithHeaders: la._678,
                            ctrlC: la._679,
                            endsWith: la._598,
                            equals: la._599,
                            filterOoo: la._177,
                            first: la._610,
                            greaterThan: la._601,
                            greaterThanOrEqual: la._602,
                            inRange: la._603,
                            isNoneOf: "Is none of",
                            isOneOf: "Is one of",
                            last: la._611,
                            lessThan: la._604,
                            lessThanOrEqual: la._605,
                            loadingOoo: la._600,
                            next: la._612,
                            noRowsToShow: la._606,
                            notContains: la._607,
                            notEqual: la._608,
                            nullValue: la._666,
                            of: la._613,
                            page: la._292,
                            previous: la._614,
                            selectAll: la._671,
                            startsWith: la._609,
                            to: la._615
                        }[v];
                        return "undefined" !== typeof v ? v : G
                    },
                    postProcessPopup: function(v) {
                        if ("columnMenu" === v.type) {
                            var G = v.ePopup;
                            v = ["casin", "variation"].includes(v.column.gridOptionsWrapper.gridOptions.context.pageId) ? 1 : 2;
                            G.style.top = d.balham * v - 4 + "px"
                        }
                    }
                }
            },
            asin: {
                gridId: "grid-asin",
                gridWrapperId: "grid-wrapper-asin",
                gridOptions: {
                    pagination: !1,
                    getRowClass: function(v) {
                        if ("undefined" === typeof v.data)
                            return null;
                        var G = [];
                        3 === v.data.productType && G.push("row-product-inaccessible");
                        return G.length ? G.join(" ") : null
                    },
                    getRowHeight: function(v) {
                        return v && v.node.data.freeAccessRow ? d.balham + 8 : 3 * (d.balham - 8) + 8
                    }
                }
            },
            asinViewer: {},
            asinDeals: {
                gridId: "grid-asin-deals",
                gridWrapperId: "grid-wrapper-asin-deals",
                gridOptions: {
                    rowModelType: "infinite",
                    cacheBlockSize: 150,
                    cacheOverflowSize: 0,
                    infiniteInitialRowCount: 0,
                    maxConcurrentDatasourceRequests: 1,
                    paginationPageSize: 150,
                    rowHeight: 3 * (d.balham - 8) + 8
                }
            },
            asinFinder: {
                gridId: "grid-asin-finder",
                gridWrapperId: "grid-wrapper-asin-finder",
                gridOptions: {
                    rowModelType: "infinite",
                    cacheBlockSize: 100,
                    cacheOverflowSize: 0,
                    infiniteInitialRowCount: 0,
                    maxBlocksInCache: 1,
                    maxConcurrentDatasourceRequests: 1,
                    rowHeight: 3 * (d.balham - 8) + 8
                }
            },
            buyBoxStatistics: {
                gridId: "grid-buy-box-statistics",
                gridWrapperId: "grid-wrapper-buy-box-statistics",
                gridOptions: {
                    defaultColDef: {
                        filter: !1,
                        resizable: !0,
                        suppressMenu: !0,
                        suppressSizeToFit: !0,
                        width: 100
                    },
                    pagination: !1
                }
            },
            casin: {
                gridId: "grid-casin",
                gridWrapperId: "grid-wrapper-casin",
                gridOptions: {
                    defaultColDef: {
                        equals: GridHelper.valuesAreEqual,
                        filter: "agTextColumnFilter",
                        filterParams: {
                            suppressAndOrCondition: !0
                        },
                        resizable: !0,
                        sortable: !0,
                        sortingOrder: ["asc", "desc"]
                    },
                    minColWidth: 20,
                    autoGroupColumnDef: {
                        cellClass: "cell-right",
                        cellRenderer: function(v) {
                            return null == v.value ? "" : LocaleType.getContinentName(v.data.domainId)
                        },
                        headerName: "",
                        suppressMenu: !0,
                        suppressSizeToFit: !0,
                        width: 110,
                        minColWidth: 110
                    },
                    groupDefaultExpanded: 1,
                    groupHideOpenParents: !0,
                    defaultGroupSortComparator: function(v, G) {
                        v = Number(v.key);
                        G = Number(G.key);
                        return isFirefox ? v - G : G - v
                    },
                    pagination: !1
                }
            },
            category: {
                gridId: "grid-category",
                gridWrapperId: "grid-wrapper-category",
                gridOptions: {
                    autoGroupColumnDef: {
                        cellClassRules: {
                            "cell-group-no-children": function(v) {
                                return "undefined" === typeof v.data || null == v.data.children || 0 === v.data.children.length
                            }
                        },
                        className: "cell-autogroup",
                        field: "name1",
                        headerName: "Category Tree",
                        suppressSizeToFit: !1,
                        width: 600
                    },
                    defaultColDef: {
                        filter: !1,
                        resizable: !1,
                        sortable: !1,
                        suppressMenu: !0,
                        suppressSizeToFit: !0,
                        width: 100
                    },
                    rowModelType: "serverSide",
                    cacheBlockSize: 500,
                    rowGroupPanelShow: "never",
                    pagination: !1,
                    suppressContextMenu: !1,
                    getContextMenuItems: function(v) {
                        return ["copy", "copyWithHeaders"]
                    },
                    getRowNodeId: function(v) {
                        return v.catId
                    },
                    getChildCount: function(v) {
                        return "undefined" === typeof v || 0 === v.parent ? -1 : null === v.children || 0 === v.children.length ? -1 : v.children.length
                    }
                }
            },
            lightningDeal: {
                gridId: "grid-lightning-deal",
                gridWrapperId: "grid-wrapper-lightning-deal",
                gridOptions: {
                    pagination: !1,
                    suppressContextMenu: !1,
                    getContextMenuItems: function(v) {
                        return ["copy", "copyWithHeaders"]
                    },
                    getRowHeight: function(v) {
                        return 2 * (d.balham - 8) + 8
                    },
                    onGridSizeChanged: function(v) {
                        setTimeout(function() {
                            v.api.sizeColumnsToFit()
                        })
                    }
                }
            },
            manage: {
                gridId: "grid-manage",
                gridWrapperId: "grid-wrapper-manage",
                gridOptions: {
                    enableRangeSelection: !0,
                    cacheQuickFilter: !0,
                    groupDefaultExpanded: 1,
                    pagination: !0,
                    paginationPageSize: 1E4,
                    suppressPaginationPanel: !0,
                    detailCellRendererParams: {},
                    masterDetail: !0,
                    suppressCopyRowsToClipboard: !0,
                    suppressContextMenu: !1,
                    components: {
                        cellEditorAutocompleteChips: GridCellEditorComponents.AutocompleteChips,
                        cellEditorMetaData: GridCellEditorComponents.MetaData,
                        cellEditorThresholdBooleanValues: GridCellEditorComponents.ThresholdBooleanValues,
                        cellEditorThresholdValues: GridCellEditorComponents.ThresholdValues,
                        customNumberArrayColumnFilter: GridFilter.NumberArrayFilter,
                        customResetHeader: GridComponents.CustomResetHeader
                    },
                    getContextMenuItems: function(v) {
                        if (null === v.node)
                            return [];
                        var G = v.columnApi
                          , w = v.node.data;
                        return [{
                            name: la._681,
                            action: function() {
                                var B = "#!track/" + w.domainId + "-" + w.asin;
                                iframe.isIframe ? window.open(getBaseUrl() + B, "_blank").focus() : window.open(B, "_self")
                            },
                            icon: '<i class="fa fa-bell-o"></i>',
                            cssClasses: ["menu-option-bold"]
                        }, "separator", "copy", "copyWithHeaders", "separator", "autoSizeAll", {
                            name: la._680,
                            action: function() {
                                G.resetColumnState();
                                v.api.sizeColumnsToFit();
                                GridState.saveColumnState(v)
                            }
                        }]
                    },
                    getRowClass: function(v) {
                        if ("undefined" === typeof v.data)
                            return null;
                        var G = [];
                        v.data.isDeleted && G.push("row-deleted");
                        v.context.config.activeViewMode !== GridManage.viewModes.COMPACT || v.data.multiLocaleProductsReduced.length || G.push("row-padding");
                        return G.length ? G.join(" ") : null
                    },
                    getRowHeight: function(v) {
                        if (v.node.detail)
                            return v.data.detailRowHeight;
                        var G = 1;
                        if (v.data.multiLocaleProductsReduced.length) {
                            v = $jscomp.makeIterator(v.data.multiLocaleProductsReduced);
                            for (var w = v.next(); !w.done; w = v.next())
                                G++
                        } else
                            v.context.config.activeViewMode === GridManage.viewModes.COMPACT && (G += 1);
                        return G * (d.balham - 2) + 2
                    },
                    processCellForClipboard: GridHelper.processCellForClipboard,
                    processHeaderForClipboard: GridHelper.processHeaderForClipboard,
                    onFilterChanged: function(v) {
                        var G = 0 < Object.keys(v.api.getFilterModel()).length;
                        v = null != v.api.filterManager.quickFilter && 0 < v.api.filterManager.quickFilter.length;
                        G || v ? $("#fab-reset").show() : $("#fab-reset").hide();
                        GridManage.removeDeletedRows(!0);
                        GridManage.adjustGridHeight();
                        GridManage.updateRowCount()
                    },
                    onGridReady: function(v) {
                        window.addEventListener("resize", function() {
                            setTimeout(function() {
                                GridPage.resizeToViewPort(v.api.gridOptionsWrapper.gridOptions.context.config, !0);
                                v.api.gridOptionsWrapper.gridOptions.context.config.maxHeight = $("#" + v.api.gridOptionsWrapper.gridOptions.context.gridWrapperId).height();
                                v.api.sizeColumnsToFit();
                                $("#grid-wrapper-lightning-deal").length && $("#grid-wrapper-lightning-deal").width($("#grid-wrapper-manage").width() + "px")
                            })
                        })
                    },
                    onGridSizeChanged: function(v) {
                        setTimeout(function() {
                            v.api.sizeColumnsToFit()
                        })
                    }
                }
            },
            manageDetail: {
                detailGridOptions: {
                    columnDefs: GridConfig.getColumns("manageDetail"),
                    cacheQuickFilter: !0,
                    headerHeight: 0,
                    overlayLoadingTemplate: '<div class="grid-loading-simple"></div>',
                    suppressContextMenu: !0,
                    components: {
                        cellEditorImagesCsv: GridCellEditorComponents.ImagesCsv
                    },
                    getRowClass: function(v) {
                        return "undefined" === typeof v.data ? null : v.data.isDeleted ? "row-deleted" : null
                    },
                    getRowHeight: function(v) {
                        return v.data.detailRowHeight
                    },
                    onGridReady: function(v) {},
                    onGridSizeChanged: function(v) {
                        setTimeout(function() {
                            var G = Math.max(720, window.innerWidth - 275)
                              , w = v.columnApi.getColumn("graphData").actualWidth;
                            G != w && (v.columnApi.setColumnWidth("graphData", G),
                            graph.resizeGraphs(!0))
                        })
                    }
                },
                getDetailRowData: function(v) {
                    var G = v.data.detailRowData;
                    G && G.length ? (v.data.isDeleted && (G[0].isDeleted = !0),
                    v.successCallback(G)) : network.request({
                        path: "product",
                        asin: v.data.asin,
                        domainId: v.data.detailDomainId,
                        getTracking: !0,
                        history: !0,
                        maxAge: 15,
                        offerPages: 0,
                        refreshProduct: !1,
                        type: "manage",
                        version: 3
                    }).done(function(w) {
                        if (null != w && null != w.products && 1 == w.products.length) {
                            w = GridHelper.prepareProductTrackingDetail(w.products[0]);
                            var B = GridManage.calculateDetailRowHeight(w)
                              , Q = w.domainId === v.data.domainId ? B : v.data.detailRowHeight;
                            G.detailDomainId = v.data.detailDomainId;
                            var fa = {};
                            G.push({
                                detailDomainId: v.data.detailDomainId,
                                detailsPerDomain: (fa[w.domainId] = {
                                    asin: w.asin,
                                    domainId: w.domainId,
                                    imagesCSV: w.imagesCSV,
                                    title: w.title,
                                    lastUpdate: w.lastUpdate,
                                    lastEbayUpdate: w.lastEbayUpdate,
                                    lastPriceChange: w.lastPriceChange,
                                    graphData: {
                                        buyBoxSellerIdHistory: w.buyBoxSellerIdHistory,
                                        csv: w.csv,
                                        offers: w.offers,
                                        tracking: v.data.tracking
                                    },
                                    detailRowHeight: B
                                },
                                fa),
                                wishLists: v.data.wishLists,
                                conditionsMet: v.data.conditionsMet,
                                detailRowHeight: Q
                            });
                            v.data.detailRowData = G
                        }
                        v.successCallback(v.data.detailRowData)
                    }).fail(showErrorPopup)
                }
            },
            offer: {
                gridId: "grid-offer",
                gridWrapperId: "grid-wrapper-offer",
                gridOptions: {
                    defaultColDef: {
                        filter: !1,
                        suppressMenu: !0
                    },
                    pagination: !1,
                    getRowHeight: function(v) {
                        var G = 6;
                        v && v.node.rowPinned && (G = 2);
                        return G * (d.balham - 8) + 8
                    },
                    getRowStyle: function(v) {
                        return v.data.isScam ? {
                            opacity: "0.4"
                        } : null
                    }
                }
            },
            productDetail: {
                gridId: "grid-product-detail",
                gridWrapperId: "grid-wrapper-product-detail",
                gridOptions: {
                    pagination: !1,
                    domLayout: "autoHeight",
                    components: {
                        cellRendererAutoHeightRow: GridCellRendererComponents.AutoHeightRow
                    },
                    onFirstDataRendered: function(v) {
                        setTimeout(function() {
                            v.api.forEachNode(function(G) {
                                G = v.api.getCellRendererInstances({
                                    rowNodes: [G],
                                    columns: ["productValue"]
                                });
                                0 < G.length && G[0].updateRowHeight()
                            })
                        }, 0);
                        iframe.isIframe && setTimeout(addon, 2)
                    }
                }
            },
            productPrice: {
                gridId: "grid-product-price",
                gridWrapperId: "grid-wrapper-product-price",
                gridOptions: {
                    pagination: !1,
                    domLayout: "autoHeight"
                }
            },
            seller: {
                gridId: "grid-seller",
                gridWrapperId: "grid-wrapper-seller",
                gridOptions: {
                    getRowHeight: function(v) {
                        return v.node.data.freeAccessRow ? d.balham + 8 : d.balham
                    }
                }
            },
            sellerbrandstatistic: {
                gridId: "grid-sellerbrandstatistic",
                gridWrapperId: "grid-wrapper-sellerbrandstatistic",
                gridOptions: {
                    defaultColDef: {
                        filter: !1,
                        resizable: !1,
                        suppressMenu: !0,
                        suppressSizeToFit: !0,
                        width: 100
                    },
                    pagination: !1
                }
            },
            sellercategorystatistic: {
                gridId: "grid-sellercategorystatistic",
                gridWrapperId: "grid-wrapper-sellercategorystatistic",
                gridOptions: {
                    defaultColDef: {
                        filter: !1,
                        resizable: !1,
                        suppressMenu: !0,
                        suppressSizeToFit: !0,
                        width: 100
                    },
                    pagination: !1
                }
            },
            search: {
                gridId: "grid-search",
                gridWrapperId: "grid-wrapper-search",
                gridOptions: {
                    defaultColDef: {
                        filter: !1,
                        suppressMenu: !0
                    },
                    pagination: !1,
                    getRowHeight: function(v) {
                        return 6 * (d.balham - 8) + 8
                    }
                }
            },
            variation: {
                gridId: "grid-variation",
                gridWrapperId: "grid-wrapper-variation",
                gridOptions: {
                    pagination: !1,
                    getRowHeight: function(v) {
                        return v && v.node.data.freeAccessRow ? d.balham + 8 : 6 * (d.balham - 8) + 8
                    },
                    onFilterChanged: function(v) {
                        GridTools.updateResults("variation", v.api.getDisplayedRowCount())
                    }
                }
            }
        };
        u.asinViewer = u.asin;
        return u
    }
      , m = function(u, v) {
        var G = h();
        G = $.extend(!0, G.default, G[u]);
        G.gridOptions.columnDefs = t(u, v);
        "manage" === u && (GridManage.pageConfig.activeViewMode === GridManage.viewModes.COMPACT ? G.gridOptions.masterDetail = !1 : G.gridOptions.detailCellRendererParams = m("manageDetail"));
        return G
    }
      , t = function(u, v) {
        var G = []
          , w = [];
        switch (u) {
        case "asin":
        case "asinViewer":
            w = f(u);
            break;
        case "asinDeals":
            w = n(u, v);
            break;
        case "asinFinder":
            w = r(u);
            break;
        case "buyBoxStatistics":
            w = z();
            break;
        case "casin":
            w = F();
            break;
        case "category":
            w = I();
            break;
        case "lightningDeal":
            w = p();
            break;
        case "manage":
            w = E();
            break;
        case "manageDetail":
            w = K();
            break;
        case "offer":
            w = H();
            break;
        case "productDetail":
            w = V();
            break;
        case "productPrice":
            w = S();
            break;
        case "search":
            w = pa();
            break;
        case "seller":
            w = aa();
            break;
        case "sellerbrandstatistic":
            w = ea();
            break;
        case "sellercategorystatistic":
            w = ra();
            break;
        case "variation":
            w = ua()
        }
        var B = "manage" === u ? ["filterMenuTab", "columnsMenuTab"] : ["filterMenuTab"];
        u = {};
        for (var Q in w)
            u.$jscomp$loop$prop$id$676 = Q,
            w[u.$jscomp$loop$prop$id$676].children ? w[u.$jscomp$loop$prop$id$676].children.forEach(function(R) {
                return function(T, oa) {
                    w[R.$jscomp$loop$prop$id$676].children[oa].menuTabs = !0 === w[R.$jscomp$loop$prop$id$676].children[oa].suppressMenu ? [] : B
                }
            }(u)) : w[u.$jscomp$loop$prop$id$676].menuTabs = !0 === w[u.$jscomp$loop$prop$id$676].suppressMenu ? [] : B,
            u = {
                $jscomp$loop$prop$id$676: u.$jscomp$loop$prop$id$676
            };
        for (var fa in w)
            G.push(w[fa]);
        return G
    }
      , f = function(u) {
        u = u || "asin";
        var v = GridHelper.getCurrentUnits();
        v = {
            checkboxSelection: GridConfig.gridTypesWithCheckboxSelection.includes(u) ? {
                headerName: "",
                field: "checkboxSelection",
                checkboxSelection: !0,
                headerCheckboxSelection: !0,
                headerCheckboxSelectionFilteredOnly: !0,
                hide: !0,
                lockPinned: !0,
                pinned: "left",
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                sortable: !1,
                suppressToolPanel: !0,
                width: 30
            } : {},
            domainId: {
                headerName: "",
                field: "domainId",
                cellClass: "cell-icon",
                cellRenderer: GridHelper.cellRendererDomainId,
                filter: !1,
                suppressMenu: !0,
                resizable: !1,
                suppressSizeToFit: !0,
                sortable: !1,
                suppressToolPanel: !0,
                width: 20
            },
            imagesCSV: {
                headerName: la._589,
                field: "imagesCSV",
                cellClass: "cell-image",
                cellRenderer: GridHelper.cellRendererImage,
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                sortable: !1,
                width: 54
            },
            title: {
                headerName: la._590,
                field: "title",
                cellRenderer: GridHelper.cellRendererTitle,
                lockVisible: !0,
                minWidth: 140,
                width: 200
            },
            groupSalesRank: na("SALES", u),
            groupReviews: GridHelperReviews.getColumnGroupReviews(),
            dealFound: "asinDeals" === u ? {
                headerName: "Deal found",
                field: "dealFound",
                type: ["dateAgoColumn"]
            } : {},
            lastPriceChange: {
                headerName: "Last Price Change",
                field: "lastPriceChange",
                type: ["dateAgoColumn"],
                width: 114
            },
            lastUpdate: {
                headerName: "Last Update",
                field: "lastUpdate",
                type: ["dateAgoColumn"],
                hide: !0,
                width: 114
            },
            lastOffersUpdate: {
                headerName: "Last Offer Update",
                field: "lastOffersUpdate",
                type: ["dateAgoColumn"],
                hide: !0,
                valueGetter: function(w) {
                    return "undefined" === typeof w.data ? null : w.data.stats.lastOffersUpdate
                },
                width: 114
            },
            groupPriceAmazon: na("AMAZON", u),
            newPriceIsMAP: {
                headerName: "" + la._907,
                headerTooltip: "Whether or not the lowest new price (either price type Amazon or New)<br>is restricted by MAP (Minimum Advertised Price). Use this to differentiate<br>out of stock vs. MAP restriction.",
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate("", '<i class="fa fa-info"></i>')
                },
                field: "newPriceIsMAP",
                type: ["booleanColumn"],
                hide: !0,
                width: 120
            },
            groupPriceNew: na("NEW", u),
            groupPriceNewFBA: na("NEW_FBA", u),
            sellerIdsLowestFBA: A("FBA"),
            fbaFees: D(),
            groupPriceNewFBMShipping: na("NEW_FBM_SHIPPING", u),
            sellerIdsLowestFBM: A("FBM"),
            groupPriceUsed: na("USED", u),
            groupPriceListprice: na("LISTPRICE", u),
            groupPriceLightningDeal: na("LIGHTNING_DEAL", u),
            groupPriceWarehouse: na("WAREHOUSE", u),
            groupPriceCollectable: na("COLLECTIBLE", u),
            groupPriceRefurbished: na("REFURBISHED", u),
            groupOfferCountNew: ka("COUNT_NEW"),
            groupOfferSellerCountNew: {
                headerName: "Count of retrieved live offers",
                children: [N("FBA"), N("FBM")]
            },
            groupOfferCountUsed: ka("COUNT_USED"),
            groupOfferCountRefurbished: ka("COUNT_REFURBISHED"),
            groupOfferCountCollectible: ka("COUNT_COLLECTIBLE"),
            groupPriceBuyBoxShipping: na("BUY_BOX_SHIPPING", u),
            buyBoxSellerIdHistory: {
                headerName: "Buy Box Seller",
                field: "buyBoxSellerIdHistory",
                cellRenderer: GridHelper.cellRendererBuyBoxSellerId,
                filter: "agSetColumnFilter",
                filterParams: {
                    cellHeight: 22,
                    suppressAndOrCondition: !0,
                    suppressMiniFilter: !0,
                    suppressRemoveEntries: !0
                },
                filterValueGetter: function(w) {
                    if ("undefined" === typeof w.data || null == w.data.asin)
                        return "-";
                    var B = w.data.buyBoxSellerIdHistory;
                    if (null == B)
                        return "-";
                    if (!Array.isArray(B))
                        return "3rd Party";
                    if (0 >= B.length || w.data.offersOutdated)
                        return "-";
                    B = getLast(B, CsvType.AMAZON);
                    return -1 == B ? "-" : isSellerIdAmazon(B, w.data.domainId) ? "Amazon" : "3rd Party"
                },
                suppressSizeToFit: !0,
                valueGetter: GridHelper.valueGetterBuyBoxSellerId,
                width: 110
            },
            buyBoxIsFBA: {
                headerName: "Buy Box: Is FBA",
                headerTooltip: "Whether or not the buy box is fulfilled by Amazon",
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate("", '<i class="fa fa-info"></i>')
                },
                field: "buyBoxIsFBA",
                type: ["booleanColumn"],
                valueGetter: GridHelper.valueGetterStats,
                width: 135
            },
            buyBoxIsUnqualified: {
                headerName: "Buy Box: Unqualified",
                headerTooltip: "Whether or not a seller won the buy box. If there are only sellers with bad offers none qualifies for the buy box.",
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate("", '<i class="fa fa-info"></i>')
                },
                field: "buyBoxIsUnqualified",
                type: ["booleanColumn"],
                valueGetter: GridHelper.valueGetterStats,
                width: 135
            },
            groupPriceUsedNewShipping: na("USED_NEW_SHIPPING", u),
            groupPriceUsedVeryGoodShipping: na("USED_VERY_GOOD_SHIPPING", u),
            groupPriceUsedGoodShipping: na("USED_GOOD_SHIPPING", u),
            groupPriceUsedAcceptableShipping: na("USED_ACCEPTABLE_SHIPPING", u),
            groupPriceCollectibleNewShipping: na("COLLECTIBLE_NEW_SHIPPING", u),
            groupPriceCollectibleVeryGoodShipping: na("COLLECTIBLE_VERY_GOOD_SHIPPING", u),
            groupPriceCollectibleGoodShipping: na("COLLECTIBLE_GOOD_SHIPPING", u),
            groupPriceCollectibleAcceptableShipping: na("COLLECTIBLE_ACCEPTABLE_SHIPPING", u),
            groupPriceRefurbishedShipping: na("REFURBISHED_SHIPPING", u),
            groupPriceEbayNewShipping: na("EBAY_NEW_SHIPPING", u),
            groupPriceEbayUsedShipping: na("EBAY_USED_SHIPPING", u),
            groupPriceTradeIn: na("TRADE_IN", u),
            groupPriceRent: na("RENT", u),
            trackingSince: {
                headerName: "Tracking since",
                field: "trackingSince",
                type: ["dateColumn"]
            },
            listedSince: {
                headerName: "Listed since",
                field: "listedSince",
                type: ["dateColumn"]
            },
            groupUrls: {
                headerName: "URL",
                children: [{
                    headerName: "Amazon",
                    headerNameGroup: "URL",
                    field: "urlAmazon",
                    cellRenderer: function(w) {
                        return "undefined" === typeof w.data ? "" : '<a href="' + w.value + '" target="_blank">' + w.value + "</a>"
                    },
                    hide: !0,
                    suppressSizeToFit: !0,
                    valueGetter: function(w) {
                        return "undefined" === typeof w.data ? "" : "https://www.amazon." + getTldByDomain(w.data.domainId) + "/dp/" + w.data.asin
                    },
                    width: 120
                }, {
                    headerName: "Keepa",
                    headerNameGroup: "URL",
                    field: "urlKeepa",
                    cellRenderer: function(w) {
                        return "undefined" === typeof w.data ? "" : '<a href="' + w.value + '" target="_blank">' + w.value + "</a>"
                    },
                    hide: !0,
                    suppressSizeToFit: !0,
                    valueGetter: function(w) {
                        return "undefined" === typeof w.data ? "" : "https://keepa.com/#!product/" + w.data.domainId + "-" + w.data.asin
                    },
                    width: 120
                }]
            },
            groupCategories: {
                headerName: la._202,
                children: [{
                    headerName: "Root",
                    headerNameGroup: la._202,
                    field: "rootCategory",
                    cellRenderer: function(w) {
                        return "undefined" === typeof w.data || w.data.rootCategory > invalidIfLargerCatId ? "" : GridHelperCategory.render(w.data.domainId, w.data.rootCategory, w.value, w)
                    },
                    suppressSizeToFit: !0,
                    valueGetter: GridHelperCategory.valueGetterRootCategory,
                    width: 160
                }, {
                    headerName: "Sub",
                    headerNameGroup: la._202,
                    field: "categories",
                    cellClass: "cell-wrap",
                    cellRenderer: function(w) {
                        if ("undefined" === typeof w.data)
                            return "";
                        var B = w.data.categories;
                        if (null == B || "undefined" === typeof B)
                            return "";
                        var Q = w.data.domainId;
                        if ("finder" === w.context.pageId) {
                            var fa = document.createElement("div");
                            B.forEach(function(T, oa) {
                                var Z = GridHelperCategory.getName(Q, T);
                                T = GridHelperCategory.render(Q, T, Z, w);
                                oa < B.length - 1 ? fa.appendChild(T).insertAdjacentHTML("beforeend", " / ") : fa.appendChild(T)
                            });
                            return fa
                        }
                        var R = "";
                        B.forEach(function(T, oa) {
                            var Z = GridHelperCategory.getName(Q, T);
                            T = GridHelperCategory.render(Q, T, Z, w);
                            R += (0 < oa ? " / " : "") + ("object" === typeof T ? T.outerHTML : T)
                        });
                        return R
                    },
                    suppressSizeToFit: !0,
                    sortable: !1,
                    valueGetter: GridHelperCategory.valueGetterCategories,
                    width: 240
                }, {
                    headerName: "Tree",
                    headerNameGroup: la._202,
                    field: "categoryTree",
                    cellClass: "cell-wrap",
                    cellRenderer: function(w) {
                        if ("undefined" === typeof w.data || "undefined" === typeof w.value || null === w.value)
                            return "";
                        var B = w.value
                          , Q = document.createElement("div");
                        B.forEach(function(fa, R) {
                            fa = GridHelperCategory.render(w.data.domainId, fa.catId, fa.name, w);
                            R < B.length - 1 ? Q.appendChild(fa).insertAdjacentHTML("beforeend", " &rsaquo; ") : Q.appendChild(fa)
                        });
                        return Q.outerHTML
                    },
                    filter: !1,
                    sortable: !1,
                    suppressSizeToFit: !0,
                    width: 240
                }, {
                    headerName: "Launchpad",
                    headerNameGroup: la._202,
                    field: "launchpad",
                    type: ["booleanColumn"],
                    width: 95
                }]
            },
            asin: {
                headerName: "ASIN",
                field: "asin",
                cellClass: "cell-id",
                lockVisible: !0,
                suppressSizeToFit: !0,
                width: 86
            },
            groupProductCodes: {
                headerName: "Product Codes",
                children: [{
                    headerName: "EAN",
                    headerNameGroup: "Product Codes",
                    field: "eanList",
                    type: ["productCodeColumn"]
                }, {
                    headerName: "UPC",
                    headerNameGroup: "Product Codes",
                    field: "upcList",
                    type: ["productCodeColumn"]
                }, {
                    headerName: "PartNumber",
                    headerNameGroup: "Product Codes",
                    field: "partNumber",
                    type: ["productCodeColumn"]
                }]
            },
            parentAsin: {
                headerName: "Parent ASIN",
                field: "parentAsin",
                cellClass: "cell-id",
                suppressSizeToFit: !0,
                width: 84
            },
            variationCSV: {
                headerName: "Variation ASINs",
                field: "variationCSV",
                cellClass: "cell-id cell-wrap",
                cellRenderer: GridHelper.cellRendererLinkedAsins,
                suppressSizeToFit: !0,
                width: 102
            },
            frequentlyBoughtTogether: {
                headerName: "Freq. Bought Together",
                field: "frequentlyBoughtTogether",
                cellClass: "cell-id cell-wrap",
                cellRenderer: GridHelper.cellRendererLinkedAsins,
                suppressSizeToFit: !0,
                width: 133
            },
            manufacturer: {
                headerName: "Manufacturer",
                field: "manufacturer",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !0,
                width: 114
            },
            brand: {
                headerName: "Brand",
                field: "brand",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !0,
                width: 114
            },
            productGroup: {
                headerName: "Product Group",
                field: "productGroup",
                cellRenderer: GridHelper.cellRendererProductGroup,
                suppressSizeToFit: !0,
                width: 114
            },
            model: {
                headerName: "Model",
                field: "model",
                cellRenderer: function(w) {
                    return w.value ? GridHelper.defaultTextClamp(w.value, 3) : ""
                },
                suppressSizeToFit: !0,
                width: 160
            },
            variationAttributes: {
                headerName: "Variation Attributes",
                field: "variationAttributes",
                cellClass: "cell-flex",
                cellRenderer: function(w) {
                    var B = ""
                      , Q = "";
                    if (w = w.value) {
                        w = $jscomp.makeIterator(w);
                        for (var fa = w.next(); !fa.done; fa = w.next())
                            fa = fa.value,
                            B += "<i>" + fa.dimension + ":</i>&emsp;<br>",
                            Q += fa.value + "<br>"
                    }
                    return "<span>" + B + "</span><span>" + Q + "</span>"
                },
                tooltipValueGetter: function(w) {
                    var B = "";
                    if (w = w.value) {
                        w = $jscomp.makeIterator(w);
                        for (var Q = w.next(); !Q.done; Q = w.next())
                            Q = Q.value,
                            B += Q.dimension + ": " + Q.value + "; "
                    }
                    return B.trim()
                },
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                sortable: !1,
                width: 160
            },
            color: {
                headerName: la._591,
                field: "color",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !0,
                width: 114
            },
            size: {
                headerName: la._592,
                field: "size",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !0,
                width: 114
            },
            edition: {
                headerName: la._593,
                field: "edition",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !0,
                width: 114
            },
            format: {
                headerName: la._595,
                field: "format",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !0,
                width: 114
            },
            author: {
                headerName: "Author",
                field: "author",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !0,
                width: 114
            },
            binding: {
                headerName: "Binding",
                field: "binding",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !0,
                width: 114
            },
            numberOfItems: {
                headerName: "Number of Items",
                field: "numberOfItems",
                cellClass: "cell-number",
                comparator: GridHelper.comparatorNumberNullLast,
                filter: "agNumberColumnFilter",
                icons: GridHelper.getIconsSortNumeric(),
                suppressSizeToFit: !0,
                valueGetter: GridHelper.valueGetterNoNegative,
                width: 120
            },
            numberOfPages: {
                headerName: "Number of Pages",
                field: "numberOfPages",
                cellClass: "cell-number",
                comparator: GridHelper.comparatorNumberNullLast,
                filter: "agNumberColumnFilter",
                icons: GridHelper.getIconsSortNumeric(),
                suppressSizeToFit: !0,
                valueGetter: GridHelper.valueGetterNoNegative,
                width: 120
            },
            publicationDate: {
                headerName: "Publication Date",
                field: "publicationDate",
                cellRenderer: GridHelper.cellRendererDateYMD,
                comparator: GridHelper.comparatorNumberNullLast,
                filter: "agNumberColumnFilter",
                icons: GridHelper.getIconsSortNumeric(),
                suppressSizeToFit: !0,
                width: 129
            },
            releaseDate: {
                headerName: "Release Date",
                field: "releaseDate",
                cellRenderer: GridHelper.cellRendererDateYMD,
                comparator: GridHelper.comparatorNumberNullLast,
                filter: "agNumberColumnFilter",
                icons: GridHelper.getIconsSortNumeric(),
                suppressSizeToFit: !0,
                width: 110
            },
            languages: {
                headerName: "Languages",
                field: "languages",
                cellRenderer: GridHelper.cellRendererLanguage,
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                valueGetter: GridHelper.valueGetterLanguage,
                width: 200
            },
            groupPackage: {
                headerName: "Package",
                children: [{
                    headerName: "Dimension",
                    headerNameGroup: "Package",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.measure + "</span>\u00b3)")
                    },
                    field: "packageDimension",
                    cellClass: "cell-number",
                    cellRenderer: GridHelper.cellRendererDimension,
                    comparator: GridHelper.comparatorNumberNullLast,
                    filter: "agNumberColumnFilter",
                    hide: !1,
                    icons: GridHelper.getIconsSortNumeric(),
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterDimension,
                    valueGetter: GridHelper.valueGetterDimension,
                    width: 135
                }, {
                    headerName: "Length",
                    headerNameGroup: "Package",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.measure + "</span>)")
                    },
                    field: "packageLength",
                    type: ["measureColumn"]
                }, {
                    headerName: "Width",
                    headerNameGroup: "Package",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.measure + "</span>)")
                    },
                    field: "packageWidth",
                    type: ["measureColumn"]
                }, {
                    headerName: "Height",
                    headerNameGroup: "Package",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.measure + "</span>)")
                    },
                    field: "packageHeight",
                    type: ["measureColumn"]
                }, {
                    headerName: "Weight",
                    headerNameGroup: "Package",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.weight + "</span>)")
                    },
                    field: "packageWeight",
                    cellClass: "cell-number",
                    comparator: GridHelper.comparatorNumberNullLast,
                    filter: "agNumberColumnFilter",
                    icons: GridHelper.getIconsSortNumeric(),
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterWeight,
                    valueGetter: GridHelper.valueGetterWeight,
                    width: 97
                }]
            },
            groupItem: {
                headerName: "Item",
                children: [{
                    headerName: "Dimension",
                    headerNameGroup: "Item",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.measure + "</span>\u00b3)")
                    },
                    field: "itemDimension",
                    cellClass: "cell-number",
                    cellRenderer: GridHelper.cellRendererDimension,
                    comparator: GridHelper.comparatorNumberNullLast,
                    filter: "agNumberColumnFilter",
                    hide: !1,
                    icons: GridHelper.getIconsSortNumeric(),
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterDimension,
                    valueGetter: GridHelper.valueGetterDimension,
                    width: 135
                }, {
                    headerName: "Length",
                    headerNameGroup: "Item",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.measure + "</span>)")
                    },
                    field: "itemLength",
                    type: ["measureColumn"]
                }, {
                    headerName: "Width",
                    headerNameGroup: "Item",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.measure + "</span>)")
                    },
                    field: "itemWidth",
                    type: ["measureColumn"]
                }, {
                    headerName: "Height",
                    headerNameGroup: "Item",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.measure + "</span>)")
                    },
                    field: "itemHeight",
                    type: ["measureColumn"]
                }, {
                    headerName: "Weight",
                    headerNameGroup: "Item",
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '(<span class="toggle-unit" title="Toggle unit">' + v.weight + "</span>)")
                    },
                    field: "itemWeight",
                    cellClass: "cell-number",
                    comparator: GridHelper.comparatorNumberNullLast,
                    filter: "agNumberColumnFilter",
                    icons: GridHelper.getIconsSortNumeric(),
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterWeight,
                    valueGetter: GridHelper.valueGetterWeight,
                    width: 97
                }]
            },
            isAdultProduct: {
                headerName: "Adult Product",
                field: "isAdultProduct",
                type: ["booleanColumn"],
                width: 95
            },
            isEligibleForTradeIn: {
                headerName: "Trade-In Eligible",
                field: "isEligibleForTradeIn",
                type: ["booleanColumn"],
                width: 107
            },
            isEligibleForSuperSaverShipping: {
                headerName: "Prime Eligible (Buy Box)",
                field: "isEligibleForSuperSaverShipping",
                type: ["booleanColumn"],
                width: 94
            },
            isSNS: {
                headerName: "Subscribe and Save",
                field: "isSNS",
                type: ["booleanColumn"],
                width: 124
            },
            groupCouponOneTime: {
                headerName: "One Time Coupon",
                children: [{
                    headerName: "Absolute",
                    headerNameGroup: "One Time Coupon",
                    field: "couponOneTimeAbsolute",
                    cellRenderer: GridHelper.cellRendererMoney,
                    suppressSizeToFit: !0,
                    type: ["numberColumn"],
                    valueFormatter: GridHelper.valueFormatterMoney,
                    valueGetter: GridHelper.valueGetterMoney,
                    width: 69
                }, {
                    headerName: "Percentage",
                    headerNameGroup: "One Time Coupon",
                    field: "couponOneTimePercent",
                    cellRenderer: GridHelper.cellRendererCouponPercentage,
                    suppressSizeToFit: !0,
                    type: ["numberColumn"],
                    valueFormatter: GridHelper.valueFormatterCouponPercentage,
                    valueGetter: GridHelper.valueGetterCouponPercentage,
                    width: 81
                }]
            },
            groupCouponSNS: {
                headerName: "Subscribe and Save Coupon",
                children: [{
                    headerName: "Percentage",
                    headerNameGroup: "Subscribe and Save Coupon",
                    field: "couponSNSPercent",
                    cellRenderer: GridHelper.cellRendererCouponPercentage,
                    suppressSizeToFit: !0,
                    type: ["numberColumn"],
                    valueFormatter: GridHelper.valueFormatterCouponPercentage,
                    valueGetter: GridHelper.valueGetterCouponPercentage,
                    width: 81
                }]
            },
            promotions: {}
        };
        "undefined" !== typeof v.checkboxSelection.field && ["asinDeals", "asinFinder"].includes(u) && (v.checkboxSelection.headerCheckboxSelection = !1);
        u = {};
        for (var G in v)
            v[G].children ? (u.$jscomp$loop$prop$keepChildren$678 = [],
            v[G].children.forEach(function(w) {
                return function(B, Q) {
                    0 < Object.keys(B).length && w.$jscomp$loop$prop$keepChildren$678.push(B)
                }
            }(u)),
            v[G].children = u.$jscomp$loop$prop$keepChildren$678) : 0 === Object.keys(v[G]).length && delete v[G],
            u = {
                $jscomp$loop$prop$keepChildren$678: u.$jscomp$loop$prop$keepChildren$678
            };
        return v
    }
      , n = function(u, v) {
        var G = f(u);
        u = {};
        for (var w in G)
            u.$jscomp$loop$prop$id$680 = w,
            G[u.$jscomp$loop$prop$id$680].children ? G[u.$jscomp$loop$prop$id$680].children.forEach(function(B) {
                return function(Q, fa) {
                    G[B.$jscomp$loop$prop$id$680].children[fa] = P(Q, v)
                }
            }(u)) : G[u.$jscomp$loop$prop$id$680] = P(G[u.$jscomp$loop$prop$id$680], v),
            u = {
                $jscomp$loop$prop$id$680: u.$jscomp$loop$prop$id$680
            };
        return G
    }
      , r = function(u) {
        var v = f(u);
        v.groupHidden = {
            headerName: "[hidden]",
            children: []
        };
        a.forEach(function(w) {
            "undefined" !== typeof CsvType[w] && v.groupHidden.children.push({
                headerName: CsvType.getName(CsvType[w].index) + ": Lowest ever",
                field: w + "_isLowest",
                filter: "customBooleanColumnFilter",
                filterParams: {
                    applyButton: !0,
                    newRowsAction: "keep",
                    isCheckbox: !0,
                    suppressAndOrCondition: !0
                },
                type: ["hiddenColumn"]
            })
        });
        b.forEach(function(w) {
            v.groupHidden.children.push({
                headerName: CsvType.getName(CsvType[w].index) + ": Out of stock",
                field: w + "_outOfStock",
                filter: "customBooleanColumnFilter",
                filterParams: {
                    applyButton: !0,
                    newRowsAction: "keep",
                    isCheckbox: !0,
                    suppressAndOrCondition: !0
                },
                type: ["hiddenColumn"]
            })
        });
        v.groupHidden.children.push({
            field: "productType",
            headerName: "Product Type",
            filter: "agSetColumnFilter",
            filterParams: {
                values: [0, 1],
                valueMap: {
                    0: "Physical Product",
                    1: "Digital Product"
                },
                suppressAndOrCondition: !0,
                suppressMiniFilter: !0,
                suppressRemoveEntries: !0
            },
            type: ["hiddenColumn"]
        });
        v.groupHidden.children.push({
            field: "hasParentASIN",
            headerName: "Variations",
            filter: "customBooleanColumnFilter",
            filterParams: {
                applyButton: !0,
                newRowsAction: "keep",
                isCheckbox: !1,
                suppressAndOrCondition: !0
            },
            type: ["hiddenColumn"]
        });
        v.groupHidden.children.push({
            field: "singleVariation",
            headerName: "Show only one variation per product",
            filter: "customBooleanColumnFilter",
            filterParams: {
                applyButton: !0,
                newRowsAction: "keep",
                isCheckbox: !0,
                suppressAndOrCondition: !0
            },
            type: ["hiddenColumn"]
        });
        v.groupHidden.children.push({
            headerName: "Seller IDs",
            field: "sellerIds",
            filter: "agTextColumnFilter",
            filterParams: {
                applyButton: !0,
                caseSensitive: !0,
                defaultOption: "isOneOf",
                filterOptions: ["isOneOf"],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            },
            type: ["hiddenColumn"]
        });
        v.groupHidden.children.push({
            headerName: "Allow products with possibly outdated price information to be included",
            field: "allowOutdatedOfferData",
            filter: "customBooleanColumnFilter",
            filterParams: {
                applyButton: !0,
                newRowsAction: "keep",
                isCheckbox: !0,
                suppressAndOrCondition: !0
            },
            type: ["hiddenColumn"]
        });
        v.groupHidden.children.push({
            headerName: "Exclude sub categories",
            field: "categories_exclude",
            filter: "customAutocompleteColumnFilter",
            filterParams: {
                applyButton: !0,
                caseSensitive: !0,
                filterOptions: ["isNoneOf"],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            },
            type: ["hiddenColumn"]
        });
        enableSubcategorySalesRankFilter && (v.groupHidden.children.push({
            headerName: "Current",
            headerNameGroup: "Sales Rank # - Subcategory",
            field: "salesRankReference_current",
            filter: "agNumberColumnFilter",
            filterParams: {
                applyButton: !0,
                defaultOption: "lessThanOrEqual",
                filterOptions: ["lessThanOrEqual", "greaterThanOrEqual", "inRange"],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            },
            type: ["hiddenColumn"]
        }),
        v.groupHidden.children.push({
            headerName: "Sales Rank Subcategory",
            headerNameGroup: "Sales Rank # - Subcategory",
            field: "salesRankReference",
            filter: "customAutocompleteColumnFilter",
            filterParams: {
                applyButton: !0,
                caseSensitive: !0,
                defaultOption: "equals",
                filterOptions: [{
                    displayKey: "equals",
                    displayName: "equals",
                    test: !0
                }],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            },
            type: ["hiddenColumn"]
        }));
        u = {};
        for (var G in v)
            u.$jscomp$loop$prop$id$682 = G,
            v[u.$jscomp$loop$prop$id$682].children ? v[u.$jscomp$loop$prop$id$682].children.forEach(function(w) {
                return function(B, Q) {
                    v[w.$jscomp$loop$prop$id$682].children[Q] = M(B)
                }
            }(u)) : v[u.$jscomp$loop$prop$id$682] = M(v[u.$jscomp$loop$prop$id$682]),
            u = {
                $jscomp$loop$prop$id$682: u.$jscomp$loop$prop$id$682
            };
        return v
    }
      , p = function() {
        return {
            domainId: {
                headerName: "",
                field: "domainId",
                cellClass: "cell-icon",
                cellRenderer: GridHelper.cellRendererDomainId,
                icons: GridHelper.getIconsSortNumeric(),
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                suppressToolPanel: !0,
                width: 40
            },
            imagesCSV: {
                headerName: " ",
                field: "imagesCSV",
                cellClass: "cell-image",
                cellRenderer: GridHelper.cellRendererImage,
                cellRendererParams: {
                    imageSize: 35
                },
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                sortable: !1,
                width: 39
            },
            title: {
                headerName: la._590,
                field: "title",
                cellRenderer: function(u) {
                    return '<a href="#!product/' + u.data.domainId + "-" + u.data.asin + '">' + GridHelper.defaultTextClamp(u.value, 2) + "</a>"
                },
                filter: !1,
                suppressMenu: !0,
                minWidth: 200
            },
            LIGHTNING_DEAL_current: {
                headerName: CsvType.getName(CsvType.LIGHTNING_DEAL.index) + " - " + la._344,
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate('<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(CsvType.LIGHTNING_DEAL.index).color + '" ></i> ', "")
                },
                field: "LIGHTNING_DEAL_current",
                cellClass: "cell-number cell-number-bold",
                type: ["priceColumn"],
                filter: !1,
                suppressMenu: !0,
                width: 153
            },
            LIGHTNING_DEAL_start: {
                headerName: la._648,
                field: "LIGHTNING_DEAL_start",
                type: ["dateColumn"],
                cellRenderer: GridHelper.cellRendererDateTimeKeepaTime,
                width: 104,
                sort: "asc"
            },
            LIGHTNING_DEAL_last: {
                headerName: la._649 + " " + la._650,
                field: "LIGHTNING_DEAL_last",
                type: ["priceColumn"],
                filter: !1,
                suppressMenu: !0,
                width: 185
            },
            LIGHTNING_DEAL_lastStart: {
                headerName: la._649,
                field: "LIGHTNING_DEAL_lastStart",
                type: ["dateColumn"],
                cellRenderer: GridHelper.cellRendererDateAgo,
                width: 118
            }
        }
    }
      , z = function() {
        var u = {
            template: GridHelper.getHeaderComponentTemplate("", '<i class="fa fa-info"></i>')
        };
        u = {
            percentageWon: {
                headerName: "% won",
                headerTooltip: "Percentage the seller won the Buy Box",
                headerComponentParams: u,
                field: "percentageWon",
                cellClass: "cell-number cell-number-last",
                comparator: GridHelper.comparatorNumberNullLast,
                icons: GridHelper.getIconsSortNumeric(),
                sort: "desc",
                valueFormatter: function(v) {
                    return 0 >= v.value ? "-" : 1 > v.value ? "<1%" : parseInt(Math.round(v.value)) + "%"
                },
                maxWidth: 120,
                width: 120
            },
            avgPrice: {
                headerName: "Avg. price",
                headerTooltip: "Average price of the Buy Box offer of this seller",
                headerComponentParams: u,
                field: "avgPrice",
                cellClass: "cell-number cell-number-last",
                comparator: GridHelper.comparatorNumberNullLast,
                icons: GridHelper.getIconsSortNumeric(),
                valueFormatter: GridHelper.valueFormatterPrice,
                maxWidth: 120,
                width: 120
            },
            avgNewOfferCount: {
                headerName: "Avg. New Offer Count",
                headerTooltip: "Average New Offer Count during the time the seller held the Buy Box",
                headerComponentParams: u,
                field: "avgNewOfferCount",
                cellClass: "cell-number cell-number-last",
                comparator: GridHelper.comparatorNumberNullLast,
                icons: GridHelper.getIconsSortNumeric(),
                valueFormatter: function(v) {
                    return 0 <= v.value ? v.value : "-"
                },
                width: 140
            },
            stock: {
                headerName: la._632,
                field: "stock",
                type: ["stockSingleColumn"]
            },
            groupSeller: {
                headerName: la._554,
                children: [{
                    headerName: "Name",
                    headerNameGroup: la._554,
                    field: "sellerName",
                    cellRenderer: function(v) {
                        var G = v.data.domainId
                          , w = v.data.sellerId;
                        if (v.data.isAmazon)
                            return v.value;
                        var B = getBaseUrl() + "#!seller/" + G + "-" + w;
                        G = "https://www.amazon." + getTldByDomain(G) + "/gp/aag/details/?seller=" + w;
                        return '<a href="' + B + '" title="' + la._181 + '" target="_blank">' + v.value + '</a>&ensp;<a href="' + G + '" title="' + la._646 + ' Amazon" target="_blank"><i class="fa fa-external-link"></i></a><br><span style="font-family: monospace;color:#ccc">' + w + "</span>"
                    },
                    suppressSizeToFit: !1,
                    minWidth: 140,
                    width: 140
                }, {
                    headerName: "FBA",
                    headerNameGroup: la._554,
                    field: "isFBA",
                    type: ["booleanColumn"],
                    width: 54
                }, {
                    headerName: la._440,
                    headerNameGroup: la._554,
                    field: "currentRating",
                    cellClass: "cell-number",
                    cellRenderer: GridHelper.cellRendererRating,
                    comparator: GridHelper.comparatorNumberNullLast,
                    icons: GridHelper.getIconsSortNumeric(),
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterRatingPercentage,
                    width: 56
                }, {
                    headerName: la._441,
                    headerNameGroup: la._554,
                    field: "currentRatingCount",
                    cellClass: "cell-number",
                    cellRenderer: GridHelper.cellRendererRating,
                    comparator: GridHelper.comparatorNumberNullLast,
                    icons: GridHelper.getIconsSortNumeric(),
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterRatingCount,
                    width: 92
                }]
            },
            lastSeen: {
                headerName: "Last won",
                headerTooltip: "Last time the seller won the Buy Box",
                headerComponentParams: u,
                field: "lastSeen",
                type: ["dateColumn"],
                cellRenderer: GridHelper.cellRendererDateTimeKeepaTime,
                width: 120
            },
            lastSeenAgo: {
                headerName: "Last won (ago)",
                headerTooltip: "How long ago the seller won the Buy Box",
                headerComponentParams: u,
                field: "lastSeen",
                type: ["dateAgoColumn"]
            }
        };
        !0 === disableStockFeatures && delete u.stock;
        return u
    }
      , F = function() {
        var u = function(G) {
            var w = "BUY_BOX_SHIPPING" === G ? 110 : null;
            return {
                headerName: CsvType.getName(CsvType[G].index),
                headerTooltip: CsvType.getName(CsvType[G].index),
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate('<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(CsvType[G].index).color + '" ></i> ', "")
                },
                field: G + "_current",
                type: ["priceColumn"],
                cellClass: function(B) {
                    return B.data && B.data[G + "_isLowest"] ? "cell-number cell-highlight" : "cell-number"
                },
                suppressSizeToFit: !1,
                minWidth: w
            }
        };
        u = {
            continentId: {
                headerName: "",
                field: "continentId",
                hide: !0,
                rowGroup: !0,
                sort: "asc"
            },
            domainId: {
                headerName: "",
                field: "domainId",
                cellClass: "cell-icon",
                cellRenderer: function(G) {
                    return '<img title=".' + getTldByDomain(G.value) + '" src="' + flags[G.value] + '" style="margin-top:3px;">'
                },
                filter: !1,
                suppressMenu: !0,
                resizable: !1,
                suppressSizeToFit: !1,
                sortable: !1,
                width: 30
            },
            BUY_BOX_SHIPPING: hasDataAccessSubscription ? u("BUY_BOX_SHIPPING") : {},
            AMAZON_current: u("AMAZON"),
            NEW_current: u("NEW"),
            USED_current: u("USED"),
            linkAmazon: {
                headerName: "",
                field: "linkAmazon",
                cellClass: "cell-icon",
                cellRenderer: function(G) {
                    return G.value ? '<span style="display:inline-block;padding-top:1px;"><a class="gridExternalAmazon" href="' + G.value + '" target="_blank" style><i class="fa fa-amazon"></i></a></span>' : ""
                },
                filter: !1,
                sortable: !1,
                suppressMenu: !0,
                valueGetter: function(G) {
                    return getAmazonRedirectByDomain(G.data.domainId, G.data.asin)
                },
                tooltipValueGetter: function(G) {
                    return la._99 + " Amazon"
                },
                suppressSizeToFit: !0,
                width: 20
            },
            linkReviews: {
                headerName: "",
                field: "linkReviews",
                cellClass: "cell-icon cell-opaque",
                cellRenderer: function(G) {
                    return G.value ? '<a href="' + G.value + '" target="_blank" style><i class="fa fa-star"></i></a>' : ""
                },
                filter: !1,
                sortable: !1,
                suppressMenu: !0,
                valueGetter: function(G) {
                    return 0 < G.data.COUNT_REVIEWS_current ? "http://www.amazon." + getTldByDomain(G.data.domainId) + "/product-reviews/" + G.data.asin : ""
                },
                tooltipValueGetter: function(G) {
                    return 0 < G.data.COUNT_REVIEWS_current ? la._939 : null
                },
                suppressSizeToFit: !0,
                width: 20
            },
            linkShipping: {
                headerName: "",
                field: "linkShipping",
                cellClass: "cell-icon cell-opaque",
                cellRenderer: function(G) {
                    return G.value ? '<a href="' + G.value + '" target="_blank" style><i class="fa fa-truck fa-flip-horizontal"></i></a>' : ""
                },
                filter: !1,
                sortable: !1,
                suppressMenu: !0,
                valueGetter: function(G) {
                    return LocaleType.getShippingInfoLink(G.data.domainId)
                },
                tooltipValueGetter: function(G) {
                    return LocaleType.getShippingInfoLink(G.data.domainId) ? la._314 : null
                },
                suppressSizeToFit: !0,
                width: 20
            }
        };
        for (var v in u)
            0 === Object.keys(u[v]).length && delete u[v];
        return u
    }
      , I = function() {
        for (var u = {
            catId: {
                headerName: "Category ID",
                field: "catId",
                cellClass: "cell-number"
            },
            links: {
                headerName: " ",
                field: "links",
                cellRenderer: function(w) {
                    if ("undefined" === typeof w.data)
                        return "";
                    var B = w.data.parent
                      , Q = {};
                    B = {
                        f: (Q[0 === B ? "rootCategory" : "categories"] = {
                            filter: 0 === B ? w.data.catId : w.data.catId + ""
                        },
                        Q),
                        s: null,
                        t: "g"
                    };
                    B = encodeURIComponent(JSON.stringify(B));
                    Q = getBaseUrl() + "#!finder/" + B;
                    B = document.createElement("a");
                    B.className = "gridFinder";
                    B.href = Q;
                    B.innerHTML = '&ensp;<i class="fa fa-search"></i>';
                    B.title = 'Search for "' + w.data.name1.replace(/"/g, "&quot;") + '" in our Product Finder';
                    0 === w.data.productCount && (B.style.visibility = "hidden");
                    Q = document.createElement("a");
                    Q.className = "gridBestseller";
                    Q.href = getBaseUrl() + "#!bestseller/" + w.data.domainId + "-" + w.data.catId;
                    Q.innerHTML = '&ensp;<i class="fa fa-hashtag"></i>';
                    Q.title = "Show Best Sellers List";
                    0 === w.data.productCount && (Q.style.visibility = "hidden");
                    var fa = document.createElement("a");
                    fa.className = "gridExternalAmazon";
                    fa.href = "https://www.amazon." + getTldByDomain(w.data.domainId) + "/b/?node=" + w.data.catId;
                    fa.innerHTML = '&ensp;<i class="fa fa-amazon"></i>';
                    fa.target = "_blank";
                    fa.title = la._99 + " Amazon";
                    w = document.createElement("span");
                    w.appendChild(B);
                    w.appendChild(Q);
                    w.appendChild(fa);
                    return w
                },
                width: 70
            },
            productCount: {
                headerName: "Number of products",
                headerTooltip: "Estimate, as the value is from the Keepa product database and not retrieved from Amazon",
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate("", '<i class="fa fa-info"></i>')
                },
                field: "productCount",
                cellClass: "cell-number cell-number-last",
                valueFormatter: function(w) {
                    return null == w.value ? "-" : NumberUtil.format(w.value)
                },
                width: 135
            }
        }, v = 1; v <= GridCategoryTree.depth; v++) {
            var G = "name" + v;
            u[G] = {
                field: G,
                rowGroup: !0,
                hide: !0
            }
        }
        return u
    }
      , E = function() {
        var u = GridManage.pageConfig.activeViewMode === GridManage.viewModes.COMPACT
          , v = GridManage.pageConfig.activeViewMode === GridManage.viewModes.COMFORTABLE;
        v = {
            imagesCSV: u ? {
                headerName: "",
                field: "imagesCSV",
                cellClass: "cell-image cell-image-compact",
                cellEditor: "cellEditorMetaData",
                cellEditorParams: {
                    ttlOptions: TrackingComponent.getTtlOptions(),
                    ttlDefault: Number(storage.s_trackingTtl)
                },
                cellRenderer: function(B) {
                    if (B.data.isDeleted)
                        return "";
                    var Q = B.data.product.imagesCSV;
                    if ("undefined" === typeof Q)
                        return "";
                    var fa = document.createElement("div")
                      , R = imageToUrl(Q, 41)
                      , T = Q ? Q.split(",")[0] : "";
                    Q = document.createElement("img");
                    Q.width = 41;
                    Q.height = 41;
                    Q.src = R ? R : imgCDNUrl + "no-photo-available.png";
                    Q.style.height = "41px";
                    Q.style.width = "41px";
                    R || (Q.alt = "No image available");
                    R && ProductImageHover.preview.add_events(Q, T);
                    R = document.createElement("div");
                    R.appendChild(Q);
                    fa.appendChild(R);
                    R = document.createElement("div");
                    if (B.data.conditionsMet.length) {
                        Q = document.createElement("span");
                        Q.className = "check";
                        Q.innerHTML = '<i class="fa fa-check fa-lg"></i>';
                        Q.title = la._87 + ":\n";
                        T = $jscomp.makeIterator(B.data.conditionsMet);
                        for (var oa = T.next(); !oa.done; oa = T.next())
                            oa = oa.value,
                            Q.title += "." + getTldByDomain(oa.domainId) + ": " + CsvType.getName(oa.csvTypeIndex) + "\n";
                        R.appendChild(Q)
                    }
                    B.data.tracking.expiresSoon && (B = GridHelper.cellRendererDateSpan({
                        value: B.data.tracking.expiresOn
                    }),
                    B = B.replace(/\s\s+/g, " "),
                    Q = document.createElement("span"),
                    Q.className = "check",
                    Q.innerHTML = '<i class="fa fa-clock-o fa-lg"></i>',
                    Q.title = la._882 + ":" + B + "\n" + la._806,
                    R.appendChild(Q));
                    fa.appendChild(R);
                    return fa
                },
                editable: function(B) {
                    return !0 !== B.data.isDeleted && B.data.tracking.expiresSoon
                },
                enableCellChangeFlash: !0,
                equals: function() {
                    return !1
                },
                getQuickFilterText: function(B) {
                    return null
                },
                lockPosition: !0,
                lockVisible: !0,
                lockPinned: !0,
                pinned: "left",
                filter: !1,
                suppressKeyboardEvent: GridHelper.cellSuppressKeyboardEvent,
                suppressMenu: !0,
                suppressMovable: !0,
                resizable: !1,
                suppressSizeToFit: !0,
                sortable: !1,
                suppressToolPanel: !0,
                valueSetter: GridHelper.valueSetterMetaData,
                minWidth: 88,
                maxWidth: 88,
                width: 88
            } : {},
            metaData: {
                headerName: la._680,
                headerTooltip: la._680,
                headerComponent: "customResetHeader",
                field: "metaData",
                cellClass: "cell-meta",
                cellEditor: "cellEditorMetaData",
                cellEditorParams: {
                    ttlOptions: TrackingComponent.getTtlOptions(),
                    ttlDefault: Number(storage.s_trackingTtl)
                },
                cellRenderer: u ? GridHelper.cellRendererMetaDataCompact : GridHelper.cellRendererMetaData,
                editable: function(B) {
                    return !0 !== B.data.isDeleted && B.data.tracking.expiresSoon
                },
                enableCellChangeFlash: !0,
                equals: function() {
                    return !1
                },
                getQuickFilterText: function(B) {
                    return null
                },
                lockPosition: !0,
                lockVisible: !0,
                lockPinned: !0,
                pinned: "left",
                filter: !1,
                suppressKeyboardEvent: GridHelper.cellSuppressKeyboardEvent,
                suppressMenu: !0,
                suppressMovable: !0,
                resizable: !1,
                suppressSizeToFit: !0,
                sortable: !1,
                suppressToolPanel: !0,
                valueSetter: GridHelper.valueSetterMetaData,
                minWidth: u ? 120 : 155,
                maxWidth: u ? 120 : 155,
                width: u ? 120 : 155
            },
            productTitle: u ? {
                headerName: la._676,
                field: "title",
                cellRenderer: function(B) {
                    if (B.data.isDeleted)
                        return "";
                    var Q = Math.max(2, B.data.multiLocaleProductsReduced.length)
                      , fa = "";
                    "Firefox" === browserInfo().name && (fa = ' style="height:' + 16 * Q + 'px;display:block;overflow:hidden;"');
                    return "<div" + fa + '><a class="href" href="#!product/' + B.data.domainId + "-" + B.data.asin + '">' + GridHelper.defaultTextClamp(B.value, Q) + "</a></div>"
                },
                cellClass: "cell-text-compact",
                equals: function() {
                    return !1
                },
                valueGetter: function(B) {
                    return B.data.product.title
                },
                lockPinned: !1,
                suppressSizeToFit: !0,
                minWidth: 140,
                maxWidth: 400,
                width: 200
            } : {},
            groupSales: qa("SALES"),
            groupRating: qa("RATING"),
            groupCountReviews: qa("COUNT_REVIEWS"),
            groupAmazon: qa("AMAZON"),
            groupNew: qa("NEW"),
            groupNewFBA: qa("NEW_FBA"),
            groupNewFBMShipping: qa("NEW_FBM_SHIPPING"),
            groupUsed: qa("USED"),
            groupListprice: qa("LISTPRICE"),
            groupLightningDeal: qa("LIGHTNING_DEAL"),
            groupWarehouse: qa("WAREHOUSE"),
            groupCollectable: qa("COLLECTIBLE"),
            groupRefurbished: qa("REFURBISHED"),
            groupCountNew: qa("COUNT_NEW"),
            groupCountUsed: qa("COUNT_USED"),
            groupCountRefurbished: qa("COUNT_REFURBISHED"),
            groupCountCollectible: qa("COUNT_COLLECTIBLE"),
            groupBuyBoxShipping: qa("BUY_BOX_SHIPPING"),
            groupUsedNewShipping: qa("USED_NEW_SHIPPING"),
            groupUsedVeryGoodShipping: qa("USED_VERY_GOOD_SHIPPING"),
            groupUsedGoodShipping: qa("USED_GOOD_SHIPPING"),
            groupUsedAcceptableShipping: qa("USED_ACCEPTABLE_SHIPPING"),
            groupCollectibleNewShipping: qa("COLLECTIBLE_NEW_SHIPPING"),
            groupCollectibleVeryGoodShipping: qa("COLLECTIBLE_VERY_GOOD_SHIPPING"),
            groupCollectibleGoodShipping: qa("COLLECTIBLE_GOOD_SHIPPING"),
            groupCollectibleAcceptableShipping: qa("COLLECTIBLE_ACCEPTABLE_SHIPPING"),
            groupRefurbishedShipping: qa("REFURBISHED_SHIPPING"),
            groupEbayNewShipping: qa("EBAY_NEW_SHIPPING"),
            groupEbayUsedShipping: qa("EBAY_USED_SHIPPING"),
            groupTradeIn: qa("TRADE_IN"),
            trackingCreateDate: {
                headerName: la._197,
                headerTooltip: la._197,
                field: "trackingCreateDate",
                cellClass: u ? "cell-text-compact" : null,
                getQuickFilterText: function(B) {
                    return null
                },
                lockPinned: !0,
                valueGetter: function(B) {
                    return B.data.isDeleted ? -2 : B.data.tracking.createDate
                },
                type: ["dateAgoColumn"],
                suppressSizeToFit: !1,
                minWidth: 120,
                width: 120
            },
            trackingExpiresOn: {
                headerName: la._882,
                headerTooltip: la._882,
                field: "trackingExpiresOn",
                type: ["dateAgoColumn"],
                cellClass: u ? "cell-text-compact" : null,
                cellRenderer: GridHelper.cellRendererDateSpan,
                comparator: GridHelper.comparatorNumberNullLast,
                getQuickFilterText: function(B) {
                    return null
                },
                lockPinned: !0,
                valueGetter: function(B) {
                    return B.data.isDeleted ? -2 : B.data.tracking.expiresOn
                },
                suppressSizeToFit: !1,
                minWidth: 120,
                width: 120
            },
            tags: O("tags"),
            memo: O("memo"),
            wishListNameInfo: v ? {} : {
                headerName: la._419,
                headerTooltip: la._419,
                field: "wishListNameInfo",
                cellClass: "cell-text-compact cell-wrap",
                cellRenderer: function(B) {
                    if (B.data.isDeleted || !B.data.tracking.wishListId)
                        return "";
                    var Q = u ? Math.max(2, B.data.multiLocaleProductsReduced.length) : 1
                      , fa = B.data.wishLists
                      , R = B.data.tracking.wishListId;
                    return fa[R] ? '<a href="' + getAmazonWishListUrl(fa[R]) + '" target="_blank">' + GridHelper.defaultTextClamp(B.value, Q) + "</a>" : "" + GridHelper.defaultTextClamp(B.value, Q)
                },
                getQuickFilterText: function(B) {
                    return null
                },
                lockPinned: !0,
                valueGetter: function(B) {
                    return B.data.product.wishListName
                },
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !1,
                minWidth: 120,
                width: 120
            },
            productGroup: {
                headerName: "Product Group",
                field: "productGroup",
                cellClass: u ? "cell-text-compact cell-wrap" : "cell-wrap",
                filter: "agSetColumnFilter",
                filterParams: {
                    cellHeight: 22,
                    suppressAndOrCondition: !0,
                    suppressMiniFilter: !0,
                    suppressRemoveEntries: !0
                },
                valueGetter: function(B) {
                    return B.data.product.productGroup
                },
                suppressSizeToFit: !0,
                type: ["manageVariationColumn"],
                width: 114
            },
            color: {
                headerName: la._591,
                field: "color",
                cellClass: u ? "cell-text-compact cell-wrap" : "cell-wrap",
                type: ["manageVariationColumn"]
            },
            size: {
                headerName: la._592,
                field: "size",
                cellClass: u ? "cell-text-compact cell-wrap" : "cell-wrap",
                type: ["manageVariationColumn"]
            },
            edition: {
                headerName: la._593,
                field: "edition",
                cellClass: u ? "cell-text-compact cell-wrap" : "cell-wrap",
                type: ["manageVariationColumn"]
            },
            format: {
                headerName: la._595,
                field: "format",
                cellClass: u ? "cell-text-compact cell-wrap" : "cell-wrap",
                type: ["manageVariationColumn"]
            },
            title: u ? {} : {
                headerName: "Title",
                field: "title",
                getQuickFilterText: function(B) {
                    var Q = [B.value];
                    if (B.data.multiLocaleProductsReduced.length) {
                        B = $jscomp.makeIterator(B.data.multiLocaleProductsReduced);
                        for (var fa = B.next(); !fa.done; fa = B.next())
                            Q.push(fa.value.title)
                    }
                    return Q
                },
                valueGetter: function(B) {
                    return B.data.product.title
                },
                type: ["hiddenColumn"]
            },
            multiDomainIds: {
                headerName: la._203,
                field: "multiDomainIds",
                filter: "agSetColumnFilter",
                filterParams: {
                    cellHeight: 22,
                    suppressAndOrCondition: !0,
                    suppressRemoveEntries: !0,
                    selectAllOnMiniFilter: !0
                },
                type: ["hiddenColumn"]
            },
            rootCategoryName: {
                headerName: "Root category",
                field: "rootCategoryName",
                filter: "agSetColumnFilter",
                filterParams: {
                    cellHeight: 22,
                    suppressAndOrCondition: !0,
                    suppressRemoveEntries: !0,
                    selectAllOnMiniFilter: !0
                },
                valueGetter: function(B) {
                    return B.data.product.rootCategory > invalidIfLargerCatId ? "-" : B.context.categoryHashMap[B.data.product.rootCategory]
                },
                type: ["hiddenColumn"]
            },
            conditionsMet: {
                headerName: la._87,
                field: "conditionsMet",
                filter: "agSetColumnFilter",
                filterParams: {
                    cellHeight: 22,
                    suppressAndOrCondition: !0,
                    suppressRemoveEntries: !0,
                    selectAllOnMiniFilter: !0
                },
                valueGetter: function(B) {
                    return B.data.conditionsMet.length ? la._88 : la._89
                },
                type: ["hiddenColumn"]
            },
            csvTypesWithTracking: {
                headerName: "Active price trackings",
                field: "csvTypesWithTracking",
                filter: "agSetColumnFilter",
                filterParams: {
                    cellHeight: 22,
                    suppressAndOrCondition: !0,
                    suppressRemoveEntries: !0,
                    selectAllOnMiniFilter: !0
                },
                valueGetter: function(B) {
                    return B.data.product.csvTypesWithTracking.map(function(Q) {
                        return CsvType.getName(CsvType[Q].index)
                    })
                },
                type: ["hiddenColumn"]
            },
            trackingTypes: {
                headerName: "Tracking type",
                field: "trackingTypes",
                filter: "agSetColumnFilter",
                filterParams: {
                    cellHeight: 22,
                    suppressAndOrCondition: !0,
                    suppressRemoveEntries: !0,
                    selectAllOnMiniFilter: !0
                },
                valueGetter: function(B) {
                    var Q = [];
                    B.data.product.hasPriceDropTracking && Q.push(la._711);
                    B.data.product.hasPriceIncreaseTracking && Q.push(la._712);
                    return Q
                },
                type: ["hiddenColumn"]
            },
            wishListName: {
                headerName: la._419,
                field: "wishListName",
                filter: "agSetColumnFilter",
                filterParams: {
                    cellHeight: 22,
                    suppressAndOrCondition: !0,
                    suppressRemoveEntries: !0,
                    selectAllOnMiniFilter: !0
                },
                valueGetter: function(B) {
                    return B.data.product.wishListName
                },
                type: ["hiddenColumn"]
            },
            expiresSoon: {
                headerName: la._889.replace("!", ""),
                field: "expiresSoon",
                filter: "agSetColumnFilter",
                filterParams: {
                    cellHeight: 22,
                    suppressAndOrCondition: !0,
                    suppressRemoveEntries: !0,
                    selectAllOnMiniFilter: !0
                },
                valueGetter: function(B) {
                    return B.data.tracking.expiresSoon ? la._254 : la._255
                },
                type: ["hiddenColumn"]
            },
            maxDelta: {
                field: "MAX_delta",
                comparator: GridHelper.comparatorNumberArrayNullLast,
                valueGetter: GridHelper.valueGetterTracking,
                sortingOrder: ["desc", "asc", null],
                type: ["hiddenColumn"]
            },
            maxDeltaCustom: {
                field: "MAX_deltaCustom",
                comparator: GridHelper.comparatorNumberArrayNullLast,
                valueGetter: GridHelper.valueGetterTracking,
                sortingOrder: ["desc", "asc", null],
                type: ["hiddenColumn"]
            },
            maxDeltaTrackingCreated: {
                field: "MAX_deltaTrackingCreated",
                comparator: GridHelper.comparatorNumberArrayNullLast,
                valueGetter: GridHelper.valueGetterTracking,
                sortingOrder: ["desc", "asc", null],
                type: ["hiddenColumn"]
            },
            maxLastPriceChange: {
                field: "MAX_lastPriceChange",
                comparator: GridHelper.comparatorNumberArrayOnlyFirstNullLast,
                valueGetter: GridHelper.valueGetterTrackingNonCsvArray,
                sortingOrder: ["desc", "asc", null],
                type: ["hiddenColumn"]
            },
            trackingID: {
                headerName: "Tracking ID",
                field: "trackingID",
                valueGetter: function(B) {
                    return B.data.asin
                },
                type: ["hiddenColumn"]
            },
            asin: {
                headerName: "ASIN",
                field: "asin",
                getQuickFilterText: function(B) {
                    return B.data.asin
                },
                valueGetter: function(B) {
                    return B.data.asin
                },
                type: ["hiddenColumn"]
            },
            domainId: {
                headerName: la._203,
                field: "domainId",
                type: ["hiddenColumn"]
            },
            currency: {
                headerName: la._685,
                field: "currency",
                valueGetter: function(B) {
                    return getCurrencyCodeByDomain(B.data.domainId)
                },
                type: ["hiddenColumn"]
            },
            lastUpdate: {
                headerName: la._540,
                field: "lastUpdate",
                valueGetter: function(B) {
                    B = Date.now() / 6E4 - (B.data.product.lastUpdate + 60 * offsetHours);
                    return prettyDate(B)
                },
                type: ["hiddenColumn"]
            },
            lastPriceChange: {
                headerName: la._532,
                field: "lastPriceChange",
                valueGetter: function(B) {
                    B = Date.now() / 6E4 - (B.data.product.lastPriceChange + 60 * offsetHours);
                    return prettyDate(B)
                },
                type: ["hiddenColumn"]
            },
            internalHref: {
                headerName: "Keepa URL",
                field: "internalHref",
                valueGetter: function(B) {
                    return "https://keepa.com/#!product/" + B.data.domainId + "-" + B.data.asin
                },
                type: ["hiddenColumn"]
            },
            externalHref: {
                headerName: "Amazon URL",
                field: "externalHref",
                valueGetter: function(B) {
                    return "https://www.amazon." + getTldByDomain(B.data.domainId) + "/dp/" + B.data.asin
                },
                type: ["hiddenColumn"]
            }
        };
        var G = {}, w;
        for (w in v)
            v[w].children ? (G.$jscomp$loop$prop$keepChildren$684 = [],
            v[w].children.forEach(function(B) {
                return function(Q, fa) {
                    0 < Object.keys(Q).length && B.$jscomp$loop$prop$keepChildren$684.push(Q)
                }
            }(G)),
            v[w].children = G.$jscomp$loop$prop$keepChildren$684) : 0 === Object.keys(v[w]).length && delete v[w],
            G = {
                $jscomp$loop$prop$keepChildren$684: G.$jscomp$loop$prop$keepChildren$684
            };
        return v
    }
      , K = function() {
        var u = GridManage.pageConfig.activeViewMode === GridManage.viewModes.DEFAULT;
        return {
            imagesCSV: {
                headerName: la._589,
                field: "imagesCSV",
                cellClass: u ? "cell-image cell-image-default" : "cell-image",
                cellRenderer: function(v) {
                    if (v.data.isDeleted)
                        return "";
                    var G = v.data.detailsPerDomain[v.data.detailDomainId]
                      , w = G.imagesCSV;
                    if ("undefined" === typeof w)
                        return "";
                    var B = document.createElement("div")
                      , Q = u ? 90 : 135
                      , fa = imageToUrl(w, Q)
                      , R = w ? w.split(",")[0] : "";
                    w = document.createElement("img");
                    w.width = Q;
                    w.height = Q;
                    w.src = fa ? fa : imgCDNUrl + "no-photo-available.png";
                    w.style.height = Q + "px";
                    w.style.width = Q + "px";
                    fa || (w.alt = "No image available");
                    fa && ProductImageHover.preview.add_events(w, R);
                    Q = document.createElement("div");
                    Q.appendChild(w);
                    B.appendChild(Q);
                    if (v.data.conditionsMet.length) {
                        Q = document.createElement("span");
                        Q.className = "check";
                        Q.innerHTML = '<i class="fa fa-check fa-2x"></i>';
                        Q.title = la._87 + ":\n";
                        v = $jscomp.makeIterator(v.data.conditionsMet);
                        for (fa = v.next(); !fa.done; fa = v.next())
                            fa = fa.value,
                            Q.title += "." + getTldByDomain(fa.domainId) + ": " + CsvType.getName(fa.csvTypeIndex) + "\n";
                        B.appendChild(Q)
                    }
                    v = document.createElement("a");
                    v.href = getAmazonRedirectByDomain(G.domainId, G.asin);
                    v.innerHTML = '<img src="' + imgCDNUrl + "/amazon/small/" + getTldByDomain(G.domainId) + '.png">';
                    v.className = "amazonLink";
                    v.target = "_blank";
                    v.title = la._99 + " Amazon";
                    fa = keepaTime.now();
                    Q = !1;
                    if (0 >= G.lastEbayUpdate || 0 < G.lastEbayUpdate && 20160 < fa - G.lastEbayUpdate)
                        Q = !0;
                    fa = document.createElement("a");
                    fa.href = getEbayRedirectByDomain(G.domainId, G.asin, !0);
                    fa.innerHTML = "ebay";
                    fa.className = "ebayLink";
                    fa.style.color = Q ? "#aaaaaa" : "#666666";
                    fa.target = "_blank";
                    fa.title = Q ? "unverified if sold on ebay" : la._99 + " eBay";
                    Q = document.createElement("div");
                    Q.appendChild(v);
                    globalEbayArray[G.domainId] && Q.appendChild(fa);
                    B.appendChild(Q);
                    return B
                },
                equals: function() {
                    return !1
                },
                filter: !1,
                suppressMenu: !0,
                suppressMovable: !0,
                resizable: !1,
                suppressSizeToFit: !0,
                sortable: !1,
                width: 155
            },
            graphData: {
                field: "graphData",
                cellClass: "cell-graph",
                cellRenderer: function(v) {
                    if (v.data.isDeleted)
                        return "";
                    var G = v.data.detailsPerDomain[v.data.detailDomainId]
                      , w = v.data.wishLists
                      , B = G.graphData
                      , Q = G.title
                      , fa = G.asin
                      , R = G.domainId
                      , T = document.createElement("div")
                      , oa = document.createElement("div");
                    oa.className = "head";
                    u && (oa.className += " head-default");
                    var Z = document.createElement("a");
                    Z.className = "href";
                    Z.href = "#!product/" + R + "-" + fa;
                    Z.innerHTML = "" + Q;
                    Z.title = "" + escapeHTML(Q);
                    oa.appendChild(Z).insertAdjacentHTML("beforebegin", '<img class="flag" title="' + getTldByDomain(R) + '" src="' + flags[R] + '" />&emsp;');
                    T.appendChild(oa);
                    u || (Q = document.createElement("div"),
                    Q.className = "info",
                    oa = Date.now() / 6E4 - (G.lastUpdate + 60 * offsetHours),
                    G = Date.now() / 6E4 - (G.lastPriceChange + 60 * offsetHours),
                    Z = document.createElement("span"),
                    Z.innerHTML = "(" + la._123 + prettyDate(oa) + ", " + la._532 + ": " + prettyDate(G) + ")",
                    Q.appendChild(Z),
                    G = B.tracking.wishListId,
                    w[G] && (oa = document.createElement("span"),
                    oa.innerHTML = la._558 + ': <a href="' + getAmazonWishListUrl(w[G]) + '">' + w[G].name + "</a>",
                    Q.appendChild(oa).insertAdjacentHTML("beforebegin", "&emsp;|&emsp;")),
                    T.appendChild(Q));
                    w = "historyGraphCache" + R;
                    v.data[w] || (Q = $("<div/>", {
                        id: "graph-historyGraph-" + R + "-" + fa,
                        class: "graph",
                        style: "line-height: 12px"
                    }),
                    G = $("<div/>", {
                        style: "visibility: hidden;"
                    }),
                    G.append(Q),
                    $("body").append(G),
                    R = graph.prepare(R),
                    R.asin = fa,
                    R.buyBoxSellerIdHistory = B.buyBoxSellerIdHistory,
                    R.csv = B.csv,
                    R.offers = B.offers,
                    R.stats = getStatistics(B),
                    R.graphIndex = 0,
                    R.isOnTrackingPage = !0,
                    R.showOnlyTracked = u,
                    R.$container = Q,
                    R.$container.show(),
                    R.parameter.tracking = B.tracking,
                    R.parameter.height = "110px",
                    R.parameter.width = v.column.actualWidth - 10 - (R.showOnlyTracked ? 140 : 215) + "px",
                    R.parameter.interval = GridManage.pageConfig.graphRange,
                    graph.create(R),
                    G.detach(),
                    v.data.isEmptyGraph = R.showOnlyTracked && 0 === Object.keys(R.data).length,
                    v.data[w] = Q.get(0));
                    T.appendChild(v.data[w]);
                    v.data.isEmptyGraph && (v = document.createElement("span"),
                    v.style.color = "#7d7d7d",
                    v.style.fontSize = "11px",
                    v.style.position = "relative",
                    v.style.top = "-12px",
                    v.innerHTML = '<i class="fa fa-exclamation"></i>&ensp;' + la._716,
                    T.appendChild(v));
                    return T
                },
                equals: function() {
                    return !1
                },
                minWidth: 720,
                width: Math.max(720, window.innerWidth - 275),
                filter: !1,
                suppressMenu: !0,
                suppressMovable: !0,
                resizable: !1,
                suppressSizeToFit: !1,
                sortable: !1
            }
        }
    }
      , H = function() {
        var u = {
            offerCSV: {
                headerName: la._634,
                field: "offerCSV",
                cellClass: "cell-number",
                cellRenderer: GridHelper.cellRendererOfferCSV,
                comparator: GridHelper.comparatorNumberNullLast,
                icons: GridHelper.getIconsSortNumeric(),
                pinnedRowCellRenderer: function(v) {
                    var G = Money.format(v.data.offerCSV, {
                        sourceDomainId: v.data.domainId
                    })
                      , w = "";
                    showReferencePrice(v.data.domainId) && (w = Money.format(v.data.offerCSV, {
                        sourceDomainId: v.data.domainId,
                        targetDomainId: v.data.domainId
                    }),
                    w = '<span style="color:#ccc">' + w + "</span>&ensp;");
                    return "<span>" + la._385 + "</span><br>" + w + G
                },
                sort: "asc",
                lockVisible: !0,
                valueGetter: function(v) {
                    var G = v.node.rowPinned ? v.data.offerCSV : v.data.offerCSV ? v.data.offerCSV[v.data.offerCSV.length - 2] + v.data.offerCSV[v.data.offerCSV.length - 1] : -1;
                    return 0 > G ? null : G = Money.raw(G, {
                        sourceDomainId: v.data.domainId
                    })
                },
                minWidth: 186,
                width: 186
            },
            externalLink: {
                headerName: "",
                field: "externalLink",
                cellClass: "cell-icon",
                cellRenderer: function(v) {
                    v = v.data;
                    return '<a href="https://www.amazon.' + (getTldByDomain(v.domainId) + "/dp/" + v.asin + "/?m=" + v.sellerId + '&psc=1" target="_blank"><i class="fa fa-external-link"></i></a>')
                },
                pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                sortable: !1,
                suppressToolPanel: !0,
                width: 50
            },
            condition: {
                headerName: la._553,
                field: "condition",
                cellRenderer: function(v) {
                    return v.value ? GridHelper.defaultTextClamp(v.value, 2) : ""
                },
                pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                valueGetter: function(v) {
                    return ConditionType.getName(v.data.condition)
                },
                minWidth: 72,
                width: 72
            },
            priceHistory: {
                headerName: "Price History",
                field: "priceHistory",
                type: ["graphColumn"],
                cellRenderer: function(v) {
                    return GridHelper.cellRendererGraph(v, "price", v.data.offerId, graph.insertOfferGraph, v.data.priceHistory ? v.data.priceHistory : v.data.ageInHours)
                },
                minWidth: 200,
                maxWidth: 200,
                resizable: !1
            },
            groupStock: {
                headerName: la._632,
                children: [{
                    headerName: la._632,
                    headerNameGroup: la._632,
                    field: "stockCSV",
                    cellClass: "cell-number",
                    cellRenderer: function(v) {
                        return null == v.value ? "?" : "" + v.value + (v.data.stockIsMax ? "+" : "")
                    },
                    comparator: GridHelper.comparatorNumberNullLast,
                    icons: GridHelper.getIconsSortNumeric(),
                    pinnedRowCellRenderer: function(v) {
                        return "undefined" === typeof v.value || null == v.value ? "" : "<span>Stock Total</span><br>" + v.value + (v.data.stockHasMax ? "+" : "")
                    },
                    suppressSizeToFit: !0,
                    valueGetter: function(v) {
                        return v.node.rowPinned ? v.data.stockCSV : v.data.stock
                    },
                    width: 80
                }, {
                    headerName: "Sold",
                    headerTooltip: la._659,
                    headerNameGroup: la._632,
                    headerComponentParams: {
                        template: GridHelper.getHeaderComponentTemplate("", '<i class="fa fa-info"></i>')
                    },
                    field: "sold",
                    cellClass: "cell-number",
                    cellRenderer: function(v) {
                        v = v.value;
                        return -1 == v ? "?" : "~" + v
                    },
                    comparator: GridHelper.comparatorNumberNullLast,
                    icons: GridHelper.getIconsSortNumeric(),
                    pinnedRowCellRenderer: function(v) {
                        return "<span>Total</span><br>~" + v.value
                    },
                    suppressSizeToFit: !0,
                    valueGetter: function(v) {
                        return v.node.rowPinned ? v.data.totalSold : v.data.sold
                    },
                    width: 60
                }, {
                    headerName: "Sold 30 days",
                    headerNameGroup: la._632,
                    field: "sold30Day",
                    cellClass: "cell-number",
                    cellRenderer: function(v) {
                        return -1 == v.value ? "?" : "~" + v.value
                    },
                    comparator: GridHelper.comparatorNumberNullLast,
                    icons: GridHelper.getIconsSortNumeric(),
                    pinnedRowCellRenderer: function(v) {
                        return "<span>Total</span><br>~" + v.value
                    },
                    suppressSizeToFit: !0,
                    valueGetter: function(v) {
                        return v.node.rowPinned ? v.data.totalSold30Day : v.data.sold30Day
                    },
                    width: 90
                }, {
                    headerName: "Stock History",
                    headerNameGroup: la._632,
                    field: "stockHistory",
                    type: ["graphColumn"],
                    cellRenderer: function(v) {
                        return GridHelper.cellRendererGraph(v, "stock", v.data.offerId, graph.insertOfferGraph, v.data.stockHistory ? v.data.stockHistory : v.data.ageInHours)
                    }
                }]
            },
            isPrime: {
                headerName: la._619,
                headerTooltip: la._620,
                field: "isPrime",
                type: ["booleanColumn"],
                width: 54
            },
            isFBA: {
                headerName: "FBA",
                headerTooltip: "Whether or not this offer is fulfilled by Amazon.",
                field: "isFBA",
                type: ["booleanColumn"],
                width: 54
            },
            groupSeller: {
                headerName: la._554,
                children: [{
                    headerName: "Name",
                    headerNameGroup: la._554,
                    field: "sellerName",
                    cellRenderer: function(v) {
                        v = v.data;
                        var G = getBaseUrl() + "#!seller/" + v.domainId + "-" + v.sellerId
                          , w = "https://www.amazon." + getTldByDomain(v.domainId) + "/gp/aag/details/?seller=" + v.sellerId;
                        return '<a href="' + G + '" title="' + la._181 + '" target="_blank">' + v.sellerName + '</a>&ensp;<a href="' + w + '" title="' + la._646 + ' Amazon" target="_blank"><i class="fa fa-external-link"></i></a><br><span style="font-family: monospace;color:#ccc">' + v.sellerId + "</span>"
                    },
                    pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                    minWidth: 140,
                    width: 140
                }, {
                    headerName: la._440,
                    headerNameGroup: la._554,
                    field: "sellerCurrentRating",
                    cellClass: "cell-number",
                    cellRenderer: GridHelper.cellRendererRating,
                    comparator: GridHelper.comparatorNumberNullLast,
                    icons: GridHelper.getIconsSortNumeric(),
                    pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterRatingPercentage,
                    width: 56
                }, {
                    headerName: la._441,
                    headerNameGroup: la._554,
                    field: "sellerCurrentRatingCount",
                    cellClass: "cell-number",
                    cellRenderer: GridHelper.cellRendererRating,
                    comparator: GridHelper.comparatorNumberNullLast,
                    icons: GridHelper.getIconsSortNumeric(),
                    pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterRatingCount,
                    width: 92
                }]
            },
            lastSeen: {
                headerName: la._635,
                field: "lastSeen",
                type: ["dateAgoColumn"]
            },
            firstSeen: {
                headerName: la._636,
                field: "firstSeen",
                type: ["dateAgoColumn"],
                valueGetter: function(v) {
                    return v.data.offerCSV[0]
                }
            },
            conditionComment: {
                headerName: la._24,
                field: "conditionComment",
                cellRenderer: function(v) {
                    return v.value ? GridHelper.defaultTextClamp(v.value, 6) : ""
                },
                pinnedRowCellRenderer: GridHelper.cellRendererEmpty,
                suppressMenu: !0,
                minWidth: 300,
                width: 300
            },
            isWarehouseDeal: {
                headerName: la._626,
                field: "isWarehouseDeal",
                type: ["booleanColumn"],
                width: 104
            },
            isScam: {
                headerName: la._627,
                headerTooltip: la._628,
                field: "isScam",
                type: ["booleanColumn"],
                cellRenderer: function(v) {
                    return v.value ? '<i title="' + la._628 + '" style="color:#f00 !important;font-size: 21px !important;" class="fa fa-exclamation-triangle"></i>' : ""
                },
                width: 98
            },
            isMAP: {
                headerName: la._622,
                headerTooltip: la._623,
                field: "isMAP",
                type: ["booleanColumn"],
                width: 58
            },
            isAmazon: {
                headerName: la._629,
                headerTooltip: la._630,
                field: "isAmazon",
                type: ["booleanColumn"],
                width: 104
            },
            isPrimeExcl: {
                headerName: la._631,
                field: "isPrimeExcl",
                type: ["booleanColumn"],
                width: 102
            },
            isShippable: {
                headerName: la._621,
                field: "isShippable",
                type: ["booleanColumn"],
                width: 72
            },
            isAddonItem: {
                headerName: la._624,
                field: "isAddonItem",
                type: ["booleanColumn"],
                width: 86
            },
            isPreorder: {
                headerName: la._625,
                field: "isPreorder",
                type: ["booleanColumn"],
                width: 72
            }
        };
        !0 === disableStockFeatures ? delete u.groupStock : !0 === disableSoldNumbers && (u.groupStock.children = u.groupStock.children.filter(function(v) {
            return "sold" !== v.field && "sold30Day" !== v.field
        }));
        return u
    }
      , V = function() {
        return {
            productKey: {
                headerName: "Details",
                field: "productKey",
                cellClass: "cell-wrap",
                cellRenderer: "cellRendererAutoHeightRow",
                filter: !1,
                suppressMenu: !0,
                resizable: !1,
                suppressSizeToFit: !0,
                sortable: !1,
                width: 170
            },
            productValue: {
                headerName: "",
                field: "productValue",
                cellClass: "cell-wrap",
                cellRenderer: "cellRendererAutoHeightRow",
                filter: !1,
                suppressMenu: !0,
                resizable: !1,
                suppressSizeToFit: !0,
                sortable: !1,
                valueFormatter: function(u) {
                    return u.data.productValueFormatted
                },
                width: 320
            }
        }
    }
      , S = function() {
        return {
            productKey: {
                headerName: la._344 + " & " + la._385,
                field: "productKey",
                cellRenderer: function(u) {
                    return u.valueFormatted ? u.valueFormatted : u.value
                },
                filter: !1,
                suppressMenu: !0,
                resizable: !1,
                suppressSizeToFit: !0,
                sortable: !1,
                width: 230
            },
            productValue: {
                headerName: "",
                field: "productValue",
                cellClass: function(u) {
                    return u.data.cellClass
                },
                cellRenderer: function(u) {
                    return u.data.realCellRenderer(u)
                },
                filter: !1,
                suppressMenu: !0,
                resizable: !1,
                suppressSizeToFit: !0,
                sortable: !1,
                valueFormatter: function(u) {
                    return u.data.productValueFormatted
                },
                width: 140
            }
        }
    }
      , aa = function() {
        return {
            rank: {
                headerName: " ",
                field: "rank",
                cellClass: "cell-number",
                icons: GridHelper.getIconsSortNumeric(),
                sort: "asc",
                suppressMenu: !0,
                suppressSizeToFit: !0,
                suppressToolPanel: !0,
                width: 64
            },
            sellerName: {
                headerName: "Name",
                field: "sellerName",
                cellRenderer: function(u) {
                    return '<a href="' + getBaseUrl() + "#!seller/" + u.data.domainId + "-" + u.data.sellerId + '" title="' + la._181 + '">' + u.value + "</a>"
                },
                lockVisible: !0,
                minWidth: 100
            },
            currentRating: {
                headerName: la._440,
                field: "currentRating",
                cellClass: "cell-number",
                cellRenderer: GridHelper.cellRendererRating,
                comparator: GridHelper.comparatorNumberNullLast,
                filter: "agNumberColumnFilter",
                icons: GridHelper.getIconsSortNumeric(),
                suppressSizeToFit: !0,
                valueFormatter: GridHelper.valueFormatterRatingPercentage,
                width: 76
            },
            groupRatingCount: {
                headerName: la._441,
                children: [{
                    headerName: "Total",
                    headerNameGroup: la._441,
                    field: "currentRatingCount",
                    cellClass: "cell-number",
                    cellRenderer: GridHelper.cellRendererRating,
                    comparator: GridHelper.comparatorNumberNullLast,
                    filter: "agNumberColumnFilter",
                    icons: GridHelper.getIconsSortNumeric(),
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterRatingCount,
                    width: 70
                }, {
                    headerName: "Last 30 Days",
                    headerNameGroup: la._441,
                    field: "ratingsLast30Days",
                    cellClass: "cell-number",
                    cellRenderer: GridHelper.cellRendererRating,
                    comparator: GridHelper.comparatorNumberNullLast,
                    filter: "agNumberColumnFilter",
                    icons: GridHelper.getIconsSortNumeric(),
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterRatingCount,
                    width: 108
                }]
            },
            hasFBA: {
                headerName: "Uses FBA",
                field: "hasFBA",
                type: ["booleanColumn"],
                width: 72
            },
            totalStorefrontAsins: {
                headerName: "Verified Listings",
                field: "totalStorefrontAsins",
                cellClass: "cell-number",
                comparator: GridHelper.comparatorNumberNullLast,
                filter: "agNumberColumnFilter",
                icons: GridHelper.getIconsSortNumeric(),
                suppressSizeToFit: !0,
                valueFormatter: function(u) {
                    return null == u.value ? "-" : NumberUtil.format(u.value)
                },
                valueGetter: function(u) {
                    var v = null;
                    u.data.totalStorefrontAsins && 2 == u.data.totalStorefrontAsins.length && (v = u.data.totalStorefrontAsins[1]);
                    if (null == v || 0 === v)
                        v = null != u.data.totalProductCountFromStatistics ? u.data.totalProductCountFromStatistics : v;
                    return v
                },
                minWidth: 104,
                width: 104
            },
            topCategory: {
                headerName: "Selling primarily",
                field: "topCategory",
                cellRenderer: function(u) {
                    if (null == u.value)
                        return "-";
                    var v = {
                        f: {
                            rootCategory: {
                                filter: u.data.topCategory
                            },
                            sellerIds: {
                                filter: u.data.sellerId,
                                type: "isOneOf"
                            }
                        },
                        s: null,
                        t: "g"
                    };
                    u.data.topCategory > invalidIfLargerCatId && delete v.f.rootCategory;
                    v = encodeURIComponent(JSON.stringify(v));
                    v = getBaseUrl() + "#!finder/" + v;
                    var G = u.value
                      , w = u.data.sellerName
                      , B = document.createElement("div")
                      , Q = document.createElement("a");
                    Q.href = v;
                    Q.innerHTML = "" + u.value;
                    Q.title = 'Search for "' + w.replace(/\\"/g, "&quot;") + '"' + (G.length ? ' and "' + G.replace(/"/g, "&quot;") + '"' : "") + " in our Product Finder";
                    B.appendChild(Q).insertAdjacentHTML("beforeend", ' <span style="color:#999;">(' + NumberUtil.format(u.data.topCategoryProductCountPercentage) + " %)</span>");
                    return B
                },
                suppressSizeToFit: !1,
                minWidth: 100,
                valueGetter: function(u) {
                    return "undefined" === typeof u.data.topCategory ? null : GridHelperCategory.getName(u.data.domainId, u.data.topCategory)
                },
                width: 150
            },
            sellerId: {
                headerName: la._618,
                field: "sellerId",
                cellClass: "cell-id",
                suppressSizeToFit: !0,
                width: 126
            }
        }
    }
      , ea = function() {
        return {
            catName: {
                headerName: "Brand",
                field: "brand",
                cellRenderer: function(u) {
                    if (null == u.value)
                        return "-";
                    var v = encodeURIComponent(JSON.stringify({
                        f: {
                            brand: {
                                filter: u.value,
                                type: "isOneOf"
                            },
                            sellerIds: {
                                filter: u.context.data.sellerId,
                                type: "isOneOf"
                            }
                        },
                        s: null,
                        t: "g"
                    }));
                    v = getBaseUrl() + "#!finder/" + v;
                    var G = u.value
                      , w = u.context.data.sellerName
                      , B = document.createElement("div")
                      , Q = document.createElement("a");
                    Q.href = v;
                    Q.innerHTML = "" + u.value;
                    Q.title = 'Search for "' + w.replace(/\\"/g, "&quot;") + '" and "' + G.replace(/"/g, "&quot;") + '" in our Product Finder';
                    B.appendChild(Q);
                    return B
                },
                suppressSizeToFit: !1,
                width: 280
            },
            productCountPercentage: {
                headerName: "Listings",
                field: "productCountPercentage",
                sort: "desc",
                type: ["numberColumn"],
                valueFormatter: function(u) {
                    return NumberUtil.format(u.value, 2) + " %"
                },
                width: 85
            },
            productCountWithAmazonOfferPercentage: {
                headerName: "Listings with Amazon offer",
                field: "productCountWithAmazonOfferPercentage",
                type: ["numberColumn"],
                valueFormatter: function(u) {
                    return NumberUtil.format(u.value, 2) + " %"
                },
                width: 180
            },
            avg30SalesRank: {
                headerName: "30 days avg. sales rank",
                field: "avg30SalesRank",
                type: ["numberColumn", "numberSalesRankColumn"],
                width: 150
            }
        }
    }
      , ra = function() {
        return {
            catName: {
                headerName: "Category",
                field: "catName",
                cellRenderer: function(u) {
                    if (null == u.value)
                        return "-";
                    var v = encodeURIComponent(JSON.stringify({
                        f: {
                            rootCategory: {
                                filter: u.data.catId
                            },
                            sellerIds: {
                                filter: u.context.data.sellerId,
                                type: "isOneOf"
                            }
                        },
                        s: null,
                        t: "g"
                    }));
                    v = getBaseUrl() + "#!finder/" + v;
                    var G = u.value
                      , w = u.context.data.sellerName
                      , B = document.createElement("div")
                      , Q = document.createElement("a");
                    Q.href = v;
                    Q.innerHTML = "" + u.value;
                    Q.title = 'Search for "' + w.replace(/\\"/g, "&quot;") + '" and "' + G.replace(/"/g, "&quot;") + '" in our Product Finder';
                    B.appendChild(Q);
                    return B
                },
                suppressSizeToFit: !1,
                width: 280
            },
            productCountPercentage: {
                headerName: "Listings",
                field: "productCountPercentage",
                sort: "desc",
                type: ["numberColumn"],
                valueFormatter: function(u) {
                    return NumberUtil.format(u.value, 2) + " %"
                },
                width: 85
            },
            productCountWithAmazonOfferPercentage: {
                headerName: "Listings with Amazon offer",
                field: "productCountWithAmazonOfferPercentage",
                type: ["numberColumn"],
                valueFormatter: function(u) {
                    return NumberUtil.format(u.value, 2) + " %"
                },
                width: 180
            },
            avg30SalesRank: {
                headerName: "30 days avg. sales rank",
                field: "avg30SalesRank",
                type: ["numberColumn", "numberSalesRankColumn"],
                width: 150
            }
        }
    }
      , pa = function() {
        return {
            imagesCSV: {
                headerName: la._589,
                field: "imagesCSV",
                cellClass: "cell-image",
                cellRenderer: GridHelper.cellRendererImage,
                cellRendererParams: {
                    imageSize: 99
                },
                suppressSizeToFit: !0,
                sortable: !1,
                width: 101
            },
            title: {
                headerName: la._590,
                field: "title",
                cellRenderer: function(u) {
                    return '<a href="#!product/' + u.data.domainId + "-" + u.data.asin + '">' + GridHelper.defaultTextClamp(u.value, 6) + "</a>"
                },
                width: 200
            },
            AMAZON_current: {
                headerName: CsvType.getName(CsvType.AMAZON.index),
                field: "AMAZON_current",
                type: ["priceColumn"],
                minWidth: 74,
                width: 74
            },
            NEW_current: {
                headerName: CsvType.getName(CsvType.NEW.index),
                field: "NEW_current",
                type: ["priceColumn"],
                minWidth: 74,
                width: 74
            },
            USED_current: {
                headerName: CsvType.getName(CsvType.USED.index),
                field: "USED_current",
                type: ["priceColumn"],
                minWidth: 74,
                width: 74
            },
            color: {
                headerName: la._591,
                field: "color",
                cellRenderer: function(u) {
                    return GridHelper.defaultTextClamp(u.value, 6)
                },
                width: 120
            },
            size: {
                headerName: la._592,
                field: "size",
                cellRenderer: function(u) {
                    return GridHelper.defaultTextClamp(u.value, 6)
                },
                width: 120
            },
            edition: {
                headerName: la._593,
                field: "edition",
                cellRenderer: function(u) {
                    return GridHelper.defaultTextClamp(u.value, 6)
                },
                width: 120
            },
            format: {
                headerName: la._595,
                field: "format",
                cellRenderer: function(u) {
                    return GridHelper.defaultTextClamp(u.value, 6)
                },
                width: 120
            },
            asin: {
                headerName: "ASIN",
                field: "asin",
                cellClass: "cell-id",
                width: 90
            }
        }
    }
      , ua = function() {
        var u = {
            checkboxSelection: GridConfig.gridTypesWithCheckboxSelection.includes("variation") ? {
                headerName: "",
                field: "checkboxSelection",
                checkboxSelection: !0,
                headerCheckboxSelection: !0,
                headerCheckboxSelectionFilteredOnly: !0,
                hide: !0,
                lockPinned: !0,
                pinned: "left",
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                sortable: !1,
                suppressToolPanel: !0,
                width: 30
            } : {},
            imagesCSV: {
                headerName: la._589,
                field: "imagesCSV",
                cellClass: "cell-image",
                cellRenderer: GridHelper.cellRendererImage,
                cellRendererParams: {
                    imageSize: 99
                },
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                sortable: !1,
                width: 101
            },
            title: {
                headerName: la._590,
                field: "title",
                cellRenderer: function(w) {
                    var B = "#!product/" + w.data.domainId + "-" + w.data.asin
                      , Q = "";
                    iframe.isIframe && (B = "http://www.amazon." + getTldByDomain(w.data.domainId) + "/dp/" + w.data.asin + "?psc=1",
                    Q = ' target="_parent"');
                    return '<a class="href" href="' + B + '"' + Q + ">" + GridHelper.defaultTextClamp(w.value, 6) + "</a>"
                },
                lockVisible: !0,
                minWidth: 100,
                width: 200
            },
            AMAZON_current: {
                headerName: CsvType.getName(CsvType.AMAZON.index),
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate('<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(CsvType.AMAZON.index).color + '" ></i> ', "")
                },
                field: "AMAZON_current",
                type: ["priceColumn"],
                sort: "asc"
            },
            NEW_current: {
                headerName: CsvType.getName(CsvType.NEW.index),
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate('<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(CsvType.NEW.index).color + '" ></i> ', "")
                },
                field: "NEW_current",
                type: ["priceColumn"]
            },
            USED_current: {
                headerName: CsvType.getName(CsvType.USED.index),
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate('<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(CsvType.USED.index).color + '" ></i> ', "")
                },
                field: "USED_current",
                type: ["priceColumn"]
            },
            variationAttributes: {
                headerName: "Variation Attributes",
                field: "variationAttributes",
                cellClass: "cell-flex",
                cellRenderer: function(w) {
                    var B = ""
                      , Q = "";
                    if (w = w.value) {
                        w = $jscomp.makeIterator(w);
                        for (var fa = w.next(); !fa.done; fa = w.next())
                            fa = fa.value,
                            B += "<i>" + fa.dimension + ":</i>&emsp;<br>",
                            Q += fa.value + "<br>"
                    }
                    return "<span>" + B + "</span><span>" + Q + "</span>"
                },
                tooltipValueGetter: function(w) {
                    var B = "";
                    if (w = w.value) {
                        w = $jscomp.makeIterator(w);
                        for (var Q = w.next(); !Q.done; Q = w.next())
                            Q = Q.value,
                            B += Q.dimension + ": " + Q.value + "; "
                    }
                    return B.trim()
                },
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                sortable: !1,
                width: 160
            },
            color: {
                headerName: la._591,
                field: "color",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !1,
                minWidth: 80,
                width: 120
            },
            size: {
                headerName: la._592,
                field: "size",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !1,
                minWidth: 80,
                width: 120
            },
            edition: {
                headerName: la._593,
                field: "edition",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !1,
                minWidth: 80,
                width: 120
            },
            format: {
                headerName: la._595,
                field: "format",
                cellClass: "cell-wrap",
                cellRenderer: GridHelper.cellRendererTextFinder,
                suppressSizeToFit: !1,
                minWidth: 80,
                width: 120
            },
            groupReviews: GridHelperReviews.getColumnGroupReviewsFormatSpecific(),
            asin: {
                headerName: "ASIN",
                field: "asin",
                cellClass: "cell-id",
                filter: !1,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                width: 90
            },
            eanList: {
                headerName: "EAN",
                field: "eanList",
                type: ["productCodeColumn"],
                cellRenderer: GridHelper.cellRendererProductCodeSingle
            },
            upcList: {
                headerName: "UPC",
                field: "upcList",
                type: ["productCodeColumn"],
                cellRenderer: GridHelper.cellRendererProductCodeSingle
            },
            COUNT_NEW_current: {
                headerName: CsvType.getName(CsvType.COUNT_NEW.index),
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate('<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(CsvType.COUNT_NEW.index).color + '" ></i> ', "")
                },
                field: "COUNT_NEW_current",
                type: ["offerCountColumn"],
                width: 120
            },
            COUNT_USED_current: {
                headerName: CsvType.getName(CsvType.COUNT_USED.index),
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate('<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(CsvType.COUNT_USED.index).color + '" ></i> ', "")
                },
                field: "COUNT_USED_current",
                type: ["offerCountColumn"],
                width: 120
            },
            COUNT_REFURBISHED_current: {
                headerName: CsvType.getName(CsvType.COUNT_REFURBISHED.index),
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate('<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(CsvType.COUNT_REFURBISHED.index).color + '" ></i> ', "")
                },
                field: "COUNT_REFURBISHED_current",
                type: ["offerCountColumn"],
                width: 140
            },
            COUNT_COLLECTIBLE_current: {
                headerName: CsvType.getName(CsvType.COUNT_COLLECTIBLE.index),
                headerComponentParams: {
                    template: GridHelper.getHeaderComponentTemplate('<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.getObject(CsvType.COUNT_COLLECTIBLE.index).color + '" ></i> ', "")
                },
                field: "COUNT_COLLECTIBLE_current",
                type: ["offerCountColumn"],
                width: 140
            }
        }, v = {}, G;
        for (G in u)
            u[G].children ? (v.$jscomp$loop$prop$keepChildren$686 = [],
            u[G].children.forEach(function(w) {
                return function(B, Q) {
                    0 < Object.keys(B).length && w.$jscomp$loop$prop$keepChildren$686.push(B)
                }
            }(v)),
            u[G].children = v.$jscomp$loop$prop$keepChildren$686) : 0 === Object.keys(u[G]).length && delete u[G],
            v = {
                $jscomp$loop$prop$keepChildren$686: v.$jscomp$loop$prop$keepChildren$686
            };
        return u
    }
      , na = function(u, v) {
        var G = CsvType[u].index
          , w = CsvType.getName(G)
          , B = "SALES" === u ? ["salesRankColumn"] : ["priceColumn"]
          , Q = "asinDeals" === v
          , fa = "asinFinder" === v;
        v = "asinViewer" === v;
        if ("RENT" === u && Number(storage.domain) !== getDomainByTld("com"))
            return {};
        var R = "";
        GridHelper.isOfferData(u) && (R = "? = last offer update older than 72 hours\nitalic = last offer update older than 24 hours");
        G = {
            headerName: CsvType.getNameWithCircle(G),
            children: [{
                headerName: la._344,
                headerNameGroup: w,
                headerTooltip: R,
                field: u + "_current",
                type: B
            }, Q && "LIGHTNING_DEAL" !== u ? {
                headerName: "1 day avg.",
                headerNameGroup: w,
                field: u + "_avg1",
                type: B,
                hide: !0
            } : {}, Q && "LIGHTNING_DEAL" !== u ? {
                headerName: "7 days avg.",
                headerNameGroup: w,
                field: u + "_avg7",
                type: B,
                hide: !0
            } : {}, "LIGHTNING_DEAL" !== u ? {
                headerName: "30 days avg.",
                headerNameGroup: w,
                field: u + "_avg30",
                type: B,
                hide: !0
            } : {}, "LIGHTNING_DEAL" !== u ? {
                headerName: "90 days avg.",
                headerNameGroup: w,
                field: u + "_avg90",
                type: B
            } : {}, "LIGHTNING_DEAL" === u || Q ? {} : {
                headerName: "180 days avg.",
                headerNameGroup: w,
                field: u + "_avg180",
                type: B,
                hide: !0
            }, Q && "LIGHTNING_DEAL" !== u ? g({
                headerNameGroup: w,
                csvType: u,
                range: 1
            }) : {}, Q && "LIGHTNING_DEAL" !== u ? g({
                headerNameGroup: w,
                csvType: u,
                range: 7
            }) : {}, Q && "LIGHTNING_DEAL" !== u ? g({
                headerNameGroup: w,
                csvType: u,
                range: 30
            }) : "LIGHTNING_DEAL" !== u ? J({
                headerNameGroup: w,
                csvType: u,
                range: 30,
                hide: !0
            }) : {}, Q && "LIGHTNING_DEAL" !== u ? g({
                headerNameGroup: w,
                csvType: u,
                range: 90
            }) : "LIGHTNING_DEAL" !== u ? J({
                headerNameGroup: w,
                csvType: u,
                range: 90,
                hide: !fa
            }) : {}, v && "LIGHTNING_DEAL" !== u ? za({
                headerNameGroup: w,
                csvType: u,
                range: "custom",
                hide: v
            }) : {}, v && "LIGHTNING_DEAL" !== u ? J({
                headerNameGroup: w,
                csvType: u,
                range: "custom",
                hide: v
            }) : {}, v && "LIGHTNING_DEAL" !== u ? {
                headerName: "Last visit",
                headerTooltip: "(" + prettyDate((Date.now() - (Number(storage.lastViewerVisit) || Date.now())) / 6E4).replace(/&nbsp;/g, " ") + ")",
                headerNameGroup: w,
                field: u + "_atIntervalStart",
                type: B,
                hide: !0
            } : {}, "LIGHTNING_DEAL" !== u ? {
                headerName: "Lowest",
                headerNameGroup: w,
                field: u + "_lowest",
                type: B,
                hide: !0
            } : {}, "LIGHTNING_DEAL" !== u ? {
                headerName: "Highest",
                headerNameGroup: w,
                field: u + "_highest",
                type: B,
                hide: !0
            } : {}]
        };
        "SALES" === u && (G.groupId = "groupSalesRank",
        G.children[0].sort = "asc",
        Q || (G.children.push(ba(30)),
        G.children.push(ba(90)),
        G.children.push(ba(180)),
        G.children.push(q()),
        G.children.push(L())));
        "AMAZON" === u && (!0 !== disableStockFeatures && G.children.push({
            headerName: "Stock",
            headerNameGroup: CsvType.getName(CsvType.AMAZON.index),
            field: "stockAmazon",
            type: ["stockSingleColumn"],
            hide: !0
        }),
        G.children.push(GridHelperCsvType.getColumnOutOfStockPercentage(u)),
        G.children.push({
            headerName: "Availability of the Amazon offer",
            headerNameGroup: CsvType.getName(CsvType.AMAZON.index),
            headerTooltip: "Availability of the Amazon offer",
            field: "availabilityAmazon",
            cellRenderer: function(T) {
                return GridHelper.defaultTextClamp(T.valueFormatted, 3, !0)
            },
            filter: "agSetColumnFilter",
            filterParams: {
                cellHeight: 22,
                cellRenderer: function(T) {
                    return '<span title="' + T.valueFormatted + '" class="text-clamp clamp-lines-1">' + T.valueFormatted + "</span>"
                },
                suppressAndOrCondition: !0,
                suppressMiniFilter: !0,
                suppressRemoveEntries: !0,
                values: fa ? [-1, 0, 1, 2, 3, 4] : null,
                valueMap: fa ? GridHelper.availabilityAmazonValueMap : null
            },
            hide: !0,
            sortable: !1,
            suppressSizeToFit: !0,
            valueFormatter: function(T) {
                return GridHelper.availabilityAmazonValueMap[T.value]
            },
            width: 150
        }));
        ["NEW", "USED"].includes(u) && G.children.push(GridHelperCsvType.getColumnOutOfStockPercentage(u));
        "BUY_BOX_SHIPPING" === u && (!0 !== disableStockFeatures && G.children.push({
            headerName: "Stock",
            headerNameGroup: CsvType.getName(CsvType.BUY_BOX_SHIPPING.index),
            field: "stockBuyBox",
            type: ["stockSingleColumn"]
        }),
        G.children.push(GridHelperCsvType.getColumnOutOfStockPercentage(u)));
        "LIGHTNING_DEAL" === u && G.children.push({
            headerName: "Upcoming Deal",
            headerNameGroup: CsvType.getName(CsvType.LIGHTNING_DEAL.index),
            field: "LIGHTNING_DEAL_upcoming",
            type: ["booleanColumn"],
            valueGetter: function(T) {
                return "undefined" === typeof T.data ? !1 : (T = T.data.stats.lightningDealInfo ? T.data.stats.lightningDealInfo[0] : -1) && T > keepaTime.now()
            }
        });
        return G
    }
      , qa = function(u) {
        if (!CsvType[u].isEnabled)
            return {};
        var v = function(Z) {
            return CsvType[u].isTrackable ? la._746 : ""
        }
          , G = function(Z, ja, W) {
            W && reportBug(null, ja);
            showPopup(Z, ja, !0)
        }
          , w = GridManage.pageConfig.activeViewMode === GridManage.viewModes.COMPACT
          , B = GridHelper.csvTypeIsTrackable(u)
          , Q = CsvType[u].index
          , fa = CsvType.getName(Q)
          , R = CsvType[u].currency
          , T = Q === CsvType.LIGHTNING_DEAL.index
          , oa = Number(storage.lastManageVisit) || Date.now();
        return {
            headerName: CsvType.getNameWithCircle(Q),
            headerTooltip: fa,
            children: [w && CsvType[u].graphAPI ? {
                headerName: la._692,
                headerNameGroup: fa,
                headerTooltip: la._692,
                field: u + "_graph",
                cellClass: "cell-graph-compact",
                cellRenderer: function(Z) {
                    if (Z.data.isDeleted || -2 === Z.data.product[u + "_current"])
                        return "";
                    var ja = GridManage.graphRanges
                      , W = ja.MONTH;
                    W = -1 < GridManage.pageConfig.graphRange ? GridManage.pageConfig.graphRange : 2399976;
                    var Aa = Math.ceil(W / 24)
                      , Ca = "1 " + la._136;
                    W == ja.WEEK ? Ca = "1 " + la._137 : W == ja.MONTH ? Ca = "1 " + la._139 : W == ja.QUARTER ? Ca = "" + la._140 : W == ja.YEAR ? Ca = "1 " + la._141 : GridManage.pageConfig.graphRange == ja.ALL && (Ca = "");
                    var Ba = Z.data.detailDomainId;
                    ja = Z.data.product.csvTypesWithData;
                    Z.data.product.domainId !== Ba && (W = Z.data.multiLocaleProductsReduced.find(function(ta) {
                        return ta.domainId === Ba
                    })) && (ja = W.csvTypesWithData);
                    W = "";
                    ja.includes(u) && (ja = GraphService.getWebGraphTypeAllOff(),
                    ja[CsvType[u].index] = 1,
                    W = GraphService.getUrl(Z.data.asin, Ba, 103, 37, ja, Aa, 1));
                    Aa = document.createElement("span");
                    Aa.title = "Amazon." + getTldByDomain(Ba) + ": " + Ca + " " + fa + " " + ("SALES" !== u ? "price " : "") + "history";
                    Aa.style.background = W ? "url(" + W + ") no-repeat left" : "none";
                    Aa.style.height = "37px";
                    Aa.style.width = "103px";
                    Z.data.multiLocaleProductsReduced.length && (Aa.style.cursor = "pointer",
                    Aa.dataset.domainid = Ba,
                    Aa.addEventListener("click", function() {
                        var ta = getTldByDomain($(this).data("domainid"));
                        ta = Z.data.multiDomainIds.indexOf(ta);
                        ta = getDomainByTld(Z.data.multiDomainIds[ta + 1] ? Z.data.multiDomainIds[ta + 1] : Z.data.multiDomainIds[0]);
                        var Ea = Z.node.data;
                        Ea.detailDomainId = ta;
                        Z.api.updateRowData({
                            update: [Ea]
                        })
                    }));
                    Ca = document.createElement("span");
                    Ca.appendChild(Aa);
                    return Ca
                },
                filter: !1,
                getQuickFilterText: function(Z) {
                    return ""
                },
                lockPinned: !0,
                suppressMenu: !0,
                suppressSizeToFit: !0,
                sortable: !1,
                suppressToolPanel: !1,
                valueGetter: function(Z) {
                    return "graph-" + Z.data.detailDomainId
                },
                minWidth: 101,
                maxWidth: 101,
                width: 101
            } : {}, {
                headerName: la._344,
                headerNameGroup: fa,
                headerTooltip: la._344,
                headerClass: "header-cell-align-right",
                field: u + "_current",
                cellClass: "cell-number cell-number-bold",
                type: ["trackingColumn"]
            }, B && T ? {
                headerName: la._869,
                headerNameGroup: fa,
                headerTooltip: la._431,
                headerClass: "header-cell-align-right",
                field: u + "_upcoming",
                cellClass: "cell-icon cell-right cell-text-compact",
                cellRenderer: function(Z) {
                    return Z.value ? '<span><i class="fa fa-check" style="color:rgba(255, 0, 0, 0.7);"></i></span>' : ""
                },
                filter: "customBooleanColumnFilter",
                getQuickFilterText: null,
                icons: GridHelper.getIconsSortNumeric(),
                lockPinned: !0,
                suppressSizeToFit: !0,
                valueGetter: function(Z) {
                    return Z.data.product[u + "_upcoming"]
                },
                minWidth: 100,
                width: 100,
                editable: !0,
                cellEditor: "cellEditorThresholdBooleanValues",
                cellEditorParams: {
                    isMultiLocaleData: !1
                },
                enableCellChangeFlash: !0,
                suppressKeyboardEvent: GridHelper.cellSuppressKeyboardEvent,
                tooltipValueGetter: v,
                valueSetter: function(Z) {
                    Z.data.domainId != getDomainByTld("in") && Z.data.domainId != getDomainByTld("com.br") || 0 !== Z.data.multiLocaleProductsReduced.length || (Z.newValue = !1);
                    if (Z.newValue === Z.oldValue)
                        return !1;
                    var ja = function(W, Aa) {
                        var Ca = W.node.data;
                        Ca.product[u + "_upcoming"] = Aa;
                        setTimeout(function() {
                            W.api.updateRowData({
                                update: [Ca]
                            })
                        }, 0)
                    };
                    (function(W) {
                        var Aa = GridManage.getTrackingUpdateObject();
                        Aa.lightningDealsAlerts = W.newValue;
                        var Ca = {
                            path: "track",
                            type: "updateTracking",
                            asin: W.data.asin,
                            trackingUpdate: Aa,
                            version: 3
                        };
                        isTest && console.info("%ctrackingUpdateRequest", "color:green;", Aa);
                        network.request(Ca).done(function(Ba) {
                            null == Ba.error ? ja(W, Aa.lightningDealsAlerts) : G("Tracking Update Error", Ba.error, !0)
                        }).fail(function(Ba) {
                            G("Tracking Update Error", Ba.error, !0)
                        })
                    }
                    )(Z);
                    return !0
                }
            } : {}, B && T ? {
                headerName: la._870,
                headerNameGroup: fa,
                headerTooltip: la._713,
                headerClass: "header-cell-align-right",
                field: u + "_backInStock",
                cellClass: "cell-icon cell-right cell-boolean",
                cellRenderer: function(Z) {
                    var ja = Z.colDef.field;
                    if ("undefined" !== typeof Z.data.isUpdating && !0 === Z.data.isUpdating[ja])
                        return '<div style="text-align:right;padding-top:5px;"><i class="fa fa-spinner fa-spin"></i></div>';
                    ja = Z.data.product[u + "_backInStock"] ? '<span><i class="fa fa-check" style="color:rgba(255, 0, 0, 0.7);"></i></span><br>' : "<span><i>&nbsp;</i></span><br>";
                    if (Z.data.multiLocaleProductsReduced.length) {
                        Z = $jscomp.makeIterator(Z.data.multiLocaleProductsReduced);
                        for (var W = Z.next(); !W.done; W = Z.next())
                            ja += W.value[u + "_backInStock"] ? '<span><i class="fa fa-check" style="color:rgba(255, 0, 0, 0.7);"></i></span><br>' : "<span><i>&nbsp;</i><span><br>"
                    }
                    return ja
                },
                filter: "customBooleanColumnFilter",
                filterValueGetter: function(Z) {
                    var ja = Z.data.product[u + "_backInStock"];
                    if (Z.data.multiLocaleProductsReduced.length) {
                        Z = $jscomp.makeIterator(Z.data.multiLocaleProductsReduced);
                        for (var W = Z.next(); !W.done; W = Z.next())
                            W.value[u + "_backInStock"] && (ja = !0)
                    }
                    return ja
                },
                getQuickFilterText: null,
                icons: GridHelper.getIconsSortNumeric(),
                lockPinned: !0,
                suppressSizeToFit: !0,
                valueGetter: function(Z) {
                    var ja = {};
                    ja[Z.data.product.domainId] = Z.data.product[u + "_backInStock"];
                    if (Z.data.multiLocaleProductsReduced.length) {
                        Z = $jscomp.makeIterator(Z.data.multiLocaleProductsReduced);
                        for (var W = Z.next(); !W.done; W = Z.next())
                            W = W.value,
                            ja[W.domainId] = W[u + "_backInStock"]
                    }
                    return ja
                },
                minWidth: 130,
                width: 130,
                editable: !0,
                cellEditor: "cellEditorThresholdBooleanValues",
                cellEditorParams: {
                    isMultiLocaleData: !0
                },
                enableCellChangeFlash: !0,
                suppressKeyboardEvent: GridHelper.cellSuppressKeyboardEvent,
                tooltipValueGetter: v,
                valueSetter: function(Z) {
                    var ja = Z.colDef.field
                      , W = Z.newValue;
                    W[getDomainByTld("in")] && (W[getDomainByTld("in")] = !1);
                    W[getDomainByTld("com.br")] && (W[getDomainByTld("com.br")] = !1);
                    var Aa = function(Ba) {
                        var ta = NotifyIfType.indexOf("BACK_IN_STOCK")
                          , Ea = Z.node
                          , va = Ea.data;
                        va.isUpdating[ja] = !1;
                        if (!0 !== Ba)
                            Ea.setData(va);
                        else {
                            Ba = va.multiLocaleProductsReduced;
                            var da = {}, Y;
                            for (Y in W) {
                                da.$jscomp$loop$prop$domainId$236$694 = Y;
                                a: {
                                    var ma = W[da.$jscomp$loop$prop$domainId$236$694]
                                      , ca = !1;
                                    if (da.$jscomp$loop$prop$domainId$236$694 == va.domainId) {
                                        if (ma == va.product[ja])
                                            break a;
                                        va.product[ja] = ma;
                                        !0 === ma && (va.product[u + "_desired"] = -1,
                                        va.product[u + "_delta"] = null);
                                        0 < va.product[u + "_current"] && (va.product[u + "_isDrop"] && 0 >= va.product[u + "_delta"] || !va.product[u + "_isDrop"] && 0 <= va.product[u + "_delta"]) && (ca = !0)
                                    } else {
                                        var ha = Ba.findIndex(function(C) {
                                            return function(U) {
                                                return U.domainId == C.$jscomp$loop$prop$domainId$236$694
                                            }
                                        }(da));
                                        if (-1 < ha) {
                                            if (ma == va.multiLocaleProductsReduced[ha][ja])
                                                break a;
                                            va.multiLocaleProductsReduced[ha][ja] = ma;
                                            !0 === ma && (va.multiLocaleProductsReduced[ha][u + "_desired"] = -1,
                                            va.multiLocaleProductsReduced[ha][u + "_delta"] = null);
                                            0 < va.multiLocaleProductsReduced[ha][u + "_current"] && (va.multiLocaleProductsReduced[ha][u + "_isDrop"] && 0 >= va.multiLocaleProductsReduced[ha][u + "_delta"] || !va.multiLocaleProductsReduced[ha][u + "_isDrop"] && 0 <= va.multiLocaleProductsReduced[ha][u + "_delta"]) && (ca = !0)
                                        }
                                    }
                                    ha = va.conditionsMet.findIndex(function(C) {
                                        return function(U) {
                                            return U.domainId == C.$jscomp$loop$prop$domainId$236$694 && U.csvTypeIndex == CsvType[u].index
                                        }
                                    }(da));
                                    ca && -1 == ha ? va.conditionsMet.push({
                                        domainId: Number(da.$jscomp$loop$prop$domainId$236$694),
                                        csvTypeIndex: CsvType[u].index
                                    }) : !ca && -1 < ha && va.conditionsMet.splice(ha, 1);
                                    null == va.tracking.thresholdValues && (va.tracking.thresholdValues = []);
                                    ca = va.tracking.thresholdValues.findIndex(function(C) {
                                        return function(U) {
                                            return U.csvType == CsvType[u].index && U.domain == C.$jscomp$loop$prop$domainId$236$694
                                        }
                                    }(da));
                                    !0 === ma && -1 < ca && (va.tracking.thresholdValues = va.tracking.thresholdValues.filter(function(C) {
                                        return function(U) {
                                            return !(U.csvType == CsvType[u].index && U.domain == C.$jscomp$loop$prop$domainId$236$694)
                                        }
                                    }(da)));
                                    !0 === ma ? va.tracking.notifyIf.push({
                                        domain: Number(da.$jscomp$loop$prop$domainId$236$694),
                                        csvType: CsvType[u].index,
                                        notifyIfType: ta
                                    }) : va.tracking.notifyIf = va.tracking.notifyIf.filter(function(C) {
                                        return function(U) {
                                            return !(U.domain === Number(C.$jscomp$loop$prop$domainId$236$694) && U.csvType === CsvType[u].index && U.notifyIfType === ta)
                                        }
                                    }(da))
                                }
                                da = {
                                    $jscomp$loop$prop$domainId$236$694: da.$jscomp$loop$prop$domainId$236$694
                                }
                            }
                            setTimeout(function() {
                                Ea.setData(va);
                                if (!w) {
                                    var C = Z.api.getDetailGridInfo(Z.node.detailNode.id);
                                    C.api.forEachNode(function(U) {
                                        var ia = U.data;
                                        ia.detailsPerDomain = [];
                                        for (var X = 1; X < numberOfDomains; X++)
                                            delete ia["historyGraphCache" + X];
                                        network.request({
                                            path: "product",
                                            asin: va.asin,
                                            domainId: va.detailDomainId,
                                            getTracking: !0,
                                            history: !0,
                                            maxAge: 15,
                                            offerPages: 0,
                                            refreshProduct: !1,
                                            type: "manage",
                                            version: 3
                                        }).done(function(sa) {
                                            null == sa || null == sa.products || 1 != sa.products.length ? (ia.detailDomainId = va.detailDomainId,
                                            U.setData(ia)) : (sa = GridHelper.prepareProductTrackingDetail(sa.products[0]),
                                            ia.detailDomainId = va.detailDomainId,
                                            ia.detailsPerDomain[va.detailDomainId] = {
                                                asin: sa.asin,
                                                domainId: sa.domainId,
                                                imagesCSV: sa.imagesCSV,
                                                title: sa.title,
                                                lastUpdate: sa.lastUpdate,
                                                lastEbayUpdate: sa.lastEbayUpdate,
                                                lastPriceChange: sa.lastPriceChange,
                                                graphData: {
                                                    buyBoxSellerIdHistory: sa.buyBoxSellerIdHistory,
                                                    csv: sa.csv,
                                                    offers: sa.offers,
                                                    tracking: va.tracking
                                                },
                                                detailRowHeight: GridManage.calculateDetailRowHeight(sa)
                                            },
                                            ia.wishLists = va.wishLists,
                                            ia.detailRowHeight = va.detailRowHeight,
                                            U.setData(ia),
                                            U.setRowHeight(ia.detailsPerDomain[va.detailDomainId].detailRowHeight),
                                            va.detailNode && va.detailNode.setRowHeight(ia.detailsPerDomain[va.detailDomainId].detailRowHeight),
                                            Z.api.onRowHeightChanged(),
                                            C.api.onRowHeightChanged())
                                        }).fail(showErrorPopup)
                                    })
                                }
                            }, 0)
                        }
                    }
                      , Ca = function() {
                        var Ba = NotifyIfType.indexOf("BACK_IN_STOCK")
                          , ta = function(ca, ha) {
                            ha === CsvType.LIGHTNING_DEAL.index && (va.desiredPrices = va.desiredPrices.filter(function(C) {
                                return !(C.domain === ca && C.csvType === ha)
                            }))
                        }
                          , Ea = Z.data.tracking
                          , va = GridManage.getTrackingCreationObject(Ea, !0, !1)
                          , da = Object.keys(W)
                          , Y = Ea.notifyIf;
                        if ("undefined" !== Y && null != Y) {
                            Ea = {};
                            Y = $jscomp.makeIterator(Y);
                            for (var ma = Y.next(); !ma.done; Ea = {
                                $jscomp$loop$prop$existingNotifyIf$696: Ea.$jscomp$loop$prop$existingNotifyIf$696
                            },
                            ma = Y.next())
                                Ea.$jscomp$loop$prop$existingNotifyIf$696 = ma.value,
                                Ea.$jscomp$loop$prop$existingNotifyIf$696.csvType !== CsvType[u].index || Ea.$jscomp$loop$prop$existingNotifyIf$696.notifyIfType !== Ba ? va.notifyIf.push(Ea.$jscomp$loop$prop$existingNotifyIf$696) : Ea.$jscomp$loop$prop$existingNotifyIf$696.csvType === CsvType[u].index && Ea.$jscomp$loop$prop$existingNotifyIf$696.notifyIfType === Ba && !0 === Z.newValue[Ea.$jscomp$loop$prop$existingNotifyIf$696.domain] && (va.notifyIf.push(Ea.$jscomp$loop$prop$existingNotifyIf$696),
                                da = da.filter(function(ca) {
                                    return function(ha) {
                                        return Number(ha) !== ca.$jscomp$loop$prop$existingNotifyIf$696.domain
                                    }
                                }(Ea)),
                                ta(Ea.$jscomp$loop$prop$existingNotifyIf$696.domain, Ea.$jscomp$loop$prop$existingNotifyIf$696.csvType))
                        }
                        if (da.length)
                            for (da = $jscomp.makeIterator(da),
                            Ea = da.next(); !Ea.done; Ea = da.next())
                                Ea = Ea.value,
                                Ea = Number(Ea),
                                !0 === Z.newValue[Ea] && (va.notifyIf.push({
                                    domain: Ea,
                                    csvType: CsvType[u].index,
                                    notifyIfType: Ba
                                }),
                                ta(Ea, CsvType[u].index));
                        isTest && console.info("%ctrackingCreationObject", "color:green;", va);
                        network.request({
                            path: "track",
                            type: "addTracking",
                            trackingRequest: va,
                            version: 3
                        }).done(function(ca) {
                            if (null == ca.error)
                                Aa(!0),
                                $("#fab-refresh").show();
                            else {
                                switch (ca.error.type) {
                                case "productNotKnown":
                                    G("Tracking Error", "Product is invalid and can not be tracked.", !1);
                                    break;
                                case "maxTrackingReached":
                                    G("Tracking Limit Reached", la._920.replace("#maxTrackingAllowed#", maxTrackingAllowed) + "<br><br><b>" + la._921 + "</b>", !1);
                                    break;
                                default:
                                    G("Tracking Error", ca.error, !0)
                                }
                                Aa(!1)
                            }
                        }).fail(function(ca) {
                            G("Tracking Error", ca.error, !0);
                            Aa(!1)
                        })
                    };
                    return function() {
                        var Ba = Z.data.multiLocaleProductsReduced, ta = {}, Ea;
                        for (Ea in W) {
                            ta.$jscomp$loop$prop$domainId$235$688 = Ea;
                            var va = W[ta.$jscomp$loop$prop$domainId$235$688];
                            if (ta.$jscomp$loop$prop$domainId$235$688 == Z.data.domainId && va !== Z.data.product[ja])
                                return !0;
                            var da = Ba.findIndex(function(Y) {
                                return function(ma) {
                                    return ma.domainId == Y.$jscomp$loop$prop$domainId$235$688
                                }
                            }(ta));
                            if (-1 < da && Z.data.multiLocaleProductsReduced[da][ja] !== va)
                                return !0;
                            ta = {
                                $jscomp$loop$prop$domainId$235$688: ta.$jscomp$loop$prop$domainId$235$688
                            }
                        }
                        return !1
                    }() ? ("undefined" === typeof Z.data.isUpdating && (Z.data.isUpdating = {}),
                    Z.data.isUpdating[ja] = !0,
                    Ca(),
                    !0) : !1
                }
            } : {}, B ? {
                headerName: R ? la._342.replace("&nbsp;", " ") : la._860,
                headerNameGroup: fa,
                headerTooltip: R ? la._342.replace("&nbsp;", " ") : la._860,
                headerClass: "header-cell-align-right",
                field: u + "_desired",
                cellClass: function(Z) {
                    var ja = ["cell-number"]
                      , W = Z.data.product;
                    if (!W.csvTypesWithTracking.includes(u) || !0 !== Z.context.hasPriceIncreaseTracking)
                        return ja;
                    W[u + "_isDrop"] ? ja.push("cell-desired-drop") : ja.push("cell-desired-increase");
                    return ja
                },
                cellStyle: function(Z) {
                    if (Z.data.isDeleted || !Z.data.product.csvTypesWithTracking.includes(u))
                        return null;
                    Z = CsvType[u].bg;
                    var ja = CsvType[u].color;
                    Z = Z.replace(/0.[1-9]/, "0.2");
                    return {
                        "background-color": Z,
                        "--csvtype-color": ja
                    }
                },
                type: ["trackingColumn"],
                editable: function(Z) {
                    if (!CsvType[u].isTrackable)
                        return !1;
                    Z = $jscomp.makeIterator(Z.data.multiDomainIds);
                    for (var ja = Z.next(); !ja.done; ja = Z.next())
                        if (ja = getDomainByTld(ja.value),
                        graphIsRestricted(ja, CsvType[u].index))
                            return !1;
                    return !0
                },
                cellEditor: "cellEditorThresholdValues",
                enableCellChangeFlash: !0,
                suppressKeyboardEvent: GridHelper.cellSuppressKeyboardEvent,
                tooltipValueGetter: v,
                valueParser: function(Z) {
                    isTest && console.info("%cvalueParser", "color:orange;", "newValue:", Z.newValue);
                    return Z.newValue
                },
                valueSetter: function(Z) {
                    var ja = u + "_desired"
                      , W = function(Ba, ta, Ea) {
                        var va = keepaTime.now()
                          , da = Ba.node
                          , Y = da.data;
                        Y.isUpdating[ja] = !1;
                        if (!0 !== Ea)
                            da.setData(Y);
                        else {
                            Ea = Y.multiLocaleProductsReduced;
                            var ma = {}, ca;
                            for (ca in ta) {
                                ma.$jscomp$loop$prop$domainId$242$703 = ca;
                                a: {
                                    var ha = ta[ma.$jscomp$loop$prop$domainId$242$703];
                                    if (-2 < ha) {
                                        var C = null
                                          , U = ha
                                          , ia = !1;
                                        if (ma.$jscomp$loop$prop$domainId$242$703 == Y.domainId) {
                                            if (ha == Y.product[ja])
                                                break a;
                                            Y.product[ja] = ha;
                                            0 < Y.product[u + "_current"] && 0 < U && (C = Y.product[u + "_current"] - U);
                                            Y.product[u + "_delta"] = C;
                                            0 < Y.product[u + "_current"] && (Y.product[u + "_isDrop"] && 0 >= Y.product[u + "_delta"] || !Y.product[u + "_isDrop"] && 0 <= Y.product[u + "_delta"]) && (ia = !0);
                                            CsvType[u].index === CsvType.LIGHTNING_DEAL.index && 0 <= ha && (Y.product[u + "_backInStock"] = !1)
                                        } else {
                                            var X = Ea.findIndex(function(sa) {
                                                return function(wa) {
                                                    return wa.domainId == sa.$jscomp$loop$prop$domainId$242$703
                                                }
                                            }(ma));
                                            if (-1 < X) {
                                                if (ha == Y.multiLocaleProductsReduced[X][ja])
                                                    break a;
                                                Y.multiLocaleProductsReduced[X][ja] = ha;
                                                currencies[Y.domainId] !== currencies[ma.$jscomp$loop$prop$domainId$242$703] && (U = Money.raw(U, {
                                                    sourceDomainId: Y.domainId,
                                                    targetDomainId: ma.$jscomp$loop$prop$domainId$242$703,
                                                    keepUnit: !0,
                                                    noDigits: !0
                                                }));
                                                0 < Y.multiLocaleProductsReduced[X][u + "_current"] && 0 < U && (C = Y.multiLocaleProductsReduced[X][u + "_current"] - U);
                                                Y.multiLocaleProductsReduced[X][u + "_delta"] = C;
                                                0 < Y.multiLocaleProductsReduced[X][u + "_current"] && (Y.multiLocaleProductsReduced[X][u + "_isDrop"] && 0 >= Y.multiLocaleProductsReduced[X][u + "_delta"] || !Y.multiLocaleProductsReduced[X][u + "_isDrop"] && 0 <= Y.multiLocaleProductsReduced[X][u + "_delta"]) && (ia = !0);
                                                CsvType[u].index === CsvType.LIGHTNING_DEAL.index && 0 <= ha && (Y.multiLocaleProductsReduced[X][u + "_backInStock"] = !1)
                                            }
                                        }
                                        C = Y.conditionsMet.findIndex(function(sa) {
                                            return function(wa) {
                                                return wa.domainId == sa.$jscomp$loop$prop$domainId$242$703 && wa.csvTypeIndex == CsvType[u].index
                                            }
                                        }(ma));
                                        ia && -1 == C ? Y.conditionsMet.push({
                                            domainId: Number(ma.$jscomp$loop$prop$domainId$242$703),
                                            csvTypeIndex: CsvType[u].index
                                        }) : !ia && -1 < C && Y.conditionsMet.splice(C, 1);
                                        null == Y.tracking.thresholdValues && (Y.tracking.thresholdValues = []);
                                        ia = Y.tracking.thresholdValues.findIndex(function(sa) {
                                            return function(wa) {
                                                return wa.csvType == CsvType[u].index && wa.domain == sa.$jscomp$loop$prop$domainId$242$703
                                            }
                                        }(ma));
                                        -1 < ia ? (Y.tracking.thresholdValues[ia].thresholdValueCSV.push(va),
                                        Y.tracking.thresholdValues[ia].thresholdValueCSV.push(ha)) : Y.tracking.thresholdValues.push({
                                            csvType: CsvType[u].index,
                                            deltasAreBetweenNotifications: null,
                                            domain: Number(ma.$jscomp$loop$prop$domainId$242$703),
                                            isDrop: Y.product[u + "_isDrop"],
                                            minDeltaAbsolute: null,
                                            minDeltaPercentage: null,
                                            thresholdValueCSV: [va, ha]
                                        });
                                        CsvType[u].index === CsvType.LIGHTNING_DEAL.index && 0 <= ha && (Y.tracking.notifyIf = Y.tracking.notifyIf.filter(function(sa) {
                                            return function(wa) {
                                                return !(wa.domain === Number(sa.$jscomp$loop$prop$domainId$242$703) && wa.csvType === CsvType[u].index && 1 === wa.notifyIfType)
                                            }
                                        }(ma)))
                                    }
                                }
                                ma = {
                                    $jscomp$loop$prop$domainId$242$703: ma.$jscomp$loop$prop$domainId$242$703
                                }
                            }
                            setTimeout(function() {
                                da.setData(Y);
                                if (!w) {
                                    var sa = Ba.api.getDetailGridInfo(Ba.node.detailNode.id);
                                    sa.api.forEachNode(function(wa) {
                                        var xa = wa.data;
                                        xa.detailsPerDomain = [];
                                        for (var Ia = 1; Ia < numberOfDomains; Ia++)
                                            delete xa["historyGraphCache" + Ia];
                                        network.request({
                                            path: "product",
                                            asin: Y.asin,
                                            domainId: Y.detailDomainId,
                                            getTracking: !0,
                                            history: !0,
                                            maxAge: 15,
                                            offerPages: 0,
                                            refreshProduct: !1,
                                            type: "manage",
                                            version: 3
                                        }).done(function(Fa) {
                                            null == Fa || null == Fa.products || 1 != Fa.products.length ? (xa.detailDomainId = Y.detailDomainId,
                                            wa.setData(xa)) : (Fa = GridHelper.prepareProductTrackingDetail(Fa.products[0]),
                                            xa.detailDomainId = Y.detailDomainId,
                                            xa.detailsPerDomain[Y.detailDomainId] = {
                                                asin: Fa.asin,
                                                domainId: Fa.domainId,
                                                imagesCSV: Fa.imagesCSV,
                                                title: Fa.title,
                                                lastUpdate: Fa.lastUpdate,
                                                lastEbayUpdate: Fa.lastEbayUpdate,
                                                lastPriceChange: Fa.lastPriceChange,
                                                graphData: {
                                                    buyBoxSellerIdHistory: Fa.buyBoxSellerIdHistory,
                                                    csv: Fa.csv,
                                                    offers: Fa.offers,
                                                    tracking: Y.tracking
                                                },
                                                detailRowHeight: GridManage.calculateDetailRowHeight(Fa)
                                            },
                                            xa.wishLists = Y.wishLists,
                                            xa.detailRowHeight = Y.detailRowHeight,
                                            wa.setData(xa),
                                            wa.setRowHeight(xa.detailsPerDomain[Y.detailDomainId].detailRowHeight),
                                            Y.detailNode && Y.detailNode.setRowHeight(xa.detailsPerDomain[Y.detailDomainId].detailRowHeight),
                                            Ba.api.onRowHeightChanged(),
                                            sa.api.onRowHeightChanged())
                                        }).fail(showErrorPopup)
                                    })
                                }
                            }, 0)
                        }
                    }
                      , Aa = function(Ba, ta) {
                        var Ea = function(ha, C) {
                            C === CsvType.LIGHTNING_DEAL.index && (da.notifyIf = da.notifyIf.filter(function(U) {
                                return !(U.domain === ha && U.csvType === C && 1 === U.notifyIfType)
                            }))
                        }
                          , va = Ba.data.tracking
                          , da = GridManage.getTrackingCreationObject(va, !1, !0)
                          , Y = va.thresholdValues;
                        if ("undefined" !== Y && null != Y) {
                            var ma = Object.keys(ta);
                            va = {};
                            Y = $jscomp.makeIterator(Y);
                            for (var ca = Y.next(); !ca.done; va = {
                                $jscomp$loop$prop$existingThresholdValue$705: va.$jscomp$loop$prop$existingThresholdValue$705
                            },
                            ca = Y.next())
                                va.$jscomp$loop$prop$existingThresholdValue$705 = ca.value,
                                ca = va.$jscomp$loop$prop$existingThresholdValue$705.thresholdValueCSV[va.$jscomp$loop$prop$existingThresholdValue$705.thresholdValueCSV.length - 1],
                                va.$jscomp$loop$prop$existingThresholdValue$705.csvType === CsvType[u].index && "undefined" !== typeof ta[va.$jscomp$loop$prop$existingThresholdValue$705.domain] && (ca = ta[va.$jscomp$loop$prop$existingThresholdValue$705.domain],
                                ma = ma.filter(function(ha) {
                                    return function(C) {
                                        return Number(C) !== ha.$jscomp$loop$prop$existingThresholdValue$705.domain
                                    }
                                }(va))),
                                0 > ca || (da.desiredPrices.push({
                                    domain: va.$jscomp$loop$prop$existingThresholdValue$705.domain,
                                    csvType: va.$jscomp$loop$prop$existingThresholdValue$705.csvType,
                                    isDrop: va.$jscomp$loop$prop$existingThresholdValue$705.isDrop,
                                    thresholdValue: ca
                                }),
                                Ea(va.$jscomp$loop$prop$existingThresholdValue$705.domain, va.$jscomp$loop$prop$existingThresholdValue$705.csvType));
                            ma = $jscomp.makeIterator(ma);
                            for (va = ma.next(); !va.done; va = ma.next())
                                if (va = va.value,
                                va = Number(va),
                                "AMAZON" !== u || va != getDomainByTld("in"))
                                    Y = ta[va],
                                    0 > Y || (da.desiredPrices.push({
                                        domain: va,
                                        csvType: CsvType[u].index,
                                        isDrop: Ba.data.product[u + "_isDrop"],
                                        thresholdValue: Y
                                    }),
                                    Ea(va, CsvType[u].index))
                        } else
                            for (ma in ta)
                                if ("AMAZON" !== u || ma != getDomainByTld("in"))
                                    va = ta[ma],
                                    0 > va || (da.desiredPrices.push({
                                        domain: ma,
                                        csvType: CsvType[u].index,
                                        isDrop: !0,
                                        thresholdValue: va
                                    }),
                                    Ea(ma, CsvType[u].index));
                        isTest && console.info("%ctrackingCreationObject", "color:green;", da);
                        network.request({
                            path: "track",
                            type: "addTracking",
                            trackingRequest: da,
                            version: 3
                        }).done(function(ha) {
                            if (null == ha.error)
                                W(Ba, ta, !0),
                                $("#fab-refresh").show();
                            else {
                                switch (ha.error.type) {
                                case "productNotKnown":
                                    G("Tracking Error", "Product is invalid and can not be tracked.", !1);
                                    break;
                                case "maxTrackingReached":
                                    G("Tracking Limit Reached", la._920.replace("#maxTrackingAllowed#", maxTrackingAllowed) + "<br><br><b>" + la._921 + "</b>", !1);
                                    break;
                                default:
                                    G("Tracking Error", ha.error, !0)
                                }
                                W(Ba, ta, !1)
                            }
                        }).fail(function(ha) {
                            G("Tracking Error", ha.error, !0);
                            W(Ba, ta, !1)
                        })
                    }
                      , Ca = function(Ba) {
                        var ta = {}, Ea;
                        for (Ea in Ba) {
                            var va = Ba[Ea];
                            "string" === typeof va && (va = va.replace(/(\d)\.(\d\d)/g, "$1$2"),
                            va = va.replace(/(\d),(\d)/g, "$1$2"),
                            va = va.replace(/^0+/, ""),
                            va = "-" === va ? -1 : parseFloat(va));
                            ta[Ea] = va
                        }
                        return ta
                    }(Z.newValue);
                    "AMAZON" === u && (Ca[getDomainByTld("in")] = -1);
                    return function(Ba, ta) {
                        var Ea = Ba.data.multiLocaleProductsReduced, va = {}, da;
                        for (da in ta) {
                            va.$jscomp$loop$prop$domainId$241$698 = da;
                            var Y = ta[va.$jscomp$loop$prop$domainId$241$698];
                            if (-2 < Y) {
                                if (va.$jscomp$loop$prop$domainId$241$698 == Ba.data.domainId && Y !== Ba.data.product[ja])
                                    return !0;
                                var ma = Ea.findIndex(function(ca) {
                                    return function(ha) {
                                        return ha.domainId == ca.$jscomp$loop$prop$domainId$241$698
                                    }
                                }(va));
                                if (-1 < ma && Ba.data.multiLocaleProductsReduced[ma][ja] !== Y)
                                    return !0
                            }
                            va = {
                                $jscomp$loop$prop$domainId$241$698: va.$jscomp$loop$prop$domainId$241$698
                            }
                        }
                        return !1
                    }(Z, Ca) ? ("undefined" === typeof Z.data.isUpdating && (Z.data.isUpdating = {}),
                    Z.data.isUpdating[ja] = !0,
                    Aa(Z, Ca),
                    !0) : !1
                }
            } : {}, B ? {
                headerName: R ? la._198 : la._861,
                headerNameGroup: fa,
                headerTooltip: R ? la._198 : la._861,
                headerClass: "header-cell-align-right",
                field: u + "_delta",
                cellRenderer: function(Z) {
                    if ("undefined" === typeof Z.data || Z.data.isDeleted)
                        return "";
                    var ja = Z.colDef.field
                      , W = GridHelper.getCsvObjectName(ja)
                      , Aa = Z.data.product[u + "_isDrop"]
                      , Ca = ""
                      , Ba = Z.value[0]
                      , ta = null != Ba && (Aa && 0 >= Ba || !Aa && 0 <= Ba);
                    Ba = ta ? "fa-caret-down" : "fa-caret-up";
                    Aa || (Ba = ta ? "fa-caret-up" : "fa-caret-down");
                    "-" != Z.valueFormatted && (Ca = ' <i class="fa ' + Ba + '" style="color:' + (ta ? "limegreen" : "red") + ';"></i>');
                    var Ea = "";
                    "-" != Z.valueFormatted && (Ea = NumberUtil.format(Z.data.product[u + "_deltaPercent"], 0) + "%&ensp;&hybull;&ensp;");
                    Ca = '<span class="delta' + (ta ? "-good" : "") + '" style="color:' + CsvType[W].color + ";border-color:" + CsvType[W].bg + ';">' + Ea + Z.valueFormatted + Ca + "</span>";
                    if (Z.data.multiLocaleProductsReduced.length)
                        for (ta = $jscomp.makeIterator(Z.data.multiLocaleProductsReduced),
                        Ea = ta.next(); !Ea.done; Ea = ta.next()) {
                            Ea = Ea.value;
                            var va = Ea[ja]
                              , da = "-"
                              , Y = ""
                              , ma = ""
                              , ca = ""
                              , ha = null != va && (Aa && 0 >= va || !Aa && 0 <= va);
                            null != va && 0 != va && (da = {
                                sourceDomainId: Ea.domainId,
                                targetDomainId: Z.data.domainId,
                                acceptMinusOne: ja.includes("delta")
                            },
                            R ? (da = Money.format(va, da),
                            Ea.domainId !== Z.data.domainId && currencies[Ea.domainId] !== currencies[Z.data.domainId] && (ma = Money.format(va, {
                                sourceDomainId: Ea.domainId,
                                targetDomainId: Ea.domainId,
                                acceptMinusOne: ja.includes("delta")
                            }))) : da = CsvType.format(W, va),
                            Y = ' <i class="fa ' + Ba + '" style="color:' + (ha ? "limegreen" : "red") + ';"></i>',
                            ca = NumberUtil.format(Ea[u + "_deltaPercent"], 0) + "%&ensp;&hybull;&ensp;");
                            Ca += '<br><span class="delta' + (0 < ha ? "-good" : "") + '" style="color:' + CsvType[W].color + ";border-color:" + CsvType[W].bg + ';font-style:italic;opacity:0.8;"' + (ma ? 'title="' + ma + '"' : "") + ">" + ca + da + Y + "</span>"
                        }
                    return Ca
                },
                sortingOrder: ["asc", "desc", null],
                type: ["trackingColumn"],
                enableCellChangeFlash: !0
            } : {}, B && !T ? {
                headerName: la._701,
                headerNameGroup: fa,
                headerTooltip: la._701 + " (" + prettyDate((Date.now() - oa) / 6E4).replace(/&nbsp;/g, " ") + ")",
                headerClass: "header-cell-align-right",
                field: u + "_deltaCustom",
                cellRenderer: GridHelper.cellRendererTrackingDelta,
                hide: !0,
                sortingOrder: ["asc", "desc", null],
                type: ["trackingColumn"],
                width: 150
            } : {}, B && !T ? {
                headerName: la._702,
                headerNameGroup: fa,
                headerTooltip: "" + la._702,
                headerClass: "header-cell-align-right",
                field: u + "_deltaTrackingCreated",
                cellRenderer: GridHelper.cellRendererTrackingDelta,
                hide: !0,
                sortingOrder: ["asc", "desc", null],
                type: ["trackingColumn"],
                width: 186
            } : {}, B ? {
                headerName: la._977,
                headerNameGroup: fa,
                headerTooltip: "" + la._977,
                field: u + "_lastPriceChange",
                type: ["dateAgoColumn"],
                valueGetter: GridHelper.valueGetterTrackingNonCsvArray,
                comparator: GridHelper.comparatorNumberArrayOnlyFirstNullLast,
                cellClass: "cell-boolean",
                cellRenderer: GridHelper.cellRendererDateAgoArray,
                hide: !0
            } : {}]
        }
    }
      , ka = function(u) {
        var v = CsvType[u].index
          , G = CsvType.getName(v);
        return {
            headerName: CsvType.getNameWithCircle(v),
            children: [{
                headerName: la._344,
                headerNameGroup: G,
                field: u + "_current",
                type: ["offerCountColumn"]
            }, {
                headerName: "90 days avg.",
                headerNameGroup: G,
                field: u + "_avg90",
                type: ["offerCountColumn"]
            }]
        }
    }
      , za = function(u) {
        var v = u.range
          , G = v + " day" + (1 < v ? "s" : "") + " drop";
        "custom" === v && (G = la._199);
        var w = Number(storage.lastViewerVisit) || Date.now();
        return {
            headerName: G,
            headerTooltip: "custom" === v ? "(" + prettyDate((Date.now() - w) / 6E4).replace(/&nbsp;/g, " ") + ")" : "",
            headerNameGroup: u.headerNameGroup,
            field: u.csvType + "_delta" + ("custom" === v ? "Custom" : v),
            cellRenderer: function(B) {
                if ("undefined" === typeof B.data)
                    return "";
                var Q = B.colDef.field
                  , fa = GridHelper.getCsvObjectName(Q)
                  , R = CsvType[fa].currency
                  , T = ""
                  , oa = "";
                null != B.value && (0 == B.value ? (T = ' <i class="fa fa-arrow-circle-right" style="color:#ccc;"></i>',
                oa = ' <i class="fa fa-arrow-circle-right" style="color:#ccc;"></i> ') : (oa = 0 < B.value,
                T = ' <i class="fa fa-arrow-circle-' + (oa ? "down" : "up") + '" style="color:' + (oa ? "green" : "red") + ';"></i>',
                oa = ' <i class="fa fa-arrow-circle-' + (oa ? "down" : "up") + '" style="color:#ccc"></i> '));
                fa = '<span style="color:' + CsvType[fa].color + '">' + B.valueFormatted + "</span>" + T;
                R && showReferencePrice(B.data.domainId) && (Q = B.data[Q],
                B = null == B.value ? "-" : Money.format(Q, {
                    sourceDomainId: B.data.domainId,
                    targetDomainId: B.data.domainId
                }),
                fa = fa + '<br><span style="color:#ccc;">' + (B + "</span> " + oa));
                return fa
            },
            type: ["deltaColumn"],
            hide: u.hide || !1,
            width: "custom" === v ? 128 : 88,
            valueFormatter: GridHelper.valueFormatterDelta,
            valueGetter: function(B) {
                if ("undefined" === typeof B.data)
                    return null;
                var Q = B.colDef.field
                  , fa = GridHelper.getCsvObjectName(Q);
                if (GridHelper.isOfferData(fa) && (B.data.offersOutdated || B.data.offersNeverUpdated) || -1 === B.data[fa + "_current"])
                    return null;
                Q = B.data[Q];
                return "SALES" === fa || null == Q ? Q : Money.raw(Q, {
                    sourceDomainId: B.data.domainId,
                    targetDomainId: 0 < currencyDomainId ? currencyDomainId : Number(B.data.domainId)
                })
            }
        }
    }
      , J = function(u) {
        var v = u.range
          , G = v + " day" + (1 < v ? "s" : "") + " drop %";
        "custom" === v && (G = "Drop % since last visit");
        var w = Number(storage.lastViewerVisit) || Date.now();
        return {
            headerName: G,
            headerTooltip: "custom" === v ? "(" + prettyDate((Date.now() - w) / 6E4).replace(/&nbsp;/g, " ") + ")" : "",
            headerNameGroup: u.headerNameGroup,
            field: u.csvType + "_deltaPercent" + ("custom" === v ? "Custom" : v),
            cellRenderer: function(B) {
                var Q = GridHelper.getCsvObjectName(B.colDef.field)
                  , fa = "";
                null != B.value && (0 == B.value ? fa = ' <i class="fa fa-arrow-circle-right" style="color:#ccc;"></i> ' : (fa = 0 < B.value,
                fa = ' <i class="fa fa-arrow-circle-' + (fa ? "down" : "up") + '" style="color:' + (fa ? "green" : "red") + ';"></i> '));
                return '<span style="color:' + CsvType[Q].color + '">' + B.valueFormatted + "</span>" + fa
            },
            type: ["deltaPercentColumn"],
            hide: u.hide || !1,
            width: "custom" === v ? 138 : 98,
            valueFormatter: function(B) {
                return null == B.value ? "-" : B.value + " %"
            },
            valueGetter: function(B) {
                if ("undefined" === typeof B.data)
                    return null;
                var Q = B.colDef.field
                  , fa = GridHelper.getCsvObjectName(Q);
                if (GridHelper.isOfferData(fa) && (B.data.offersOutdated || B.data.offersNeverUpdated) || -1 === B.data[fa + "_current"])
                    return null;
                var R = B.data[Q];
                if ("undefined" === typeof R) {
                    isTest && !Q.includes("_deltaPercentCustom") && console.log("ATTENTION: values are calculated", Q);
                    Q = B.data[fa + "_current"];
                    R = B.data[fa + "_avg" + v];
                    "custom" === v && (R = B.data.stats.atIntervalStart[CsvType[fa].index]);
                    "WAREHOUSE" === fa && "custom" !== v && (B.data["AMAZON_avg" + v] && 0 < B.data["AMAZON_avg" + v] ? R = B.data["AMAZON_avg" + v] : B.data["NEW_avg" + v] && 0 < B.data["NEW_avg" + v] && (R = B.data["NEW_avg" + v]));
                    if (0 > Q || 0 > R || 0 == R)
                        return null;
                    B = Math.round(100 * (1 - Q / R));
                    99 < B && (B = 99);
                    -99 > B && (B = -99);
                    R = B
                }
                return R
            }
        }
    }
      , g = function(u) {
        var v = u.range;
        return {
            headerName: v + " day" + (1 < v ? "s" : "") + " drop",
            headerNameGroup: u.headerNameGroup,
            field: u.csvType + "_deltaPercent" + v,
            cellClass: "cell-number cell-deal",
            cellRenderer: function(G) {
                var w = GridHelper.getCsvObjectName(G.colDef.field)
                  , B = ""
                  , Q = "";
                null != G.value && (0 == G.value ? Q = ' <i class="fa fa-arrow-circle-right" style="color:#ccc;"></i> ' : (Q = 0 < G.value,
                Q = ' <i class="fa fa-arrow-circle-' + (Q ? "down" : "up") + '" style="color:' + (Q ? "green" : "red") + ';"></i> '),
                0 !== G.value && (B = G.data[w + "_delta" + v],
                B = "SALES" === w ? NumberUtil.format(B) : Money.format(B, {
                    sourceDomainId: G.data.domainId
                })));
                return '<span class="drop" style="color:' + CsvType[w].color + '">' + G.valueFormatted + "</span>" + Q + '\n\t\t\t\t\t\t<br><span style="color:' + CsvType[w].color + '">' + B + "</span>"
            },
            type: ["deltaPercentColumn"],
            valueFormatter: function(G) {
                return null == G.value ? "-" : G.value + " %"
            },
            valueGetter: function(G) {
                if ("undefined" === typeof G.data)
                    return null;
                var w = G.colDef.field
                  , B = GridHelper.getCsvObjectName(w);
                return GridHelper.isOfferData(B) && (G.data.offersOutdated || G.data.offersNeverUpdated) || -1 === G.data[B + "_current"] ? null : G.data[w]
            }
        }
    }
      , D = function() {
        return {
            headerName: "FBA Pick&Pack Fee",
            field: "fbaFees",
            cellClass: "cell-number",
            cellRenderer: GridHelper.cellRendererFbaFees,
            comparator: GridHelper.comparatorNumberNullLast,
            filter: "agNumberColumnFilter",
            icons: GridHelper.getIconsSortNumeric(),
            suppressSizeToFit: !0,
            valueFormatter: GridHelper.valueFormatterMoney,
            valueGetter: function(u) {
                if ("undefined" === typeof u.data || null == u.data.fbaFees)
                    return null;
                var v = u.data.domainId;
                return Money.raw(u.data[u.colDef.field + "Total"], {
                    sourceDomainId: v,
                    targetDomainId: v
                })
            },
            width: 190
        }
    }
      , N = function(u) {
        var v = "offerCount" + u
          , G = "FBM" === u ? "NEW_FBM_SHIPPING" : "NEW_FBA";
        return {
            headerName: "New, " + u,
            headerNameGroup: "Count of retrieved live offers",
            field: v,
            cellClass: "cell-number",
            cellRenderer: function(w) {
                if ("undefined" === typeof w.data)
                    return "";
                var B = "";
                w.data.offersOutworn && !w.data.offersOutdated && (B = "font-style:italic;");
                return '<span style="color:' + CsvType[G].color + ";" + B + '">' + w.valueFormatted + "</span>"
            },
            comparator: GridHelper.comparatorNumberNullLast,
            equals: function() {
                return !1
            },
            filter: "agNumberColumnFilter",
            icons: GridHelper.getIconsSortNumeric(),
            suppressSizeToFit: !0,
            valueFormatter: function(w) {
                return null == w.value ? "-" : w.value
            },
            valueGetter: function(w) {
                if ("undefined" === typeof w.data)
                    return null;
                w = w.data.stats[v];
                return 0 > w ? null : w
            },
            width: 110
        }
    }
      , ba = function(u) {
        var v = "salesRankDrops" + u;
        return {
            headerName: "Drops last " + u + " days",
            headerNameGroup: CsvType.getName(CsvType.SALES.index),
            field: v,
            type: ["numberColumn"],
            cellRenderer: function(G) {
                return '<span style="color:' + CsvType.SALES.color + ';">' + G.valueFormatted + "</span>"
            },
            suppressSizeToFit: !0,
            width: 110
        }
    }
      , q = function() {
        return {
            headerName: "Reference",
            headerNameGroup: CsvType.getName(CsvType.SALES.index),
            field: "salesRankReference",
            cellRenderer: function(u) {
                return "undefined" === typeof u.data || u.data.salesRankReference > invalidIfLargerCatId || -1 === u.data.salesRankReference ? "" : -2 === u.data.salesRankReference ? "Launchpad" : GridHelperCategory.render(u.data.domainId, u.data.salesRankReference, u.value, u)
            },
            filter: !1,
            sortable: !1,
            suppressMenu: !0,
            suppressSizeToFit: !0,
            valueGetter: GridHelperCategory.valueGetterSalesRankReference,
            width: 160
        }
    }
      , L = function() {
        return {
            headerName: "Subcategory Sales Ranks",
            headerNameGroup: CsvType.getName(CsvType.SALES.index),
            field: "subcategorySalesRanks",
            cellRenderer: function(u) {
                var v = u.value;
                if (!v || 0 === v.length)
                    return "-";
                u = "";
                v = $jscomp.makeIterator(v);
                for (var G = v.next(); !G.done; G = v.next())
                    currentRank = G.value,
                    G = 100 < currentRank.topPct ? "" : 'Top <span style="width: 30px; display: inline-block; text-align: right;">' + currentRank.topPct + "%</span>",
                    u += '\n                        <span style="width: 65px; display: inline-block; margin-right: 8px; text-align: right; color:' + CsvType.SALES.color + ';">' + CsvType.format("SALES", currentRank.rank) + '</span>\n                        <span style="width: 65px; display: inline-block;color:#40bdb2;" title="Products in Category: ' + NumberUtil.format(currentRank.cr.productCount) + '">' + G + '</span>\n                        <span style="color:#333;" title="' + (currentRank.cr.contextFreeName == currentRank.tree ? "" : currentRank.tree) + '">' + currentRank.cr.contextFreeName + "</span>\n                        <br>\n                    ";
                return u
            },
            filter: !1,
            sortable: !1,
            suppressMenu: !0,
            suppressSizeToFit: !0,
            width: 300
        }
    }
      , A = function(u) {
        var v = "sellerIdsLowest" + u
          , G = "FBM" === u ? "NEW_FBM_SHIPPING_current" : "NEW_FBA_current";
        return {
            headerName: "Lowest " + u + " Seller",
            headerTooltip: "Seller of the lowest priced live " + u + " offer(s). Multiple entries if multiple offers share the same price.",
            field: v,
            cellRenderer: GridHelper.cellRendererSellerIdsLowest,
            hide: !0,
            valueFormatter: GridHelper.valueFormatterSellerIdsLowest,
            valueGetter: function(w) {
                return "undefined" === typeof w.data || null == w.data.asin || w.data.offersOutdated || w.data.offersNeverUpdated || 0 > w.data[G] || (null == w.data.stats[v] || 0 == w.data.stats[v].length) && "undefined" == typeof w.data[v] ? null : w.data[v] ? w.data[v] : w.data.stats[v]
            },
            filter: !1,
            suppressMenu: !0,
            sortable: !1,
            suppressSizeToFit: !0,
            width: 220
        }
    }
      , O = function(u) {
        var v = GridManage.pageConfig.activeViewMode === GridManage.viewModes.COMPACT
          , G = "tags" === u
          , w = {
            tags: la._807,
            memo: la._808
        }
          , B = "agLargeTextCellEditor"
          , Q = {
            maxLength: 100,
            rows: 4,
            cols: 30
        }
          , fa = "agTextColumnFilter"
          , R = {
            suppressAndOrCondition: !0
        };
        G && (B = "cellEditorAutocompleteChips",
        Q = {},
        fa = "agSetColumnFilter",
        R = {
            cellHeight: 22,
            suppressAndOrCondition: !0,
            suppressMiniFilter: !0,
            suppressRemoveEntries: !0
        });
        return {
            headerName: w[u],
            field: u,
            cellClass: v ? "cell-text-compact cell-wrap" : "cell-wrap",
            cellEditor: B,
            cellEditorParams: Q,
            cellRenderer: function(T) {
                if ("undefined" !== typeof T.data.isUpdating && !0 === T.data.isUpdating[u])
                    return '<div><i class="fa fa-spinner fa-spin"></i></div>';
                var oa = ""
                  , Z = "";
                "string" === typeof T.value ? (oa = T.value.replace(/[\r\n]+/g, "<br>"),
                Z = escapeHTML(T.value)) : T.value instanceof Array && T.value.length && (oa = T.value.map(function(ja) {
                    return null == ja ? "" : '<span class="chip"><span>' + ja + "</span></span>"
                }).filter(function(ja) {
                    return ja.length
                }).join(" "),
                Z = T.value.join(" "));
                return '<span class="text-clamp clamp-lines-' + Math.max(2, T.data.multiLocaleProductsReduced.length) + '" title="' + Z + '">' + oa + "</span>"
            },
            editable: function(T) {
                return !0 !== T.data.isDeleted
            },
            enableCellChangeFlash: !0,
            filter: fa,
            filterParams: R,
            suppressMenu: G,
            suppressSizeToFit: !0,
            suppressKeyboardEvent: GridHelper.cellSuppressKeyboardEvent,
            tooltipValueGetter: function(T) {
                return !0 === T.data.isDeleted ? "" : la._806
            },
            valueGetter: function(T) {
                var oa = G ? [null] : "";
                if (T.data.isDeleted)
                    return oa;
                try {
                    var Z = JSON.parse(T.data.tracking.metaData);
                    if ("undefined" !== typeof Z[u]) {
                        var ja = Z[u];
                        G && ("string" === typeof Z[u] && (ja = [Z[u]]),
                        0 < ja.length && ja.sort(),
                        0 === ja.length && (ja = oa));
                        return ja
                    }
                } catch (W) {}
                return oa
            },
            valueSetter: function(T) {
                var oa = function(Z, ja) {
                    var W = Z.node.data;
                    W.tracking.metaData = ja;
                    setTimeout(function() {
                        Z.api.updateRowData({
                            update: [W]
                        });
                        if (G) {
                            var Aa = Z.api.getFilterInstance(u)
                              , Ca = Aa.getModel();
                            Aa.resetFilterValues();
                            null !== Ca && Aa.setModel(Ca);
                            GridManage.updateFilterToolbar(["tags"])
                        }
                    }, 0)
                };
                (function(Z) {
                    var ja = G ? 200 : 100
                      , W = Z.newValue;
                    if (G)
                        for (; W.join('","').length > ja; )
                            W.pop();
                    else
                        W = W.slice(0, ja);
                    var Aa = GridManage.getTrackingUpdateObject();
                    try {
                        var Ca = JSON.parse(Z.data.tracking.metaData);
                        Ca[u] = W
                    } catch (Ba) {
                        ja = {},
                        Ca = (ja[u] = W,
                        ja)
                    }
                    Aa.metaData = JSON.stringify(Ca);
                    W = {
                        path: "track",
                        type: "updateTracking",
                        asin: Z.data.asin,
                        trackingUpdate: Aa,
                        version: 3
                    };
                    isTest && console.info("%ctrackingUpdateRequest", "color:green;", Aa);
                    network.request(W).done(function(Ba) {
                        null == Ba.error ? oa(Z, Aa.metaData) : (Ba = Ba.error,
                        reportBug(null, Ba),
                        showPopup("Tracking Update Error", Ba, !0))
                    }).fail(function(Ba) {
                        Ba = Ba.error;
                        reportBug(null, Ba);
                        showPopup("Tracking Update Error", Ba, !0)
                    })
                }
                )(T);
                return !0
            },
            minWidth: 80,
            width: 100
        }
    }
      , P = function(u, v) {
        var G = !0;
        "domainId asin imagesCSV title dealFound eanList upcList color size edition format".split(" ").includes(u.field) ? G = !1 : u.field.includes("_current") && u.type && u.type.some(function(w) {
            return ["priceColumn", "salesRankColumn"].includes(w)
        }) ? G = !1 : u.type && u.type.some(function(w) {
            return ["deltaColumn", "deltaPercentColumn"].includes(w)
        }) && (G = !1);
        u.hide = G;
        v.filterFields.includes(u.field) && (u.cellClass = "cell-number cell-deal-filtered");
        u.filter = !1;
        u.sortable = !1;
        u.suppressMenu = !0;
        return u
    }
      , M = function(u) {
        var v = u.field
          , G = u.type ? u.type[0] : null
          , w = "_highest _lowest COLLECTIBLE_ACCEPTABLE_SHIPPING_ COLLECTIBLE_GOOD_SHIPPING_ COLLECTIBLE_NEW_SHIPPING_ COLLECTIBLE_VERY_GOOD_SHIPPING_".split(" ");
        isTest || w.push("_deltaPercent30");
        var B = ["_deltaPercent30"];
        Number(storage.domain) !== getDomainByTld("com") && (w.push("TRADE_IN_"),
        w.push("RENT_"));
        var Q = "COUNT_REVIEWS_current itemWeight numberOfItems numberOfPages packageWeight RATING_current AMAZON_outOfStockPercentage90 NEW_outOfStockPercentage90 USED_outOfStockPercentage90 BUY_BOX_SHIPPING_outOfStockPercentage90 salesRankDrops30 salesRankDrops90 salesRankDrops180".split(" ");
        switch (v) {
        case "title":
            u.filter = "agTextColumnFilter";
            u.filterParams = {
                applyButton: !0,
                caseSensitive: !0,
                filterOptions: ["contains"],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            };
            break;
        case "partNumber":
            u.filter = "agTextColumnFilter";
            u.filterParams = {
                applyButton: !0,
                caseSensitive: !0,
                defaultOption: "isOneOf",
                filterOptions: [{
                    displayKey: "isOneOf",
                    displayName: "isOneOf",
                    test: !0
                }, {
                    displayKey: "isNoneOf",
                    displayName: "isNoneOf",
                    test: !0
                }],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            };
            break;
        case "categories":
            u.filter = "customAutocompleteColumnFilter";
            u.filterParams = {
                applyButton: !0,
                caseSensitive: !0,
                defaultOption: "isOneOf",
                filterOptions: [{
                    displayKey: "isOneOf",
                    displayName: "isOneOf",
                    test: !0
                }],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            };
            u.suppressMenu = !1;
            break;
        case "categories_exclude":
            u.filter = "customAutocompleteColumnFilter";
            u.filterParams = {
                applyButton: !0,
                caseSensitive: !0,
                defaultOption: "isNoneOf",
                filterOptions: [{
                    displayKey: "isNoneOf",
                    displayName: "isNoneOf",
                    test: !0
                }],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            };
            u.suppressMenu = !1;
            break;
        case "author":
        case "binding":
        case "brand":
        case "color":
        case "edition":
        case "format":
        case "languages":
        case "manufacturer":
        case "model":
        case "productGroup":
        case "size":
            u.filter = "customAutocompleteColumnFilter";
            u.filterParams = {
                applyButton: !0,
                caseSensitive: !0,
                defaultOption: "isOneOf",
                filterOptions: [{
                    displayKey: "isOneOf",
                    displayName: "isOneOf",
                    test: !0
                }, {
                    displayKey: "isNoneOf",
                    displayName: "isNoneOf",
                    test: !0
                }],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            };
            u.suppressMenu = !1;
            break;
        case "buyBoxSellerIdHistory":
            u.filter = "customDynamicColumnFilter";
            u.filterParams = {
                applyButton: !0,
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            };
            u.suppressMenu = !1;
            break;
        case "categoryTree":
        case "eanList":
        case "frequentlyBoughtTogether":
        case "linkReviews":
        case "parentAsin":
        case "reviews.ratingCount":
        case "reviews.reviewCount":
        case "sellerIdsLowestFBA":
        case "sellerIdsLowestFBM":
        case "subcategorySalesRanks":
        case "stockAmazon":
        case "stockBuyBox":
        case "upcList":
        case "urlAmazon":
        case "urlKeepa":
        case "variationCSV":
            u.filter = !1;
            u.suppressMenu = !0;
            break;
        case "asin":
        case "domainId":
        case "imagesCSV":
            u.filter = !1;
            u.suppressMenu = !0;
            break;
        case "lastUpdate":
        case "lastOffersUpdate":
            u.filter = !1;
            u.suppressMenu = !0;
            break;
        case "lastPriceChange":
        case "listedSince":
        case "publicationDate":
        case "releaseDate":
        case "trackingSince":
            u.filter = "agDateColumnFilter";
            u.filterParams = {
                applyButton: !0,
                defaultOption: "lessThanOrEqual",
                filterOptions: ["lessThanOrEqual", "greaterThanOrEqual", "inRange"],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            };
            u.suppressMenu = !1;
            break;
        case "rootCategory":
            Q = GridHelperCategory.getRootHashMap(storage.domain);
            B = [];
            for (var fa in Q)
                Q = GridHelperCategory.getRoot(storage.domain, fa),
                B.push({
                    value: Q.catId,
                    label: Q.name + " (" + Q.productCount + ")"
                });
            B.sort(function(R, T) {
                R = R.label.toUpperCase();
                T = T.label.toUpperCase();
                return R < T ? -1 : R > T ? 1 : 0
            });
            u.filter = "customSingleChoiceColumnFilter";
            u.filterParams = {
                applyButton: !0,
                valueOptions: B,
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            };
            u.suppressMenu = !1;
            break;
        case "couponOneTimeAbsolute":
        case "couponOneTimePercent":
        case "couponSNSPercent":
            u.suppressMenu = !1;
            break;
        case "COUNT_REVIEWS_avg30":
        case "COUNT_REVIEWS_avg90":
        case "COUNT_REVIEWS_avg180":
            u.filter = !1;
            u.suppressMenu = !0;
            break;
        case "offerCountFBA":
        case "offerCountFBM":
        case "fbaFees":
            u.filter = "agNumberColumnFilter";
            u.filterParams = {
                applyButton: !0,
                defaultOption: "lessThanOrEqual",
                filterOptions: ["lessThanOrEqual", "greaterThanOrEqual", "inRange"],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            };
            break;
        case "availabilityAmazon":
        case "checkboxSelection":
        case "itemDimension":
        case "packageDimension":
        case "salesRankReference":
        case "variationAttributes":
            break;
        default:
            v.includes("LIGHTNING_DEAL") && Number(storage.domain) === getDomainByTld("in") ? (u.filter = !1,
            u.suppressMenu = !0) : "deltaPercentColumn" === G || "measureColumn" === G || "offerCountColumn" === G || "priceColumn" === G || "salesRankColumn" === G || Q.includes(v) ? "priceColumn" !== G && "salesRankColumn" !== G && "deltaPercentColumn" !== G || !B.concat(w).some(function(R) {
                return 0 <= v.indexOf(R)
            }) ? (u.filter = "agNumberColumnFilter",
            u.filterParams = {
                applyButton: !0,
                defaultOption: "lessThanOrEqual",
                filterOptions: ["lessThanOrEqual", "greaterThanOrEqual", "inRange"],
                newRowsAction: "keep",
                suppressAndOrCondition: !0
            }) : (u.filter = !1,
            u.suppressMenu = !0) : "booleanColumn" === G ? (u.filter = "customBooleanColumnFilter",
            u.filterParams = {
                applyButton: !0,
                newRowsAction: "keep",
                isCheckbox: !1,
                suppressAndOrCondition: !0
            },
            u.suppressMenu = !1) : "hiddenColumn" === G ? u.suppressMenu = !1 : (u.filter = !1,
            u.suppressMenu = !0,
            isTest && console.warn("Missing filter setting: " + u.field + " | " + G))
        }
        switch (v) {
        case "availabilityAmazon":
        case "buyBoxSellerIdHistory":
        case "domainId":
        case "eanList":
        case "frequentlyBoughtTogether":
        case "imagesCSV":
        case "isAdultProduct":
        case "isEligibleForSuperSaverShipping":
        case "isEligibleForTradeIn":
        case "isSNS":
        case "languages":
        case "parentAsin":
        case "promotions":
        case "sellerIdsLowestFBA":
        case "sellerIdsLowestFBM":
        case "subcategorySalesRanks":
        case "upcList":
        case "variationCSV":
            u.sortable = !1;
            break;
        case "asin":
        case "categoryTree":
        case "linkReviews":
        case "reviews.ratingCount":
        case "reviews.reviewCount":
        case "stockAmazon":
        case "stockBuyBox":
        case "urlAmazon":
        case "urlKeepa":
        case "variationAttributes":
            u.sortable = !1;
            break;
        case "categories":
        case "rootCategory":
        case "salesRankReference":
            u.sortable = !1;
            break;
        case "lastOffersUpdate":
        case "lastUpdate":
            u.sortable = !1;
            break;
        default:
            "priceColumn" !== G && "salesRankColumn" !== G && "deltaPercentColumn" !== G || !w.some(function(R) {
                return 0 <= v.indexOf(R)
            }) ? u.sortable = "hiddenColumn" === G ? !1 : !0 : u.sortable = !1
        }
        return u
    };
    return {
        csvTypesEnableLowestEver: a,
        csvTypesEnableOutOfStock: b,
        gridTypesWithCheckboxSelection: enableListTrackingComponent ? ["asinViewer", "variation"] : [],
        maxValuesPerFinderFilter: 50,
        maxRowsFreeUser: 5,
        rowHeight: d,
        unitSystem: {
            METRIC: {
                measure: "cm",
                weight: "g"
            },
            IMPERIAL: {
                measure: "in",
                weight: "lb"
            }
        },
        get: m,
        getColumns: t,
        getNewColumns: function(u) {
            switch (u) {
            case "bestseller":
            case "deals":
            case "storefront":
                var v = "asin";
                break;
            case "viewer":
                v = "asinViewer";
                break;
            case "finder":
                v = "asinFinder";
                break;
            default:
                v = u
            }
            var G = {
                asin: [],
                asinViewer: [],
                asinFinder: [],
                manage: [],
                offer: [],
                buyBoxStatistics: []
            };
            ["asin", "asinViewer", "asinFinder"].includes(v) && (G.asin.push({
                colState: {
                    colId: "variationAttributes",
                    hide: "deals" === u ? !0 : !1
                },
                insertAfterColId: "model"
            }),
            G.asin.push({
                colState: {
                    colId: "AMAZON_outOfStockPercentage90",
                    hide: "deals" === u ? !0 : !1
                },
                insertAfterColId: "AMAZON_highest"
            }, {
                colState: {
                    colId: "NEW_outOfStockPercentage90",
                    hide: "deals" === u ? !0 : !1
                },
                insertAfterColId: "NEW_highest"
            }, {
                colState: {
                    colId: "USED_outOfStockPercentage90",
                    hide: "deals" === u ? !0 : !1
                },
                insertAfterColId: "USED_highest"
            }),
            G.asin.push({
                colState: {
                    colId: "reviews.ratingCount",
                    hide: "deals" === u ? !0 : !1
                },
                insertAfterColId: "COUNT_REVIEWS_avg180"
            }, {
                colState: {
                    colId: "reviews.reviewCount",
                    hide: "deals" === u ? !0 : !1
                },
                insertAfterColId: "reviews.ratingCount"
            }),
            G.asin.push({
                colState: {
                    colId: "BUY_BOX_SHIPPING_outOfStockPercentage90",
                    hide: "deals" === u ? !0 : !1
                },
                insertAfterColId: "BUY_BOX_SHIPPING_highest"
            }),
            G.asinFinder = G.asin.slice(0),
            G.asinViewer = G.asin.slice(0));
            if ("manage" === v) {
                for (var w in CsvType)
                    "object" === typeof CsvType[w] && GridHelper.csvTypeIsTrackable(w) && G.manage.push({
                        colState: {
                            colId: w + "_lastPriceChange",
                            hide: !0
                        },
                        insertAfterColId: w + "_deltaTrackingCreated"
                    });
                if (isTest) {
                    u = ["COLLECTIBLE_NEW_SHIPPING", "COLLECTIBLE_VERY_GOOD_SHIPPING", "COLLECTIBLE_GOOD_SHIPPING", "COLLECTIBLE_ACCEPTABLE_SHIPPING", "REFURBISHED_SHIPPING"];
                    for (var B in CsvType)
                        if ("object" === typeof CsvType[B] && (w = GridHelper.csvTypeIsTrackable(B),
                        u.includes(B))) {
                            var Q = CsvType.getObjectName(CsvType[B].index - 1)
                              , fa = GridHelper.csvTypeIsTrackable(Q);
                            G.manage.push({
                                colState: {
                                    colId: B + "_current",
                                    hide: !0
                                },
                                insertAfterColId: fa ? Q + "_deltaTrackingCreated" : Q + "_current"
                            });
                            w && (G.manage.push({
                                colState: {
                                    colId: B + "_desired",
                                    hide: !0
                                },
                                insertAfterColId: B + "_current"
                            }),
                            G.manage.push({
                                colState: {
                                    colId: B + "_delta",
                                    hide: !0
                                },
                                insertAfterColId: B + "_desired"
                            }),
                            G.manage.push({
                                colState: {
                                    colId: B + "_deltaCustom",
                                    hide: !0
                                },
                                insertAfterColId: B + "_delta"
                            }),
                            G.manage.push({
                                colState: {
                                    colId: B + "_deltaTrackingCreated",
                                    hide: !0
                                },
                                insertAfterColId: B + "_deltaCustom"
                            }))
                        }
                }
            }
            "buyBoxStatistics" === v && (G.buyBoxStatistics.push({
                colState: {
                    colId: "stock",
                    hide: !1
                },
                insertAfterColId: "avgNewOfferCount"
            }),
            G.buyBoxStatistics.push({
                colState: {
                    colId: "isFBA",
                    hide: !1
                },
                insertAfterColId: "sellerName"
            }));
            "offer" === v && G.offer.push({
                colState: {
                    colId: "sold",
                    hide: !1
                },
                insertAfterColId: "stockCSV"
            }, {
                colState: {
                    colId: "sold30Day",
                    hide: !1
                },
                insertAfterColId: "sold"
            });
            GridConfig.gridTypesWithCheckboxSelection.includes(v) && G[v].push({
                colState: {
                    colId: "checkboxSelection",
                    hide: !0
                },
                insertAfterColId: !1
            });
            return G[v] ? G[v] : []
        },
        getRowCountOptions: function(u) {
            var v = !hasDataAccessSubscription;
            return {
                asin: {
                    values: [5, 20, 100, 500, 1E3, 2E3, 5E3],
                    disabled: [!1, v, v, v, v, v, v]
                },
                asinFinder: {
                    values: [5, 20, 100, 500, 1E3, 2E3, 5E3],
                    disabled: [!1, v, v, v, v, v, v]
                },
                seller: {
                    values: [5, 1E3, 2E3, 5E3, 1E4, 2E4, 5E4, 1E5],
                    disabled: [!1, v, v, v, v, v, v, v]
                }
            }[u]
        }
    }
}()
  , GridCellEditorComponents = function() {
    function a() {}
    function b() {}
    function d() {}
    function h() {}
    a.prototype.init = function(m) {
        var t = this
          , f = this;
        this.eGui = document.createElement("div");
        this.eGui.className = "cell-editing--autocomplete-chips";
        this.eDivTags = document.createElement("div");
        m.value.length && m.value.forEach(function(r) {
            null != r && t.addChip(r.trim())
        });
        this.eGui.appendChild(this.eDivTags);
        var n = document.createElement("div");
        n.className = "flex filter-text--autocomplete ui-front";
        this.input = document.createElement("input");
        this.addAutocompleter(m);
        n.appendChild(this.input).insertAdjacentHTML("beforeend", "&emsp;");
        this.addButton = document.createElement("button");
        this.addButton.innerHTML = '<i class="fa fa-plus"></i>';
        this.addButton.addEventListener("click", function(r) {
            if (r = f.input.value.trim().replace(/\s\s+/g, " "))
                r.split(" ").forEach(function(p) {
                    f.addChip(p, f.ul)
                }),
                f.input.value = ""
        });
        n.appendChild(this.addButton);
        this.eGui.appendChild(n);
        n = document.createElement("div");
        this.saveButton = document.createElement("button");
        this.saveButton.innerHTML = '<i class="fa fa-caret-right"></i> Ok';
        this.saveButton.addEventListener("click", function(r) {
            f.addButton.click();
            m.stopEditing()
        });
        n.appendChild(this.saveButton);
        this.eGui.appendChild(n)
    }
    ;
    a.prototype.addAutocompleter = function(m) {
        var t = m.api.getFilterInstance(m.column.colDef.field).valueModel.allUniqueValues.filter(function(n) {
            return null != n
        })
          , f = [];
        $(this.input).autocomplete({
            classes: {
                "ui-autocomplete": "ag-custom-component-popup"
            },
            source: function(n, r) {
                var p = n.term;
                if (p.length) {
                    n = t.filter(function(F) {
                        return 0 === F.indexOf(p)
                    });
                    var z = t.filter(function(F) {
                        return 0 < F.indexOf(p)
                    });
                    f = n.concat(z)
                } else
                    f = t;
                r(f)
            },
            autoFocus: !0,
            delay: 200,
            minLength: 0,
            close: function(n, r) {
                n.stopPropagation()
            },
            position: {
                my: "left top",
                at: "left bottom",
                collision: "none"
            }
        }).focus(function() {
            $(this).data("ui-autocomplete").search($(this).val())
        })
    }
    ;
    a.prototype.addChip = function(m) {
        if (0 !== m.length) {
            m = m.replace(/\s/g, "");
            var t = this
              , f = document.createElement("span");
            f.className = "chip";
            var n = document.createElement("span");
            n.innerHTML = "" + m;
            f.appendChild(n).insertAdjacentHTML("beforeend", " ");
            m = document.createElement("i");
            m.className = "fa fa-times";
            f.appendChild(m);
            this.eDivTags.appendChild(f);
            m.addEventListener("click", function(r) {
                t.eDivTags.removeChild(this.parentElement)
            })
        }
    }
    ;
    a.prototype.getValue = function() {
        var m = [];
        this.eDivTags.querySelectorAll("span > span").forEach(function(t) {
            m.push(t.innerHTML.trim())
        });
        return Array.from(new Set(m))
    }
    ;
    a.prototype.getGui = function() {
        return this.eGui
    }
    ;
    a.prototype.afterGuiAttached = function() {}
    ;
    a.prototype.destroy = function() {}
    ;
    a.prototype.isPopup = function() {
        return !0
    }
    ;
    b.prototype.init = function(m) {
        var t = this;
        this.ttlOptions = m.ttlOptions;
        this.ttlDefault = m.ttlDefault;
        this.eGui = document.createElement("div");
        this.eGui.className = "cell-editing--images-csv";
        var f = document.createElement("div")
          , n = material.getSelect("tracking-ttl", "tracking-ttl", this.ttlDefault, this.ttlOptions, "", !0, !0);
        f.innerHTML = "<span>" + la._906 + ":</span>&emsp;" + n + "&emsp;";
        this.hiddenInput = document.createElement("input");
        this.hiddenInput.hidden = !0;
        this.hiddenInput.value = 0;
        f.appendChild(this.hiddenInput);
        this.submitButton = document.createElement("button");
        this.submitButton.innerHTML = '<i class="fa fa-caret-right"></i> Ok';
        this.submitButton.addEventListener("click", function(r) {
            t.hiddenInput.value = Number($(t.eGui.querySelector("select")).val());
            m.stopEditing()
        });
        f.appendChild(this.submitButton);
        this.eGui.appendChild(f)
    }
    ;
    b.prototype.getValue = function() {
        var m = Number(this.hiddenInput.value);
        0 < m && "undefined" === typeof this.ttlOptions.find(function(t) {
            return t.value == m
        }) && (m = this.ttlDefault);
        return m
    }
    ;
    b.prototype.getGui = function() {
        return this.eGui
    }
    ;
    b.prototype.afterGuiAttached = function() {}
    ;
    b.prototype.destroy = function() {}
    ;
    b.prototype.isPopup = function() {
        return !0
    }
    ;
    d.prototype.init = function(m) {
        var t = m.isMultiLocaleData ? m.isMultiLocaleData : !1
          , f = function(z, F) {
            var I = document.createElement("div");
            if (t) {
                var E = document.createElement("img");
                E.title = "." + getTldByDomain(z);
                E.src = flags[z];
                I.appendChild(E)
            }
            E = function(K, H, V) {
                var S = document.createElement("input");
                S.checked = V;
                S.className = "ag-filter-checkbox";
                S.name = z;
                S.type = "radio";
                S.value = H;
                H = document.createElement("label");
                H.appendChild(S);
                H.insertAdjacentHTML("beforeend", " " + K);
                return H
            }
            ;
            I.appendChild(E(la._254, 1, F));
            I.appendChild(E(la._255, 0, !F));
            return I
        }
          , n = m.column.colId
          , r = m.node.data;
        m = document.createElement("div");
        m.className = "cell-editing--threshold-boolean";
        m.appendChild(f(r.product.domainId, r.product[n]));
        if (t && r.multiLocaleProductsReduced.length) {
            r = $jscomp.makeIterator(r.multiLocaleProductsReduced);
            for (var p = r.next(); !p.done; p = r.next())
                p = p.value,
                m.appendChild(f(p.domainId, p[n]))
        }
        this.eGui = m;
        this.isMultiLocaleData = t
    }
    ;
    d.prototype.getValue = function() {
        var m = this.eGui.querySelectorAll("input:checked");
        if (this.isMultiLocaleData) {
            var t = {};
            m.forEach(function(f) {
                t[Number(f.name)] = 1 === Number(f.value)
            });
            return t
        }
        return 1 === Number(m[0].value)
    }
    ;
    d.prototype.getGui = function() {
        return this.eGui
    }
    ;
    d.prototype.destroy = function() {}
    ;
    d.prototype.isPopup = function() {
        return !1
    }
    ;
    h.prototype.init = function(m) {
        var t = function(I, E, K) {
            var H = document.createElement("div")
              , V = document.createElement("img");
            V.title = "." + getTldByDomain(I);
            V.src = flags[I];
            H.appendChild(V);
            V = document.createElement("input");
            V.name = I;
            V.pattern = "^\\d*(\\.\\d{1,2}$)?";
            V.title = la._745;
            V.value = "";
            r && 0 < K ? V.value = Money.format(K, {
                sourceDomainId: E,
                targetDomainId: E,
                skipSymbol: !0
            }).replace(",", "") : !r && 0 <= K && (V.value = "RATING" == n ? (K / 10).toFixed(1) : K);
            H.appendChild(V);
            I = document.createElement("span");
            I.innerHTML = '<i class="fa fa-exclamation" title="' + la._105 + '"></i>';
            H.appendChild(I);
            return H
        }
          , f = m.column.colId
          , n = GridHelper.getCsvObjectName(f)
          , r = CsvType[n].currency;
        m = m.node.data;
        var p = document.createElement("div");
        p.className = "cell-editing--threshold";
        p.appendChild(t(m.product.domainId, m.product.domainId, m.product[f]));
        if (m.multiLocaleProductsReduced.length)
            for (var z = $jscomp.makeIterator(m.multiLocaleProductsReduced), F = z.next(); !F.done; F = z.next())
                F = F.value,
                p.appendChild(t(F.domainId, m.product.domainId, F[f]));
        this.eGui = p;
        this.domainId = m.product.domainId;
        this.csvTypeName = n;
        this.isCurrency = r
    }
    ;
    h.prototype.isValid = function(m) {
        return !isNaN(parseFloat(m)) && isFinite(m)
    }
    ;
    h.prototype.getValue = function() {
        var m = this
          , t = {};
        this.eGui.querySelectorAll("input").forEach(function(f) {
            var n = f.value.trim();
            n = 0 === n.length ? -1 : m.isValid(n) ? m.isCurrency ? Money.format(Money.unformat(n), {
                sourceDomainId: m.domainId,
                targetDomainId: m.domainId,
                isDivided: !0,
                skipSymbol: !0
            }) : "RATING" === m.csvTypeName ? 10 * Money.unformat(n) : Money.unformat(n) : -2;
            t[f.name] = n
        });
        return t
    }
    ;
    h.prototype.getGui = function() {
        return this.eGui
    }
    ;
    h.prototype.destroy = function() {}
    ;
    h.prototype.isPopup = function() {
        return !1
    }
    ;
    return {
        AutocompleteChips: a,
        MetaData: b,
        ThresholdBooleanValues: d,
        ThresholdValues: h
    }
}()
  , GridCellRendererComponents = function() {
    function a() {}
    a.prototype.init = function(b) {
        this.params = b;
        this.eGui = document.createElement("div");
        b = this.getContent();
        "object" === typeof b ? this.eGui.appendChild(b) : this.eGui.innerHTML = this.getContent()
    }
    ;
    a.prototype.getGui = function() {
        return this.eGui
    }
    ;
    a.prototype.refresh = function(b) {
        this.updateRowHeight();
        return !1
    }
    ;
    a.prototype.getContent = function() {
        var b = this;
        if ("productKey" === this.params.column.colId)
            return this.params.valueFormatted ? this.params.valueFormatted : this.params.value;
        var d = ""
          , h = this.params.data.realField
          , m = this.params.data.realType
          , t = this.params.data.cellClass;
        t && (d += '<div class="' + t + '">');
        if (m && m.includes("booleanColumn"))
            d += GridHelper.cellRendererBoolean(this.params);
        else if ((h.includes("_current") || h.includes("_avg")) && "RATING_current" !== h)
            d += GridHelper.cellRendererCsvType(this.params);
        else
            switch (h) {
            case "domainId":
                h = this.params.value;
                d += '<div class="gridDomainCell">\n\t\t\t\t\t\t\t<img title=".' + getTldByDomain(h) + '" src="' + flags[h] + '">\n\t\t\t\t\t\t</div>';
                break;
            case "imagesCSV":
                this.params.colDef.cellRendererParams = {
                    imageSize: 36
                };
                d += GridHelper.cellRendererImage(this.params);
                break;
            case "title":
                d += this.params.value;
                break;
            case "lastPriceChange":
                d += GridHelper.cellRendererDateAgo(this.params);
                break;
            case "trackingSince":
                d += GridHelper.cellRendererDateKeepaTime(this.params);
                break;
            case "listedSince":
                d += GridHelper.cellRendererDateKeepaTime(this.params);
                break;
            case "RATING_current":
                d += GridHelper.cellRendererRatingStar(this.params).replace("<br>", " ");
                break;
            case "rootCategory":
                this.params.value < invalidIfLargerCatId && (h = GridHelperCategory.getName(this.params.data.domainId, this.params.value),
                h = GridHelperCategory.render(this.params.data.domainId, this.params.value, h),
                d += "object" === typeof h ? h.outerHTML : h);
                break;
            case "categories":
                this.params.value.forEach(function(r, p) {
                    var z = GridHelperCategory.getName(b.params.data.domainId, r);
                    r = GridHelperCategory.render(b.params.data.domainId, r, z);
                    d += (0 < p ? " / " : "") + ("object" === typeof r ? r.outerHTML : r)
                });
                break;
            case "categoryTree":
                if (null == this.params.value || "" === this.params.value)
                    d += "";
                else {
                    var f = this.params.value
                      , n = document.createElement("div");
                    f.forEach(function(r, p) {
                        r = GridHelperCategory.render(b.params.data.domainId, r.catId, r.name);
                        p < f.length - 1 ? n.appendChild(r).insertAdjacentHTML("beforeend", " &rsaquo; ") : n.appendChild(r)
                    });
                    d += n.outerHTML
                }
                break;
            case "eanList":
            case "upcList":
            case "partNumber":
                return GridHelper.cellRendererProductCodes(this.params);
            case "manufacturer":
            case "brand":
            case "color":
            case "size":
            case "edition":
            case "format":
            case "author":
            case "binding":
                d += GridHelper.cellRendererTextFinder(this.params);
                break;
            case "model":
                d += GridHelper.defaultTextClamp(this.params.value);
                break;
            case "variationCSV":
            case "frequentlyBoughtTogether":
                d += GridHelper.cellRendererLinkedAsins(this.params);
                break;
            case "productGroup":
                d += GridHelper.cellRendererProductGroup(this.params);
                break;
            case "publicationDate":
            case "releaseDate":
                d += GridHelper.cellRendererDateYMD(this.params);
                break;
            case "languages":
                d += GridHelper.cellRendererLanguage(this.params);
                break;
            case "packageDimension":
            case "itemDimension":
                d += GridHelper.cellRendererDimension(this.params);
                break;
            case "buyBoxSellerIdHistory":
                d += GridHelper.cellRendererBuyBoxSellerId(this.params);
                break;
            case "sellerIdsLowestFBA":
            case "sellerIdsLowestFBM":
                d += GridHelper.cellRendererSellerIdsLowest(this.params);
                break;
            case "couponOneTimeAbsolute":
                d += GridHelper.cellRendererMoney(this.params);
                break;
            case "fbaFees":
                d += GridHelper.cellRendererFbaFees(this.params);
                break;
            default:
                d += this.params.valueFormatted ? this.params.valueFormatted : this.params.value
            }
        t && (d += "</div>");
        return d
    }
    ;
    a.prototype.updateRowHeight = function() {
        var b = this.params.api.getCellRendererInstances({
            rowNodes: [this.params.node]
        }).reduce(function(d, h) {
            h.eGui.offsetHeight > d && (d = h.eGui.offsetHeight);
            return d
        }, 0);
        this.params.node.setRowHeight(b + 8);
        this.params.api.onRowHeightChanged()
    }
    ;
    return {
        AutoHeightRow: a
    }
}()
  , GridComponents = function() {
    function a() {}
    a.prototype.init = function(b) {
        this.eGui = document.createElement("div");
        this.eGui.innerHTML = '<div class="ag-cell-label-container" role="presentation">\n\t\t\t\t<div ref="eLabel" class="ag-header-cell-label custom-reset-header-cell" role="presentation">\n\t\t\t\t\t<span ref="eText" class="ag-header-cell-text" role="columnheader">' + b.displayName + '&ensp;<i class="fa fa-undo"></i></span>\n\t\t\t\t</div>\n\t\t\t</div>';
        this.eLabel = this.eGui.querySelector(".ag-header-cell-label");
        this.eLabel.addEventListener("click", function() {
            b.columnApi.resetColumnState();
            b.api.sizeColumnsToFit();
            GridState.saveColumnState(b)
        })
    }
    ;
    a.prototype.getGui = function() {
        return this.eGui
    }
    ;
    a.prototype.destroy = function() {}
    ;
    return {
        CustomResetHeader: a
    }
}()
  , GridFilter = function() {
    function a() {}
    function b() {}
    function d() {}
    function h() {}
    function m() {}
    function t() {}
    var f = null
      , n = function(z) {
        var F = $(z).attr("name").replace("autocomplete-", "")
          , I = $(z).parent().parent()
          , E = I.children("p").first()
          , K = I.find('input[type="hidden"]')
          , H = []
          , V = function(S) {
            var aa = K.val().split("###").filter(function(pa) {
                return pa
            })
              , ea = !1;
            S = $jscomp.makeIterator(S);
            for (var ra = S.next(); !ra.done; ra = S.next())
                if (ra = ra.value,
                -1 === aa.indexOf(ra)) {
                    if (0 === aa.length)
                        E.append(GridFilter.getClearAllItem()).find("i").on("click", function() {
                            p(this)
                        });
                    aa.length < GridConfig.maxValuesPerFinderFilter ? (E.append("<span><span>" + ra + '</span> <i class="fa fa-times"></i></span>').find("i").on("click", function() {
                        p(this)
                    }),
                    aa.push(ra)) : ea = !0
                }
            aa.length && (aa.sort(),
            aa = aa.map(function(pa) {
                return pa.replace(/"/g, "&quot;")
            }),
            K.val(aa.join("###")).change());
            ea && GridFinder.showPopupMaxValuesPerFinderFilter()
        };
        $(z).autocomplete({
            source: function(S, aa) {
                var ea = S.term;
                network.request({
                    path: "pro/autocomplete",
                    content: ea,
                    domainId: Number(storage.domain),
                    maxResults: 25,
                    type: F,
                    version: 3
                }).done(function(ra) {
                    if (null != ra.suggestions) {
                        for (var pa = [], ua = [], na = 0; na < ra.suggestions.length; na++) {
                            var qa = ra.suggestions[na]
                              , ka = qa.value + " (" + qa.count + ")";
                            pa.push(qa.value);
                            ua.push({
                                label: ka,
                                value: qa.value
                            })
                        }
                        ua.unshift({
                            selectAll: !0,
                            data: pa.join("###"),
                            label: "Select all",
                            value: " "
                        });
                        H = pa;
                        aa(ua)
                    } else
                        H = [],
                        aa([{
                            label: ea + " (?)",
                            value: ea
                        }])
                }).fail(function(ra) {
                    showErrorPopup("Status: " + ra.status)
                })
            },
            autoFocus: !0,
            delay: 200,
            minLength: 0,
            close: function(S, aa) {
                S = $(z).val();
                -1 < H.indexOf(S) && V([S]);
                $(z).val("")
            },
            select: function(S, aa) {
                if ("" != aa.item.value || "" != aa.item.data)
                    return S = [],
                    aa.item.data ? S = aa.item.data.split("###") : S.push(aa.item.value),
                    V(S),
                    $(z).val(""),
                    !1
            },
            position: {
                my: "left top",
                at: "left bottom",
                collision: "none"
            }
        }).focus(function() {
            $(this).data("ui-autocomplete").search($(this).val())
        }).data("ui-autocomplete")._renderItem = function(S, aa) {
            var ea = $("<li>")
              , ra = $("<div>")
              , pa = aa.label;
            aa.disabled && (ea.addClass("ui-state-disabled"),
            pa = '<i class="fa fa-ban"></i>&ensp;' + pa);
            aa.selectAll && (ea.addClass("ui-item-select-all"),
            pa = '<i class="fa fa-check-circle-o"></i>&ensp;' + pa);
            ra.html(pa);
            return ea.append(ra).appendTo(S)
        }
    }
      , r = function(z) {
        var F = $(z).attr("name").replace("autocomplete-", "")
          , I = $(z).parent().parent()
          , E = I.children("p").first()
          , K = I.find('input[type="hidden"]')
          , H = "salesRankReference" === F;
        $(z).autocomplete({
            source: function(V, S) {
                V = V.term;
                var aa = -1
                  , ea = $("#singleChoice-rootCategory");
                $(ea).is(":visible") ? aa = Number(ea.val()) : f && f.api && (ea = f.api.getFilterInstance("rootCategory").getModel()) && ea.filterActive && (aa = Number(ea.filter));
                V = {
                    path: "service/search",
                    type: "category",
                    domainId: Number(storage.domain),
                    rootCategory: isNaN(aa) ? -1 : aa,
                    content: V,
                    version: 3
                };
                isTest && console.info("%cGrid: searchCategory \u27fc ", "color:#6666bf;font-weight:bold;", V, [JSON.stringify(V)]);
                network.request(V).always(function(ra) {
                    if (null != ra && null != ra.categories) {
                        ra = ra.categories;
                        var pa = [], ua = [], na = "?;Categories;Kategorien;Categor\u00edas;Categorie;Categorias;\u30ab\u30c6\u30b4\u30ea\u30fc\u5225;Products;Produkte;Departments;Special Feature Stores;Custom Stores".split(";"), qa;
                        for (qa in ra) {
                            var ka = ra[qa];
                            if ("undefined" != typeof ka.matched && ka.productCount && ka.name && "?" != ka.name && 0 < ka.parent && (!H || H && (null == ka.children || 0 === ka.children.length))) {
                                var za = {
                                    id: qa,
                                    name: ka.name
                                };
                                H || pa.push(za);
                                for (var J = [], g = ka; null != g && 0 != g.parent; )
                                    g = ra[g.parent],
                                    null == g || na.includes(g.name) || J.unshift(g.name);
                                ua.push({
                                    data: [za],
                                    prefix: J.length ? J.join(" &raquo; ") + " &raquo;" : null,
                                    label: ka.name + " (" + ka.productCount + ")",
                                    value: qa,
                                    count: ka.productCount
                                })
                            }
                        }
                        ua.sort(function(D, N) {
                            return D.count < N.count ? 1 : D.count > N.count ? -1 : 0
                        });
                        ua.length ? (H || ua.unshift({
                            selectAll: !0,
                            data: pa,
                            label: "Select all",
                            value: " "
                        }),
                        S(ua)) : S([{
                            disabled: !0,
                            label: "No matches found",
                            value: "No matches found"
                        }])
                    } else
                        S([{
                            disabled: !0,
                            label: "No matches found",
                            value: "No matches found"
                        }])
                })
            },
            autoFocus: !0,
            delay: 200,
            minLength: [5, 7].includes(Number(storage.domain)) ? 1 : 2,
            close: function(V, S) {
                $(z).val("")
            },
            select: function(V, S) {
                if ("" != S.item.value || S.item.data) {
                    var aa = S.item.data || {
                        id: S.item.value,
                        name: S.item.label
                    };
                    V = H ? [] : K.val().split("###").filter(function(ra) {
                        return ra
                    });
                    S = !1;
                    aa = $jscomp.makeIterator(aa);
                    for (var ea = aa.next(); !ea.done; ea = aa.next())
                        if (ea = ea.value,
                        -1 === V.indexOf(ea.id)) {
                            if (0 === V.length && !H)
                                E.append(GridFilter.getClearAllItem()).find("i").on("click", function() {
                                    p(this)
                                });
                            V.length < GridConfig.maxValuesPerFinderFilter ? (H && E.html("&thinsp;"),
                            E.append("<span><span>" + ea.name + '</span> <i class="fa fa-times" data-id="' + ea.id + '"></i></span>').find("i").on("click", function() {
                                p(this)
                            }),
                            V.push(ea.id)) : S = !0
                        }
                    V.length && K.val(V.join("###")).change();
                    $(z).val("");
                    S && GridFinder.showPopupMaxValuesPerFinderFilter();
                    return !1
                }
            },
            position: {
                my: "left top",
                at: "left bottom",
                collision: "none"
            }
        }).data("ui-autocomplete")._renderItem = function(V, S) {
            var aa = $("<li>")
              , ea = $("<div>")
              , ra = S.label;
            S.disabled && (aa.addClass("ui-state-disabled"),
            ra = '<i class="fa fa-ban"></i>&ensp;' + ra);
            S.selectAll && (aa.addClass("ui-item-select-all"),
            ra = '<i class="fa fa-check-circle-o"></i>&ensp;' + ra);
            ea.addClass("item--categories");
            ra = S.prefix ? "<span>" + (S.prefix ? S.prefix : "-") + "<br></span>" + ra : "" + ra;
            ea.html(ra);
            return aa.append(ea).appendTo(V)
        }
    }
      , p = function(z) {
        var F = $(z).closest("div")
          , I = F.find('input[type="hidden"]');
        F = F.find(".mdc-text-field-helper-text--persistent");
        if (I.length)
            if (-1 === $(z).data("id"))
                I.val("").change(),
                F.html("&thinsp;");
            else {
                var E = $(z).prev().text();
                $(z).data("id") && (E = $(z).data("id") + "");
                F = I.val().split("###").filter(function(K) {
                    return K
                });
                F = F.filter(function(K) {
                    return K !== E
                });
                F.sort();
                F = F.map(function(K) {
                    return K.replace(/"/g, "&quot;")
                });
                I.val(F.join("###")).change();
                $(z).parent().remove()
            }
    };
    a.prototype.init = function(z) {
        var F = "autocomplete-" + z.colDef.field
          , I = !("categories" === z.colDef.field || "categories_exclude" === z.colDef.field);
        this.eGui = document.createElement("div");
        this.eGui.innerHTML = '\n\t\t\t<div class="filter-text--autocomplete ui-front">\n\t\t\t\t<div>\n\t\t\t\t\t<select class="ag-filter-select" id="filterType"' + (I ? "" : " disabled") + '>\n\t\t\t\t\t\t<option value="isOneOf">Is one of</option>\n\t\t\t\t\t\t' + (I ? '<option value="isNoneOf">Is none of</option>' : "") + '\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div class="ag-filter-body">\n\t\t\t\t\t<input class="ag-filter-filter" id="filterText" name="' + F + '" type="text" placeholder="Filter">\n\t\t\t\t</div>\n\t\t\t\t<p></p>\n\t\t\t\t<input type="hidden" name="' + F + '" value="">\n\t\t\t\t<div class="ag-filter-apply-panel" id="applyPanel">\n\t\t\t\t\t<button type="button" id="clearButton"' + (z.clearButton ? "" : ' class="ag-hidden"') + '>Clear Filter</button>\n\t\t\t\t\t<button type="button" id="applyButton"' + (z.applyButton ? "" : ' class="ag-hidden"') + '><i class="fa fa-caret-right"></i> Apply</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t';
        z.applyButton && (this.applyButton = this.eGui.querySelector("#applyButton"),
        this.applyButton.addEventListener("click", this.onFilterChanged.bind(this)));
        this.select = this.eGui.querySelector("#filterType");
        this.input = this.eGui.querySelector("#filterText");
        this.wrapper = $(this.input).parent().parent();
        this.hidden = $(this.wrapper).find('input[type="hidden"]');
        "categories" === z.colDef.field || "categories_exclude" === z.colDef.field ? r(this.input) : n(this.input);
        this.filterField = z.colDef.field;
        this.filter = "";
        this.type = "isOneOf";
        this.filterActive = "" !== this.filter;
        this.filterChangedCallback = z.filterChangedCallback;
        this.valueGetter = z.valueGetter
    }
    ;
    a.prototype.getGui = function() {
        return this.eGui
    }
    ;
    a.prototype.afterGuiAttached = function(z) {
        this.hidePopup = z.hidePopup
    }
    ;
    a.prototype.isFilterActive = function() {
        return this.filterActive
    }
    ;
    a.prototype.getModel = function() {
        return this.filterActive ? {
            filterType: "autocomplete",
            filter: this.filter,
            type: this.type
        } : null
    }
    ;
    a.prototype.setModel = function(z) {
        if (z) {
            var F = ""
              , I = ""
              , E = z.filter ? z.filter.split("###").map(function(H) {
                return H.trim()
            }).filter(function(H) {
                return "" != H
            }) : [];
            if (E.length) {
                var K = "categories" === this.filterField || "categories_exclude" === this.filterField;
                E = Array.from(new Set(E));
                E.sort();
                E.forEach(function(H) {
                    F = K ? F + ("<span><span>" + H + '</span> <i class="fa fa-times" data-id="' + H + '"></i></span>') : F + ("<span><span>" + H + '</span> <i class="fa fa-times"></i></span>')
                });
                I = E.join("###")
            }
            E = $(this.wrapper).children("p").first();
            E.html(F);
            E.find("i").on("click", function() {
                GridFilter.autocompleterRemoveItem(this)
            });
            $(this.hidden).val(I);
            this.filter = z.filter;
            this.type = z.type;
            this.filterActive = 0 < this.filter.length;
            $(this.select).val(this.type)
        } else
            this.filter = "",
            this.type = "isOneOf",
            this.filterActive = !1,
            $(this.hidden).val(""),
            $(this.select).val("isOneOf")
    }
    ;
    a.prototype.onFilterChanged = function() {
        this.filter = $(this.hidden).val();
        this.type = $(this.select).val();
        this.filterActive = "" !== this.filter;
        this.filterChangedCallback()
    }
    ;
    b.prototype.init = function(z) {
        var F = "manage" === z.context.pageId
          , I = z.colDef.field + "Filter";
        !0 === z.isCheckbox ? this.eGui = document.createElement("div") : (this.eGui = document.createElement("div"),
        this.eGui.innerHTML = '\n\t\t\t\t<div class="ag-filter-body">\n\t\t\t\t\t<label>\n\t\t\t\t\t\t<input type="radio" name="' + I + '" value="-1" checked="true" class="ag-filter-checkbox" /> All\n\t\t\t\t\t</label>\n\t\t\t\t\t<label>\n\t\t\t\t\t\t<input type="radio" name="' + I + '" value="1" class="ag-filter-checkbox" /> Yes\n\t\t\t\t\t</label>\n\t\t\t\t\t' + ("LIGHTNING_DEAL_upcoming" !== z.colDef.field || F ? '<label>\n\t\t\t\t\t\t<input type="radio" name="' + I + '" value="0" class="ag-filter-checkbox" /> No\n\t\t\t\t\t</label> ' : "") + '\t\t\t&ensp;\n\t\t\t\t</div>\n\t\t\t\t<div class="ag-filter-apply-panel" id="applyPanel">\n\t\t\t\t\t<button type="button" id="clearButton"' + (z.clearButton ? "" : ' class="ag-hidden"') + '>Clear Filter</button>\n\t\t\t\t\t<button type="button" id="applyButton"' + (z.applyButton ? "" : ' class="ag-hidden"') + '><i class="fa fa-caret-right"></i> Apply</button>\n\t\t\t\t</div>\n\t\t\t');
        this.radios = this.eGui.querySelectorAll('input[name="' + I + '"]');
        if (z.applyButton)
            (this.applyButton = this.eGui.querySelector("#applyButton")) && this.applyButton.addEventListener("click", this.onFilterChanged.bind(this));
        else
            for (I = 0; I < this.radios.length; I++)
                this.radios[I].addEventListener("change", this.onFilterChanged.bind(this));
        this.isManage = F;
        this.isCheckbox = z.isCheckbox;
        this.filterField = z.colDef.field;
        this.filter = !0 === this.isCheckbox ? "" : -1;
        this.filterActive = !this.isCheckbox && -1 < this.filter || !0 === this.isCheckbox && "on" === this.filter;
        this.filterChangedCallback = z.filterChangedCallback;
        this.filterValueGetter = z.colDef.filterValueGetter;
        this.type = "equals";
        this.valueGetter = z.colDef.valueGetter
    }
    ;
    b.prototype.getGui = function() {
        return this.eGui
    }
    ;
    b.prototype.afterGuiAttached = function(z) {
        this.hidePopup = z.hidePopup
    }
    ;
    b.prototype.isFilterActive = function() {
        return this.filterActive
    }
    ;
    b.prototype.doesFilterPass = function(z) {
        var F = z.data[this.filterField];
        !this.isManage || "LIGHTNING_DEAL_upcoming" !== this.filterField && "LIGHTNING_DEAL_backInStock" !== this.filterField || (F = "LIGHTNING_DEAL_upcoming" === this.filterField ? this.valueGetter(z) : this.filterValueGetter(z));
        return F == this.filter
    }
    ;
    b.prototype.getModel = function() {
        return this.filterActive ? {
            filterType: "boolean",
            filter: this.filter,
            type: this.type
        } : null
    }
    ;
    b.prototype.setModel = function(z) {
        z ? ($(this.eGui.querySelector('input[value="' + z.filter + '"]')).prop("checked", !0),
        this.filter = z.filter) : this.filter = !0 === this.isCheckbox ? "" : -1;
        this.filterActive = !this.isCheckbox && -1 < this.filter || !0 === this.isCheckbox && "on" === this.filter
    }
    ;
    b.prototype.onFilterChanged = function() {
        this.filter = $(this.eGui.querySelector("input:checked")).val();
        this.filterActive = !this.isCheckbox && -1 < this.filter || !0 === this.isCheckbox && "on" === this.filter;
        this.filterChangedCallback()
    }
    ;
    d.prototype.init = function(z) {
        var F = this;
        if ("buyBoxSellerIdHistory" !== z.colDef.field)
            this.eGui = document.createElement("div");
        else {
            var I = Number(storage.domain)
              , E = [];
            AmazonSellerIds[I].length && E.push(AmazonSellerIds[I]);
            AltAmazonSellerIds[I].length && E.push(AltAmazonSellerIds[I]);
            I = Array.from(E, function(H) {
                return "-" + H
            });
            E = E.join(",");
            I = I.join(",");
            this.eGui = document.createElement("div");
            this.eGui.innerHTML = '\n\t\t\t<div class="ag-filter-body" style="width:200px;">\n\t\t\t\t<label>\n\t\t\t\t\t<input type="radio" name="dynamic-' + z.colDef.field + '" value="-1" class="ag-filter-checkbox" /> All\n\t\t\t\t</label><br>\n\t\t\t\t' + (E.length ? '\n\t\t\t\t<label>\n\t\t\t\t\t<input type="radio" name="dynamic-' + z.colDef.field + '" value="' + E + '" class="ag-filter-checkbox" /> Amazon\n\t\t\t\t</label><br>' : "") + "\n\t\t\t\t" + (I.length ? '\n\t\t\t\t<label>\n\t\t\t\t\t<input type="radio" name="dynamic-' + z.colDef.field + '" value="' + I + '" class="ag-filter-checkbox" /> 3rd Party\n\t\t\t\t</label><br>' : "") + '\n\t\t\t\t<label>\n\t\t\t\t\t<input type="radio" name="dynamic-' + z.colDef.field + '" value="1" class="ag-filter-checkbox" /> Seller IDs:\n\t\t\t\t</label><br>\n\t\t\t\t<input type="text" name="dynamicAnyOfDetail-' + z.colDef.field + '" class="ag-filter-filter" style="width:92%;" />\n\t\t\t</div>\n\t\t\t<div class="ag-filter-apply-panel" id="applyPanel">\n\t\t\t\t<button type="button" id="clearButton"' + (z.clearButton ? "" : ' class="ag-hidden"') + '>Clear Filter</button>\n\t\t\t\t<button type="button" id="applyButton"' + (z.applyButton ? "" : ' class="ag-hidden"') + '><i class="fa fa-caret-right"></i> Apply</button>\n\t\t\t</div>\n\t\t';
            this.radios = this.eGui.querySelectorAll('input[type="radio"]');
            z.applyButton && (this.applyButton = this.eGui.querySelector("#applyButton")) && this.applyButton.addEventListener("click", this.onFilterChanged.bind(this));
            E = function(H) {
                var V = H.target;
                H = V.value;
                "radio" === V.type ? (V = F.eGui.querySelector('input[name="dynamicAnyOfDetail-' + z.colDef.field + '"'),
                1 == H ? V.focus() : V.value = "") : F.eGui.querySelector('input[value="1"]').checked = !0
            }
            ;
            I = this.eGui.querySelectorAll('input[name^="dynamic"]');
            for (var K = 0; K < I.length; K++)
                I[K].addEventListener("focus", E)
        }
        this.filterField = z.colDef.field;
        this.filter = -1;
        this.filterDetail = "";
        this.filterActive = -1 != this.filter;
        this.filterChangedCallback = z.filterChangedCallback;
        this.type = "equals";
        this.valueGetter = z.valueGetter
    }
    ;
    d.prototype.getGui = function() {
        return this.eGui
    }
    ;
    d.prototype.afterGuiAttached = function(z) {
        this.hidePopup = z.hidePopup
    }
    ;
    d.prototype.isFilterActive = function() {
        return this.filterActive
    }
    ;
    d.prototype.getModel = function() {
        return this.filterActive ? {
            filterType: "dynamic",
            filter: this.filter,
            filterDetail: this.filterDetail,
            type: this.type
        } : null
    }
    ;
    d.prototype.setModel = function(z) {
        var F = z ? $(this.eGui.querySelector('input[value="' + z.filter + '"]')) : [];
        z && F.length ? ($(this.eGui.querySelector('input[value="' + z.filter + '"]')).prop("checked", !0),
        $(this.eGui.querySelector('input[name="dynamicAnyOfDetail-' + this.filterField + '"')).val(z.filterDetail),
        this.filter = z.filter,
        this.filterDetail = z.filterDetail) : (this.filter = -1,
        this.filterDetail = "");
        this.filterActive = -1 != this.filter
    }
    ;
    d.prototype.onFilterChanged = function() {
        this.filter = $(this.eGui.querySelector("input:checked")).val();
        this.filterDetail = $(this.eGui.querySelector('input[name="dynamicAnyOfDetail-' + this.filterField + '"')).val();
        this.filterActive = -1 != this.filter;
        this.filterChangedCallback()
    }
    ;
    m.prototype.init = function(z) {
        var F = z.colDef.field + "Filter", I = z.colDef.filterParams.valueOptions, E = '<option value="-1">All</option>', K;
        for (K in I) {
            var H = I[K];
            E += '<option value="' + H.value + '">' + H.label + "</option>"
        }
        this.eGui = document.createElement("div");
        this.eGui.innerHTML = '\n\t\t\t<div class="ag-filter-body">\n\t\t\t\t<select id="' + F + '" class="ag-filter-select">\n\t\t\t\t\t' + E + '\n\t\t\t\t</select>\n\t\t\t&ensp;\n\t\t\t</div>\n\t\t\t<div class="ag-filter-apply-panel" id="applyPanel">\n\t\t\t\t<button type="button" id="clearButton"' + (z.clearButton ? "" : ' class="ag-hidden"') + '>Clear Filter</button>\n\t\t\t\t<button type="button" id="applyButton"' + (z.applyButton ? "" : ' class="ag-hidden"') + '><i class="fa fa-caret-right"></i> Apply</button>\n\t\t\t</div>\n\t\t';
        this.select = this.eGui.querySelector("#" + F);
        z.applyButton ? (this.applyButton = this.eGui.querySelector("#applyButton"),
        this.applyButton.addEventListener("click", this.onFilterChanged.bind(this))) : this.select.addEventListener("change", this.onFilterChanged.bind(this));
        this.valueOptions = I;
        this.filter = -1;
        this.filterActive = -1 < this.filter;
        this.filterChangedCallback = z.filterChangedCallback;
        this.type = "equals";
        this.valueGetter = z.valueGetter
    }
    ;
    m.prototype.getGui = function() {
        return this.eGui
    }
    ;
    m.prototype.afterGuiAttached = function(z) {
        this.hidePopup = z.hidePopup
    }
    ;
    m.prototype.isFilterActive = function() {
        return this.filterActive
    }
    ;
    m.prototype.getModel = function() {
        return -1 < this.filter ? {
            filterType: "singleChoice",
            filter: this.filter,
            type: this.type
        } : null
    }
    ;
    m.prototype.setModel = function(z) {
        z ? ($(this.select).val(z.filter),
        this.filter = z.filter) : this.filter = -1;
        this.filterActive = -1 < this.filter
    }
    ;
    m.prototype.onFilterChanged = function() {
        this.filter = $(this.select).val();
        this.filterActive = -1 < this.filter;
        this.filterChangedCallback()
    }
    ;
    t.prototype.init = function(z) {
        var F = "singleChoiceRadio-" + z.colDef.field + "Filter", I = z.colDef.filterParams.valueOptions, E = I.find(function(S) {
            return !0 === S.default
        }), K = "", H;
        for (H in I) {
            var V = I[H];
            K += '<label>\n\t\t\t\t\t<input type="radio" name="' + F + '" value="' + V.value + '" class="ag-filter-checkbox" /> ' + V.label + "\n\t\t\t\t</label><br>"
        }
        this.eGui = document.createElement("div");
        this.eGui.innerHTML = '\n\t\t\t<div class="ag-filter-body" style="width:120px;margin-top:10px;">\n\t\t\t\t' + K + '\n\t\t\t&ensp;\n\t\t\t</div>\n\t\t\t<div class="ag-filter-apply-panel" id="applyPanel">\n\t\t\t\t<button type="button" id="clearButton"' + (z.clearButton ? "" : ' class="ag-hidden"') + '>Clear Filter</button>\n\t\t\t\t<button type="button" id="applyButton"' + (z.applyButton ? "" : ' class="ag-hidden"') + '><i class="fa fa-caret-right"></i> Apply</button>\n\t\t\t</div>\n\t\t';
        this.radios = this.eGui.querySelectorAll('input[type="radio"]');
        z.applyButton ? (this.applyButton = this.eGui.querySelector("#applyButton"),
        this.applyButton.addEventListener("click", this.onFilterChanged.bind(this))) : this.select.addEventListener("change", this.onFilterChanged.bind(this));
        this.valueOptions = I;
        this.filter = this.filterDefault = E.value;
        this.filterActive = this.filter != this.filterDefault;
        this.filterChangedCallback = z.filterChangedCallback;
        this.type = "equals"
    }
    ;
    t.prototype.getGui = function() {
        return this.eGui
    }
    ;
    t.prototype.afterGuiAttached = function(z) {
        this.hidePopup = z.hidePopup
    }
    ;
    t.prototype.isFilterActive = function() {
        return this.filterActive
    }
    ;
    t.prototype.getModel = function() {
        return this.filter != this.filterDefault ? {
            filterType: "singleChoiceRadio",
            filter: this.filter,
            type: this.type
        } : null
    }
    ;
    t.prototype.setModel = function(z) {
        var F = z ? $(this.eGui.querySelector('input[value="' + z.filter + '"]')) : [];
        z && F.length ? ($(this.eGui.querySelector('input[value="' + z.filter + '"]')).prop("checked", !0),
        this.filter = z.filter) : this.filter = -1;
        this.filterActive = this.filter != this.filterDefault
    }
    ;
    t.prototype.onFilterChanged = function() {
        this.filter = $(this.eGui.querySelector("input:checked")).val();
        this.filterActive = this.filter != this.filterDefault;
        this.filterChangedCallback()
    }
    ;
    return {
        autocompleterAdd: n,
        autocompleterAddCategories: r,
        autocompleterRemoveItem: p,
        getClearAllItem: function() {
            return '<span style="background-color:#f3f3f3;"><span style="font-style:italic;">Clear all <i class="fa fa-times" data-id="-1"></i></span></span>'
        },
        initCustomNumberArrayColumnFilter: function() {
            h.prototype = new agGrid.NumberFilter;
            h.NULL_VALUE = "nullValue";
            h.prototype.afterGuiAttached = function() {
                var z = GridHelper.getCsvObjectName(this.providedFilterParams.colDef.field);
                if (3 > this.eGui.children.length && "manage" === this.gridOptionsWrapper.gridOptions.context.pageId && CsvType[z].currency) {
                    var F = getCurrencyCodeByDomain(0 < currencyDomainId ? currencyDomainId : Number(storage.domain))
                      , I = this.eGui.children[this.eGui.children.length - 1]
                      , E = document.createElement("div");
                    E.className = "custom-filter-info-panel";
                    E.innerHTML = '<i class="fa fa-info-circle"></i> ' + la._700.replace("#currency#", F);
                    I.parentNode.appendChild(E)
                }
                "SALES" === z && (z = $(this.eGui.querySelector('[ref="eOptions1"] option[value="nullValue"]')).get(0)) && (z.innerHTML = "No Sales Rank");
                this.eValueFrom1.focus()
            }
            ;
            h.prototype.updateUiVisibility = function(z) {
                z = this.allowTwoConditions;
                agGrid.Utils.setVisible(this.eCondition2Body, z);
                agGrid.Utils.setVisible(this.eType2, z);
                agGrid.Utils.setVisible(this.eJoinOperatorPanel, z);
                var F = this.showValueFrom(this.getCondition1Type())
                  , I = this.showValueTo(this.getCondition1Type());
                this.getCondition1Type() === h.NULL_VALUE && (I = F = !1);
                agGrid.Utils.setVisible(this.eValueFrom1, F);
                agGrid.Utils.setVisible(this.eValueTo1, I);
                F = z ? this.showValueFrom(this.getCondition2Type()) : !1;
                agGrid.Utils.setVisible(this.eValueFrom2, F);
                z = z ? this.showValueTo(this.getCondition2Type()) : !1;
                agGrid.Utils.setVisible(this.eValueTo2, z);
                this.getCondition1Type() === h.NULL_VALUE ? (this.eValueFrom1.value = -1,
                this.eValueTo1.value = -1) : -1 == this.eValueFrom1.value && -1 == this.eValueTo1.value && (this.eValueFrom1.value = null,
                this.eValueTo1.value = null)
            }
            ;
            h.prototype.individualConditionPasses = function(z, F) {
                var I = this;
                z = this.scalarFilterParams.valueGetter(z.node);
                var E = this.mapRangeFromModel(F)
                  , K = E.from
                  , H = E.to
                  , V = F.type
                  , S = this.scalarFilterParams.inRangeInclusive;
                if ((F = this.optionsFactory.getCustomOption(V)) && (null != K || F.hideFilterInput))
                    return F.test(K, z);
                if (Array.isArray(z))
                    return z.some(function(aa) {
                        var ea = I.nullComparator(V, K, aa);
                        aa = null == H ? null : I.nullComparator(V, H, aa);
                        return I.getPassResult(V, ea, aa, S)
                    });
                F = this.nullComparator(V, K, z);
                z = null == H ? null : this.nullComparator(V, H, z);
                return this.getPassResult(V, F, z, S)
            }
            ;
            h.prototype.getPassResult = function(z, F, I, E) {
                if (z === agGrid.ScalerFilter.EQUALS)
                    return 0 === F;
                if (z === agGrid.ScalerFilter.GREATER_THAN)
                    return 0 < F;
                if (z === agGrid.ScalerFilter.GREATER_THAN_OR_EQUAL)
                    return 0 <= F;
                if (z === agGrid.ScalerFilter.LESS_THAN_OR_EQUAL)
                    return 0 >= F;
                if (z === agGrid.ScalerFilter.LESS_THAN)
                    return 0 > F;
                if (z === agGrid.ScalerFilter.NOT_EQUAL)
                    return 0 != F;
                if (z === agGrid.ScalerFilter.IN_RANGE)
                    return E ? 0 <= F && 0 >= I : 0 < F && 0 > I;
                throw Error("Unexpected type of filter: " + z);
            }
        },
        setGridApi: function(z) {
            f = z
        },
        AutocompleteFilter: a,
        BooleanFilter: b,
        DynamicFilter: d,
        NumberArrayFilter: h,
        SingleChoiceFilter: m,
        SingleChoiceRadioFilter: t
    }
}()
  , GridHelper = function() {
    var a = !1
      , b = {
        "-1": "no Amazon offer exists",
        0: "Amazon offer is in stock and shippable",
        1: "Amazon offer is a pre-order",
        2: "Amazon offer availability is &quot;unknown&quot;",
        3: "Amazon offer is back-ordered",
        4: "Amazon offer shipping is delayed"
    }
      , d = function(g, D) {
        if (null != g.api && "undefined" !== typeof g.api) {
            D = $(D).parent('[role="row"]');
            if ("infinite" === g.rowModelType)
                return D = D.attr("row-index"),
                g.api.getDisplayedRowAtIndex(D);
            if ("serverSide" === g.rowModelType) {
                var N = D.attr("row-id")
                  , ba = null;
                g.api.forEachNode(function(q) {
                    q.id == N && (ba = q)
                });
                return ba
            }
            D = D.attr("row-id");
            return g.api.getRowNode(D)
        }
    }
      , h = {}
      , m = function(g) {
        var D = E(g.colDef.field)
          , N = CsvType[D].color
          , ba = g.data.domainId
          , q = g.data.casin
          , L = []
          , A = "";
        Object.keys(q).forEach(function(O) {
            var P = q[O][D];
            -1 < P && L.push({
                price: P,
                domainId: O
            })
        });
        0 < L.length && (L.sort(function(O, P) {
            return O.price - P.price
        }),
        L.forEach(function(O) {
            var P = Money.format(O.price, {
                sourceDomainId: ba,
                targetDomainId: ba
            });
            if (O.domainId != ba) {
                var M = getAmazonRedirectByDomain(O.domainId, g.data.asin);
                A += '<a href="' + M + '" title="' + la._99 + ' Amazon" target="_blank" class="external"><img title=".' + getTldByDomain(O.domainId) + '" src="' + flags[O.domainId] + '" style="opacity:0.8;"></a>\n\t\t\t\t\t<span style="color:' + N + ';opacity:0.8;margin-top:-4px;">' + P + "</span><br>"
            } else
                A += '<span style="color:' + N + ';opacity:0.8;margin-top:-4px;">' + P + "</span><br>"
        }));
        return A
    }
      , t = function(g) {
        return "undefined" === typeof g.value || null == g.value ? "" : -1 == g.value ? "-" : -2 == g.value ? "?" : prettyDate(keepaTime.now() - g.value)
    }
      , f = function(g) {
        return "undefined" === typeof g.value || null === g.value ? "" : (new Date(keepaTime.minutesToEpoch(g.value))).formatDate("Y/m/d")
    }
      , n = function(g) {
        return "undefined" === typeof g.value || null == g.value ? "" : -2 == g.value ? "?" : -1 == g.value ? "" : (new Date(keepaTime.minutesToEpoch(g.value))).formatDate("Y/m/d H:i")
    }
      , r = function(g) {
        if ("undefined" === typeof g.value)
            return "";
        g = g.value.toString();
        var D = g.length;
        return 8 === D ? g.substring(0, 4) + "-" + g.substring(4, 6) + "-" + g.substring(6, 8) : 6 === D ? g.substring(0, 4) + "-" + g.substring(4, 6) : 4 === D ? g : ""
    }
      , p = function(g) {
        var D = g.value;
        if (null == D || 0 == D.length)
            return "";
        "string" === typeof D && (D = [D]);
        var N = document.createElement("div");
        N.className = "text-clamp clamp-lines-" + I(g);
        N.title = D.join(", ");
        for (var ba = 0; ba < D.length; ba++) {
            var q = D[ba]
              , L = document.createElement("span");
            L.innerHTML = q + (ba !== D.length - 1 ? ", " : "");
            var A = "undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field;
            ["upcList", "eanList"].includes(A) && ProductImageHover.preview.add_events(L, {
                type: "svgBarcode",
                value: q,
                format: "upcList" === A ? "upc" : "ean13"
            });
            N.appendChild(L)
        }
        return N
    }
      , z = function(g) {
        var D = document.createElement("span");
        D.className = "toggle-filter text-clamp clamp-lines-3";
        D.innerHTML = g.value;
        D.title = 'Toggle filter: "' + g.value + '"';
        D.addEventListener("click", function() {
            F(g, this)
        });
        return D
    }
      , F = function(g, D) {
        var N = g.api.getFilterInstance(g.colDef.field)
          , ba = null;
        switch (g.colDef.filter) {
        case "customAutocompleteColumnFilter":
            ba = "categories" === g.colDef.field ? $(D).data("id").toString() : g.value.toLowerCase();
            D = N.filter.split("###").map(function(L) {
                return L.trim()
            }).filter(function(L) {
                return "" != L
            });
            var q = D.indexOf(ba);
            -1 !== q ? D.splice(q, 1) : D.push(ba);
            D.length ? N.setModel({
                filterType: "autocomplete",
                type: "isOneOf",
                filter: D.join("###")
            }) : N.setModel(null);
            break;
        case "customSingleChoiceColumnFilter":
            ba = g.data[g.colDef.field],
            N.setModel({
                filterType: "singleChoice",
                filter: ba === N.filter ? -1 : ba,
                type: "equals"
            })
        }
        g.api.onFilterChanged()
    }
      , I = function(g) {
        return (g = g.node.rowHeight) ? (g - 8) / 16 : 1
    }
      , E = function(g) {
        g = g.split("_");
        g.pop();
        return g.join("_")
    }
      , K = function(g) {
        var D = "undefined" !== typeof g.data.deleteCounter && !1 !== g.data.deleteCounter
          , N = GridManage.pageConfig.activeViewMode === GridManage.viewModes.COMPACT ? '<span><i class="fa fa-ban fa-lg"></i><span>(3)</span></span>' : la._84
          , ba = document.createElement("div");
        ba.innerHTML = D ? N.replace(/(\d+)/, g.data.deleteCounter) : N;
        ba.className = "cancel";
        D || (ba.style.display = "none");
        ba.addEventListener("click", function(q) {
            $(this).html(N);
            $(this).closest(".ag-cell").find("div").each(function(L, A) {
                "flags" === A.className || "links" === A.className ? $(A).css({
                    opacity: 1
                }) : "delete" === A.className ? $(A).fadeIn(250) : $(A).hide()
            });
            q = g.node;
            q.data.deleteCounter = !1;
            q.setData(q.data)
        });
        return ba
    }
      , H = function(g) {
        var D = GridManage.pageConfig.activeViewMode === GridManage.viewModes.COMPACT
          , N = "undefined" !== typeof g.data.deleteCounter && !1 !== g.data.deleteCounter
          , ba = document.createElement("div");
        ba.className = "delete";
        ba.title = la._100;
        N && (ba.style.display = "none");
        ba.appendChild(function() {
            var q = document.createElement("span");
            q.innerHTML = '<i class="fa fa-trash-o fa-lg"></i>';
            D || (q.innerHTML += "<span>" + la._379 + "</span>");
            q.addEventListener("click", function(L) {
                var A = g.node
                  , O = A.data.asin;
                $(this).closest(".ag-cell").find("div").each(function() {
                    if ("flags" === this.className || "links" === this.className || "check" === this.className)
                        $(this).css({
                            opacity: .1
                        });
                    else if ("cancel" === this.className) {
                        $(this).fadeIn(250);
                        var P = function() {
                            "undefined" === typeof A.data.isDeleted && !1 !== A.data.deleteCounter && (A.data.deleteCounter--,
                            A.setData(A.data),
                            0 === A.data.deleteCounter ? network.request({
                                path: "track",
                                type: "deleteTracking",
                                asinBatch: [O],
                                version: 3
                            }).done(function(M) {
                                null == M.error && ("undefined" === typeof g.context.deletedAsins && (g.context.deletedAsins = []),
                                g.context.deletedAsins.push(O),
                                A.data.isDeleted = !0,
                                A.setData(A.data),
                                A.detailNode && (M = g.api.getDetailGridInfo(A.detailNode.id),
                                "undefined" !== typeof M && M.api.forEachNode(function(u) {
                                    var v = u.data;
                                    v.isDeleted = !0;
                                    u.setData(v)
                                })))
                            }).fail(showErrorPopup) : window.setTimeout(function() {
                                P()
                            }, 1E3))
                        };
                        A.data.deleteCounter = 3;
                        A.setData(A.data);
                        window.setTimeout(function() {
                            P()
                        }, 1E3)
                    } else
                        $(this).hide()
                })
            });
            return q
        }());
        return ba
    }
      , V = function(g) {
        g = S(g || !1);
        return GridConfig.unitSystem[g]
    }
      , S = function(g) {
        g && (a = !1);
        if (!a && (g = Object.keys(GridConfig.unitSystem),
        a = g[0],
        "undefined" !== typeof storage.gridConfig)) {
            var D = JSON.parse(storage.gridConfig);
            (D = D.unitSystem ? D.unitSystem : !1) && g.includes(D) && (a = D)
        }
        return a
    }
      , aa = function(g, D) {
        return g.toLocaleString(["en-US", "en-US"], D)
    }
      , ea = function(g, D) {
        var N = d(g, D);
        "undefined" !== typeof N && (D = {
            columnKeys: [$(D).attr("col-id")],
            processCellCallback: GridHelper.processCellCallback,
            skipHeader: !0,
            shouldRowBeSkipped: function(ba) {
                return N.id !== ba.node.id
            },
            suppressQuotes: !0
        },
        g.context.isCopyToClipboard = !0,
        D = g.api.getDataAsCsv(D),
        pa(D),
        g.context.isCopyToClipboard = !1)
    }
      , ra = function(g, D, N) {
        var ba = d(g, D);
        "undefined" !== typeof ba && (D = {
            processCellCallback: GridHelper.processCellCallback,
            skipHeader: N,
            shouldRowBeSkipped: function(q) {
                return ba.id !== q.node.id
            },
            suppressQuotes: !0
        },
        g.context.isCopyToClipboard = !0,
        D = g.api.getDataAsCsv(D),
        pa(D),
        g.context.isCopyToClipboard = !1)
    }
      , pa = function(g) {
        isTest && console.log("copied \u2192", g);
        if (window.clipboardData && window.clipboardData.setData)
            return clipboardData.setData("Text", g);
        if (document.queryCommandSupported && document.queryCommandSupported("copy")) {
            var D = document.createElement("textarea");
            D.textContent = g;
            D.style.position = "fixed";
            document.body.appendChild(D);
            D.select();
            try {
                return document.execCommand("copy")
            } catch (N) {
                return isTest && console.warn("Copy to clipboard failed.", N),
                !1
            } finally {
                document.body.removeChild(D)
            }
        }
    }
      , ua = function(g) {
        var D = "undefined" !== typeof g.colDef ? g.colDef.field : g.column.colDef.field;
        if ("undefined" === typeof D)
            return "-";
        var N = "undefined" !== typeof g.node ? g.node.data : g.data;
        return "undefined" === typeof N ? "" : null == g.value ? (N.offersOutdated || N.offersNeverUpdated) && null != N[D] ? "?" : "-" : g.value + " %"
    }
      , na = function(g) {
        if (null == g.value)
            return "-";
        var D = ("undefined" === typeof g.colDef ? g.column.colDef : g.colDef).field;
        if ("SALES" === E(D))
            return NumberUtil.format(g.value);
        g = "undefined" === typeof g.data ? g.node.data : g.data;
        return Money.format(g[D], {
            sourceDomainId: g.domainId
        })
    }
      , qa = function(g) {
        var D = "undefined" !== typeof g.colDef ? g.colDef.field : g.column.colDef.field;
        if ("undefined" === typeof D)
            return "-";
        g = "undefined" !== typeof g.node ? g.node.data : g.data;
        if ("undefined" === typeof g)
            return "";
        var N = g[D];
        "fbaFees" === D && (N = g[D + "Total"]);
        return null == N ? (g.offersOutdated || g.offersNeverUpdated) && null != g[D] ? "?" : "-" : Money.format(N, {
            sourceDomainId: g.domainId,
            targetDomainId: "fbaFees" === D ? Number(g.domainId) : 0 < currencyDomainId ? currencyDomainId : Number(g.domainId)
        })
    }
      , ka = function(g) {
        var D = "undefined" !== typeof g.colDef ? g.colDef.field : g.column.colDef.field;
        if ("undefined" === typeof D)
            return isTest && console.warn("missing field, check out valueFormatterPrice"),
            "-";
        var N = "undefined" !== typeof g.node ? g.node.data : g.data;
        if ("undefined" === typeof N)
            return "";
        if (null == g.value)
            return g = E(D),
            ("NEW_FBA" == g || "NEW_FBM_SHIPPING" == g) && 1 == N.COUNT_NEW_current && 0 < N.AMAZON_current ? "-" : GridHelper.isOfferData(g) && (N.offersOutdated || N.offersNeverUpdated) && (0 < D.indexOf("_current") || 0 < D.indexOf("_atIntervalStart")) || ["EBAY_NEW_SHIPPING", "EBAY_USED_SHIPPING"].includes(g) && N.ebayOutdated && 0 < N.lastEbayUpdate ? "?" : "-";
        var ba = ("undefined" === typeof g.context || "lightningdeal" !== g.context.pageId) && 0 < currencyDomainId ? currencyDomainId : Number(N.domainId);
        "undefined" !== typeof g.context && g.context.mainDomainId && !currencyDomainId && (ba = g.context.mainDomainId);
        return Money.format(N[D], {
            sourceDomainId: N.domainId,
            targetDomainId: ba
        })
    }
      , za = function(g) {
        var D = "-";
        if (Array.isArray(g.value))
            D = g.value.join(", ");
        else if ("object" === typeof g.value && null != g.value) {
            D = [];
            for (var N in g.value) {
                var ba = g.value[N];
                D.push(ba.sellerName + " (" + ba.currentRating + "%)")
            }
            D = D.join(", ")
        }
        return D
    }
      , J = function(g, D) {
        D = void 0 === D ? !1 : D;
        if (D) {
            var N = g.column.colDef.field;
            var ba = g.node.data.product
        } else
            N = g.colDef.field,
            ba = g.data.product;
        var q = ba[N];
        if (N.includes("current") && -2 === q && !D)
            return '<i class="fa fa-lock"' + (N.includes("SALES") ? ' title="' + la._909 + '"' : "") + "></i>";
        if (null == q || !N.includes("delta") && 0 > q || !D && g.data.isDeleted)
            return "-";
        q = E(N);
        var L = CsvType[q].currency;
        return D && -1 === (g.context.exportOptions || []).indexOf("exportFormatted") ? L ? Money.format(ba[N], {
            sourceDomainId: ba.domainId,
            targetDomainId: ba.domainId,
            acceptMinusOne: N.includes("delta"),
            skipSymbol: !0
        }).replace(",", "") : ba[N] : L ? Money.format(ba[N], {
            sourceDomainId: ba.domainId,
            targetDomainId: ba.domainId,
            acceptMinusOne: N.includes("delta")
        }) : CsvType.format(q, ba[N])
    };
    return {
        availabilityAmazonValueMap: b,
        addContextMenu: function(g) {
            if (!1 !== g.suppressContextMenu) {
                var D = "#" + g.context.gridWrapperId + " .ag-body-viewport .ag-cell";
                $.contextMenu("destroy", D);
                var N = {
                    copy: {
                        name: "Copy",
                        icon: "fa-files-o",
                        accesskey: "c",
                        callback: function(ba, q) {
                            ea(g, q.$trigger[0])
                        }
                    },
                    copyRow: {
                        name: "Copy row",
                        icon: "fa-clipboard",
                        accesskey: "r",
                        callback: function(ba, q) {
                            ra(g, q.$trigger[0], !0)
                        }
                    },
                    track: {
                        name: "Track product",
                        icon: "fa-bell-o",
                        accesskey: "t",
                        callback: function(ba, q) {
                            ba = d(g, q.$trigger[0]);
                            "undefined" !== typeof ba && (ba = "#!track/" + ba.data.domainId + "-" + ba.data.asin,
                            iframe.isIframe ? window.open(getBaseUrl() + ba, "_blank").focus() : window.open(ba, "_self"))
                        }
                    }
                };
                g.context.config && ("asin" !== g.context.config.type && "variation" !== g.context.config.type && delete N.track,
                "productDetail" !== g.context.config.type && "productPrice" !== g.context.config.type || delete N.copyRow);
                $.contextMenu({
                    selector: D,
                    callback: function(ba, q) {},
                    items: N
                })
            }
        },
        addCopyByKeyboard: function(g) {
            var D = toCamelCase(g.context.gridWrapperId)
              , N = h[D];
            "undefined" === typeof h[D] && (h[D] = g,
            N = h[D]);
            ["categorytree", "manage"].includes(N.context.pageId) || ($.ctrl = function(ba, q) {
                var L = !1;
                $(document).on("keydown.copyByKeyboard", function(A) {
                    var O = [N];
                    if (A.ctrlKey || A.metaKey)
                        L = !0;
                    if (A.keyCode == ba.charCodeAt(0) && L) {
                        var P = A.target.classList.value
                          , M = $(A.target).closest("#" + N.context.gridWrapperId);
                        if (P.includes("ag-cell") && M.length)
                            return O.push(A.target),
                            q.apply($jscomp$this, O),
                            !1
                    }
                }).on("keyup.copyByKeyboard", function(A) {
                    A.ctrlKey && (L = !1)
                })
            }
            ,
            $.ctrl("C", ea),
            onPageNavigation.progress(function() {
                $(document).off("keydown.copyByKeyboard");
                $(document).off("keyup.copyByKeyboard")
            }))
        },
        addToggleUnitEvents: function(g) {
            try {
                var D = $("#" + g.context.config.gridWrapperId + " .toggle-unit:not(.done)");
                D.length && D.each(function() {
                    $(this).addClass("done");
                    $(this).on("click", function() {
                        GridApi.toggleUnit(g);
                        return !1
                    })
                })
            } catch (N) {
                reportBug(N)
            }
        },
        getCsvObjectName: E,
        cellRendererBoolean: function(g) {
            return g.value ? '<i class="fa fa-check"></i>' : ""
        },
        cellRendererBuyBoxSellerId: function(g) {
            if ("undefined" === typeof g.value)
                return "";
            if (null == g.value)
                return !0 === g.data.stats.buyBoxIsUsed || -1 === g.data.stats.buyBoxPrice ? "-" : "?";
            var D = g.data.buyBoxSeller ? g.data.buyBoxSeller[g.data.buyBoxSellerId] : g.value[g.data.buyBoxSellerId];
            if ("undefined" === typeof D)
                return "";
            if ("Amazon" === D.sellerName || -2 == g.data.buyBoxSellerId)
                return D.sellerName;
            var N = "finder" === g.context.pageId
              , ba = getBaseUrl() + "#!seller/" + g.data.domainId + "-" + g.data.buyBoxSellerId
              , q = '<a href="https://www.amazon.' + (getTldByDomain(g.data.domainId) + "/gp/aag/details/?seller=" + g.data.buyBoxSellerId) + '" title="' + la._646 + ' Amazon" target="_blank"><i class="fa fa-external-link"></i></a>';
            N = N ? '<br><span style="font-family:monospace;color:#ccc">' + g.data.buyBoxSellerId + "</span>" : "";
            if ("3rd Party" != D.sellerName)
                return '\n\t\t\t\t<a href="' + ba + '" title="' + la._181 + '" target="_blank">' + D.sellerName + '</a>\n\t\t\t\t<span style="color:#999">(' + D.currentRating + "%)</span>&ensp;\n\t\t\t\t" + q + "\n\t\t\t\t" + N + "\n\t\t\t";
            var L = g.colDef.field;
            g.context.sellerHashMap && g.context.sellerHashMap[g.data.buyBoxSellerId] ? setTimeout(function() {
                g.node.setDataValue(L, g.context.sellerHashMap[g.data.buyBoxSellerId])
            }, 0) : networkHelper.loadSellers({
                path: "pro/seller",
                history: !1,
                version: 3
            }, g.data.domainId, [g.data.buyBoxSellerId]).done(function(A) {
                var O = {}, P;
                for (P in A) {
                    var M = A[P];
                    O[P] = {
                        sellerName: M.sellerName,
                        currentRating: M.currentRating
                    }
                }
                g.context.sellerHashMap || (g.context.sellerHashMap = {});
                g.context.sellerHashMap[g.data.buyBoxSellerId] = O;
                g.node.setDataValue("undefined" !== typeof g.data.realField ? "productValue" : L, O)
            });
            return '\n\t\t\t\t<a href="' + ba + '" title="' + la._181 + '" target="_blank">' + D.sellerName + '</a>&ensp;<i class="fa fa-spinner fa-spin"></i>&ensp;\n\t\t\t\t' + q + "\n\t\t\t\t" + N + "\n\t\t\t"
        },
        cellRendererChangeFilterModel: z,
        cellRendererCouponPercentage: function(g) {
            if ("undefined" === typeof g.data)
                return "";
            var D = "undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field
              , N = "";
            g.data.offersOutworn && !g.data.offersOutdated && D.includes("coupon") && (N = ";font-style:italic;");
            return '<span style="' + N + '">' + g.valueFormatted + "</span>"
        },
        cellRendererCsvType: function(g) {
            if ("undefined" === typeof g.data)
                return "";
            var D = "undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field
              , N = E(D)
              , ba = CsvType[N].currency
              , q = "";
            GridHelper.isOfferData(N) && g.data.offersOutworn && !g.data.offersOutdated && (0 < D.indexOf("_current") || 0 < D.indexOf("_atIntervalStart")) && "COUNT_REVIEWS_current" != D && (q = ";font-style:italic;");
            var L = "";
            GridHelper.isOfferData(N) && (g.data.offersOutdated || g.data.offersNeverUpdated) && (0 < D.indexOf("_current") || 0 < D.indexOf("_atIntervalStart")) && "?" === g.valueFormatted && (L = "Only outdated data available.\nYou can force an update via the Product Viewer.");
            ["EBAY_NEW_SHIPPING", "EBAY_USED_SHIPPING"].includes(N) && g.data.ebayOutdated && 0 < g.data.lastEbayUpdate && (L = "Only outdated data available.");
            var A = "";
            ba && "undefined" !== typeof g.data.casin && 0 < Object.keys(g.data.casin).length ? A = m(g) : (A = '<span style="color:' + CsvType[N].color + q + '"' + (L ? ' title="' + L + '"' : "") + ">" + g.valueFormatted + "</span>",
            L = "",
            L = "lightningdeal" === g.context.pageId,
            ba && !L && showReferencePrice(g.data.domainId) && (ba = g.data[D],
            ba = null == g.value || 0 > ba ? "-" : Money.format(ba, {
                sourceDomainId: g.data.domainId,
                targetDomainId: g.data.domainId
            }),
            L = '<span style="color:#ccc;' + q + '">' + ba + "</span>",
            A = "undefined" !== typeof g.data.realField ? L + "&ensp;" + A : A + "<br>" + L));
            null != g.value && "left" === g.column.pinned && "SALES" !== N && -1 < D.indexOf("_current") && CsvType[N].graphAPI && -2 !== g.value && (q = "1 month " + CsvType.getName(CsvType[N].index) + " price history",
            ba = GraphService.getWebGraphTypeAllOff(),
            ba[CsvType[N].index] = 1,
            ba = GraphService.getUrl(g.data.asin, g.data.domainId, 78, 28, ba, 31, 1),
            A += '<br><span name="minigraph" title="' + q + '" style="height:28px;width:78px;margin-top:2px;margin-right:-9px;display:inline-block;background:url(' + (ba + ') no-repeat right;"></span>'));
            "deals" === g.context.pageId && "SALES" === N && -1 < D.indexOf("_current") && -2 !== g.value && g.data.stats.min.map(function(O) {
                return null !== O
            })[CsvType.SALES.index] && (D = "1 month Sales Rank history. Current Rank: " + g.valueFormatted,
            q = GraphService.getWebGraphTypeAllOff(),
            q[CsvType[N].index] = 1,
            g = GraphService.getUrl(g.data.asin, g.data.domainId, 78, 28, q, 31, 1),
            A += '<br><span name="minigraphSales" title="' + D + '" style="height:28px;width:78px;margin-top:2px;margin-right:-9px;display:inline-block;background:url(' + (g + ') no-repeat right;"></span>'));
            return A
        },
        cellRendererDateAgo: t,
        cellRendererDateAgoArray: function(g) {
            if ("undefined" === typeof g.data || g.data.isDeleted || 0 === g.value.length)
                return "";
            var D = "";
            g = $jscomp.makeIterator(g.value);
            for (var N = g.next(); !N.done; N = g.next())
                D += '<span style="' + (D.length ? "color:#999999;" : "") + '">' + t({
                    value: N.value
                }) + "</span><br>";
            return D
        },
        cellRendererDateKeepaTime: f,
        cellRendererDateSpan: function(g) {
            if ("undefined" === typeof g.value)
                return "";
            if (null == g.value || -2 == g.value)
                return "-";
            var D = g.value - keepaTime.now();
            g = Math.floor(D / 525600);
            var N = Math.floor(D % 525600 / 1440)
              , ba = Math.floor(D % 525600 % 1440 / 60);
            D = Math.floor(D % 525600 % 1440 % 60);
            return (0 < g ? g + " " + (1 < g ? la._880 : la._879) : "") + "\n\t\t\t" + (0 < N ? N + " " + (1 < N ? la._143 : la._887) : "") + "\n\t\t\t" + (0 < ba ? ba + " " + (1 < ba ? la._884 : la._883) : "") + "\n\t\t\t" + (0 < D ? D + " " + (1 < D ? la._886 : la._885) : "")
        },
        cellRendererDateTimeKeepaTime: n,
        cellRendererDateYMD: r,
        cellRendererDimension: function(g) {
            if ("-" === g.valueFormatted)
                return g.valueFormatted;
            if ("packageDimension" === ("undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field)) {
                var D = g.data.packageLength / 10;
                var N = g.data.packageWidth / 10;
                var ba = g.data.packageHeight / 10
            } else
                D = g.data.itemLength / 10,
                N = g.data.itemWidth / 10,
                ba = g.data.itemHeight / 10;
            var q = V().measure;
            q && "in" === q && (D = parseFloat((.3937 * D).toFixed(1)),
            N = parseFloat((.3937 * N).toFixed(1)),
            ba = parseFloat((.3937 * ba).toFixed(1)));
            var L = {
                minimumFractionDigits: 1
            };
            D = aa(D, L);
            N = aa(N, L);
            ba = aa(ba, L);
            return D + " x " + N + " x " + ba + " " + q + "\n\t\t<br>(= " + g.valueFormatted + " " + q + "\u00b3 )"
        },
        cellRendererDomainId: function(g) {
            if ("undefined" === typeof g.value)
                return '<i class="fa fa-spinner fa-spin"></i>';
            if (null == g.value)
                return "";
            var D = g.value
              , N = '<div class="gridDomainCell"><img title=".' + getTldByDomain(D) + '" src="' + flags[D] + '">';
            if (!iframe.isIframe) {
                var ba = getAmazonRedirectByDomain(D, g.data.asin);
                N += ' <a class="gridExternalAmazon" href="' + ba + '" title="' + la._99 + ' Amazon" target="_blank"><i class="fa fa-amazon"></i></a>'
            }
            if (globalEbayArray[D]) {
                ba = "#aaaaaa";
                var q = "unverified if sold on ebay";
                g.data.ebayOutdated || (ba = "#666666",
                q = la._99 + " eBay");
                N += ' <a class="gridExternalEbay" href="' + getEbayRedirectByDomain(D, g.data.asin, !0) + '" rel="ebay" title="' + q + '" target="_blank" style="color:' + ba + ';">\n\t\t\t\t<span>e</span>\n\t\t\t\t</a>'
            }
            return N + "</div>"
        },
        cellRendererEmpty: function() {
            return ""
        },
        cellRendererFbaFees: function(g) {
            if ("undefined" === typeof g.data)
                return "";
            var D = g.data.domainId
              , N = g.valueFormatted;
            if (null == g.data.fbaFees)
                return N;
            var ba = Money.format(g.data.fbaFees.pickAndPackFee, {
                sourceDomainId: D,
                targetDomainId: D
            });
            D = Money.format(g.data.fbaFees.pickAndPackFeeTax, {
                sourceDomainId: D,
                targetDomainId: D
            });
            N = "" + N;
            0 < g.data.fbaFees.pickAndPackFeeTax && (N += '<br>\n\t\t\t\t\t\t<span style="font-size:10px;line-height:16px;color:#999;">\n\t\t\t\t\t\tPick and Pack Fees: ' + ba + " (+" + D + " tax)</span>");
            return N
        },
        cellRendererGraph: function(g, D, N, ba, q) {
            var L = D + "Cache";
            if (!g.data[L]) {
                N = "graph-" + D + "-" + N;
                var A = $("<div/>", {
                    id: N
                })
                  , O = $("<div/>", {
                    style: "visibility: hidden;"
                });
                O.append(A);
                $("body").append(O);
                ba(g.data, N, A, D, q);
                g.data[L] = A.get(0);
                O.detach()
            }
            return g.data[L]
        },
        cellRendererLinkedAsins: function(g) {
            var D = g.value;
            if (null == D || 0 == D.length)
                return "";
            "string" === typeof D && (D = D.split(","));
            var N = [];
            D.forEach(function(ba) {
                var q = "#!product/" + g.data.domainId + "-" + ba
                  , L = "";
                iframe.isIframe && (q = "http://www.amazon." + getTldByDomain(g.data.domainId) + "/dp/" + ba + "?psc=1",
                L = ' target="_parent"');
                N.push('<a href="' + q + '"' + L + ">" + ba + "</a>")
            });
            return N.join(", ")
        },
        cellRendererMetaData: function(g) {
            if (g.data.isDeleted)
                return '<div class="delete" style="cursor:default;"><span><i class="fa fa-trash fa-lg"></i><span>' + la._687 + "</span></span></div>";
            var D = "undefined" !== typeof g.data.deleteCounter && !1 !== g.data.deleteCounter
              , N = g.data.domainId
              , ba = g.data.detailDomainId
              , q = document.createElement("span");
            q.appendChild(H(g));
            q.appendChild(K(g));
            if (g.data.tracking.expiresSoon) {
                var L = GridHelper.cellRendererDateSpan({
                    value: g.data.tracking.expiresOn
                });
                L = L.replace(/\s\s+/g, " ");
                var A = document.createElement("div");
                A.className = "check";
                D && (A.style.opacity = "0.1");
                A.innerHTML = '<i class="fa fa-clock-o fa-lg"></i>';
                A.title = la._882 + ":" + L + "\n" + la._806;
                q.appendChild(A)
            }
            L = document.createElement("div");
            L.className = "flags";
            D && (L.style.opacity = "0.1");
            D = function(P) {
                var M = document.createElement("img");
                M.title = P === ba ? "amazon." + getTldByDomain(P) + " - " + la._673 : la._672 + "." + getTldByDomain(P);
                P === N && (M.title += " (" + la._674 + ")");
                P === ba && (M.className = "detail");
                M.src = flags[P];
                M.dataset.domain = P;
                M.addEventListener("click", function(u) {
                    var v = Number(this.dataset.domain);
                    if (v !== ba) {
                        var G = g.node;
                        G.data.detailDomainId = v;
                        G.setData(G.data);
                        var w = g.api.getDetailGridInfo(g.node.detailNode.id);
                        w.api.forEachNode(function(B) {
                            var Q = B.data;
                            if ("undefined" !== typeof Q.detailsPerDomain[v]) {
                                Q.detailDomainId = v;
                                B.setData(Q);
                                var fa = Q.detailsPerDomain[v].detailRowHeight;
                                B.setRowHeight(fa);
                                G.detailNode.setRowHeight(fa);
                                w.api.onRowHeightChanged();
                                g.api.onRowHeightChanged()
                            } else
                                network.request({
                                    path: "product",
                                    asin: g.data.asin,
                                    domainId: v,
                                    getTracking: !0,
                                    history: !0,
                                    maxAge: 15,
                                    offerPages: 0,
                                    refreshProduct: !1,
                                    type: "manage",
                                    version: 3
                                }).done(function(R) {
                                    null == R || null == R.products || 1 != R.products.length ? (Q.detailDomainId = v,
                                    B.setData(Q)) : (R = GridHelper.prepareProductTrackingDetail(R.products[0]),
                                    Q.detailDomainId = g.data.detailDomainId,
                                    Q.detailsPerDomain[R.domainId] = {
                                        asin: R.asin,
                                        domainId: R.domainId,
                                        imagesCSV: R.imagesCSV,
                                        title: R.title,
                                        lastUpdate: R.lastUpdate,
                                        lastEbayUpdate: R.lastEbayUpdate,
                                        lastPriceChange: R.lastPriceChange,
                                        graphData: {
                                            buyBoxSellerIdHistory: R.buyBoxSellerIdHistory,
                                            csv: R.csv,
                                            offers: R.offers,
                                            tracking: g.data.tracking
                                        },
                                        detailRowHeight: GridManage.calculateDetailRowHeight(R)
                                    },
                                    Q.wishLists = g.data.wishLists,
                                    Q.detailRowHeight = g.data.detailRowHeight,
                                    B.setData(Q),
                                    B.setRowHeight(Q.detailsPerDomain[v].detailRowHeight),
                                    G.detailNode.setRowHeight(Q.detailsPerDomain[v].detailRowHeight),
                                    g.api.onRowHeightChanged(),
                                    w.api.onRowHeightChanged())
                                }).fail(showErrorPopup)
                        })
                    }
                });
                return M
            }
            ;
            L.appendChild(D(N)).insertAdjacentHTML("afterend", "<br>");
            if (g.data.multiLocaleProductsReduced.length) {
                A = $jscomp.makeIterator(g.data.multiLocaleProductsReduced);
                for (var O = A.next(); !O.done; O = A.next())
                    L.appendChild(D(O.value.domainId)).insertAdjacentHTML("afterend", "<br>")
            }
            q.appendChild(L);
            return q
        },
        cellRendererMetaDataCompact: function(g) {
            if (g.data.isDeleted)
                return '<div class="delete" style="cursor:default;"><i class="fa fa-trash fa-lg"></i></div>';
            var D = "undefined" !== typeof g.data.deleteCounter && !1 !== g.data.deleteCounter
              , N = g.data.domainId
              , ba = g.data.detailDomainId
              , q = document.createElement("span");
            q.appendChild(H(g));
            q.appendChild(K(g));
            var L = function(M) {
                var u = document.createElement("a");
                u.href = getAmazonRedirectByDomain(M, g.data.asin);
                u.innerHTML = '<i class="fa fa-amazon"></i>';
                u.className = "gridExternalAmazon";
                u.target = "_blank";
                u.title = la._99 + " Amazon." + getTldByDomain(M);
                return u
            }
              , A = document.createElement("div");
            A.className = "links";
            A.appendChild(L(N)).insertAdjacentHTML("afterend", "<br>");
            if (g.data.multiLocaleProductsReduced.length)
                for (var O = $jscomp.makeIterator(g.data.multiLocaleProductsReduced), P = O.next(); !P.done; P = O.next())
                    A.appendChild(L(P.value.domainId)).insertAdjacentHTML("afterend", "<br>");
            q.appendChild(A);
            L = function(M, u) {
                if (!globalEbayArray[M])
                    return M = document.createElement("span"),
                    M.innerHTML = "<span>&nbsp;</span>",
                    M.className = "gridExternalEbay",
                    M;
                var v = document.createElement("a");
                v.href = getEbayRedirectByDomain(M, g.data.asin, !0);
                v.innerHTML = "<span>e</span>";
                v.className = "gridExternalEbay";
                v.style.color = u ? "#aaaaaa" : "#666666";
                v.target = "_blank";
                v.title = u ? "unverified if sold on ebay" : la._99 + " eBay." + getTldByDomain(M);
                return v
            }
            ;
            A = document.createElement("div");
            A.className = "links";
            A.style.marginTop = "-6px";
            A.appendChild(L(N, g.data.product.ebayOutdated)).insertAdjacentHTML("afterend", "<br>");
            if (g.data.multiLocaleProductsReduced.length)
                for (O = $jscomp.makeIterator(g.data.multiLocaleProductsReduced),
                P = O.next(); !P.done; P = O.next())
                    P = P.value,
                    A.appendChild(L(P.domainId, P.ebayOutdated)).insertAdjacentHTML("afterend", "<br>");
            q.appendChild(A);
            L = document.createElement("div");
            L.className = "flags";
            D && (L.style.opacity = "0.1");
            D = function(M) {
                var u = document.createElement("img");
                M === ba && (u.className = "detail");
                u.src = flags[M];
                var v = document.createElement("a");
                v.href = "#!product/" + M + "-" + g.data.asin;
                v.title = la._699 + "." + getTldByDomain(M);
                M === N && (v.title += " (" + la._674 + ")");
                v.appendChild(u);
                return v
            }
            ;
            L.appendChild(D(N)).insertAdjacentHTML("afterend", "<br>");
            if (g.data.multiLocaleProductsReduced.length)
                for (A = $jscomp.makeIterator(g.data.multiLocaleProductsReduced),
                P = A.next(); !P.done; P = A.next())
                    L.appendChild(D(P.value.domainId)).insertAdjacentHTML("afterend", "<br>");
            q.appendChild(L);
            return q
        },
        cellRendererMoney: function(g) {
            if ("undefined" === typeof g.data)
                return "";
            var D = "undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field
              , N = "";
            g.data.offersOutworn && !g.data.offersOutdated && D.includes("coupon") && (N = "font-style:italic;");
            var ba = '<span style="' + N + '">' + g.valueFormatted + "</span>";
            showReferencePrice(g.data.domainId) && (D = g.data[D],
            D = null == g.value || 0 > D ? "-" : Money.format(D, {
                sourceDomainId: g.data.domainId,
                targetDomainId: g.data.domainId
            }),
            N = '<span style="color:#ccc;' + N + '">' + D + "</span>",
            ba = "undefined" !== typeof g.data.realField ? N + "&ensp;" + ba : ba + "<br>" + N);
            return ba
        },
        cellRendererImage: function(g) {
            if ("undefined" === typeof g.value)
                return "";
            var D = "undefined" === typeof g.colDef.cellRendererParams ? 51 : g.colDef.cellRendererParams.imageSize;
            if ("undefined" !== typeof g.context.pageId && "variation" !== g.context.pageId) {
                var N = imageToUrl(g.value, D);
                g = g.value ? g.value.split(",")[0] : "";
                var ba = document.createElement("img");
                ba.width = D;
                ba.height = D;
                ba.src = N ? N : imgCDNUrl + "no-photo-available.png";
                ba.style.height = D + "px";
                ba.style.width = D + "px";
                N || (ba.alt = "No image available");
                N && ProductImageHover.preview.add_events(ba, g);
                return ba
            }
            return imageToHtml(g.value, D, "", D)
        },
        cellRendererLanguage: function(g) {
            return GridHelper.defaultTextClamp(g.value, 3)
        },
        cellRendererOfferCSV: function(g) {
            g = g.data;
            var D = g.offerCSV[g.offerCSV.length - 2]
              , N = g.offerCSV[g.offerCSV.length - 1]
              , ba = D + N
              , q = 1;
            1 < g.condition && 6 > g.condition && (q = 2);
            6 == g.condition && (q = 6);
            6 < g.condition && (q = 5);
            11 == g.condition && (q = 31);
            g.isAmazon && (q = 0);
            q = CsvType.getObjectName(q);
            var L = Money.format(ba, {
                sourceDomainId: g.domainId
            });
            if (0 < N) {
                var A = Money.format(D, {
                    sourceDomainId: g.domainId
                });
                var O = Money.format(N, {
                    sourceDomainId: g.domainId
                });
                A = '<span style="color:#999">(' + A + " + " + O + ")</span>&ensp;"
            } else
                A = g.isPrime ? '<span style="color:#2692c2;font-style: italic;">&ensp;Prime</span>&emsp;' : "";
            q = '<span style="color:' + CsvType[q].color + ';">' + A + L + "</span>";
            L = "";
            showReferencePrice(g.domainId) && (ba = Money.format(ba, {
                sourceDomainId: g.domainId,
                targetDomainId: g.domainId
            }),
            0 < N ? (D = Money.format(D, {
                sourceDomainId: g.domainId,
                targetDomainId: g.domainId
            }),
            g = Money.format(N, {
                sourceDomainId: g.domainId,
                targetDomainId: g.domainId
            }),
            g = "<span>(" + D + " + " + g + ")</span>&ensp;") : g = g.isPrime ? '<span style="font-style: italic;">&ensp;Prime</span>&emsp;' : "",
            L = '<span style="color:#ccc;">' + g + ba + "</span>");
            return q + "<br>" + L
        },
        cellRendererProductCodes: p,
        cellRendererProductCodeSingle: function(g) {
            if (null == g.value || 0 == g.value.length)
                return "";
            g.value instanceof Array && (g.value = g.value[0]);
            return p(g)
        },
        cellRendererProductGroup: function(g) {
            if ("undefined" === typeof g.value)
                return "";
            if ("finder" === g.context.pageId)
                return z(g);
            var D = I(g)
              , N = iframe.isIframe ? ' target="_blank"' : "";
            return '<a class="href" href="' + getBaseUrl() + "#!bestseller/" + g.data.domainId + "-" + encodeURIComponent(g.value) + '"' + N + ">" + GridHelper.defaultTextClamp(g.value, D) + "</a>"
        },
        cellRendererRating: function(g) {
            return '<span style="color:' + CsvType.RATING.color + '">' + g.valueFormatted + "</span>"
        },
        cellRendererRatingStar: function(g) {
            if ("undefined" === typeof g.data)
                return "";
            var D = "undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field
              , N = "";
            (g.data.offersOutdated || g.data.offersNeverUpdated) && 0 < D.indexOf("_current") && "?" === g.valueFormatted && (N = "Only outdated data available.\nYou can force an update via the Product Viewer.");
            return null == g.value ? '<span style="color:' + CsvType.RATING.color + '"' + (N ? ' title="' + N + '"' : "") + ">" + g.valueFormatted + "</span>" : getStarsFromRating(10 * g.value) + '<br><span style="color:' + CsvType.RATING.color + '">' + g.valueFormatted + "</span>"
        },
        cellRendererSellerIdsLowest: function(g) {
            if (null == g.value)
                return "-";
            var D = "undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field
              , N = "undefined" !== typeof g.data.realField;
            if ("undefined" != typeof g.data[D]) {
                var ba = g.data[D], q = g.data.offersOutworn ? '<div style="font-style:italic;">' : "<div>", L = 0, A;
                for (A in ba) {
                    L++;
                    var O = ba[A]
                      , P = getBaseUrl() + "#!seller/" + g.data.domainId + "-" + A
                      , M = "https://www.amazon." + getTldByDomain(g.data.domainId) + "/gp/aag/details/?seller=" + A;
                    q += (!N && 3 < L ? ", " : 1 < L ? "<br>" : "") + '<a href="' + P + '" title="' + la._181 + '" target="_blank">' + O.sellerName + '</a> \n\t\t\t\t\t\t\t\t\t<span style="color:#999">(' + O.currentRating + '%)</span>&ensp;\n\t\t\t\t\t\t\t\t\t<a href="' + M + '" title="' + la._646 + ' Amazon" target="_blank"><i class="fa fa-external-link"></i></a>'
                }
                return q + "</div>"
            }
            N = g.data.stats[D];
            var u = N.join(",");
            g.context.sellerHashMap && g.context.sellerHashMap[u] ? setTimeout(function() {
                g.node.setDataValue(D, g.context.sellerHashMap[u])
            }, 0) : networkHelper.loadSellers({
                path: "pro/seller",
                history: !1,
                version: 3
            }, g.data.domainId, [u]).done(function(G) {
                var w = {}, B;
                for (B in G) {
                    var Q = G[B];
                    w[B] = {
                        sellerName: Q.sellerName,
                        currentRating: Q.currentRating
                    }
                }
                g.context.sellerHashMap || (g.context.sellerHashMap = {});
                g.context.sellerHashMap[u] = w;
                g.node.setDataValue("undefined" !== typeof g.data.realField ? "productValue" : D, w)
            });
            var v = g.data.offersOutworn ? '<div style="font-style:italic;">' : "<div>";
            N.forEach(function(G, w) {
                v += '<span style="color:#ccc">' + G + '&ensp;<i class="fa fa-spinner fa-spin"></i></span><br>'
            });
            return v += "</div>"
        },
        cellRendererStockSingle: function(g) {
            if ("undefined" === typeof g.data)
                return "";
            var D = "undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field;
            if ("stock" === D)
                return g.valueFormatted;
            D = D.replace("stock", "").toUpperCase();
            return '<span style="color:' + CsvType["BUYBOX" === D ? "BUY_BOX_SHIPPING" : D].color + '">' + g.valueFormatted + "</span>"
        },
        cellRendererTitle: function(g) {
            if ("undefined" === typeof g.value)
                return "";
            var D = I(g)
              , N = "";
            3 === g.data.productType && (--D,
            N = '<i class="fa fa-exclamation-triangle" title="\u271c Keepa: Amazon does not provide any data for this product. This might be temporary and change in a few hours. As for now, Keepa is unable to track it."></i>');
            var ba = document.createElement("a");
            ba.className = "href href--title";
            ba.href = "#!product/" + g.data.domainId + "-" + g.data.asin;
            ba.innerHTML = N + GridHelper.defaultTextClamp(g.data.title ? g.data.title : g.value, D);
            "deals" === g.context.pageId && (ba.className = "href",
            ba.addEventListener("click", function() {
                if (!g.data.isVisited) {
                    var q = g.node;
                    q.data.isVisited = !0;
                    q.setData(q.data);
                    q = g.data.domainId + "-" + g.data.asin;
                    sessionStorage[q] = 1;
                    databaseDeals && databaseDeals.setItem(q, keepaTime.now())
                }
            }));
            "undefined" !== get("overlayPriceGraph") && 1 == get("overlayPriceGraph") && (D = GraphService.getUrl(g.data.asin, g.data.domainId),
            ProductImageHover.preview.add_events(ba, D));
            return ba
        },
        cellRendererTextFinder: function(g) {
            if (!g.value)
                return "";
            if ("finder" === g.context.pageId)
                return z(g);
            var D = {};
            D = {
                f: (D["undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field] = {
                    filter: g.value.toLowerCase()
                },
                D),
                s: null,
                t: "g"
            };
            D = encodeURIComponent(JSON.stringify(D));
            D = getBaseUrl() + "#!finder/" + D;
            var N = "Search for &quot;" + g.value.replace(/"/g, "&quot;") + "&quot; in our Product Finder";
            return '<a href="' + D + '" target="_blank" title="' + N + '">' + g.value + "</a>"
        },
        cellRendererTracking: function(g) {
            if ("undefined" === typeof g.data || g.data.isDeleted)
                return "";
            var D = g.colDef.field;
            if ("undefined" !== typeof g.data.isUpdating && !0 === g.data.isUpdating[D])
                return '<div style="text-align:right;padding-top:5px;"><i class="fa fa-spinner fa-spin"></i></div>';
            var N = GridHelper.getCsvObjectName(D)
              , ba = CsvType[N].index
              , q = CsvType[N].currency
              , L = "color:" + CsvType[N].color + ";"
              , A = g.data.multiLocaleProductsReduced.length ? '<i class="fa fa-circle" style="font-size:5px;transform:translateY(-2px);color:#444;"></i>&ensp;' : "";
            ba = D.includes("current") ? g.data.lowestDomainIdsPerCsv[ba] ? g.data.lowestDomainIdsPerCsv[ba] : [] : [];
            var O = (ba.includes(g.data.domainId) ? A : "") + '<span style="' + L + '">' + g.valueFormatted + "</span>";
            if (g.data.multiLocaleProductsReduced.length)
                for (var P = $jscomp.makeIterator(g.data.multiLocaleProductsReduced), M = P.next(); !M.done; M = P.next()) {
                    M = M.value;
                    var u = M[D]
                      , v = "-"
                      , G = "";
                    -1 != u && -2 != u ? q ? (v = D.includes("desired") ? g.data.domainId : M.domainId,
                    v = Money.format(u, {
                        sourceDomainId: v,
                        targetDomainId: g.data.domainId,
                        acceptMinusOne: D.includes("delta")
                    }),
                    M.domainId !== g.data.domainId && currencies[M.domainId] !== currencies[g.data.domainId] && (G = D.includes("desired") ? g.data.domainId : M.domainId,
                    G = Money.format(u, {
                        sourceDomainId: G,
                        targetDomainId: M.domainId,
                        acceptMinusOne: D.includes("delta")
                    }))) : v = CsvType.format(N, u) : -2 === u && (v = '<i class="fa fa-lock"></i>');
                    O += "<br>" + (ba.includes(M.domainId) ? A : "") + '<span style="' + L + ';font-style:italic;opacity:0.8;"' + (G ? ' title="' + G + '"' : "") + ">" + v + "</span>"
                }
            return O
        },
        cellRendererTrackingDelta: function(g) {
            if ("undefined" === typeof g.data || g.data.isDeleted)
                return "";
            var D = g.colDef.field
              , N = GridHelper.getCsvObjectName(D)
              , ba = CsvType[N].currency
              , q = g.data.product[N + "_isDrop"]
              , L = g.value[0]
              , A = null != L && (q && 0 >= L || !q && 0 <= L)
              , O = A ? "fa-arrow-circle-down" : "fa-arrow-circle-up";
            q || (O = A ? "fa-arrow-circle-up" : "fa-arrow-circle-down");
            L = "";
            "-" != g.valueFormatted && (L = ' <i class="fa ' + O + '" style="color:' + (A ? "green" : "red") + ';"></i>');
            A = "";
            "-" != g.valueFormatted && (A = NumberUtil.format(g.data.product[D + "Percent"], 0) + "%&ensp;&hybull;&ensp;");
            L = '<span style="color:' + CsvType[N].color + ';">' + A + g.valueFormatted + "</span>" + L;
            if (g.data.multiLocaleProductsReduced.length)
                for (A = $jscomp.makeIterator(g.data.multiLocaleProductsReduced),
                O = A.next(); !O.done; O = A.next()) {
                    O = O.value;
                    var P = O[D]
                      , M = "-"
                      , u = ""
                      , v = ""
                      , G = "";
                    null != P && 0 != P && (ba ? (M = Money.format(P, {
                        sourceDomainId: O.domainId,
                        targetDomainId: g.data.domainId,
                        acceptMinusOne: D.includes("delta")
                    }),
                    O.domainId !== g.data.domainId && currencies[O.domainId] !== currencies[g.data.domainId] && (u = D.includes("desired") ? g.data.domainId : O.domainId,
                    u = Money.format(P, {
                        sourceDomainId: u,
                        targetDomainId: O.domainId,
                        acceptMinusOne: D.includes("delta")
                    }))) : M = CsvType.format(N, P),
                    v = (P = null != P && (q && 0 >= P || !q && 0 <= P)) ? "fa-arrow-circle-down" : "fa-arrow-circle-up",
                    q || (v = P ? "fa-arrow-circle-up" : "fa-arrow-circle-down"),
                    v = ' <i class="fa ' + v + '" style="color:' + (P ? "green" : "red") + ';"></i>',
                    G = NumberUtil.format(O[D + "Percent"], 0) + "%&ensp;&hybull;&ensp;");
                    L += '<br><span style="color:' + CsvType[N].color + ';font-style:italic;opacity:0.8;"' + (u ? ' title="' + u + '"' : "") + ">" + G + M + "</span>" + v
                }
            return L
        },
        cellSuppressKeyboardEvent: function(g) {
            return g.editing && ![13, 27].includes(g.event.keyCode)
        },
        comparatorDateAgo: function(g, D) {
            return D - g
        },
        comparatorNumberNullLast: function(g, D, N, ba, q) {
            return null === D ? q ? 1 : -1 : null === g ? q ? -1 : 1 : g - D
        },
        comparatorNumberArrayNullLast: function(g, D, N, ba, q) {
            g = null == g ? [null] : Object.values(g);
            D = null == D ? [null] : Object.values(D);
            var L, A;
            1 == g.length && null == g[0] && (L = null);
            1 == D.length && null == D[0] && (A = null);
            q ? ("undefined" == typeof L && (L = Math.max.apply(Math, $jscomp.arrayFromIterable(g.filter(function(O) {
                return null != O
            })))),
            "undefined" == typeof A && (A = Math.max.apply(Math, $jscomp.arrayFromIterable(D.filter(function(O) {
                return null != O
            }))))) : ("undefined" == typeof L && (L = Math.min.apply(Math, $jscomp.arrayFromIterable(g.filter(function(O) {
                return null != O
            })))),
            "undefined" == typeof A && (A = Math.min.apply(Math, $jscomp.arrayFromIterable(D.filter(function(O) {
                return null != O
            })))));
            return null === A ? q ? 1 : -1 : null === L ? q ? -1 : 1 : L - A
        },
        csvTypeIsTrackable: function(g) {
            return "object" !== typeof CsvType[g] ? !1 : CsvType[g].isTrackable || ["EBAY_NEW_SHIPPING", "EBAY_USED_SHIPPING"].includes(g)
        },
        defaultTextClamp: function(g, D, N) {
            if (null == g)
                return "";
            D = D ? D : 1;
            return (g = N ? g : escapeHTML(g)) ? '<span title="' + g + '" class="text-clamp clamp-lines-' + D + '">' + g + "</span>" : ""
        },
        getCurrentUnits: V,
        getCurrentUnitSystem: S,
        getHeaderComponentTemplate: function(g, D) {
            return '<div class="ag-cell-label-container" role="presentation">\n\t\t\t\t<span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n\t\t\t\t<div ref="eLabel" class="ag-header-cell-label" role="presentation" unselectable="on">\n\t\t\t\t\t' + (g ? "<span>" + g + "&thinsp;</span>" : "") + '\n\t\t\t\t\t<span ref="eText" class="ag-header-cell-text" role="columnheader" unselectable="on"></span>\n\t\t\t\t\t' + (D ? '<span class="ag-header-cell-text">&thinsp;' + D + "</span>" : "") + '\n\t\t\t\t\t<span ref="eFilter" class="ag-header-icon ag-filter-icon" aria-hidden="true"></span>\n\t\t\t\t\t<span ref="eSortOrder" class="ag-header-icon ag-sort-order" aria-hidden="true"></span>\n\t\t\t\t\t<span ref="eSortAsc" class="ag-header-icon ag-sort-ascending-icon" aria-hidden="true"></span>\n\t\t\t\t\t<span ref="eSortDesc" class="ag-header-icon ag-sort-descending-icon" aria-hidden="true"></span>\n\t\t\t\t\t<span ref="eSortNone" class="ag-header-icon ag-sort-none-icon" aria-hidden="true"></span>\n\t\t\t\t</div>\n\t\t\t</div>'
        },
        getIconsDefault: function() {
            return {
                sortAscending: '<i class="fa fa-sort-alpha-asc"></i>',
                sortDescending: '<i class="fa fa-sort-alpha-desc"></i>'
            }
        },
        getIconsSortNumeric: function() {
            return {
                sortAscending: '<i class="fa fa-sort-numeric-asc"></i>',
                sortDescending: '<i class="fa fa-sort-numeric-desc"></i>'
            }
        },
        isOfferData: function(g) {
            return CsvType[g].isOfferData && "BUY_BOX_SHIPPING" !== g
        },
        isValidRowsPerPage: function(g, D) {
            g = GridConfig.getRowCountOptions(g);
            if ("undefined" === typeof g)
                return !1;
            D = g.values.indexOf(D);
            return -1 < D && !g.disabled[D]
        },
        prepareProduct: function(g, D) {
            D = void 0 === D ? null : D;
            var N = []
              , ba = keepaTime.now();
            for (L in CsvType)
                if ("object" === typeof CsvType[L] && !(-1 < N.indexOf(CsvType[L].index))) {
                    var q = CsvType[L].index;
                    if (CsvType[L].index == CsvType.EXTRA_INFO_UPDATES.index) {
                        g.offersNeverUpdated = !1;
                        g.offersOutdated = !1;
                        g.offersOutworn = !1;
                        g.ratingOutdated = !1;
                        g.ebayOutdated = !1;
                        0 > g.stats.lastOffersUpdate ? g.offersNeverUpdated = !0 : 4320 < ba - g.stats.lastOffersUpdate ? g.offersOutdated = !0 : 1440 < ba - g.stats.lastOffersUpdate && (g.offersOutworn = !0);
                        if (0 >= g.lastRatingUpdate || 0 < g.lastRatingUpdate && 20160 < ba - g.lastRatingUpdate)
                            g.ratingOutdated = !0;
                        if (0 >= g.lastEbayUpdate || 0 < g.lastEbayUpdate && 20160 < ba - g.lastEbayUpdate)
                            g.ebayOutdated = !0
                    } else
                        g[L + "_avg30"] = g.stats.avg30 ? g.stats.avg30[q] : -1,
                        g[L + "_avg90"] = g.stats.avg90 ? g.stats.avg90[q] : -1,
                        g[L + "_avg180"] = g.stats.avg180 ? g.stats.avg180[q] : -1,
                        g[L + "_current"] = g.stats.current ? g.stats.current[q] : -1,
                        g[L + "_lowest"] = g.stats.min && null != g.stats.min[q] ? g.stats.min[q][1] : -1,
                        g[L + "_highest"] = g.stats.max && null != g.stats.max[q] ? g.stats.max[q][1] : -1,
                        g[L + "_atIntervalStart"] = -1,
                        g[L + "_deltaCustom"] = null,
                        "undefined" !== typeof g.stats.atIntervalStart && (g[L + "_atIntervalStart"] = g.stats.atIntervalStart[q],
                        g[L + "_deltaCustom"] = 0 < g.stats.current[q] && 0 < g.stats.atIntervalStart[q] ? g.stats.atIntervalStart[q] - g.stats.current[q] : null),
                        "undefined" !== typeof g.deal && (g[L + "_avg1"] = g.deal.avg[0][q],
                        g[L + "_avg7"] = g.deal.avg[1][q],
                        g[L + "_delta1"] = g.deal.delta[0][q],
                        g[L + "_delta7"] = g.deal.delta[1][q],
                        g[L + "_delta30"] = g.deal.delta[2][q],
                        g[L + "_delta90"] = g.deal.delta[3][q],
                        g[L + "_deltaPercent1"] = g.deal.deltaPercent[0][q],
                        g[L + "_deltaPercent7"] = g.deal.deltaPercent[1][q],
                        g[L + "_deltaPercent30"] = g.deal.deltaPercent[2][q],
                        g[L + "_deltaPercent90"] = g.deal.deltaPercent[3][q],
                        g.dealFound = g.deal.creationDate),
                        [CsvType.AMAZON.index, CsvType.NEW.index, CsvType.USED.index, CsvType.BUY_BOX_SHIPPING.index].includes(q) && (g[L + "_outOfStockPercentage90"] = g.stats.outOfStockPercentage90[q])
                }
            g.couponOneTimeAbsolute = g.coupon && 0 < g.coupon[0] ? g.coupon[0] : null;
            g.couponOneTimePercent = g.coupon && 0 > g.coupon[0] ? -1 * g.coupon[0] : null;
            g.couponSNSPercent = g.coupon && 0 > g.coupon[1] ? -1 * g.coupon[1] : null;
            g.fbaFeesTotal = null;
            null != g.fbaFees && (N = g.fbaFees.pickAndPackFee + g.fbaFees.pickAndPackFeeTax,
            0 <= N ? g.fbaFeesTotal = N : g.fbaFees = null);
            g.subcategorySalesRanks = [];
            if (null !== g.salesRanks) {
                N = GridHelperCategory.getHashMap(g.domainId);
                ba = GridHelperCategory.getTreeHashMap(g.domainId);
                var L = {};
                for (var A in g.salesRanks)
                    ba && ba[A] && (L[A] = ba[A]);
                A = getCategorySalesRanks(L, N, g.salesRanks);
                A = $jscomp.makeIterator(A);
                for (N = A.next(); !N.done; N = A.next())
                    categorySalesRank = N.value,
                    -1 !== categorySalesRank.rank && categorySalesRank.cr.catId !== g.rootCategory && g.subcategorySalesRanks.push(categorySalesRank)
            }
            g.salesRankDrops30 = g.stats && 0 < g.stats.salesRankDrops30 ? g.stats.salesRankDrops30 : null;
            g.salesRankDrops90 = g.stats && 0 < g.stats.salesRankDrops90 ? g.stats.salesRankDrops90 : null;
            g.salesRankDrops180 = g.stats && 0 < g.stats.salesRankDrops180 ? g.stats.salesRankDrops180 : null;
            g.variationAttributes = [];
            g.variations && (A = g.variations.find(function(O) {
                return O.asin === g.asin
            })) && (g.variationAttributes = A.attributes);
            if (D) {
                g.sellerIdsLowestFBA = {};
                g.sellerIdsLowestFBM = {};
                g.buyBoxSellerId = null;
                g.buyBoxSeller = {};
                N = g.stats.sellerIdsLowestFBA;
                A = g.stats.sellerIdsLowestFBM;
                if (g.offersOutdated || g.offersNeverUpdated)
                    A = N = null;
                0 > g.NEW_FBA_current && (N = null);
                0 > g.NEW_FBM_SHIPPING_current && (A = null);
                if (N)
                    for (N = [].concat($jscomp.arrayFromIterable(new Set(N))),
                    N = $jscomp.makeIterator(N),
                    ba = N.next(); !ba.done; ba = N.next())
                        ba = ba.value,
                        (L = D[ba]) && (g.sellerIdsLowestFBA[ba] = L);
                if (A)
                    for (A = [].concat($jscomp.arrayFromIterable(new Set(A))),
                    A = $jscomp.makeIterator(A),
                    ba = A.next(); !ba.done; ba = A.next())
                        N = ba.value,
                        (ba = D[N]) && (g.sellerIdsLowestFBM[N] = ba);
                g.buyBoxSellerIdHistory && (g.buyBoxSellerId = getLast(g.buyBoxSellerIdHistory, CsvType.AMAZON),
                (D = D[g.buyBoxSellerId]) && (g.buyBoxSeller[g.buyBoxSellerId] = D))
            }
            return g
        },
        prepareProductCasin: function(g, D) {
            if (!g)
                return null;
            var N = {};
            N.asin = g.asin;
            N.domainId = g.domainId;
            N.continentId = LocaleType.getContinentId(g.domainId);
            for (var ba = $jscomp.makeIterator(["AMAZON", "NEW", "USED", "BUY_BOX_SHIPPING", "COUNT_REVIEWS"]), q = ba.next(); !q.done; q = ba.next())
                if (q = q.value,
                "object" === typeof CsvType[q]) {
                    var L = CsvType[q].index;
                    N[q + "_current"] = g.stats[L] && "undefined" !== typeof g.stats[L].current.val ? g.stats[L].current.val : -1;
                    N[q + "_isLowest"] = -1 < N[q + "_current"] && D[L] === g.domainId
                }
            return N
        },
        prepareProductLightningDeal: function(g) {
            var D = keepaTime.now()
              , N = g.csv[CsvType.LIGHTNING_DEAL.index]
              , ba = getValueAtTimeWithExactTime(N, D, CsvType.LIGHTNING_DEAL)
              , q = 0
              , L = 0
              , A = -1
              , O = N.length;
            if (3 < O && -1 === N[O - 1]) {
                try {
                    for (; -1 === N[O - 5]; )
                        O -= 2;
                    q = N[O - 2];
                    for (var P = O; q < keepaTime.now() && P + 2 <= N.length; )
                        P += 2,
                        q = N[P - 2]
                } catch (M) {
                    console.error(M, N, O)
                }
                D > q && (q = 0);
                5 < O && 0 < N[O - 5] && (L = N[O - 6],
                A = N[O - 5])
            }
            return {
                asin: g.asin,
                domainId: g.domainId,
                title: g.title,
                imagesCSV: g.imagesCSV,
                LIGHTNING_DEAL_current: ba[1],
                LIGHTNING_DEAL_start: ba && -1 < ba[1] ? ba[0] : q ? q : -2,
                LIGHTNING_DEAL_last: A,
                LIGHTNING_DEAL_lastStart: L ? L : -2
            }
        },
        prepareProductSearch: function(g) {
            var D = {};
            D.asin = g.asin;
            D.domainId = g.domainId;
            D.title = g.title;
            D.imagesCSV = g.imagesCSV;
            D.color = g.color;
            D.size = g.size;
            D.edition = g.edition;
            D.format = g.format;
            for (var N = $jscomp.makeIterator(["AMAZON", "NEW", "USED", "SALES"]), ba = N.next(); !ba.done; ba = N.next())
                ba = ba.value,
                "object" === typeof CsvType[ba] && (D[ba + "_current"] = g.stats.current[CsvType[ba].index]);
            return D
        },
        prepareProductTracking: function(g, D, N, ba) {
            var q = keepaTime.now();
            null == g.title && (g.title = "Delete me");
            var L = 0
              , A = []
              , O = []
              , P = [];
            g.MAX_delta = null;
            g.MAX_deltaCustom = null;
            g.MAX_deltaTrackingCreated = null;
            g.MAX_lastPriceChange = null;
            g.hasPriceIncreaseTracking = !1;
            g.hasPriceDropTracking = !1;
            var M = {}, u;
            for (u in CsvType) {
                if ("object" === typeof CsvType[u])
                    if (M.$jscomp$loop$prop$index$708 = CsvType[u].index,
                    CsvType[u].index == CsvType.EXTRA_INFO_UPDATES.index)
                        if (g.ebayOutdated = !1,
                        "undefined" === typeof g.lastEbayUpdate)
                            g.ebayOutdated = -1 === g.stats.current[CsvType.EBAY_NEW_SHIPPING.index] && -1 === g.stats.current[CsvType.EBAY_USED_SHIPPING.index];
                        else {
                            if (0 >= g.lastEbayUpdate || 0 < g.lastEbayUpdate && 20160 < q - g.lastEbayUpdate)
                                g.ebayOutdated = !0
                        }
                    else {
                        g[u + "_current"] = g.stats.current[M.$jscomp$loop$prop$index$708];
                        g[u + "_desired"] = -1;
                        g[u + "_delta"] = null;
                        g[u + "_isDrop"] = !0;
                        if ("undefined" !== typeof D.thresholdValues && null != D.thresholdValues) {
                            var v = D.thresholdValues.find(function(B) {
                                return function(Q) {
                                    return Q.csvType == B.$jscomp$loop$prop$index$708 && Q.domain == g.domainId && 0 <= Q.thresholdValueCSV[Q.thresholdValueCSV.length - 1]
                                }
                            }(M));
                            "undefined" !== typeof v && (g[u + "_desired"] = v.thresholdValueCSV[v.thresholdValueCSV.length - 1],
                            g[u + "_isDrop"] = v.isDrop,
                            g.hasPriceIncreaseTracking = g.hasPriceIncreaseTracking || !v.isDrop,
                            g.hasPriceDropTracking = g.hasPriceDropTracking || v.isDrop);
                            v = g[u + "_desired"];
                            CsvType[u].currency && g.domainId !== N && currencies[N] !== currencies[g.domainId] && (v = Money.raw(v, {
                                sourceDomainId: N,
                                targetDomainId: g.domainId,
                                keepUnit: !0,
                                noDigits: !0
                            }));
                            0 < g[u + "_current"] && 0 < v && (g[u + "_delta"] = g[u + "_current"] - v,
                            g[u + "_deltaPercent"] = Math.round(100 * g[u + "_delta"] / g[u + "_current"]),
                            (g[u + "_isDrop"] && 0 >= g[u + "_delta"] || !g[u + "_isDrop"] && 0 <= g[u + "_delta"]) && P.push({
                                domainId: g.domainId,
                                csvTypeIndex: M.$jscomp$loop$prop$index$708
                            }))
                        }
                        g[u + "_atIntervalStart"] = -1;
                        g[u + "_deltaCustom"] = null;
                        "undefined" !== typeof g.stats.atIntervalStart && (g[u + "_atIntervalStart"] = g.stats.atIntervalStart[M.$jscomp$loop$prop$index$708],
                        g[u + "_deltaCustom"] = 0 < g.stats.current[M.$jscomp$loop$prop$index$708] && 0 < g.stats.atIntervalStart[M.$jscomp$loop$prop$index$708] ? g.stats.current[M.$jscomp$loop$prop$index$708] - g.stats.atIntervalStart[M.$jscomp$loop$prop$index$708] : null,
                        0 == g[u + "_deltaCustom"] && (g[u + "_deltaCustom"] = null),
                        g[u + "_deltaCustomPercent"] = g[u + "_deltaCustom"] ? Math.round(100 * g[u + "_deltaCustom"] / g.stats.current[M.$jscomp$loop$prop$index$708]) : null);
                        g[u + "_atTrackingCreated"] = -1;
                        g[u + "_deltaTrackingCreated"] = null;
                        "undefined" !== typeof g.stats.atTrackingCreated && (g[u + "_atTrackingCreated"] = g.stats.atTrackingCreated[M.$jscomp$loop$prop$index$708],
                        g[u + "_deltaTrackingCreated"] = 0 < g.stats.current[M.$jscomp$loop$prop$index$708] && 0 < g.stats.atTrackingCreated[M.$jscomp$loop$prop$index$708] ? g.stats.current[M.$jscomp$loop$prop$index$708] - g.stats.atTrackingCreated[M.$jscomp$loop$prop$index$708] : null,
                        0 == g[u + "_deltaTrackingCreated"] && (g[u + "_deltaTrackingCreated"] = null),
                        g[u + "_deltaTrackingCreatedPercent"] = g[u + "_deltaTrackingCreated"] ? Math.round(100 * g[u + "_deltaTrackingCreated"] / g.stats.current[M.$jscomp$loop$prop$index$708]) : null);
                        g[u + "_lastPriceChange"] = -1;
                        "undefined" !== typeof g.stats.lastPriceChange && (g[u + "_lastPriceChange"] = g.stats.lastPriceChange[M.$jscomp$loop$prop$index$708],
                        GridHelper.csvTypeIsTrackable(u) && (v = g[u + "_lastPriceChange"],
                        null !== v && (g.MAX_lastPriceChange = null === g.MAX_lastPriceChange ? v : Math.max(g.MAX_lastPriceChange, v))));
                        CsvType[u].isEnabled && CsvType[u].isTopGraph && (-1 != g.stats.current[M.$jscomp$loop$prop$index$708] || -1 != g.stats.avg30[M.$jscomp$loop$prop$index$708] || null != g.stats.min[M.$jscomp$loop$prop$index$708]) && (L++,
                        A.push(u));
                        0 <= g[u + "_desired"] && O.push(u);
                        if (CsvType[u].isTrackable && CsvType[u].currency) {
                            v = $jscomp.makeIterator(["delta", "deltaCustom", "deltaTrackingCreated"]);
                            for (var G = v.next(); !G.done; G = v.next()) {
                                G = G.value;
                                var w = g[u + "_" + G];
                                null != w && (g["MAX_" + G] = null == g["MAX_" + G] ? w : Math.max(g["MAX_" + G], w));
                                w = g[u + "_" + G + "Percent"];
                                null != w && (g["MAX_" + G + "Percent"] = null == g["MAX_" + G + "Percent"] ? w : Math.max(g["MAX_" + G + "Percent"], w))
                            }
                        }
                        CsvType[u].index === CsvType.LIGHTNING_DEAL.index && (g[u + "_upcoming"] = g.domainId === N && D.lightningDealsAlerts,
                        v = null !== D.notifyIf && D.notifyIf.find(function(B) {
                            return function(Q) {
                                return Q.csvType == B.$jscomp$loop$prop$index$708 && Q.domain == g.domainId && 1 === Q.notifyIfType
                            }
                        }(M)),
                        g[u + "_backInStock"] = v ? !0 : !1,
                        !0 !== g[u + "_upcoming"] && !0 !== g[u + "_backInStock"] || O.includes(u) || O.push(u))
                    }
                M = {
                    $jscomp$loop$prop$index$708: M.$jscomp$loop$prop$index$708
                }
            }
            g.countTypesTopGraph = L;
            g.csvTypesWithData = A;
            g.csvTypesWithTracking = O;
            g.conditionsMet = P;
            g.wishListName = "-";
            ba && Object.keys(ba).length && (g.wishListName = null == D.wishListId ? "-" : ba[D.wishListId].name);
            return g
        },
        prepareProductTrackingDetail: function(g) {
            null == g.title && (g.title = "Delete me");
            g.countTypesTopGraph = 0;
            for (var D in CsvType)
                if ("object" === typeof CsvType[D]) {
                    var N = CsvType[D].index;
                    CsvType[D].index != CsvType.EXTRA_INFO_UPDATES.index && CsvType[D].isEnabled && CsvType[D].isTopGraph && null != g.csv[N] && (2 < g.csv[N].length || 2 === g.csv[N].length && -1 !== g.csv[N][1]) && g.countTypesTopGraph++
                }
            return g
        },
        processCellCallback: function(g) {
            try {
                var D = g.column.colDef
                  , N = "undefined" !== typeof D.type ? D.type[0] : !1
                  , ba = g.column.colId;
                D = !1;
                "productValue" === ba && (ba = g.node.data.realField,
                N = "undefined" !== typeof g.node.data.realType ? g.node.data.realType[0] : N,
                D = !0);
                var q = null == g.value ? "" : g.value;
                switch (N) {
                case "booleanColumn":
                    q = g.value ? "yes" : "no";
                    break;
                case "dateColumn":
                    q = f(g);
                    break;
                case "dateAgoColumn":
                    q = Array.isArray(g.value) ? n({
                        value: g.value[0]
                    }) : n(g);
                    break;
                case "deltaColumn":
                    "" !== q && (q = na(g));
                    break;
                case "deltaPercentColumn":
                    "" !== q && (q += " %");
                    break;
                case "graphColumn":
                    q = "(Graph n.a.)";
                    break;
                case "priceColumn":
                    D ? q = g.node.data.productValueFormatted : "" !== g.value && null != g.value && (q = ka(g));
                    break;
                case "offerCountColumn":
                case "salesRankColumn":
                case "stockSingleColumn":
                    break;
                case "productCodeColumn":
                    q = null == g.value ? "" : g.value;
                    q instanceof Array && (q = q.join(", ", q));
                    break;
                case "trackingColumn":
                    q = J(g, !0);
                    break;
                default:
                    switch (N = {},
                    ba) {
                    case "domainId":
                        q = getTldByDomain(g.value);
                        break;
                    case "imagesCSV":
                        var L = g.value ? g.value : [];
                        "string" == typeof L && (L = L.split(","));
                        var A = [];
                        if (L instanceof Array)
                            for (var O = $jscomp.makeIterator(L), P = O.next(); !P.done; P = O.next())
                                A.push(imageToUrl(P.value));
                        q = A.length ? A.join(";") : "";
                        break;
                    case "externalLink":
                        var M = g.node.data;
                        q = "https://www.amazon." + getTldByDomain(M.domainId) + "/dp/" + M.asin + "/?m=" + M.sellerId + "&psc=1";
                        break;
                    case "publicationDate":
                    case "releaseDate":
                        q = r(g);
                        break;
                    case "variationCSV":
                    case "frequentlyBoughtTogether":
                        q = null == g.value ? "" : g.value;
                        q instanceof Array && (q = q.join(", ", q));
                        break;
                    case "offerCSV":
                        N = {
                            data: g.node.data
                        };
                        q = GridHelper.cellRendererOfferCSV(N);
                        q = q.replace(/(<([^>]+)>)/ig, "").replace(/&e[mn]sp;/g, " ");
                        break;
                    case "sold":
                    case "sold30Day":
                        q = 0 < q ? "" + q : "?";
                        break;
                    case "stockCSV":
                        q = "" == q ? "?" : "" + q + (g.node.data.stockIsMax ? "+" : "");
                        break;
                    case "buyBoxSellerIdHistory":
                        if ("object" === typeof q) {
                            var u = Object.keys(q)[0]
                              , v = isSellerIdAmazon(u, g.node.data.domainId);
                            q = v || g.context.isCopyToClipboard ? "" + q[u].sellerName + (v ? "" : " (" + q[u].currentRating + "%)") : "3rd Party (" + (-2 == u ? "?" : u) + ")"
                        }
                        break;
                    case "sellerCurrentRating":
                        q = 0 < q ? q + " %" : "0 %";
                        break;
                    case "sellerCurrentRatingCount":
                        q = 0 < q ? q : 0;
                        break;
                    case "AMAZON_outOfStockPercentage90":
                    case "NEW_outOfStockPercentage90":
                    case "USED_outOfStockPercentage90":
                    case "BUY_BOX_SHIPPING_outOfStockPercentage90":
                        q = "number" != typeof q ? "-" : q + " %";
                        break;
                    case "availabilityAmazon":
                        q = b[q];
                        break;
                    case "rootCategory":
                        D && (q = GridHelperCategory.getName(g.node.data.domainId, q));
                        break;
                    case "categories":
                        if (D) {
                            var G = [];
                            g.node.data.productValue.forEach(function(Z, ja) {
                                Z = GridHelperCategory.getName(g.node.data.domainId, Z);
                                G.push(Z)
                            });
                            q = G.join(", ")
                        }
                        break;
                    case "topCategory":
                        q = "" === q ? "-" : q + " (" + NumberUtil.format(g.node.data.topCategoryProductCountPercentage) + " %)";
                        break;
                    case "categoryTree":
                        "" !== q && (q = getSimpleTreeToString(q));
                        break;
                    case "couponOneTimePercent":
                    case "couponSNSPercent":
                        q = ua(g);
                        break;
                    case "couponOneTimeAbsolute":
                        q = qa(g);
                        break;
                    case "sellerIdsLowestFBA":
                    case "sellerIdsLowestFBM":
                        !0 !== g.context.isCopyToClipboard && (g.value = g.node.data.stats[ba]);
                        q = za(g);
                        break;
                    case "fbaFees":
                        q = "undefined" === typeof g.node.data ? "" : g.node.data.productValueFormatted ? g.node.data.productValueFormatted : qa(g);
                        break;
                    case "subcategorySalesRanks":
                        q = "";
                        A = g.value;
                        if (0 < A.length) {
                            L = [];
                            for (var w = $jscomp.makeIterator(A), B = w.next(); !B.done; B = w.next()) {
                                currentRank = B.value;
                                var Q = 100 < currentRank.topPct ? "-" : currentRank.topPct;
                                L.push(CsvType.format("SALES", currentRank.rank) + " | Top " + Q + "% | " + currentRank.cr.contextFreeName)
                            }
                            q = L.join("; ")
                        }
                        break;
                    case "salesRankReference":
                        -2 === q && (q = "Launchpad");
                        break;
                    case "variationAttributes":
                        q = "";
                        var fa = g.value;
                        if (fa)
                            for (var R = $jscomp.makeIterator(fa), T = R.next(); !T.done; T = R.next()) {
                                var oa = T.value;
                                q += oa.dimension + ": " + oa.value + "; "
                            }
                        q = q.trim();
                        break;
                    default:
                        "string" === typeof q && (q = q.replace(/&nbsp;/g, " ")),
                        ba.includes("_backInStock") && (q = (q = g.value[g.node.data.product.domainId]) ? "yes" : "no")
                    }
                }
                return q
            } catch (Z) {
                q = {
                    lastUrl: lastUrl,
                    lastSubUrl: lastSubUrl,
                    "params.node": g.node
                },
                reportBug(Z, q),
                isTest && console.log(q)
            }
        },
        processHeaderCallback: function(g) {
            var D = "manage" === g.context.pageId
              , N = g.column.colId
              , ba = g.column.colDef;
            g = ba.headerName;
            !ba.headerNameGroup || "undefined" !== typeof ba.type && ba.type.includes("hiddenColumn") || (g = ba.headerNameGroup + ": " + g);
            switch (N) {
            case "rank":
                g = " ";
                break;
            case "domainId":
                g = D ? ba.headerName : "Locale";
                break;
            case "externalLink":
                g = "Deeplink";
                break;
            case "currentRating":
                g = ba.headerName + " %";
                break;
            case "packageDimension":
            case "packageLength":
            case "packageWidth":
            case "packageHeight":
            case "packageWeight":
            case "itemDimension":
            case "itemLength":
            case "itemWidth":
            case "itemHeight":
            case "itemWeight":
                D = V();
                N = N.includes("Weight") ? D.weight : N.includes("Dimension") ? D.measure + "\u00b3" : D.measure;
                g = g + " (" + N + ")";
                break;
            case "trackingExpiresOn":
                g = la._888;
                break;
            default:
                g = g.replace(/&nbsp;/g, " ")
            }
            return g
        },
        processCellForClipboard: function(g) {
            var D = g.column.colDef
              , N = null == g.value ? "" : g.value;
            switch ("undefined" !== typeof D.type ? D.type[0] : !1) {
            case "trackingColumn":
                N = J(g, !0)
            }
            return N
        },
        processHeaderForClipboard: function(g) {
            return g.column.getColDef().headerName
        },
        removeColumnsEmpty: function(g, D) {
            g.forEach(function(N, ba) {
                if (!N.children) {
                    var q = N.field;
                    if ("checkboxSelection" !== q) {
                        var L = q.split(".");
                        N = !1;
                        1 === L.length ? N = D.some(function(A) {
                            return null != A[q] && -1 != A[q]
                        }) : 2 === L.length ? N = D.some(function(A) {
                            return A[L[0]] ? null != A[L[0]][L[1]] && -1 != A[L[0]][L[1]] : !1
                        }) : isTest && console.log("removeColumnsEmpty: missing field format handling");
                        N || delete g[ba]
                    }
                }
            });
            return g = g.filter(function(N) {
                return N
            })
        },
        removeColumnsOffer: function(g, D, N) {
            N = void 0 === N ? !1 : N;
            var ba = ["conditionComment"]
              , q = ["isMAP"]
              , L = "isPrime isWarehouseDeal isScam isAmazon isPrimeExcl isShippable isAddonItem isPreorder".split(" ");
            g.forEach(function(A, O) {
                var P = A.field;
                if (ba.includes(P))
                    D.some(function(u) {
                        return null != u[P] && -1 != u[P]
                    }) || (N ? g[O].hide = !0 : delete g[O]);
                else if (q.includes(P))
                    D.some(function(u) {
                        return u[P]
                    }) || (N ? g[O].hide = !0 : delete g[O]);
                else if (L.includes(P)) {
                    A = D.some(function(u) {
                        return u[P]
                    });
                    var M = D.some(function(u) {
                        return !u[P]
                    });
                    A && M || (N ? g[O].hide = !0 : delete g[O])
                }
            });
            N || (g = g.filter(function(A) {
                return A
            }));
            return g
        },
        valueFormatterCouponPercentage: ua,
        valueFormatterCsvType: function(g) {
            if ("undefined" === typeof g.data)
                return "";
            var D = g.colDef.field;
            if (null == g.value)
                return "COUNT_REVIEWS_current" === D && g.data.ratingOutdated ? "?" : "-";
            if (-2 === g.value)
                return '<i class="fa fa-lg fa-lock"></i>';
            D = E(D);
            return CsvType.format(D, g.value)
        },
        valueFormatterDelta: na,
        valueFormatterDimension: function(g) {
            g = g.value;
            return null === g ? "-" : aa(g, {
                maximumFractionDigits: 0
            })
        },
        valueFormatterMeasure: function(g) {
            g = g.value;
            return null === g ? "-" : aa(g, {
                minimumFractionDigits: 1
            })
        },
        valueFormatterMoney: qa,
        valueFormatterPrice: ka,
        valueFormatterRating: function(g) {
            if ("undefined" === typeof g.data)
                return "";
            var D = g.value;
            return null === D ? g.data.ratingOutdated ? "?" : "-" : aa(D, {
                minimumFractionDigits: 1
            })
        },
        valueFormatterRatingCount: function(g) {
            if (g.data && g.data.isAmazon)
                return "-";
            g = g.value;
            return "undefined" === typeof g || 0 > g ? 0 : NumberUtil.format(g)
        },
        valueFormatterRatingPercentage: function(g) {
            if (g.data && g.data.isAmazon)
                return "-";
            g = g.value;
            if ("undefined" === typeof g || 0 > g)
                g = 0;
            return g + " %"
        },
        valueFormatterSellerIdsLowest: za,
        valueFormatterStockSingle: function(g) {
            return "undefined" === typeof g.data ? "?" : isStockMax(g.value, g.data.stockLimit) ? g.value + "+" : null === g.value ? "?" : g.value
        },
        valueFormatterTracking: J,
        valueFormatterWeight: function(g) {
            g = g.value;
            if (null === g)
                return "-";
            var D = 0
              , N = V().weight;
            N && "lb" === N && (D = 3);
            return aa(g, {
                maximumFractionDigits: D,
                minimumFractionDigits: D
            })
        },
        valueGetterBuyBoxSellerId: function(g) {
            if ("undefined" !== typeof g.data && null != g.data.asin) {
                var D = g.data.buyBoxSellerIdHistory;
                if (null == D)
                    return null;
                if (g.data.buyBoxSeller)
                    return g.data.buyBoxSeller;
                if (!Array.isArray(D))
                    return D;
                if (0 >= D.length || !0 === g.data.stats.buyBoxIsUsed || -1 === g.data.stats.buyBoxPrice)
                    return null;
                D = getLast(D, CsvType.AMAZON);
                if (-1 == D)
                    return null;
                var N = isSellerIdAmazon(D, g.data.domainId);
                g.data.buyBoxSellerId = D;
                g = {};
                return g[D] = {
                    sellerName: N ? "Amazon" : "3rd Party",
                    currentRating: null
                },
                g
            }
        },
        valueGetterCouponPercentage: function(g) {
            return "undefined" === typeof g.data || g.data.offersOutdated || g.data.offersNeverUpdated ? null : g.data[g.colDef.field]
        },
        valueGetterDateKeepaTime: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            g = g.data[g.colDef.field];
            return 0 === g || -1 === g ? null : g
        },
        valueGetterDimension: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            var D = g.data;
            if ("packageDimension" === g.colDef.field) {
                g = D.packageLength;
                var N = D.packageWidth;
                D = D.packageHeight
            } else
                g = D.itemLength,
                N = D.itemWidth,
                D = D.itemHeight;
            if ("undefined" === typeof g || 0 >= g || "undefined" === typeof N || 0 >= N || "undefined" === typeof D || 0 >= D)
                return null;
            D = g * N * D / 1E3;
            (g = V().measure) && "in" === g && (D *= .061024);
            return parseFloat(D.toFixed(0))
        },
        valueGetterLanguage: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            g = g.data[g.colDef.field];
            if (null == g)
                return "";
            for (var D = "", N = 0; N < g.length; N++) {
                var ba = g[N];
                ba && (D = 1 === ba.length ? D + ba[0] : D + (2 === ba.length ? ba[0] + ": " + ba[1] : ba[0] + ": " + ba[1] + ", " + ba[2]),
                N != g.length - 1 && (D += "; "))
            }
            return D
        },
        valueGetterMeasure: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            g = g.data[g.colDef.field];
            if ("undefined" === typeof g || 0 >= g)
                return null;
            g /= 10;
            var D = V().measure;
            D && "in" === D && (g *= .3937);
            return parseFloat(g.toFixed(1))
        },
        valueGetterMoney: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            var D = "undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field;
            return null == g.data[D] || (g.data.offersOutdated || g.data.offersNeverUpdated) && D.includes("coupon") ? null : Money.raw(g.data[D], {
                sourceDomainId: g.data.domainId,
                targetDomainId: 0 < currencyDomainId ? currencyDomainId : Number(g.data.domainId)
            })
        },
        valueGetterNoNegative: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            g = g.data[g.colDef.field];
            return 0 > g ? null : g
        },
        valueGetterPrice: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            var D = g.colDef.field;
            if (0 > g.data[D])
                return null;
            var N = E(D);
            if (GridHelper.isOfferData(N) && (g.data.offersOutdated || g.data.offersNeverUpdated) && (0 < g.colDef.field.indexOf("_current") || 0 < g.colDef.field.indexOf("_atIntervalStart")) || ["EBAY_NEW_SHIPPING", "EBAY_USED_SHIPPING"].includes(N) && g.data.ebayOutdated)
                return null;
            N = ("undefined" === typeof g.context || "lightningdeal" !== g.context.pageId) && 0 < currencyDomainId ? currencyDomainId : Number(g.data.domainId);
            "undefined" !== typeof g.context && g.context.mainDomainId && !currencyDomainId && (N = g.context.mainDomainId);
            return Money.raw(g.data[D], {
                sourceDomainId: g.data.domainId,
                targetDomainId: N
            })
        },
        valueGetterRating: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            var D = g.data[g.colDef.field];
            return -1 == D || g.data.ratingOutdated ? null : parseFloat((D / 10).toFixed(1))
        },
        valueGetterReviewCount: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            var D = g.data[g.colDef.field];
            return -1 == D || g.data.ratingOutdated ? null : D
        },
        valueGetterSalesRank: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            g = g.data[g.colDef.field];
            return -1 == g ? null : g
        },
        valueGetterStats: function(g) {
            return "undefined" === typeof g.data || "undefined" === typeof g.data.stats || null === g.data.stats ? null : g.data.stats[g.colDef.field]
        },
        valueGetterStockSingle: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            var D = "undefined" !== typeof g.data.realField ? g.data.realField : g.colDef.field;
            if ("stock" === D && "undefined" === typeof g.data.stats)
                return g.data.stock;
            g = g.data.stats[D] || -2;
            return -2 == g ? null : g
        },
        valueGetterTracking: function(g) {
            if ("undefined" === typeof g.data || g.data.isDeleted)
                return [null];
            var D = g.colDef.field;
            if ("undefined" !== typeof g.data.isUpdating && !0 === g.data.isUpdating[D])
                return [null];
            var N = g.data.product
              , ba = D.includes("delta") && GridManage.pageConfig.sortFilterReference === GridManage.sortFilterReferences.PERCENTAGE;
            ba && (D += "Percent");
            var q = N[D];
            if (!D.includes("delta") && 0 > q || D.includes("delta") && null == q)
                q = null;
            var L = E(D)
              , A = "undefined" !== typeof CsvType[L] && CsvType[L].currency || "MAX" === L
              , O = 0 < currencyDomainId ? currencyDomainId : Number(storage.domain)
              , P = function(v, G) {
                return ba ? v : A ? null == v ? v : Money.raw(v, {
                    sourceDomainId: G,
                    targetDomainId: O
                }) : CsvType[L].index === CsvType.RATING.index ? v / 10 : v
            };
            N = [P(q, N.domainId)];
            if (g.data.multiLocaleProductsReduced.length) {
                q = $jscomp.makeIterator(g.data.multiLocaleProductsReduced);
                for (var M = q.next(); !M.done; M = q.next()) {
                    var u = M.value;
                    M = u[D];
                    if (!D.includes("delta") && 0 > M || D.includes("delta") && null == M)
                        M = null;
                    u = D.includes("desired") ? g.data.domainId : u.domainId;
                    N.push(P(M, u))
                }
            }
            return N
        },
        valueGetterTrackingNonCsvArray: function(g) {
            if ("undefined" === typeof g.data || g.data.isDeleted)
                return [null];
            var D = g.colDef.field
              , N = [g.data.product[D]];
            if (g.data.multiLocaleProductsReduced.length) {
                g = $jscomp.makeIterator(g.data.multiLocaleProductsReduced);
                for (var ba = g.next(); !ba.done; ba = g.next())
                    N.push(ba.value[D])
            }
            return N
        },
        valueGetterWeight: function(g) {
            if ("undefined" === typeof g.data)
                return null;
            g = g.data[g.colDef.field];
            if ("undefined" === typeof g || 0 >= g)
                return null;
            var D = V().weight;
            D && "lb" === D && (g *= .0022046);
            return parseFloat(g.toFixed(3))
        },
        valuesAreEqual: function(g, D) {
            return g instanceof Array ? D.length === g.length && D.every(function(N, ba) {
                return N === g[ba]
            }) : "object" === typeof g ? JSON.stringify(g) === JSON.stringify(D) : g === D
        },
        valueSetterMetaData: function(g) {
            if (0 >= g.newValue)
                return !1;
            var D = function(N, ba) {
                var q = N.node.data;
                q.tracking.ttl = Math.round((keepaTime.now() - q.tracking.createDate) / 60) + ba;
                ba = keepaTime.now() + 60 * ba;
                q.tracking.expiresOn = 5256E3 < ba - keepaTime.now() ? null : ba;
                q.tracking.expiresSoon = 10080 > ba - keepaTime.now();
                setTimeout(function() {
                    N.api.updateRowData({
                        update: [q]
                    })
                }, 0)
            };
            (function(N) {
                var ba = GridManage.getTrackingUpdateObject();
                ba.ttl = N.newValue;
                var q = {
                    path: "track",
                    type: "updateTracking",
                    asin: N.data.asin,
                    trackingUpdate: ba,
                    version: 3
                };
                isTest && console.info("%ctrackingUpdateRequest", "color:green;", ba);
                network.request(q).done(function(L) {
                    null == L.error ? D(N, ba.ttl) : updateFailed("Tracking Update Error", L.error, !0)
                }).fail(function(L) {
                    updateFailed("Tracking Update Error", L.error, !0)
                })
            }
            )(g);
            return !0
        }
    }
}()
  , GridHelperReviews = function() {
    var a = function(f) {
        var n = "current" === f
          , r = CsvType.getName(CsvType.COUNT_REVIEWS.index);
        n || (r += " - " + f.replace("avg", "") + " days avg.");
        return {
            headerName: r,
            headerTooltip: r,
            headerNameGroup: "Reviews",
            field: "COUNT_REVIEWS_" + f,
            cellClass: "cell-number",
            cellRenderer: GridHelper.cellRendererCsvType,
            comparator: GridHelper.comparatorNumberNullLast,
            equals: function() {
                return !1
            },
            hide: !n,
            filter: "agNumberColumnFilter",
            icons: GridHelper.getIconsSortNumeric(),
            suppressSizeToFit: !0,
            valueFormatter: GridHelper.valueFormatterCsvType,
            valueGetter: GridHelper.valueGetterReviewCount,
            width: n ? 100 : 140
        }
    }
      , b = function(f, n) {
        n = void 0 === n ? !1 : n;
        var r = {
            "reviews.ratingCount": !0 === n ? "Ratings" : "Ratings - Format Specific",
            "reviews.reviewCount": !0 === n ? "Reviews" : "Review Count - Format Specific"
        };
        return {
            field: f,
            headerName: r[f],
            headerTooltip: r[f],
            valueGetter: d,
            valueFormatter: h,
            cellRenderer: m,
            cellClass: "cell-number",
            comparator: GridHelper.comparatorNumberNullLast,
            icons: GridHelper.getIconsSortNumeric(),
            filter: "agNumberColumnFilter",
            width: !0 === n ? 80 : 120,
            suppressSizeToFit: !0
        }
    }
      , d = function(f) {
        if ("undefined" === typeof f.data || !f.data.reviews)
            return null;
        var n = f.data.reviews
          , r = keepaTime.now()
          , p = n.lastUpdate;
        if (0 >= p || 0 < p && 20160 < r - p)
            return null;
        f = f.colDef.field.split(".")[1];
        return "undefined" === typeof n[f] ? null : n[f][n[f].length - 1]
    }
      , h = function(f) {
        return null === f.value ? "?" : 0 > f.value ? "-" : NumberUtil.format(f.value)
    }
      , m = function(f) {
        if ("undefined" === typeof f.data)
            return "";
        var n = f.colDef.field.split(".")[1]
          , r = ("ratingCount" === n && f.data.reviewsRatingIsMax ? '<span title="Format with the most ratings"><i class="fa fa-trophy"></i></span>&emsp;' : "") + '<span style="color:' + CsvType["ratingCount" === n ? "RATING" : "COUNT_REVIEWS"].color + '">' + f.valueFormatted + "</span>";
        "ratingCount" === n && 0 < f.data.ratingCountAcrossVariations && 0 < f.value && (f = Math.round(100 * f.value / f.data.ratingCountAcrossVariations),
        n = NumberUtil.format(f),
        1 > f && (n = "<1"),
        r += '<br><span style="color:#999">' + n + "%</span>");
        return r
    }
      , t = function() {
        return {
            field: "linkReviews",
            headerName: "",
            valueGetter: function(f) {
                var n = f.data.reviews;
                return n ? 0 < n.ratingCount[n.ratingCount.length - 1] ? "http://www.amazon." + getTldByDomain(f.data.domainId) + "/product-reviews/" + f.data.asin + "/?ie=UTF8&formatType=current_format&sortBy=recent" : "" : ""
            },
            tooltipValueGetter: function(f) {
                return 0 < f.data.COUNT_REVIEWS_current ? la._939 : null
            },
            cellRenderer: function(f) {
                return f.value ? '<a href="' + f.value + '" target="_blank" style><i class="fa fa-star"></i></a>' : ""
            },
            cellClass: "cell-icon cell-opaque",
            filter: !1,
            sortable: !1,
            suppressMenu: !0,
            suppressSizeToFit: !0,
            width: 20
        }
    };
    return {
        getColumnGroupReviews: function() {
            return {
                headerName: '<i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:' + CsvType.RATING.color + '"></i> Reviews',
                children: [{
                    headerName: CsvType.getName(CsvType.RATING.index),
                    headerNameGroup: "Reviews",
                    field: "RATING_current",
                    cellClass: "cell-number",
                    cellRenderer: GridHelper.cellRendererRatingStar,
                    comparator: GridHelper.comparatorNumberNullLast,
                    equals: function() {
                        return !1
                    },
                    filter: "agNumberColumnFilter",
                    icons: GridHelper.getIconsSortNumeric(),
                    suppressSizeToFit: !0,
                    valueFormatter: GridHelper.valueFormatterRating,
                    valueGetter: GridHelper.valueGetterRating,
                    width: 76
                }, a("current"), a("avg30"), a("avg90"), a("avg180"), b("reviews.ratingCount"), b("reviews.reviewCount")]
            }
        },
        getColumnGroupReviewsFormatSpecific: function() {
            return {
                headerName: "Reviews",
                children: [b("reviews.ratingCount", !0), b("reviews.reviewCount", !0), t()]
            }
        }
    }
}()
  , GridHelperCsvType = function() {
    getColumnOutOfStockPercentage = function(h) {
        var m = {};
        m = (m[CsvType.AMAZON.index] = {
            headerTooltip: "The Amazon out of stock percentage of the last 90 days.<br>The higher the number, the less time Amazon was in stock."
        },
        m[CsvType.NEW.index] = {
            headerTooltip: "The out of stock percentage of any offer in the New condition of the last 90 days.<br>The higher the number, the less time an offer in the New condition was in stock."
        },
        m[CsvType.USED.index] = {
            headerTooltip: "The out of stock percentage of any offer in the Used condition of the last 90 days.<br>The higher the number, the less time an offer in the Used condition was in stock."
        },
        m[CsvType.BUY_BOX_SHIPPING.index] = {
            headerTooltip: "The Box out of stock / suppressed percentage of the last 90 days.<br>The higher the number, the less time a Buy Box offer was available."
        },
        m);
        var t = CsvType[h];
        return {
            field: h + "_outOfStockPercentage90",
            headerName: "90 days OOS",
            headerNameGroup: CsvType.getName(t.index),
            headerTooltip: m[t.index] ? m[t.index].headerTooltip : "",
            headerComponentParams: {
                template: GridHelper.getHeaderComponentTemplate("", '<i class="fa fa-info"></i>')
            },
            valueGetter: a,
            valueFormatter: b,
            cellRenderer: d,
            cellClass: "cell-number",
            comparator: GridHelper.comparatorNumberNullLast,
            icons: GridHelper.getIconsSortNumeric(),
            filter: "agNumberColumnFilter",
            width: 110,
            suppressSizeToFit: !0
        }
    }
    ;
    var a = function(h) {
        if ("undefined" === typeof h.data)
            return null;
        var m = "undefined" !== typeof h.data.realField ? h.data.realField : h.colDef.field;
        return 0 > h.data[m] ? null : h.data[m]
    }
      , b = function(h) {
        return null == h.value ? "-" : h.value + " %"
    }
      , d = function(h) {
        if ("undefined" === typeof h.data)
            return "";
        var m = GridHelper.getCsvObjectName("undefined" !== typeof h.data.realField ? h.data.realField : h.colDef.field);
        return '<span style="color:' + CsvType[m].color + '">' + h.valueFormatted + "</span>"
    };
    return {
        getColumnOutOfStockPercentage: getColumnOutOfStockPercentage
    }
}()
  , GridHelperCategory = function() {
    var a = {}
      , b = {}
      , d = {}
      , h = function(t, f) {
        return f > invalidIfLargerCatId || -1 === f ? "" : d[t] && d[t][f] ? d[t][f].name : a[t] && a[t][f] ? a[t][f].name : f
    }
      , m = function(t, f) {
        return $.Deferred(function(n) {
            0 === f.length || null === t || "null" === t || 0 == storage.accountType ? n.resolve() : network.request({
                path: "pro/category",
                domainId: t,
                categoryIds: f,
                includeTrees: !0,
                version: 3
            }).done(function(r) {
                var p = r.categories;
                a[t] = a[t] || {};
                Object.assign(a[t], p);
                r = r.categoryTrees;
                b[t] = b[t] || {};
                Object.assign(b[t], r);
                n.resolve()
            }).fail(function(r) {
                reportBug("Category data could not be loaded.", JSON.stringify({
                    domainId: t,
                    categoryIds: f,
                    response: r
                }));
                n.resolve()
            })
        })
    };
    return {
        getHashMap: function(t) {
            return a[t]
        },
        getName: h,
        getRoot: function(t, f) {
            return d[t][f]
        },
        getRootHashMap: function(t) {
            return d[t]
        },
        getTreeHashMap: function(t) {
            return b[t]
        },
        load: function(t, f, n) {
            return $.Deferred(function(r) {
                var p = {};
                f && n && (p[f] = n);
                if (null !== t)
                    for (var z = 0; z < t.length; z++) {
                        var F = t[z];
                        p[F.domainId] = p[F.domainId] || [];
                        p[F.domainId].push(F.rootCategory);
                        F.categories && (p[F.domainId] = [].concat($jscomp.arrayFromIterable(p[F.domainId]), $jscomp.arrayFromIterable(F.categories)));
                        p[F.domainId].push(F.salesRankReference)
                    }
                z = [];
                for (var I in p)
                    F = Array.from(new Set(p[I])),
                    z.push(m(I, F));
                isTest && console.time("load categories");
                $.when.apply($, $jscomp.arrayFromIterable(z)).done(function() {
                    isTest && console.timeEnd("load categories");
                    r.resolve()
                })
            })
        },
        render: function(t, f, n, r) {
            if ("undefined" === typeof f)
                return "";
            var p = !1;
            if ("undefined" !== typeof r && (p = "finder" === r.context.pageId) && !["categoryTree", "salesRankReference"].includes(r.colDef.field))
                return r.value = n,
                p = GridHelper.cellRendererChangeFilterModel(r),
                p.className = "toggle-filter",
                p.dataset.id = f,
                r = document.createElement("a"),
                r.href = "https://www.amazon." + getTldByDomain(t) + "/b/?node=" + f,
                r.innerHTML = '<i class="fa fa-external-link"></i>',
                r.title = la._99 + " Amazon",
                r.target = "_blank",
                t = document.createElement("span"),
                t.appendChild(p).insertAdjacentHTML("afterend", "&ensp;"),
                t.appendChild(r),
                t;
            r = document.createElement("span");
            r.innerHTML = n;
            var z = document.createElement("a");
            z.className = "href";
            z.href = getBaseUrl() + "#!bestseller/" + t + "-" + f;
            z.innerHTML = n;
            z.target = iframe.isIframe ? "_blank" : "";
            n = document.createElement("a");
            n.href = "https://www.amazon." + getTldByDomain(t) + "/b/?node=" + f;
            n.innerHTML = '&ensp;<i class="fa fa-external-link"></i>';
            n.target = "_blank";
            n.title = la._99 + " Amazon";
            t = document.createElement("span");
            t.appendChild(p ? r : z);
            t.appendChild(n);
            return t
        },
        setRootHashMap: function(t, f) {
            d[t] = d[t] || {};
            Object.assign(d[t], f)
        },
        valueGetterCategories: function(t) {
            if ("undefined" === typeof t.data || null == t.data.categories)
                return "";
            var f = [];
            t.data.categories.forEach(function(n) {
                n = h(t.data.domainId, n);
                f.push(n)
            });
            return f.join(", ")
        },
        valueGetterRootCategory: function(t) {
            return "undefined" === typeof t.data || null == t.data.asin ? "" : h(t.data.domainId, t.data.rootCategory)
        },
        valueGetterSalesRankReference: function(t) {
            return "undefined" === typeof t.data || null == t.data.asin ? "" : h(t.data.domainId, t.data.salesRankReference)
        }
    }
}()
  , GridPage = function() {
    var a = function(b, d) {
        var h = $("#" + b.gridWrapperId)
          , m = 110;
        "deals" === b.pageId && (m = 628);
        "manage" === b.pageId && (m = 400);
        "search" === b.pageId && (m = 220);
        var t = 420;
        if ("manage" === b.pageId || "lightningdeal" === b.pageId)
            t = 900;
        "search" === b.pageId && (t = 860);
        var f = $(window).height()
          , n = $(window).width();
        f -= 220;
        !1 !== b.showTools && (f -= 20);
        b.containerId && (f -= 120);
        "bestseller" === b.pageId && (f -= 100);
        "finder" === b.pageId && (f += 40);
        "manage" === b.pageId && (f += 75);
        "topseller" === b.pageId && (f += 40);
        "search" === b.pageId && (f = Math.min(f + 110, 1065));
        if ("deals" === b.pageId) {
            var r = $("#dealsGrid").offset();
            f -= (r ? r.top : 0) + -320
        }
        f = Math.max(f, m);
        m = n - (b.containerId ? 110 : 80);
        "deals" === b.pageId && (m -= 150);
        "search" === b.pageId && (m += 30);
        "manage" === b.pageId && (m -= 20);
        "lightningdeal" === b.pageId && (m = $("#grid-wrapper-manage").width());
        m = Math.max(m, t);
        if (!hasDataAccessSubscription && !["manage", "search", "categorytree"].includes(b.pageId)) {
            n = t = GridConfig.rowHeight.balham;
            f = t + 8;
            r = 0;
            "asin" === b.template && (n = 56,
            r = 8);
            if ("finder" === b.pageId || "deals" === b.pageId)
                f = 56;
            f = 2 * t + n * GridConfig.maxRowsFreeUser + f + r
        }
        "lightningdeal" === b.pageId && (t = GridConfig.rowHeight.balham,
        f = t + 5 * (2 * (t - 8) + 8) + 0);
        "manage" === b.pageId && d && b.neededHeight && b.neededHeight < f && (f = b.neededHeight);
        h.height(f + "px");
        h.width(m + "px")
    };
    return {
        init: function(b) {
            document.title = docTitlePrefix + b.title;
            var d = getLoaderBox(!0)
              , h = ""
              , m = "";
            b.showTools && !1 !== b.showTools.filter && (h = '<div id="grid-form-' + b.pageId + '" class="grid-filter-form"></div>');
            !1 !== b.showTools && (m = '<div id="grid-tools-' + b.pageId + '" class="grid-wrapper-tools"></div>');
            insertPage(h + '\n\t\t\t\n\t\t\t<div class="data-container text_long ' + b.template + '">\n\t\t\t\t' + m + '\t\n\t\t\t\t<div id="' + b.gridWrapperId + '" class="grid-wrapper ' + b.template + '"> \n\t\t\t\t' + d + "\n\t\t\t\t</div>\n\t\t\t</div>");
            $("#contentAlign").css({
                marginRight: "40px",
                marginLeft: "40px",
                minWidth: "420px",
                width: $(window).width() - 80 + "px"
            });
            "manage" === b.pageId && $("#contentAlign").css({
                marginTop: "125px"
            });
            b.resizeToViewport && a(b)
        },
        initContainer: function(b) {
            var d = getLoaderBox(!0)
              , h = ""
              , m = ""
              , t = "";
            !1 !== b.showTools && (h = '<div id="grid-tools-' + b.pageId + '" class="grid-wrapper-tools"></div>');
            b.showFilterTop && (m = '<div id="' + b.gridWrapperId + '-filter" class="grid-filter-top"></div>');
            !1 !== b.showTools && !0 === b.showTools.track && "variation" === b.pageId && (t = '<div id="' + b.gridWrapperId + '-tracking" style="display: none;' + (iframe.isIframe ? "margin: 0px 0px 0px 23px;" : "") + '"></div>');
            replaceHtml(b.containerId, h + "\n\t\t\t" + m + '\n\t\t\t<div id="' + b.gridWrapperId + '" class="grid-wrapper ' + b.template + '">\n\t\t\t\t' + d + "\n\t\t\t</div>\n\t\t\t" + t);
            b.resizeToIframeTab && (d = $("#" + b.gridWrapperId),
            h = d.parent(),
            m = $(h).data("wrapper"),
            "undefined" !== typeof m && (h = $("#" + m)),
            t = h.width() - 4,
            "undefined" !== typeof m && (t -= 50),
            h && 0 < t && d.width(t));
            b.resizeToViewport && ("deals" !== b.pageId && $("#contentAlign").css({
                marginRight: "40px",
                marginLeft: "40px",
                minWidth: "420px",
                width: $(window).width() - 80 + "px"
            }),
            a(b))
        },
        initGridContainer: function(b) {
            replaceHtml(b.gridWrapperId, '<div id="' + b.gridId + '" class="' + b.gridClass + '"></div>')
        },
        resizeToViewPort: a
    }
}()
  , GridTools = function() {
    var a = function(f) {
        var n = {};
        f.context.config && f.context.config.showTools && (n = f.context.config.showTools);
        var r = "<div>";
        n.info && (r += '<div class="tool__info"></div>');
        n.column && (r += '\n\t\t\t\t<span class="tool__column">\n\t\t\t\t\t<span class="trigger">\n\t\t\t\t\t\t<i class="fa fa-columns fa-lg"></i>&ensp;Configure Columns&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t');
        n.filter && (r += '\n\t\t\t\t<span class="tool__filter">\n\t\t\t\t\t<span class="trigger">\n\t\t\t\t\t\t<i class="fa fa-filter fa-lg"></i>&ensp;Advanced Filter&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t');
        if (n.row) {
            for (var p = GridConfig.getRowCountOptions(f.context.config.type), z = [], F = 0; F < p.values.length; F++) {
                var I = p.values[F];
                z.push({
                    content: I,
                    value: I,
                    disabled: p.disabled[F]
                })
            }
            p = material.getMenu("tool-row-menu", z);
            z = GridApi.getRowsPerPage(f);
            r += '\n\t\t\t\t<span class="tool__row mdc-menu-anchor">\n\t\t\t\t\t<span class="trigger">\n\t\t\t\t\t\t<i class="fa fa-list-ol fa-lg"></i><span>&ensp;' + z + " rows&emsp;</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t" + p + "\n\t\t\t\t</span>\n\t\t\t"
        }
        n.import && (r += '\n\t\t\t\t<span class="tool__import">\n\t\t\t\t\t<span class="trigger">\n\t\t\t\t\t\t<i class="fa fa-upload fa-lg"></i>&ensp;Import list&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t');
        n.export && (r += '\n\t\t\t\t<span class="tool__export">\n\t\t\t\t\t<span class="trigger">\n\t\t\t\t\t\t<i class="fa fa-download fa-lg"></i>&ensp;Export&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t');
        n.delete && (r += '\n\t\t\t\t<span class="tool__delete">\n\t\t\t\t\t<span class="trigger" title="Remove selected rows (hold down<br>ctrl + click to select or deselect rows)">\n\t\t\t\t\t\t<span><i class="fa fa-trash-o fa-lg"></i>&ensp;Remove&emsp;</span>\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t');
        n.update && (r += '\n\t\t\t\t<span class="tool__update">\n\t\t\t\t\t<span class="trigger" title="Force an update of all product data<br>older than a couple of hours.">\n\t\t\t\t\t\t<i class="fa fa-refresh fa-lg"></i>&ensp;Update product data&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t');
        if (n.range) {
            var E = "";
            n.rangeConfig.options.forEach(function(ea) {
                E += '<span data-range="' + ea + '" class="trigger">&thinsp;' + ea + "&thinsp;</span>"
            });
            r += '\n\t\t\t\t<span class="tool__range">\n\t\t\t\t\t<span class="">\n\t\t\t\t\t\t<i class="fa fa-calendar fa-lg"></i>&ensp;Range in days: ' + E + "&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t"
        }
        n.results && (r += '<span class="tool__results"></span>');
        n.viewer && (r += '\n\t\t\t\t<span class="tool__viewer">\n\t\t\t\t\t<span class="trigger">\n\t\t\t\t\t\t<i class="fa fa-fw fa-th"></i>&ensp;' + la._670 + "&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t");
        n.track && (p = la._917,
        "inMemory" === f.rowModelType && (p += "<br>" + la._923),
        r += '\n\t\t\t\t<span class="tool__tracktoggle">\n\t\t\t\t\t<span class="trigger">\n\t\t\t\t\t\t<i class="fa fa-fw fa-eye-slash"></i>&ensp;' + la._915 + '&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t\t<span class="tool__track">\n\t\t\t\t\t<span class="trigger" style="display: none;" title="' + p + '">\n\t\t\t\t\t\t<i class="fa fa-fw fa-bell-o"></i>&ensp;' + la._916.replace("#selectedAsinCount#", "") + "&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t");
        n.filterinfo && (r += '\n\t\t\t\t<span class="tool__filterinfo">\n\t\t\t\t\t<span class="trigger">\n\t\t\t\t\t\t<i class="fa fa-fw fa-file-o fa-lg"></i>&ensp;Show active filters&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t');
        n.query && (r += '\n\t\t\t\t<span class="tool__query">\n\t\t\t\t\t<span class="trigger">\n\t\t\t\t\t\t<i class="fa fa-file-code-o fa-lg"></i>&ensp;Show API query&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t');
        if (n.graph) {
            var K = "";
            [7, 30, 90, 180, 365, "all"].forEach(function(ea) {
                K += '<span data-range="' + ea + '" class="trigger">&thinsp;' + ea + "&thinsp;</span>"
            });
            r += '\n\t\t\t\t<span class="tool__graph">\n\t\t\t\t\t<span class="">\n\t\t\t\t\t\t<i class="fa fa-calendar fa-lg"></i>&ensp;Graph range in days: ' + K + "&emsp;\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t"
        }
        r += "</div>";
        if (n.column) {
            var H = {}
              , V = []
              , S = function(ea) {
                return ea.toLowerCase().replace(/[-_]+/g, " ").replace(/[.:,;()]/g, "").replace(/ (.)/g, function(ra) {
                    return ra.toUpperCase()
                }).replace(/ /g, "")
            };
            f.columnApi.getColumnState().forEach(function(ea) {
                var ra = f.columnApi.getColumn(ea.colId);
                if (!ra.colDef.suppressToolPanel) {
                    var pa = ra.colDef.headerName
                      , ua = ra.colDef.headerNameGroup ? ra.colDef.headerNameGroup.replace(/<i [\w ="-;]+><\/i>/g, "") + ": " : ""
                      , na = S(ua.replace("\ud83d\ude9a", "X") + pa.replace("%", "X"));
                    H[na] = {
                        colId: ra.colId,
                        checked: !1 === ea.hide || !0 === ra.colDef.lockVisible ? ' checked="checked"' : "",
                        disabled: !0 === ra.colDef.lockVisible ? ' disabled="disabled"' : "",
                        name: ua + pa
                    };
                    V.push(na)
                }
            });
            V.sort();
            r += '\n\t\t\t\t<div class="content-column mdc-elevation--z10">\n\t\t\t\t\t<p>Only selected columns will be shown</p>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<input class="filter-columns" type="text" placeholder="Filter columns..." />\n\t\t\t\t\t</p>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<span class="show-all">Show all</span> - <span class="hide-all">Hide all</span> - <span class="reset-all">Reset columns</span>' + (n.columnPresets ? ' - <span class="open-presets">Load/save preset</span>' : "") + '\n\t\t\t\t\t</p>\n\t\t\t\t\t<div class="scroll">\n\t\t\t';
            var aa = Date.now();
            V.forEach(function(ea) {
                ea = H[ea];
                var ra = ea.colId + "-" + aa;
                r += '\n\t\t\t\t\t<p data-search="' + escapeHTML(ea.name) + '">\n\t\t\t\t\t\t<input id="' + ra + '" data-col-id="' + ea.colId + '" type="checkbox"' + ea.checked + ea.disabled + "' />\n\t\t\t\t\t\t<label for=\"" + ra + '"' + (ea.disabled ? ' class="disabled"' : "") + ">" + ea.name + "</label>\n\t\t\t\t\t</p>\n\t\t\t\t"
            });
            r += "\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t "
        }
        n = "grid-tools-" + f.context.pageId;
        replaceHtml(n, r);
        b(f, n)
    }
      , b = function(f, n) {
        var r = {};
        f.context.config && f.context.config.showTools && (r = f.context.config.showTools);
        var p = $("#" + n);
        if (r.filter)
            p.find(".tool__filter .trigger").on("click", function() {
                "finder" === f.context.pageId ? GridFinder.initFilter(!0) : isTest && console.warn('GridTools "filter" not yet supported for this grid')
            });
        if (r.column) {
            n = p.find(".scroll");
            var z = $("#" + f.context.gridWrapperId).height() - 120;
            $(n).css({
                maxHeight: Math.min(350, z) + "px"
            });
            n.mCustomScrollbar({
                theme: "minimal-dark"
            });
            var F = $("#overlayShadow")
              , I = !1
              , E = function() {
                I = !I;
                if (!$("#productOverlay").is(":visible")) {
                    F.unbind("click.singleton");
                    if (I)
                        F.one("click.singleton", E);
                    F.toggle("fade", "fast")
                }
                p.find(".content-column").toggle()
            };
            p.find(".tool__column .trigger").on("click", E);
            p.find(".reset-all").on("click", function() {
                f.columnApi.resetColumnState();
                GridState.saveColumnState(f);
                "deals" === f.context.config.pageId && GridDeals.adjustColumnDisplay();
                F.toggle("fade", "fast");
                a(f)
            });
            p.find(".filter-columns").keyup(function() {
                var ua = $(this).val();
                (function() {
                    var na = new RegExp("\\b\\w*" + ua + "\\w*\\b","i");
                    $("p[data-search]").hide().filter(function() {
                        return na.test($(this).data("search"))
                    }).show()
                }
                )()
            });
            p.find('.scroll input[type="checkbox"]').on("change", function() {
                f.columnApi.setColumnVisible($(this).data("col-id"), $(this).prop("checked"))
            });
            p.find(".show-all,.hide-all").on("click", function() {
                var ua = $(this).hasClass("show-all")
                  , na = ".scroll p:visible input:checkbox:not(:checked)";
                ua || (na = ".scroll p:visible input:checkbox:checked:not(:disabled)");
                na = p.find(na);
                var qa = na.length - 1;
                if (-1 < qa) {
                    var ka = [];
                    na.each(function(za, J) {
                        $(J).prop("checked") !== ua && ($(J).prop("checked", ua),
                        ka.push($(J).data("col-id")));
                        za === qa && f.columnApi.setColumnsVisible(ka, ua)
                    })
                }
            });
            p.find(".open-presets").on("click", function() {
                E();
                GridState.openColumnPresetPopup(f)
            })
        }
        if (r.row) {
            n = document.querySelector(".mdc-menu");
            var K = new mdc.menu.MDCMenu(n);
            p.find(".tool__row .trigger").on("click", function() {
                if (K.open)
                    K.hide();
                else {
                    var ua = GridConfig.getRowCountOptions(f.context.config.type)
                      , na = 0;
                    "undefined" !== typeof ua && (na = ua.values.indexOf(f.context.config.currentRowsPerPage));
                    K.show({
                        focusIndex: na
                    })
                }
            });
            n.addEventListener("MDCMenu:selected", function(ua) {
                ua = parseInt(parseInt(ua.detail.item.dataset.value));
                GridApi.setRowsPerPage(f, ua)
            })
        }
        if (r.import)
            p.find(".tool__import .trigger").on("click", function() {
                "viewer" === f.context.pageId ? GridViewer.initImportPopup() : isTest && console.warn('GridTools "import" not yet supported for this grid')
            });
        if (r.export)
            p.find(".tool__export .trigger").on("click", function() {
                var ua = f.context.config.type
                  , na = t(f)
                  , qa = showPopup("Export Data", na.html, !0);
                na.onExport.done(function(ka) {
                    var za = $("#exportSubmit");
                    za.prop("disabled", !0);
                    za.html(la._600 + ' &ensp;<i class="fa fa-spinner fa-spin"></i>');
                    switch (ka.format) {
                    case "csv":
                        za = [];
                        if (ka.onlyLimited)
                            za = "seller" === ua ? ["sellerId"] : "offer" === ua ? ["externalLink"] : ["asin"];
                        else {
                            ka = ["checkboxSelection", "priceHistory", "stockHistory", "linkReviews"];
                            var J = f.columnApi.getColumnState();
                            for (var g in J) {
                                var D = J[g];
                                D.hide || ka.includes(D.colId) || za.push(D.colId)
                            }
                        }
                        J = GridApi.exportData(f, 0 < za.length ? {
                            columnKeys: za
                        } : {});
                        break;
                    case "xls":
                        J = "seller" === ua ? h(f, ka.onlyLimited) : "offer" === ua ? m(f, ka.onlyLimited) : d(f, ka.onlyLimited)
                    }
                    J.done(function() {
                        qa.close();
                        getBucketInformation()
                    }).fail(showErrorPopup)
                })
            });
        if (r.delete) {
            var H = function(ua) {
                var na = {};
                ua.api.forEachNode(function(qa) {
                    var ka = qa.data.asin;
                    qa = qa.data.domainId;
                    na[qa] = na[qa] || [];
                    na[qa].push(ka)
                });
                na.listId = ua.context.importListId || Guid.newGuid();
                na.includeInaccessibleAsins = ua.context.includeInaccessibleAsins || !1;
                ua = encodeURIComponent(JSON.stringify(na));
                window.location.hash = "!viewer" + (6E4 > ua.length ? "/" + ua : "");
                preOverlayUrl = window.location.hash
            }
              , V = $(".tool__delete > .trigger")
              , S = $($(".tool__delete > .trigger span")[0]);
            V.colorTip({
                color: "data"
            });
            V.on("click", function() {
                if (V.hasClass("undo"))
                    V.removeClass("undo"),
                    S.html('<i class="fa fa-trash-o fa-lg"></i>&ensp;Remove&emsp;'),
                    GridHelper.addContextMenu(f),
                    f.api.updateRowData({
                        add: f.context.deletedItems
                    }),
                    f.context.deletedItems = [],
                    H(f);
                else {
                    f.context.deletedItems = [];
                    var ua = f.api.getSelectedRows();
                    ua.length && (GridHelper.addContextMenu(f),
                    f.api.updateRowData({
                        remove: ua
                    }),
                    f.context.deletedItems = ua,
                    V.addClass("undo"),
                    S.html('<i class="fa fa-undo fa-lg"></i>&ensp;Undo&emsp;'),
                    setTimeout(function() {
                        V.removeClass("undo");
                        S.html('<i class="fa fa-trash-o fa-lg"></i>&ensp;Remove&emsp;')
                    }, 5E3),
                    H(f))
                }
            })
        }
        r.update && (n = $(".tool__update > .trigger"),
        n.colorTip({
            color: "data"
        }),
        n.on("click", function() {
            "viewer" === f.context.pageId ? GridViewer.initUpdatePopup() : isTest && console.warn('GridTools "update" not yet supported for this grid')
        }));
        if (r.range) {
            var aa = $(".tool__range .trigger");
            aa.on("click", function(ua) {
                aa.css({
                    "font-weight": "normal"
                });
                "buyBoxStatistics" === f.context.pageId ? (ua = $(ua.currentTarget),
                ua.css({
                    "font-weight": "500"
                }),
                ua = ua.data("range"),
                GridBuyBoxStatistics.updateInterval("all" == ua ? 99999 : ua)) : isTest && console.warn('GridTools "range" not yet supported for this grid')
            })
        }
        if (r.viewer)
            $(".tool__viewer > .trigger").on("click", function() {
                var ua = {};
                f.api.forEachNodeAfterFilterAndSort(function(na) {
                    ua[na.data.domainId] || (ua[na.data.domainId] = []);
                    ua[na.data.domainId].push(na.data.asin)
                });
                ua.listId = Guid.newGuid();
                window.open(getBaseUrl() + "#!viewer/" + encodeURIComponent(JSON.stringify(ua)), "_blank").focus()
            });
        if (r.track) {
            n = $(".tool__tracktoggle > .trigger");
            var ea = $(".tool__track > .trigger")
              , ra = !1;
            n.on("click", function() {
                ea.toggle();
                f.columnApi.setColumnVisible("checkboxSelection", !ra);
                "infinite" !== f.rowModelType ? ra ? f.api.deselectAll() : f.api.selectAllFiltered() : f.api.forEachNode(function(ua) {
                    ua.setSelected(!ra)
                });
                ra = !ra
            });
            ea.colorTip({
                color: "data"
            });
            ea.on("click", function() {
                var ua = [];
                f.api.getSelectedRows().forEach(function(qa) {
                    qa.asin && ua.push(qa.asin)
                });
                if (ua.length)
                    network.request({
                        path: "user/trackingoverview",
                        perPage: maxTrackingAllowed,
                        startIndex: -1,
                        version: 3
                    }).done(function(qa) {
                        var ka = qa.maxTrackingAllowed ? qa.maxTrackingAllowed : maxTrackingAllowed;
                        qa.trackingCount && ka - qa.trackingCount < ua.length ? showPopup(la._916.replace("#selectedAsinCount#", ""), '<div class="popup--medium popup--medium-fixed">\n\t\t\t\t\t\t\t\t\t<p class="mdc-typography--body2">' + la._920.replace("#maxTrackingAllowed#", maxTrackingAllowed) + '</p>\n\t\t\t\t\t\t\t\t\t<p class="mdc-typography--body2">' + la._922.replace("#trackingCount#", qa.trackingCount).replace("#selectedAsinCount#", ua.length) + '</p>\n\t\t\t\t\t\t\t\t\t<p class="mdc-typography--body2"><a href="#!manage" class="href"><i class="fa fa-angle-double-right"></i> ' + la._20 + '</a></p>\n\t\t\t\t\t\t\t\t\t<p class="mdc-typography--body2"><b>' + la._921 + "</b></p>\n\t\t\t\t\t\t\t\t</div>", !0) : "variation" === f.context.pageId ? ($("#grid-tools-" + f.context.pageId).hide(),
                        $("#" + f.context.gridWrapperId).hide(),
                        $("#" + f.context.gridWrapperId + "-filter").hide(),
                        $("#" + f.context.gridWrapperId + "-tracking").show(),
                        TrackingComponent.initList({
                            asinList: ua,
                            domainId: Number(storage.domain),
                            containerId: f.context.gridWrapperId + "-tracking",
                            showAsPopup: !1
                        })) : TrackingComponent.initList({
                            asinList: ua,
                            domainId: Number(storage.domain),
                            containerId: "tracklist",
                            showAsPopup: !0
                        })
                    }).fail(showErrorPopup);
                else {
                    var na = la._917;
                    "inMemory" === f.rowModelType && (na += " " + la._923);
                    showPopup(la._916.replace("#selectedAsinCount#", ""), '<div class="popup--medium popup--medium-fixed">\n\t\t\t\t\t\t\t<p class="mdc-typography--body2">' + la._918 + '</p>\n\t\t\t\t\t\t\t<p class="mdc-typography--body2">' + na + "</p>\n\t\t\t\t\t\t</div>", !0)
                }
            })
        }
        if (r.filterinfo)
            p.find(".tool__filterinfo .trigger").on("click", GridFinder.showFilterInfo);
        if (r.query)
            p.find(".tool__query .trigger").on("click", GridFinder.showApiQuery);
        if (r.graph) {
            var pa = $(".tool__graph .trigger");
            pa.on("click", function(ua) {
                pa.css({
                    "font-weight": "normal"
                });
                "offer" === f.context.pageId ? (ua = $(ua.currentTarget),
                ua.css({
                    "font-weight": "500"
                }),
                ua = ua.data("range"),
                GridOffer.updateGraphIntervalData("all" == ua ? -1 : 24 * ua)) : isTest && console.warn('GridTools "graph" not yet supported for this grid')
            })
        }
    }
      , d = function(f, n) {
        return $.Deferred(function(r) {
            setTimeout(function() {
                var p = [];
                if (n)
                    p = ["asin"];
                else {
                    var z = ["checkboxSelection", "linkReviews"]
                      , F = f.columnApi.getColumnState();
                    for (V in F) {
                        var I = F[V];
                        I.hide || z.includes(I.colId) || p.push(I.colId)
                    }
                }
                var E = []
                  , K = []
                  , H = [];
                "infinite" == f.rowModelType ? f.api.forEachNode(function(S) {
                    S = S.data;
                    if ("undefined" !== typeof S && null !== S.asin) {
                        var aa = S.title && 1 < S.title.length ? S.title[0] + S.title[S.title.length - 1] : "";
                        E.push(S.asin);
                        K.push(S.domainId);
                        H.push(aa)
                    }
                }) : f.api.forEachNodeAfterFilterAndSort(function(S) {
                    S = S.data;
                    if ((3 !== S.productType || f.context.includeInaccessibleAsins) && 4 !== S.productType && null !== S.asin) {
                        var aa = S.title && 1 < S.title.length ? S.title[0] + S.title[S.title.length - 1] : "";
                        E.push(S.asin);
                        K.push(S.domainId);
                        H.push(aa)
                    }
                });
                if (0 >= E.length)
                    r.resolve();
                else {
                    z = GridHelper.getCurrentUnitSystem();
                    F = f.context.statsStart || Number(storage.lastViewerVisit) || Date.now();
                    var V = f.context.statsEnd || Date.now();
                    7E4 > V - F && (F = V - 7E4);
                    network.request({
                        path: "pro/export",
                        fileType: "XLSX",
                        type: "product",
                        domainBatch: K,
                        asinBatch: E,
                        keyBatch: H,
                        currency: currencyDomainId,
                        columns: p,
                        unit: z,
                        stats: F + "," + V,
                        version: 3
                    }).done(function(S) {
                        r.resolve();
                        var aa = "Keepa_ASIN_Export." + (new Date).formatDate("Y_m_j") + "." + E.length + "_products";
                        null != S.hash ? document.location = "https://" + window.server[0] + "/v2/service/download/?type=xlsx&hash=" + S.hash + "&name=" + encodeURIComponent(aa) : showErrorPopup()
                    }).fail(showErrorPopup)
                }
            }, 0)
        }).promise()
    }
      , h = function(f, n) {
        return $.Deferred(function(r) {
            setTimeout(function() {
                var p = [];
                if (n)
                    p = ["sellerId"];
                else {
                    var z = f.columnApi.getColumnState(), F;
                    for (F in z) {
                        var I = z[F];
                        I.hide || p.push(I.colId)
                    }
                }
                var E = Number(storage.domain)
                  , K = []
                  , H = [];
                f.api.forEachNodeAfterFilterAndSort(function(V) {
                    V = V.data;
                    K.push(V.sellerId);
                    H.push(V.rank)
                });
                null == E || 0 >= K.length ? r.resolve() : network.request({
                    path: "pro/export",
                    fileType: "XLSX",
                    type: "seller",
                    domainId: E,
                    sellerIdBatch: K,
                    sellerRankBatch: H,
                    columns: p,
                    version: 3
                }).done(function(V) {
                    r.resolve();
                    var S = document.title.replace(" - ", "_").replace(/ /g, "_") + "." + (new Date).formatDate("Y_m_j") + "." + getTldByDomain(E) + "_" + K.length + "_sellers";
                    null != V.hash ? document.location = "https://" + window.server[0] + "/v2/service/download/?type=xlsx&hash=" + V.hash + "&name=" + encodeURIComponent(S) : showErrorPopup()
                }).fail(showErrorPopup)
            }, 0)
        }).promise()
    }
      , m = function(f, n) {
        return $.Deferred(function(r) {
            setTimeout(function() {
                var p = [];
                if (n)
                    p = ["externalLink"];
                else {
                    var z = f.columnApi.getColumnState(), F;
                    for (F in z) {
                        var I = z[F];
                        I.hide || "priceHistory" == I.colId || "stockHistory" == I.colId || p.push(I.colId)
                    }
                }
                var E = null
                  , K = ""
                  , H = [];
                f.api.forEachNodeAfterFilterAndSort(function(V) {
                    V = V.data;
                    E || (E = V.domainId);
                    K || (K = V.asin);
                    H.push(V.offerId)
                });
                null == E || 0 >= H.length ? r.resolve() : network.request({
                    path: "pro/export",
                    fileType: "XLSX",
                    type: "offer",
                    domainId: E,
                    asin: K,
                    offerIdBatch: H,
                    columns: p,
                    version: 3
                }).done(function(V) {
                    r.resolve();
                    var S = (new Date).formatDate("Y_m_j") + "." + getTldByDomain(E) + "_" + K + "_offers";
                    null != V.hash ? document.location = "https://" + window.server[0] + "/v2/service/download/?type=xlsx&hash=" + V.hash + "&name=" + encodeURIComponent(S) : showErrorPopup()
                }).fail(showErrorPopup)
            }, 0)
        }).promise()
    }
      , t = function(f) {
        var n = $.Deferred()
          , r = "seller" === f.context.config.type
          , p = "offer" === f.context.config.type
          , z = r ? "sellerIdCh" : p ? "deeplinkCh" : "asinCh"
          , F = "variation" == f.context.pageId && !hasDataAccessSubscription
          , I = "csv" === storage.exportFormat || F
          , E = "allCh" === storage.exportSelection && !F;
        r = material.getRadio(z, r ? "Only seller ids" : p ? "Only offer deeplink" : "Only ASINs", !E, "type", !1);
        E = material.getRadio("allCh", "All active columns", E, "type", F);
        p = material.getRadio("csv", "CSV", I, "format", !1);
        I = material.getRadio("xls", "Excel (.xlsx)", !I, "format", F);
        var K = material.getButton("exportSubmit", "Export", null, "download");
        f = '<div style="width:400px;margin-bottom:10px;">Export the table in the currently displayed order.</div>\n\t\t\t\t\t<form name="loadForm" id="exportForm">\n\t\t\t\t\t\t<div class="mdc-typography--caption" style="margin-top:15px;">What to export?</div>\n\t\t\t\t\t\t<section id="typeRadio" style="width: 400px">' + E + r + '</section>\n\t\t\t\t\t\t<div class="mdc-typography--caption" style="margin-top:15px;">What format should the export have?</div>\n\t\t\t\t\t\t<section id="formatRadio" style="width: 400px">' + I + p + "</section>\n\t\t\t\t\t\t<br>\n\t\t\t\t\t\t" + K + "\n\t\t\t\t\t\t" + ("finder" === f.context.pageId ? '<p style="margin-top:20px;"><i class="fa fa-info-circle" style="color:tomato;"></i>&ensp;\n\t\t\t\t\t\t\tNote: The export contains only the currently displayed page (not all possible results).\n\t\t\t\t\t\t</p>' : "") + "\n\t\t\t\t\t\t" + ("variation" === f.context.pageId && F ? '<p style="margin-top:20px;"><i class="fa fa-info-circle"></i>&ensp;\n\t\t\t\t\t\t\tNote: <a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to get access to all export options and full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>.\n\t\t\t\t\t\t</p>" : "") + "\n\t\t\t\t\t</form>";
        material.init("#exportForm");
        setTimeout(function() {
            $("#exportForm").on("submit", function(H) {
                var V = $("#formatRadio").find(":checked")[0].id.substr(0, 3)
                  , S = $("#typeRadio").find(":checked")[0].id == z + "-radio" || F;
                storage.exportFormat = F ? "csv" : V;
                storage.exportSelection = S ? "" : "allCh";
                n.resolve({
                    format: V,
                    onlyLimited: S
                });
                H.preventDefault()
            })
        }, 0);
        return {
            onExport: n.promise(),
            html: f
        }
    };
    return {
        init: a,
        setInfoBlock: function(f, n) {
            f = $("#grid-tools-" + f + " .tool__info");
            f.length && n.length && f.html(n)
        },
        updateResults: function(f, n, r) {
            f = $("#grid-tools-" + f + " .tool__results");
            if (f.length) {
                var p = "";
                n && r ? p = '<i class="fa fa-info-circle fa-lg"></i>&ensp;Displaying <b>' + NumberUtil.format(n) + "</b> rows (out of a total result of " + NumberUtil.format(r) + ")&emsp;" : n && (p = '<i class="fa fa-info-circle fa-lg"></i>&ensp;Displaying <b>' + NumberUtil.format(n) + "</b> rows &emsp;");
                f.html(p)
            }
        }
    }
}()
  , GridBestSeller = function() {
    var a, b = {
        pageId: "bestseller",
        resizeToViewport: !0,
        showTools: {
            column: !0,
            columnPresets: !0,
            export: !0,
            row: !0,
            track: GridConfig.gridTypesWithCheckboxSelection.includes("asin")
        },
        template: "asin",
        title: "Best Sellers List",
        type: "asin"
    }, d = function(t) {
        var f = lastSubUrl.split("-")
          , n = f[0]
          , r = decodeURIComponent(f[1].trim())
          , p = f[2] && [0, 30, 90, 180].includes(Number(f[2])) ? Number(f[2]) : 0;
        if (2 > f.length || 3 < f.length || !verifyRegExp.domainId.test(n) || "" == r)
            h();
        else {
            var z = isNaN(r);
            h(!1, null, r, p);
            var F = GridApi.getRowsPerPage(t);
            [30, 90, 180].includes(p) ? t.api.setSortModel([{
                colId: "SALES_avg" + p,
                sort: "asc"
            }]) : t.api.setSortModel([{
                colId: "SALES_current",
                sort: "asc"
            }]);
            network.request({
                path: "pro/bestseller",
                domainId: n,
                bestSellerKey: r,
                bestSellerRange: p,
                page: 0,
                perPage: F,
                version: 3
            }).done(function(I) {
                var E = I.queryResult;
                "undefined" == typeof E || 0 === I.listSize ? (429 == I.status ? (showPopup("Quota exceeded", quotaExceeded, !0),
                h(!0),
                addDataUpdateHandler()) : showPopup("No products found", "Sorry, no products found for this category / product group.", !0),
                GridApi.setData(t, [])) : networkHelper.loadASINs({
                    history: !1,
                    includeDeals: !0,
                    maxAge: 60,
                    offerPages: 0,
                    path: "pro/product",
                    refreshProduct: !1,
                    type: "bestseller"
                }, E, ".loadingFlipper").done(function(K) {
                    m(n, K, r, F)
                }).fail(function(K) {
                    if (429 == K.status) {
                        var H = quotaExceeded;
                        "undefined" != typeof K.products && 0 < K.products.length ? (H += "<br>" + quotaLastedFor.replace("#count#", 10 < K.products.length ? 10 * Math.round(K.products.length / 10) : K.products.length).replace("#type#", "products"),
                        showPopup("Quota exceeded", H, !0),
                        m(n, K.products, r, F)) : (showPopup("Quota exceeded", H, !0),
                        h(!0));
                        addDataUpdateHandler()
                    } else
                        showErrorPopup("Status: " + K.status)
                })
            }).fail(function(I) {
                z || network.request({
                    path: "pro/category",
                    domainId: n,
                    categoryIds: [r],
                    version: 3
                }).done(function(E) {
                    E = E.categories[r].name;
                    429 == I.status ? (showPopup("Quota exceeded", quotaExceeded, !0),
                    h(!0),
                    addDataUpdateHandler()) : h(!0, E, r)
                }).fail(showErrorPopup)
            })
        }
    }, h = function(t, f, n, r) {
        t = void 0 === t ? !0 : t;
        if (!(0 < $(".category-wrapper").length) || t) {
            var p = Number(storage.domain);
            n && GridApi.getRowsPerPage(a);
            r = r || 0;
            var z = function(K, H) {
                GridHelperCategory.setRootHashMap(p, K.categories);
                var V;
                for (V in K.categories)
                    if (V !== H) {
                        var S = K.categories[V];
                        F.push({
                            catId: S.catId,
                            domainId: S.domainId,
                            name: S.name
                        })
                    }
            }
              , F = []
              , I = network.request({
                path: "pro/category",
                domainId: p,
                categoryIds: [-1],
                version: 3
            }).done(function(K) {
                z(K, n ? n : !1)
            })
              , E = n && !isNaN(n) ? network.request({
                path: "pro/category",
                domainId: p,
                categoryIds: [n],
                version: 3
            }).done(function(K) {
                z(K)
            }) : $.Deferred().resolve();
            $.when(I, E).done(function() {
                n && isNaN(n) && F.push({
                    catId: n,
                    domainId: p,
                    name: n
                });
                F.sort(function(ea, ra) {
                    ea = ea.name.toUpperCase();
                    ra = ra.name.toUpperCase();
                    return ea < ra ? -1 : ea > ra ? 1 : 0
                });
                var K = getBaseUrl()
                  , H = '<div class="card m-b-20 p-x-15 p-y-10">\n                <div class="category-wrapper">';
                f && (H += "<span>" + la._658.replace("{NAME}", f) + '</span><hr class="-purple">');
                F.forEach(function(ea) {
                    var ra = ""
                      , pa = "";
                    ea.catId == n && (ra = ' class="mdc-typography--body2" style="color:#000;font-weight:500;"',
                    pa = ' id="activeCategory"');
                    H += "<a" + pa + ' href="' + K + "#!bestseller/" + ea.domainId + "-" + ea.catId + (0 < r ? "-" + r : "") + '" ' + ra + ">" + ea.name + "</a> "
                });
                n && (H += '<hr class="-purple"><span>Sales Rank interval:</span>\n\t\t\t\t\t' + material.getRadio("bestSellerRange0", la._344, 0 === r, "bestSellerRange", !1, 0) + "\n\t\t\t\t\t" + material.getRadio("bestSellerRange30", "30 days avg.", 30 === r, "bestSellerRange", !1, 30) + "\n\t\t\t\t\t" + material.getRadio("bestSellerRange90", "90 days avg.", 90 === r, "bestSellerRange", !1, 90) + "\n\t\t\t\t\t" + material.getRadio("bestSellerRange180", "180 days avg.", 180 === r, "bestSellerRange", !1, 180) + "\n\t\t\t\t");
                H += "</div>\n\t\t\t\t</div>\n\t\t\t";
                t ? (H += '<div class="card m-b-20 p-15">\n                        <p class="mdc-typography--body2 -center">' + la._943 + "</p>\n                    </div>",
                replaceHtml("bodyPanel", H)) : $("#grid-form-bestseller").before(H);
                for (var V = function(ea) {
                    ea = parseInt(ea.target.value);
                    window.location.hash = "#!bestseller/" + p + "-" + n + (0 < ea ? "-" + ea : "")
                }, S = $('input[name^="bestSellerRange"]'), aa = 0; aa < S.length; aa++)
                    S[aa].addEventListener("focus", V)
            }).fail(showErrorPopup)
        }
    }, m = function(t, f, n) {
        GridHelperCategory.load(f).done(function() {
            for (var r = 0; r < f.length; r++)
                f[r] = GridHelper.prepareProduct(f[r]);
            delete a.context.config.perPage;
            replaceHtml("activeCategory", GridHelperCategory.getName(t, n));
            GridApi.setData(a, f)
        })
    };
    return {
        init: function() {
            var t = lastSubUrl.split("-")
              , f = t[0];
            if (2 > t.length || 3 < t.length || !verifyRegExp.domainId.test(f) || "" == t[1].trim())
                $("#contentAlign").css({
                    marginRight: "40px",
                    marginLeft: "40px",
                    marginTop: "160px",
                    minWidth: "420px",
                    width: $(window).width() - 80 + "px"
                }),
                h();
            else
                return GridApi.load().then(function() {
                    var n = GridConfig.get(b.type);
                    n.pageId = b.pageId;
                    hasDataAccessSubscription || (n.gridOptions.pinnedBottomRowData = [{
                        freeAccessRow: !0,
                        message: '<a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to view up to 5000 rows and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>."
                    }]);
                    b.gridWrapperId = n.gridWrapperId;
                    GridPage.init(b);
                    GridPage.initGridContainer(n);
                    a = GridApi.init(n);
                    null !== a && (a.context.config = b,
                    !1 !== b.showTools && GridTools.init(a),
                    d(a))
                }).fail(showErrorPopup)
        },
        initData: d
    }
}()
  , GridBuyBoxStatistics = function() {
    var a, b = {
        pageId: "buyBoxStatistics",
        resizeToIframeTab: !0,
        showTools: {
            info: !0,
            range: !0,
            rangeConfig: {
                options: [30, 90, 180, 365],
                default: 30
            },
            results: !0
        },
        template: "buyBoxStatistics",
        type: "buyBoxStatistics"
    }, d, h, m, t, f, n = function(p) {
        d = p.products[0];
        h = p.sellers;
        m = d.buyBoxSellerIdHistory || [];
        t = d.csv[CsvType.BUY_BOX_SHIPPING.index] || [];
        f = d.csv[CsvType.COUNT_NEW.index] || [];
        p = keepaTime.now();
        var z = Math.ceil(p - Number(m[0]))
          , F = Math.ceil(z / 1440);
        p - changeV5 < 1440 * a.context.config.showTools.rangeConfig.default ? (z = p - changeV5,
        F = Math.ceil(z / 1440),
        a.context.config.showTools.rangeConfig.default = F,
        a.context.config.showTools.rangeConfig.options = [F]) : p - changeV5 < p - Number(m[0]) && (z = p - changeV5,
        F = Math.ceil(z / 1440));
        isTest && console.info("%cBuy Box History \u27fc oldestBuyBoxAgeInDays", "color:orange;", F);
        !1 !== a.context.config.showTools && (GridTools.init(a),
        GridTools.setInfoBlock(a.context.config.pageId, "The buy box can be shared between multiple sellers. The following table gives an overview of the percentage each seller held the New buy box."));
        p = $(".tool__range .trigger");
        var I = !1;
        p.css({
            "font-weight": "normal"
        });
        p.each(function(E, K) {
            E = $(K).data("range");
            "all" != E && (F > E ? $(K).css({
                display: ""
            }) : ($(K).css({
                display: I ? "none" : ""
            }),
            I = !0))
        });
        a.context.config.showTools.rangeConfig.options.includes(F) ? $('.tool__range .trigger[data-range="' + F + '"]').css({
            "font-weight": "500"
        }) : $('.tool__range .trigger[data-range="' + a.context.config.showTools.rangeConfig.default + '"]').css({
            "font-weight": "500"
        });
        r(a.context.config.showTools.rangeConfig.default, !0)
    }, r = function(p, z) {
        var F = keepaTime.now();
        p = getWeightedMeanSellerInInterval(m, t, f, p);
        0 === Object.keys(p).length && !0 === z && replaceHtml(b.containerId, "No Buy Box seller data available.");
        z = [];
        for (var I = {}, E = {}, K = m.length - 1; 0 <= K; E = {
            $jscomp$loop$prop$sellerId$710: E.$jscomp$loop$prop$sellerId$710
        },
        K -= 2)
            if (E.$jscomp$loop$prop$sellerId$710 = m[K],
            !I[E.$jscomp$loop$prop$sellerId$710] && !["-1", "-2"].includes(E.$jscomp$loop$prop$sellerId$710)) {
                var H = h[E.$jscomp$loop$prop$sellerId$710] || {}
                  , V = H.csv || []
                  , S = p[E.$jscomp$loop$prop$sellerId$710] || null
                  , aa = isSellerIdAmazon(E.$jscomp$loop$prop$sellerId$710, d.domainId);
                aa && (H.sellerName = "Amazon");
                var ea = null
                  , ra = d.offers.filter(function(na) {
                    return function(qa) {
                        return qa.sellerId === na.$jscomp$loop$prop$sellerId$710
                    }
                }(E));
                ra && (1 !== ra.length && ra.sort(function(na, qa) {
                    return qa.lastSeen - na.lastSeen
                }),
                ea = ra[0]);
                ra = !1;
                var pa = null
                  , ua = null;
                ea && (ra = ea.isFBA,
                ea.lastSeen && 1440 >= F - ea.lastSeen && ea.stockCSV && (pa = ea.stockCSV[ea.stockCSV.length - 1],
                ua = ea.stockLimit));
                I[E.$jscomp$loop$prop$sellerId$710] = {
                    domainId: d.domainId,
                    sellerId: E.$jscomp$loop$prop$sellerId$710,
                    sellerName: H ? H.sellerName : "(just launched)",
                    currentRating: H.currentRating ? H.currentRating : V[0] ? V[0][V[0].length - 1] : -1,
                    currentRatingCount: H.currentRatingCount ? H.currentRatingCount : V[1] ? V[1][V[1].length - 1] : -1,
                    lastSeen: S ? S.lastSeen : -1,
                    percentageWon: S ? S.pct : -1,
                    avgPrice: S ? S.price : -1,
                    avgNewOfferCount: S ? S.oc : -1,
                    isAmazon: aa,
                    isFBA: ra,
                    stock: pa,
                    stockLimit: ua
                };
                0 < I[E.$jscomp$loop$prop$sellerId$710].percentageWon && z.push(I[E.$jscomp$loop$prop$sellerId$710])
            }
        GridApi.setData(a, z);
        a.context.config.showTools.results && GridTools.updateResults(a.context.pageId, z.length);
        F = $("#" + a.context.gridWrapperId);
        I = GridConfig.rowHeight.balham;
        E = 2 * GridConfig.rowHeight.balham + a.scrollbarWidth;
        z.length && (E += Math.min(25, z.length) * I);
        F.height(E);
        isTest && (F = z.reduce(function(na, qa) {
            return na + (0 < qa.percentageWon ? qa.percentageWon : 0)
        }, 0),
        console.info("%cBuy Box History \u27fc weightedMeanSellerInInterval", "color:green;", p),
        console.info("%cBuy Box History \u27fc rowData", "color:orange;", z),
        console.info("%cBuy Box History \u27fc totalPercentageWon", "color:orange;", F))
    };
    return {
        init: function(p, z) {
            return GridApi.load().then(function() {
                var F = GridConfig.get(b.type);
                F.pageId = b.pageId;
                b.gridWrapperId = F.gridWrapperId;
                z ? (b.containerId = z,
                GridPage.initContainer(b)) : GridPage.init(b);
                GridPage.initGridContainer(F);
                a = GridApi.init(F);
                null !== a && (a.context.config = b,
                n(p))
            }).fail(showErrorPopup)
        },
        updateInterval: function(p) {
            GridHelper.addContextMenu(a);
            r(p)
        }
    }
}()
  , GridCasin = function() {
    var a, b = {
        pageId: "casin",
        showTools: !1,
        template: "casin",
        type: "casin"
    }, d = function(m, t) {
        a.context.mainDomainId = t;
        if (m.length) {
            GridApi.setData(a, m);
            t = {};
            for (var f = $jscomp.makeIterator(["BUY_BOX_SHIPPING_current", "AMAZON_current", "NEW_current", "USED_current"]), n = f.next(); !n.done; t = {
                $jscomp$loop$prop$field$712: t.$jscomp$loop$prop$field$712
            },
            n = f.next())
                if (t.$jscomp$loop$prop$field$712 = n.value,
                m.some(function(r) {
                    return function(p) {
                        return null != p[r.$jscomp$loop$prop$field$712] && -1 != p[r.$jscomp$loop$prop$field$712]
                    }
                }(t))) {
                    a.api.setSortModel([{
                        colId: t.$jscomp$loop$prop$field$712,
                        sort: "asc"
                    }]);
                    break
                }
        }
    }, h = function(m) {
        var t = [];
        t[CsvType.BUY_BOX_SHIPPING.index] = m.lowestBBDomain;
        t[CsvType.AMAZON.index] = m.lowestAmazonDomain;
        t[CsvType.NEW.index] = m.lowestNewDomain;
        t[CsvType.USED.index] = m.lowestUsedDomain;
        return m.map(function(f) {
            return GridHelper.prepareProductCasin(f, t)
        }).filter(function(f) {
            return f
        })
    };
    return {
        init: function(m, t, f) {
            return GridApi.load().then(function() {
                m = h(m);
                var n = GridConfig.get(b.type);
                n.pageId = b.pageId;
                b.gridWrapperId = n.gridWrapperId;
                f ? (b.containerId = f,
                GridPage.initContainer(b)) : GridPage.init(b);
                GridPage.initGridContainer(n);
                a = GridApi.init(n);
                null !== a && (a.context.config = b,
                !1 !== b.showTools && GridTools.init(a),
                $("#" + a.context.gridWrapperId).height((Math.max(m.length, 3) + 1) * GridConfig.rowHeight.balham + 1),
                d(m, t))
            }).fail(showErrorPopup)
        }
    }
}()
  , GridCategoryTree = function() {
    var a, b = {
        pageId: "categorytree",
        resizeToViewport: !0,
        showTools: !1,
        template: "category",
        title: "Category Tree",
        type: "category"
    }, d = [], h = function() {
        var m = Number(storage.domain);
        a.api.setServerSideDatasource({
            getRows: function(t) {
                var f = 0 === t.request.groupKeys.length ? [-1] : t.parentNode.data.children;
                null === f || 0 === f.length ? t.successCallback([], 0) : network.request({
                    path: "pro/category",
                    domainId: m,
                    categoryIds: f,
                    version: 3
                }).done(function(n) {
                    n = n.categories;
                    var r = [], p;
                    for (p in n) {
                        var z = n[p];
                        if (0 === z.parent)
                            d.push(Number(p));
                        else if (d.includes(z.parent) && (null === z.children || 0 === z.children.length || 0 === z.productCount))
                            continue;
                        for (var F = {
                            catId: z.catId,
                            children: z.children,
                            domainId: z.domainId,
                            parent: z.parent,
                            productCount: z.productCount,
                            highestRank: z.highestRank
                        }, I = 1; 20 >= I; I++)
                            F["name" + I] = z.name;
                        r.push(F)
                    }
                    r.sort(function(E, K) {
                        E = E.name1.toUpperCase();
                        K = K.name1.toUpperCase();
                        return E < K ? -1 : E > K ? 1 : 0
                    });
                    t.successCallback(r, r.length)
                }).fail(function(n) {
                    showErrorPopup(n.msg);
                    t.failCallback()
                })
            }
        })
    };
    return {
        depth: 20,
        init: function() {
            return GridApi.load().then(function() {
                var m = GridConfig.get(b.type);
                m.pageId = b.pageId;
                b.gridWrapperId = m.gridWrapperId;
                GridPage.init(b);
                GridPage.initGridContainer(m);
                a = GridApi.init(m);
                null !== a && (a.context.config = b,
                !1 !== b.showTools && GridTools.init(a),
                h())
            }).fail(showErrorPopup)
        }
    }
}()
  , GridDeals = function() {
    var a, b = {
        pageId: "deals",
        resizeToViewport: !0,
        showTools: {
            column: !0,
            results: !0,
            track: GridConfig.gridTypesWithCheckboxSelection.includes("asinDeals")
        },
        template: "asin",
        title: "Deals",
        type: "asinDeals"
    }, d = function(p) {
        var z = []
          , F = a.cacheBlockSize ? a.cacheBlockSize : 150;
        a.api.setDatasource({
            rowCount: null,
            getRows: function(I) {
                a.api && a.api.showLoadingOverlay();
                p.page = I.startRow / F;
                p.perPage = F;
                66 == p.page && (p.perPage = 100);
                network.request({
                    path: "service/deals",
                    type: "ws",
                    version: 3,
                    dealRequest: $.extend(!0, {}, JSON.parse(JSON.stringify(p))),
                    includeData: !0
                }).done(function(E) {
                    if (E.error)
                        I.failCallback(),
                        showErrorPopup("[" + E.error.type + "] " + E.error.message);
                    else {
                        try {
                            0 == p.page && ("undefined" !== typeof E.deals.categoryIds && dealWrapperInstance.get().formatCategories(E.deals.categoryIds, E.deals.categoryNames, E.deals.categoryCount),
                            GridPage.resizeToViewPort(b))
                        } catch (aa) {
                            console.log(aa)
                        }
                        if ("undefined" === typeof E.deals.dr || 0 == E.deals.dr.length)
                            I.successCallback([], 0),
                            a.api.hideOverlay(),
                            showPopup("No results found", "Sorry, no products found in this selection. Try resetting it.", !0);
                        else {
                            var K = {}, H;
                            for (H in E.deals.dr) {
                                K.$jscomp$loop$prop$idx$714 = H;
                                if (-1 < z.indexOf(E.deals.dr[K.$jscomp$loop$prop$idx$714].asin)) {
                                    if (Array.prototype.findIndex) {
                                        var V = E.products.findIndex(function(aa) {
                                            return function(ea) {
                                                return ea && ea.asin === E.deals.dr[aa.$jscomp$loop$prop$idx$714].asin
                                            }
                                        }(K));
                                        -1 < V && (E.products[V] = null)
                                    }
                                    E.deals.dr[K.$jscomp$loop$prop$idx$714] = null
                                } else
                                    z.push(E.deals.dr[K.$jscomp$loop$prop$idx$714].asin);
                                K = {
                                    $jscomp$loop$prop$idx$714: K.$jscomp$loop$prop$idx$714
                                }
                            }
                            K = E.products.filter(function(aa) {
                                return null != aa
                            });
                            hasDataAccessSubscription || (E.totalResults = GridConfig.maxRowsFreeUser,
                            K = K.splice(0, 5));
                            var S = Math.min(E.totalResults, 1E4);
                            h(K, E.deals.dr, 0 < Math.floor(S / F) - p.page ? 150 : S - p.page * F).done(function(aa) {
                                GridHelper.addContextMenu(a);
                                I.successCallback(aa, S);
                                a.api && (a.api.hideOverlay(),
                                !0 === a.pagination && 1 === a.api.paginationGetTotalPages() && $(".ag-paging-page-summary-panel").hide())
                            })
                        }
                    }
                }).fail(function(E) {
                    showErrorPopup(E.msg);
                    I.failCallback()
                })
            }
        })
    }, h = function(p, z, F) {
        return $.Deferred(function(I) {
            if (0 == p.length)
                I.resolve(p);
            else {
                if (p.length < F) {
                    for (var E = f(), K; m.length < CsvType.length; )
                        m.push(-1),
                        t.push(null);
                    for (K = {
                        asin: null,
                        domainId: null,
                        stats: {
                            avg30: m,
                            avg90: m,
                            avg180: m,
                            current: m,
                            min: t,
                            max: t,
                            outOfStockPercentage90: m
                        }
                    }; p.length < F; )
                        p.push(K);
                    z.push(E)
                }
                GridHelperCategory.load(p).done(function() {
                    for (var H = {
                        $jscomp$loop$prop$i$717: 0
                    }; H.$jscomp$loop$prop$i$717 < p.length; H = {
                        $jscomp$loop$prop$i$717: H.$jscomp$loop$prop$i$717
                    },
                    H.$jscomp$loop$prop$i$717++) {
                        p[H.$jscomp$loop$prop$i$717].deal = z.find(function(S) {
                            return function(aa) {
                                return aa && aa.asin === p[S.$jscomp$loop$prop$i$717].asin
                            }
                        }(H));
                        p[H.$jscomp$loop$prop$i$717] = GridHelper.prepareProduct(p[H.$jscomp$loop$prop$i$717]);
                        p[H.$jscomp$loop$prop$i$717].isVisited = !1;
                        var V = p[H.$jscomp$loop$prop$i$717].domainId + "-" + p[H.$jscomp$loop$prop$i$717].asin;
                        sessionStorage[V] ? p[H.$jscomp$loop$prop$i$717].isVisited = !0 : databaseDeals && databaseDeals.getItem(V).then(function(S) {
                            return function(aa) {
                                p[S.$jscomp$loop$prop$i$717].isVisited = !!aa
                            }
                        }(H)).catch(function(S) {})
                    }
                    I.resolve(p)
                })
            }
        }).promise()
    }, m = [], t = [], f = function() {
        for (; m.length < CsvType.length; )
            m.push(-1),
            t.push(null);
        var p = [m, m, m, m];
        return {
            asin: null,
            avg: p,
            delta: p,
            deltaPercent: p
        }
    }, n = function(p) {
        var z = CsvType.getObjectName(p.priceTypes[0]);
        p = [1, 7, 30, 90, "all"][p.dateRange];
        var F = [];
        "all" === p ? (F.push(z + "_deltaPercent1"),
        F.push(z + "_deltaPercent7"),
        F.push(z + "_deltaPercent30"),
        F.push(z + "_deltaPercent90")) : F.push(z + "_deltaPercent" + p);
        return {
            filterFields: F,
            csvTypeName: z
        }
    }, r = function(p) {
        p = "undefined" === typeof p ? a.context.columnSettings : p;
        var z = a.columnApi
          , F = z.getAllGridColumns()
          , I = []
          , E = [];
        F.forEach(function(K) {
            GridHelper.getCsvObjectName(K.colId) === p.csvTypeName ? E.push(K.colId) : K.pinned && I.push(K.colId)
        });
        E.push("imagesCSV");
        z.setColumnsPinned(I, !1);
        z.setColumnsPinned(E, "left");
        z.moveColumn("imagesCSV", F.length - 1)
    };
    return {
        init: function(p, z) {
            $("#loadingIcon").hide();
            return GridApi.load().then(function() {
                var F = n(p)
                  , I = GridConfig.get(b.type, F);
                I.pageId = b.pageId;
                I.gridOptions.getRowStyle = function(E) {
                    return "undefined" === typeof E.data ? null : E.data.isVisited ? {
                        opacity: storage.dealsOpacity || .5
                    } : null
                }
                ;
                hasDataAccessSubscription || (I.gridOptions.pagination = !1,
                I.gridOptions.paginationPageSize = GridConfig.maxRowsFreeUser,
                I.gridOptions.pinnedBottomRowData = [{
                    freeAccessRow: !0,
                    message: '<a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to view all deals in our advanced table view and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>."
                }]);
                b.gridWrapperId = I.gridWrapperId;
                z ? (b.containerId = z,
                GridPage.initContainer(b)) : GridPage.init(b);
                GridPage.initGridContainer(I);
                a = GridApi.init(I);
                if (null === a) {
                    F = "";
                    try {
                        F = {
                            error: "gridApi is null",
                            pageConfig: JSON.stringify(b)
                        },
                        F = JSON.stringify(F)
                    } catch (E) {}
                    reportBug(Error(), F ? F : "gridApi is null")
                } else
                    r(F),
                    a.context.config = b,
                    !1 !== b.showTools && GridTools.init(a),
                    a.context.columnSettings = F,
                    d(p)
            }).fail(showErrorPopup)
        },
        adjustColumnDisplay: r,
        destroy: function() {
            "undefined" !== typeof a && a.api.destroy()
        },
        setIsVisited: function(p) {
            "undefined" !== typeof a && null != a.api && a.api.forEachNode(function(z) {
                z.data.isVisited = p;
                z.setData(z.data);
                z = z.data.domainId + "-" + z.data.asin;
                sessionStorage[z] = 1;
                databaseDeals && databaseDeals.setItem(z, keepaTime.now())
            })
        }
    }
}()
  , GridFinder = function() {
    var a, b = {
        pageId: "finder",
        resizeToViewport: !0,
        showTools: {
            column: !0,
            columnPresets: !0,
            export: !0,
            filter: !0,
            filterinfo: !0,
            query: !0,
            results: !0,
            row: !0,
            track: GridConfig.gridTypesWithCheckboxSelection.includes("asinFinder")
        },
        template: "asin",
        title: "Product Finder",
        type: "asinFinder"
    }, d, h, m = {}, t = {}, f = [], n = function(w) {
        !0 === w && a.api && N(a.api.getFilterModel(), a.api.getSortModel(), !1);
        w = r();
        replaceHtml("grid-form-" + b.pageId, w.html);
        $("#filterSubmit").prop("disabled", !1);
        w.onFilter.done(function() {
            h.hide();
            d.fadeIn();
            isTest && console.info("%cGrid: onFilterChanged", "color:#6666bf;font-weight:bold;");
            a.api.onFilterChanged();
            "undefined" === typeof a.api.rowModel.datasource && (isTest && console.info("%cGrid: initDatasource", "color:#6666bf;font-weight:bold;"),
            ra())
        });
        h = $("#grid-form-" + b.pageId);
        za();
        d.fadeOut();
        h.fadeIn();
        g();
        var B = []
          , Q = $("#autocomplete-categories, #autocomplete-categories_exclude, #autocomplete-salesRankReference").parent().parent().find("p > span");
        Q.each(function() {
            B.push(parseInt(this.innerText))
        });
        var fa = Number(storage.domain);
        GridHelperCategory.load(null, fa, B).done(function() {
            Q.each(function() {
                var R = parseInt(this.innerText);
                isNaN(R) || (R = GridHelperCategory.getName(fa, R),
                $(this).find("span").html(R))
            })
        }).fail()
    }, r = function() {
        var w = $.Deferred()
          , B = GridConfig.csvTypesEnableLowestEver
          , Q = GridConfig.csvTypesEnableOutOfStock
          , fa = "allowOutdatedOfferData categories_exclude hasParentASIN productType sellerIds salesRankReference salesRankReference_current singleVariation".split(" ")
          , R = ""
          , T = ""
          , oa = ""
          , Z = ""
          , ja = ""
          , W = ""
          , Aa = ""
          , Ca = ""
          , Ba = ""
          , ta = ""
          , Ea = ""
          , va = ""
          , da = ""
          , Y = ""
          , ma = ""
          , ca = ""
          , ha = ""
          , C = ""
          , U = a.columnApi.getAllColumns()
          , ia = getCurrencyByDomain(Number(storage.domain))
          , X = ""
          , sa = ""
          , wa = ""
          , xa = !1
          , Ia = !1
          , Fa = !1
          , Ga = !1
          , Da = !1
          , Ma = !1;
        U.forEach(function(Ha) {
            var ya = Ha.colDef;
            if (!(!1 === ya.filter || ya.hide && ya.lockVisible && !fa.includes(ya.field))) {
                var Na = a.api.getFilterInstance(Ha.colId)
                  , La = Na.getModel() || {}
                  , Sa = La.type
                  , Ka = ""
                  , Ra = "";
                Ra = "";
                var Ua = [];
                Ka = Ra = Ra = null;
                switch (ya.filter) {
                case "agTextColumnFilter":
                    Ra = La.filter;
                    "isOneOf" == Na.textFilterParams.defaultOption ? "sellerIds" === ya.field ? da += '<div class="filter-row">\n\t\t\t\t\t\t\t\t<p class="filter-row--label"><b>Seller</b>&emsp;' + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n\t\t\t\t\t\t\t\t<p>Restrict your results to listings with offers from specific sellers (Seller ID required, separate multiple Seller IDs by comma).</p>\n\t\t\t\t\t\t\t\t<div class="filter-text" style="margin-top:0;">\t\t\t\t\n\t\t\t\t\t\t\t\t\t' + material.getInput(!1, "", "textArray-" + ya.field, "", "off", "textArray-" + ya.field, "", "", !1, "", Ra) + "\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>" : ja += F(ya.field, ya.headerName, Ra, Sa) : Z += z(ya.field, ya.headerName, Ra);
                    break;
                case "agNumberColumnFilter":
                    xa = ya.type && ya.type.includes("priceColumn") || Ha.colId.includes("deltaPercent90") && "SALES_deltaPercent90" !== Ha.colId;
                    Ia = ya.type && ya.type.includes("salesRankColumn") || "SALES_deltaPercent90" === Ha.colId;
                    Fa = "salesRankReference_current" === Ha.colId;
                    Ga = ya.type && ya.type.includes("offerCountColumn");
                    Da = ["offerCountFBA", "offerCountFBM"].includes(Ha.colId);
                    Ma = ["AMAZON_outOfStockPercentage90", "NEW_outOfStockPercentage90", "USED_outOfStockPercentage90", "BUY_BOX_SHIPPING_outOfStockPercentage90"].includes(Ha.colId);
                    "inRange" == Sa ? (Ra = "undefined" === typeof La.filter ? null : La.filter,
                    Ka = "undefined" === typeof La.filterTo ? null : La.filterTo) : "greaterThanOrEqual" === Sa ? (Ra = "undefined" === typeof La.filter ? null : La.filter,
                    Ka = null) : (Ra = null,
                    Ka = "undefined" === typeof La.filter ? null : La.filter);
                    "RATING_current" === Ha.colId && (Ra = 0 == Ra || Ra ? 1 > Ra ? "1.0" : 5 < Ra ? "5.0" : Ra : "",
                    Ka = 0 == Ka || Ka ? 1 > Ka ? "1.0" : 5 < Ka ? "5.0" : Ka : "");
                    if (ya.type && ya.type.includes("priceColumn") || Ha.colId.includes("fbaFees"))
                        Ra = 0 !== Ra % 1 ? Ra.toFixed(2) : Ra,
                        Ka = 0 !== Ka % 1 ? Ka.toFixed(2) : Ka;
                    Ra = 2147483647 < parseInt(Ra) ? 1E9 : Ra;
                    Ka = 2147483647 < parseInt(Ka) ? 1E9 : Ka;
                    ya.headerNameGroup = getHeaderNameGroup(Ha.colId, ya.headerNameGroup);
                    Ma && (Ra = 0 == Ra || Ra ? 0 > Ra ? "0" : 100 < Ra ? "100" : Ra : "",
                    Ka = 0 == Ka || Ka ? 0 > Ka ? "0" : 100 < Ka ? "100" : Ka : "");
                    La = getRangeLabel(Ha.colId, ya.headerName);
                    Ra = I(ya.field, La, Ra, Ka);
                    Ma ? (ta.length || (ta += '<div class="filter-row">\n                                <p class="filter-row--label"><b>' + ya.headerNameGroup + "</b>&emsp;" + G("outOfStockPercentage90") + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n                                <div>\n                            '),
                    ta += Ra) : wa !== ya.headerNameGroup ? (wa = ya.headerNameGroup,
                    xa || Ia ? (X = GridHelper.getCsvObjectName(Ha.colId),
                    sa = CsvType[X].index,
                    Ka = CsvType.getNameWithCircle(sa) + " " + ("SALES" === X ? "#" : ia),
                    La = "",
                    Q.includes(X) && (La = "boolean-" + X + "_outOfStock",
                    Ha = a.api.getFilterInstance(X + "_outOfStock").filterActive,
                    La = material.getCheckbox(La, ya.type.includes("salesRankColumn") ? "No Sales Rank" : "Out of stock", Ha, !1, La) + ' <input type="hidden" value="" name="' + La + '" />'),
                    Ha = "",
                    B.includes(X) && (Ha = "boolean-" + X + "_isLowest",
                    Sa = a.api.getFilterInstance(X + "_isLowest").filterActive,
                    Ha = material.getCheckbox(Ha, "Lowest ever", Sa, !1, Ha) + '\t<input type="hidden" value="" name="' + Ha + '" />'),
                    La = La.length || Ha.length ? '<div class="filter-row--label filter-row--label-extended">\n\t\t\t\t\t\t\t\t\t<span><b>' + Ka + "</b>&emsp;" + G(X) + '</span>\t\t\n\t\t\t\t\t\t\t\t\t<span class="filter--checkbox">' + La + '</span>\n\t\t\t\t\t\t\t\t\t<span class="filter--checkbox">' + Ha + '</span>\n\t\t\t\t\t\t\t\t\t<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span>\n\t\t\t\t\t\t\t\t</div>' : '<p class="filter-row--label"><b>' + Ka + "</b>&emsp;" + G(X) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>',
                    xa ? (R.length && (R += "</div></div>"),
                    R += '<div class="filter-row" data-csvtype="' + X + '">\n                                    ' + La + "\n                                    <div>" + Ra + "\n\t\t\t\t\t\t\t\t") : Ia && (T.length && (T += "</div></div>"),
                    T += '<div class="filter-row filter-row--matrix" data-csvtype="' + X + '" id="filter-row--matrix-' + X + '">\n                                    ' + La + "\n                                    <div>" + Ra + "\n\t\t\t\t\t\t\t\t")) : (Ka = ya.headerNameGroup,
                    Fa ? (oa.length && (oa += "</div></div>"),
                    oa += '<div class="filter-row filter-subcategory--wrapper filter-row--matrix" id="filter-row--matrix-salesRankReference">\n                                    <p class="filter-row--label"><b>' + Ka + "</b>&emsp;" + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n                                    <div style="padding-bottom: 3px;">' + Ra + "\n\t\t\t\t\t\t\t\t") : Ga ? (ma.length && (ma += "</div></div>"),
                    ma += '<div class="filter-row">\n                                    <p class="filter-row--label"><b>' + Ka + "</b>&emsp;" + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n                                    <div>' + Ra + "\n\t\t\t\t\t\t\t\t") : Da ? (ca.length && (ca += "</div></div>"),
                    ca += '<div class="filter-row">\n                                    <p class="filter-row--label"><b>' + Ka + "</b>&emsp;" + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n                                    <div>' + Ra + "\n\t\t\t\t\t\t\t\t") : (ha.length && (ha += "</div></div>"),
                    ha += '<div class="filter-row">\n                                    <p class="filter-row--label"><b>' + Ka + "</b>&emsp;" + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n                                    <div>' + Ra + "\n\t\t\t\t\t\t\t\t"))) : xa ? R += Ra : Ia ? T += Ra : Fa ? oa += Ra : Ga ? ma += Ra : Da ? ca += Ra : ha += Ra;
                    break;
                case "agDateColumnFilter":
                    "inRange" == Sa ? (Ra = (new Date(La.dateFrom)).formatDate("Y-m-d"),
                    Ka = (new Date(La.dateTo)).formatDate("Y-m-d")) : "greaterThanOrEqual" === Sa ? (Ra = (new Date(La.dateFrom)).formatDate("Y-m-d"),
                    Ka = null) : (Ra = null,
                    Ka = La.dateFrom ? (new Date(La.dateFrom)).formatDate("Y-m-d") : "");
                    Ba += '<p class="filter-row--label"><b>' + ya.headerName + "</b>&emsp;" + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t' + E(ya.field, Ra, Ka) + "\n\t\t\t\t\t\t</div>\n\t\t\t\t\t";
                    break;
                case "agSetColumnFilter":
                    if ("productType" === ya.field) {
                        var Va = Na.isFilterActive()
                          , Wa = Na.valueModel;
                        Ua = [];
                        Wa.availableUniqueValues.forEach(function(Xa) {
                            Ua.push({
                                checked: !Va || "undefined" !== typeof Wa.selectedValuesMap[Xa],
                                label: ya.filterParams.valueMap[Xa],
                                value: Xa
                            })
                        });
                        Ra = H(ya.field, ya.headerName, Ua);
                        Y += '<div class="filter-row">\n                                <p class="filter-row--label"><b>' + ya.headerName + "</b>&emsp;" + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Reset row</span></p>\n                                <div>\n                                    ' + Ra + "\n                                </div>\n                            </div>"
                    }
                    if ("availabilityAmazon" === ya.field) {
                        var Ta = Na.isFilterActive()
                          , Za = Na.valueModel;
                        Ua = [];
                        Za.availableUniqueValues.forEach(function(Xa) {
                            Ua.push({
                                checked: !Ta || "undefined" !== typeof Za.selectedValuesMap[Xa],
                                label: ya.filterParams.valueMap[Xa],
                                value: Xa
                            })
                        });
                        Ra = H(ya.field, ya.headerName, Ua);
                        ha.length && (ha += "</div></div>");
                        ha += '<div class="filter-row">\n                            <p class="filter-row--label"><b>' + ya.headerName + "</b>&emsp;" + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Reset row</span></p>\n                            <div>' + Ra + "\n                        "
                    }
                    break;
                case "customBooleanColumnFilter":
                    if ("LIGHTNING_DEAL_upcoming" === ya.field) {
                        Ra = parseInt(La.filter);
                        R += '<div class="filter-boolean--label">' + ya.headerName + '</div>\n\t\t\t\t\t\t\t<div class="filter-boolean--input" style="margin-top:12px;height:36px;">\n\t\t\t\t\t\t\t\t' + material.getRadio("booleanAll-" + ya.field, "All", 1 !== Ra, "boolean-" + ya.field, !1, -1) + "\n\t\t\t\t\t\t\t\t" + material.getRadio("booleanYes-" + ya.field, "Yes", 1 === Ra, "boolean-" + ya.field, !1, 1) + "\n\t\t\t\t\t\t\t</div>";
                        break
                    }
                    if ("allowOutdatedOfferData" === ya.field) {
                        Ra = "boolean-" + ya.field;
                        La = a.api.getFilterInstance(ya.field).filterActive;
                        C += '<div style="margin-top:0;">' + material.getCheckbox(Ra, ya.headerName, La, !1, Ra) + ' <input type="hidden" value="" name="' + Ra + '" /></div>';
                        break
                    }
                    if ("hasParentASIN" === ya.field) {
                        Ra = parseInt(La.filter);
                        Ua = material.getRadio("booleanAll-" + ya.field, "All", -1 !== Ra, "boolean-" + ya.field, !1, -1);
                        Ua += material.getRadio("booleanNo-" + ya.field, "No Variations", 0 === Ra, "boolean-" + ya.field, !1, 0);
                        Ua += material.getRadio("booleanYes-" + ya.field, "Is Variation", 1 === Ra, "boolean-" + ya.field, !1, 1);
                        Ra = a.api.getFilterInstance("singleVariation").filterActive;
                        Ra = "&emsp;| " + material.getCheckbox("boolean-singleVariation", "Show only one variation per product", Ra, !1, "boolean-singleVariation") + ' <input type="hidden" value="" name="boolean-singleVariation" />';
                        Y += '<div class="filter-row">\n                    \t\t\t<p class="filter-row--label"><b>' + ya.headerName + "</b>&emsp;" + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n                    \t\t\t<div style="padding-bottom:20px;">\n                    \t\t\t\t<div class="filter-boolean--input">\n                    \t\t\t\t\t' + Ua + "\n                    \t\t\t\t\t" + Ra + "\n                    \t\t\t\t</div>\n                    \t\t\t</div>\n                    \t\t</div>";
                        break
                    }
                    if ("singleVariation" === ya.field)
                        break;
                    if (["buyBoxIsFBA", "buyBoxIsUnqualified"].includes(ya.field)) {
                        Ca += K(ya.field, ya.headerName, parseInt(La.filter ? La.filter : -1));
                        break
                    }
                    Aa += K(ya.field, ya.headerName, parseInt(La.filter ? La.filter : -1));
                    break;
                case "customSingleChoiceColumnFilter":
                    Ra = ya.headerName;
                    "rootCategory" === ya.field && (Ea += V(ya.field, !1, parseInt(La.filter), Na.valueOptions, "All root categories"));
                    break;
                case "customAutocompleteColumnFilter":
                    La = La.filter ? La.filter.split("###").map(function(Xa) {
                        return Xa.trim()
                    }).filter(function(Xa) {
                        return "" != Xa
                    }) : [];
                    ["categories", "categories_exclude"].includes(ya.field) ? (Ra = "categories" === ya.field ? "Include sub categories" : ya.headerName,
                    va += S(ya.field, Ra, La)) : "salesRankReference" === ya.field ? oa += S(ya.field, ya.headerName, La) : W += S(ya.field, ya.headerName, La, Sa);
                    break;
                case "customDynamicColumnFilter":
                    "buyBoxSellerIdHistory" === ya.field && (Ka = Number(storage.domain),
                    Ra = La.filter,
                    La = La.filterDetail,
                    Ha = [],
                    AmazonSellerIds[Ka].length && Ha.push(AmazonSellerIds[Ka]),
                    AltAmazonSellerIds[Ka].length && Ha.push(AltAmazonSellerIds[Ka]),
                    Ka = Array.from(Ha, function(Xa) {
                        return "-" + Xa
                    }),
                    Ha = Ha.join(","),
                    Ka = Ka.join(","),
                    [Ha, Ka, "1"].includes(Ra) || (Ra = -1),
                    da = '<div class="filter-row">\n\t\t\t\t\t\t\t\t<p class="filter-row--label"><b>Buy Box Seller</b>&emsp;' + G(ya.field) + '<span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n\t\t\t\t\t\t\t\t<p>Restrict your results to the current Buy Box Seller - Amazon, 3rd Party or specific sellers (Seller ID required, separate multiple Seller IDs by comma).</p>\n\t\t\t\t\t\t\t\t<div style="padding-bottom:20px;">\n\t\t\t\t\t\t\t\t\t<div class="filter-boolean--input">\n\t\t\t\t\t\t\t\t\t\t' + material.getRadio("dynamicAll-" + ya.field, "All", "-1" == Ra, "dynamic-" + ya.field, !1, -1) + "\n\t\t\t\t\t\t\t\t\t\t" + (Ha.length ? material.getRadio("dynamicAmazon-" + ya.field, "Amazon", Ra === "" + Ha, "dynamic-" + ya.field, !1, "" + Ha) : "") + "\n\t\t\t\t\t\t\t\t\t\t" + (Ka.length ? material.getRadio("dynamic3rd-" + ya.field, "3rd Party", Ra === "" + Ka, "dynamic-" + ya.field, !1, "" + Ka) : "") + "\n\t\t\t\t\t\t\t\t\t\t" + material.getRadio("dynamicAnyOf-" + ya.field, "Seller IDs:", 1 == Ra, "dynamic-" + ya.field, !1, 1) + "\n\t\t\t\t\t\t\t\t\t\t&ensp;" + material.getInput(1 == Ra, "", "dynamicAnyOfDetail-" + ya.field, "", "off", "dynamicAnyOfDetail-" + ya.field, "", "", !1, "", La) + "\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>")
                }
            }
        });
        R = R.length ? R + "</div></div>" : R;
        T = T.length ? T + "</div></div>" : T;
        oa = oa.length ? oa + "</div></div>" : oa;
        ma = ma.length ? ma + "</div></div>" : ma;
        ca = ca.length ? ca + "</div></div>" : ca;
        ta = ta.length ? ta + "</div></div>" : ta;
        ha = ha.length ? ha + "</div></div>" : ha;
        Ca = '<div class="filter-row">\n            <p class="filter-row--label"><b>Additional Buy Box switches</b><span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n            <div style="flex-wrap:wrap;">' + Ca + "</div>\n        </div>";
        Ba = '<div class="filter-row">' + Ba + "</div>";
        Aa = '<div class="filter-row">\n\t\t\t\t<p class="filter-row--label"><b>Additional switches</b><span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n\t\t\t\t<div style="flex-wrap:wrap;">' + Aa + "</div>\n\t\t\t</div>";
        Ea = '<p class="filter-row--label"><b>Root category</b></p>\n\t\t\t<div class="filter-category--wrapper">\n\t\t\t' + Ea + "\n\t\t\t</div>";
        va = '<p class="filter-row--label"><b>Sub categories</b></p>\n\t\t\t<div class="filter-category--wrapper">\n\t\t\t' + va + "\n\t\t\t</div>";
        C = '<div class="filter-row">\n\t\t\t\t<p class="filter-row--label"><b>Additional settings</b><span class="filter--reset"><i class="fa fa-undo"></i>&nbsp;Clear row</span></p>\n\t\t\t\t' + C + "\n\t\t\t</div>";
        U = '<div>\n\t\t\t<h6 class="mdc-typography--subtitle1">Sales Rank & Price Types<span class="filter--reset filter-section--reset"><i class="fa fa-undo"></i>&nbsp;Clear section</span></h6>\n\t\t\t<p>Define your desired sales rank and/or price ranges. You can define as many ranges as you like to refine the results.</p><br>\n\t\t\t' + T + "\n\t\t\t" + oa + "\n\t\t\t" + R + "\n\t\t</div>";
        var Qa = '<div>\n\t\t\t<h6 class="mdc-typography--subtitle1">Title, Brand and more!<span class="filter--reset filter-section--reset"><i class="fa fa-undo"></i>&nbsp;Clear section</span></h6>\n\t\t\t<p>Filter the results by category, title, brand and more.</p><br>\n\t\t\t' + Ea + "\n\t\t\t" + va + '\n\t\t\t<p class="filter-row--label"><b>Text fields</b></p><br>\n\t\t\t<div class="filter-text--wrapper">' + Z + '</div>\n\t\t\t<div class="filter-text--wrapper">\n                ' + W + "\n                " + ja + "\n            </div>\n\t\t</div>"
          , Ja = '<div>\n\t\t\t<h6 class="mdc-typography--subtitle1">Offer Counts<span class="filter--reset filter-section--reset"><i class="fa fa-undo"></i>&nbsp;Clear section</span></h6>\n\t\t\t' + ma + "\n\t\t\t" + ca + "\n\t\t</div>"
          , Pa = '<div>\n\t\t\t<h6 class="mdc-typography--subtitle1">Refine your search even more!<span class="filter--reset filter-section--reset"><i class="fa fa-undo"></i>&nbsp;Clear section</span></h6>\n\t\t\t' + da + "\n\t\t\t" + Ca + "\n\t\t\t" + Y + "\n\t\t\t" + Ba + "\n\t\t\t" + ta + "\t\t\t\n            " + ha + "\n\t\t\t" + Aa + "\n\t\t\t" + C + "\n\t\t</div>"
          , Oa = material.getButton("filterSubmit", "Find Products", null, "filter");
        U = '<form name="loadForm" id="filterForm">\n\t\t\t\t<section class="paper section-about">\n\t\t\t\t\t<h6 class="mdc-typography--subtitle1">About the Product Finder<span class="filter--reset filter-form--reset"><i class="fa fa-undo"></i>&nbsp;Clear entire form</span></h6>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tFind products matching any criteria by searching our entire product database! You can search for and sort by almost any product attribute.\n\t\t\t\t\t\tFor example you could search for all electronic products with an Amazon price within the range \n\t\t\t\t\t\tof $50 and $100, a sales rank average no higher than 5,000, manufactured by Sony and with less than 5 sellers on the product listing \n\t\t\t\t\t\t- and have the output sorted in ascending order by sales rank. Sorting can be specified via the search result table, default sort \n\t\t\t\t\t\torder is by sales rank.\n\t\t\t\t\t\tWe will continuously add new functionality as we strive to make our Product Finder the most powerful Amazon product search tool.\n\t\t\t\t\t\t<br>Have suggestions or found bugs? You can provide feedback through our Comment section.</p><br>\n\t\t\t\t\t<p><b>\n\t\t\t\t\t\tEach search returns a maximum of 10,000 ASINs' + (hasDataAccessSubscription ? "" : "*") + " depending on your table row setting and pagination. As all filters and sort operations are executed remotely \n\t\t\t\t\t\t(and not in your locally loaded table) we advice to use a low row setting as it will speed up loading and reduce quota usage. \n\t\t\t\t\t\tOnly use a higher row setting when you want to export the table or want to see more products of your current selection.</b></p><br>\n\t\t\t\t\t" + (hasDataAccessSubscription ? "" : '<p style="font-size:11px;"><i>\n\t\t\t\t\t\t* <a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to get up to 10,000 rows and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>. Without a subscription the Finder will return a maximum of " + GridConfig.maxRowsFreeUser + " ASINs.\n\t\t\t\t\t</i></p><br>") + '\n\t\t\t\t\t<p>\n\t\t\t\t\t\tOnce you have submitted your query you can always go back to make changes by clicking on "Advanced Filter" above the product table. \n\t\t\t\t\t\tBut you can also add or remove filters or change the sort direction directly from the table using the column menus.\n\t\t\t\t\t\tIn either case your query will be encoded in the URL so you can save a browser bookmark of your selection. \n\t\t\t\t\t\tNavigating away from the Finder will clear all filters.</p><br>\n\t\t\t\t\t<p><i>Each filter attribute will be joined by AND condition.<br>\n\t\t\t\t\t\tFields where multiple entries are possible (e.g. Manufacturer) each entry is considered OR wise and a maximum of ' + GridConfig.maxValuesPerFinderFilter + ' entries are supported. <br>\n\t\t\t\t\t\tThe Finder searches our database and might not find all products available on Amazon matching your query.<br>\n\t\t\t\t\t\tSorting is set up in the product result table by clicking on a column header (you can also sort by multiple columns by holding down shift).<br>\n\t\t\t\t\t\tEach search/sorting consumes a small amount of your quota.</i></p>\n\t\t\t\t</section>\n\t\t\t\t<section class="paper section-csv">' + U + '</section>\n\t\t\t\t<section class="paper section-strings">' + Qa + '</section>\n\t\t\t\t<section class="paper section-offer-counts">' + Ja + '</section>\n\t\t\t\t<section class="paper section-other">' + Pa + '</section>\n\t\t\t\t<div class="button--absolute">\n\t\t\t\t    <span id="totalResultsQuery">Your current filter matches<br><span>0</span> products</span>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<a id="filterQuery" class="mdc-button mdc-button--primary mdc-ripple-upgraded">\n\t\t\t\t\t\t\tShow API query&ensp;<i class="fa fa-file-code-o"></i>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span>' + Oa + "</span>\n\t\t\t\t</div>\n\t\t\t</form>";
        material.init("#filterForm");
        setTimeout(function() {
            var Ha = $("#filterForm");
            q();
            setupChangeListener();
            L();
            A();
            aa();
            ea();
            $(".mdc-text-field__input").colorTip({
                color: "yellow"
            });
            $(".mdc-form-field").colorTip({
                color: "yellow"
            });
            $(".fa-question").colorTip({
                color: "yellow"
            });
            ba();
            Ha.on("submit", function(ya) {
                $("#filterSubmit").prop("disabled", !0);
                ya.preventDefault();
                ya = $(this).serializeArray();
                p(ya);
                ya = a.api.getFilterModel();
                0 == Object.keys(ya).length || 1 == Object.keys(ya).length && "undefined" !== typeof ya.allowOutdatedOfferData ? ($("#filterSubmit").prop("disabled", !1),
                showPopup("No filter specified", "You have to use at least one filter.", !0)) : ya.salesRankReference_current && !ya.salesRankReference || ya.salesRankReference && !ya.salesRankReference_current ? ($("#filterSubmit").prop("disabled", !1),
                showPopup("Invalid filter settings", 'Please choose a "Sales Rank # - Subcategory" range and reference category.', !0)) : w.resolve()
            })
        }, 0);
        return {
            onFilter: w.promise(),
            html: U
        }
    }, p = function(w) {
        var B = [];
        w.forEach(function(Q) {
            var fa = Q.name.split("-")
              , R = fa[0]
              , T = null
              , oa = fa[1];
            fa = Q.value;
            var Z = T = null;
            if (!B.includes(oa)) {
                var ja = a.api.getFilterInstance(oa);
                switch (R) {
                case "text":
                    fa.length ? ja.setModel({
                        type: "contains",
                        filter: fa
                    }) : ja.setModel(null);
                    break;
                case "textArray":
                case "textArrayType":
                    if ("textArrayType" === R)
                        break;
                    fa.length ? (T = (Q = w.find(function(W) {
                        return W.name === "textArrayType-" + oa
                    })) ? Q.value : "isOneOf",
                    ja.setModel({
                        type: T ? T : "isOneOf",
                        filter: fa
                    })) : ja.setModel(null);
                    break;
                case "boolean":
                    ja.isCheckbox && "" === fa ? ja.setModel(null) : ja.setModel({
                        filter: fa,
                        filterType: "boolean"
                    });
                    B.push(oa);
                    break;
                case "numberFrom":
                case "numberTo":
                    T = fa;
                    Z = w.find(function(W) {
                        return W.name === "numberTo-" + oa
                    }).value;
                    "RATING_current" === oa && (T = 0 === parseInt(T) || T ? 1 > T ? "1.0" : 5 < T ? "5.0" : T : "",
                    Z = 0 === parseInt(Z) || Z ? 1 > Z ? "1.0" : 5 < Z ? "5.0" : Z : "");
                    T.length && Z.length ? ja.setModel({
                        type: "inRange",
                        filter: T,
                        filterTo: Z
                    }) : T.length ? ja.setModel({
                        type: "greaterThanOrEqual",
                        filter: T,
                        filterTo: null
                    }) : Z.length ? ja.setModel({
                        type: "lessThanOrEqual",
                        filter: Z,
                        filterTo: null
                    }) : ja.setModel(null);
                    B.push(oa);
                    break;
                case "dateFrom":
                case "dateTo":
                    T = fa;
                    Z = w.find(function(W) {
                        return W.name === "dateTo-" + oa
                    }).value;
                    T.length && Z.length ? ja.setModel({
                        type: "inRange",
                        dateFrom: T,
                        dateTo: Z
                    }) : T.length ? ja.setModel({
                        type: "greaterThanOrEqual",
                        dateFrom: T,
                        dateTo: null
                    }) : Z.length ? ja.setModel({
                        type: "lessThanOrEqual",
                        dateFrom: Z,
                        dateTo: null
                    }) : ja.setModel(null);
                    B.push(oa);
                    break;
                case "singleChoice":
                    ja.setModel({
                        filterType: "singleChoice",
                        filter: fa
                    });
                    break;
                case "singleChoiceRadio":
                    ja.setModel({
                        filterType: "singleChoiceRadio",
                        filter: fa
                    });
                    break;
                case "autocomplete":
                case "autocompleteReal":
                case "autocompleteType":
                    if ("autocomplete" === R)
                        break;
                    if ("autocompleteType" === R)
                        break;
                    fa.length ? (T = ["categories", "categories_exclude"].includes(oa) ? "isOneOf" : "salesRankReference" === oa ? "equals" : w.find(function(W) {
                        return W.name === "autocompleteType-" + oa
                    }).value,
                    ja.setModel({
                        filterType: "autocomplete",
                        type: T ? T : "isOneOf",
                        filter: fa
                    })) : ja.setModel(null);
                    break;
                case "dynamic":
                    "buyBoxSellerIdHistory" === oa && (-1 != fa ? (Q = "",
                    1 == fa && (Q = w.find(function(W) {
                        return W.name === "dynamicAnyOfDetail-" + oa
                    }).value),
                    ja.setModel({
                        filter: fa,
                        filterDetail: Q,
                        filterType: "dynamic"
                    })) : ja.setModel(null),
                    B.push(oa));
                    break;
                case "set":
                    fa = w.map(function(W) {
                        if (W.name === R + "-" + oa)
                            return W.value
                    }).filter(function(W) {
                        return W
                    });
                    0 < fa.length && fa.length !== ja.setFilterParams.values.length ? ja.setModel({
                        type: "set",
                        values: fa
                    }) : ja.setModel(null);
                    B.push(oa);
                    break;
                default:
                    isTest && console.info("%cGrid:", "color:red;", "missing filter data type handling: ", R, oa, Q)
                }
            }
        })
    }, z = function(w, B, Q) {
        Q = Q ? Q.replace(/"/g, "&quot;") : Q;
        return '<div class="filter-text">\n\t\t\t' + material.getInput(!1, "", "text-" + w, B, "off", "text-" + w, "", "", !1, "", Q) + "\n\t\t\t" + G(w) + '\n\t\t\t<p class="mdc-text-field-helper-text">See tooltip</p>\n\t\t</div>'
    }, F = function(w, B, Q, fa) {
        return '<div class="filter-text filter-text-select">\n\t\t\t\t' + material.getSelect("textArrayType-" + w, "textArrayType-" + w, fa, [{
            label: "Is one of",
            value: "isOneOf"
        }, {
            label: "Is none of",
            value: "isNoneOf"
        }], "", !0, !1) + "\n\t\t\t\t" + material.getInput(!1, "", "textArray-" + w, B, "off", "textArray-" + w, "", "", !1, "", Q) + "\n\t\t\t\t" + G(w) + '\n\t\t\t\t<p class="mdc-text-field-helper-text">See tooltip</p>\n\t\t\t</div>'
    }, I = function(w, B, Q, fa) {
        var R = "^\\d*(\\.\\d{2}$)?"
          , T = "Allowed value format: 9999 or 19.90";
        if ("packageLength packageWidth packageHeight itemLength itemWidth itemHeight".split(" ").includes(w))
            R = "^\\d*(\\.\\d{1}$)?",
            T = "Allowed value format: 5 or 4.2";
        else if (["packageDimension", "itemDimension"].includes(w))
            R = "^\\d*(\\.\\d{3}$)?",
            T = "Allowed value format: 125 or 74.088";
        else if ("RATING_current" === w)
            R = "^[1-4](\\.\\d{1}$)?|5(\\.0$)?$",
            T = "Allowed value format: 1.5 or 4; Allowed range: 1.0 - 5.0";
        else if (["AMAZON_outOfStockPercentage90", "NEW_outOfStockPercentage90", "USED_outOfStockPercentage90", "BUY_BOX_SHIPPING_outOfStockPercentage90"].includes(w))
            R = "^[0-9]{1,3}?$",
            T = "Allowed value format: 50; Allowed range: 0 - 100";
        else if (["couponOneTimePercent"].includes(w))
            R = "^[0-9]{1,2}?$",
            T = "Allowed value format: 50; Allowed range: 0 - 99";
        else if (w.includes("deltaPercent90"))
            R = "^-[0-9]{1,3}?|-1000?|[0-9]{1,2}?$",
            T = "Allowed value format: 50; Allowed range: from -1000 to 99";
        else if (w.includes("SALES") || w.includes("COUNT_") || w.includes("offerCount") || "COUNT_REVIEWS_current itemWeight numberOfItems numberOfPages packageWeight salesRankReference_current salesRankDrops30 salesRankDrops90 salesRankDrops180".split(" ").includes(w))
            R = "^\\d*",
            T = "Only whole numbers are allowed, e.g. 99";
        return '<div class="filter-range--label">' + B + '</div>\n\t\t\t<div class="filter-range--input">\n\t\t\t\t' + material.getInputNumberPattern("numberFrom-" + w, "numberFrom-" + w, "From", Q, R, T, "off") + "\n\t\t\t\t" + material.getInputNumberPattern("numberTo-" + w, "numberTo-" + w, "To", fa, R, T, "off") + "\n\t\t\t</div>"
    }, E = function(w, B, Q) {
        return '<div class="filter-date--label">From</div>\n\t\t\t<div class="filter-date--input">\n\t\t\t\t' + material.getInputDate("dateFrom-" + w, "dateFrom-" + w, "", B) + '\n\t\t\t</div>\n\t\t\t<div class="filter-date--label">To</div>\n\t\t\t<div class="filter-date--input">\n\t\t\t\t' + material.getInputDate("dateTo-" + w, "dateTo-" + w, "", Q) + "\n\t\t\t</div>"
    }, K = function(w, B, Q) {
        return '<div><div class="filter-boolean--label">' + B + "&emsp;" + G(w) + '</div>\n\t\t\t<div class="filter-boolean--input">\n\t\t\t\t' + material.getRadio("booleanAll-" + w, "All", -1 === Q, "boolean-" + w, !1, -1) + "\n\t\t\t\t" + material.getRadio("booleanYes-" + w, "Yes", 1 === Q, "boolean-" + w, !1, 1) + "\n\t\t\t\t" + material.getRadio("booleanNo-" + w, "No", 0 === Q, "boolean-" + w, !1, 0) + "\n\t\t\t</div></div>"
    }, H = function(w, B, Q) {
        var fa = "";
        Q.forEach(function(R) {
            fa += material.getCheckbox(w + "-" + R.value, R.label, R.checked, !1, "set-" + w, R.value)
        });
        return '<div>\n                <input type="hidden" name="set-' + w + '" value="" />\t\t\t\t\n                ' + fa + "\n\t\t\t</div>"
    }, V = function(w, B, Q, fa, R) {
        return "\n\t\t\t" + (B ? '<div class="filter-singleChoice--label">' + B + "</div>" : "") + "\n\t\t\t" + material.getSelect("singleChoice-" + w, "singleChoice-" + w, Q, fa, R) + "\n\t\t\t" + G(w) + "\n\t\t"
    }, S = function(w, B, Q, fa) {
        fa = void 0 === fa ? "isOneOf" : fa;
        var R = ""
          , T = ""
          , oa = ["categories", "categories_exclude", "salesRankReference"].includes(w);
        Q.length && (T += GridFilter.getClearAllItem(),
        Q = Array.from(new Set(Q)),
        Q.sort(),
        Q.forEach(function(Z) {
            T = oa ? T + ("<span><span>" + Z + '</span> <i class="fa fa-times" data-id="' + Z + '"></i></span>') : T + ("<span><span>" + Z + '</span> <i class="fa fa-times"></i></span>')
        }),
        Q = Q.map(function(Z) {
            return Z.replace(/"/g, "&quot;")
        }),
        R = Q.join("###"));
        return oa ? '<div class="filter-text filter-text--autocomplete ui-front">\n\t\t\t' + material.getInput(!1, "", "autocomplete-" + w, B, "off", "autocomplete-" + w, "", "", !1, "", "") + "\n\t\t\t" + G(w) + '\n\t\t\t<p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent">&thinsp;' + T + '</p>\n\t\t\t<input type="hidden" name="autocompleteReal-' + w + '" value="' + R + '"/>\n\t\t</div>' : '<div class="filter-text filter-text-select filter-text--autocomplete ui-front">\n\t\t\t\t' + material.getSelect("autocompleteType-" + w, "autocompleteType-" + w, fa, [{
            label: "Is one of",
            value: "isOneOf"
        }, {
            label: "Is none of",
            value: "isNoneOf"
        }], "", !0, !1) + "\n\t\t\t\t" + material.getInput(!1, "", "autocomplete-" + w, B, "off", "autocomplete-" + w, "", "", !1, "", "") + "\n\t\t\t\t" + G(w) + '\n\t\t\t\t<p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent">&thinsp;' + T + '</p>\n\t\t\t\t<input type="hidden" name="autocompleteReal-' + w + '" value="' + R + '"/>\n\t\t\t</div>'
    }, aa = function() {
        $(".mdc-text-field-helper-text--persistent i").on("click", function() {
            GridFilter.autocompleterRemoveItem(this)
        });
        $("#filterForm").find('input[type!="hidden"][name^="autocomplete-"]').each(function() {
            ["autocomplete-categories", "autocomplete-categories_exclude", "autocomplete-salesRankReference"].includes(this.name) ? GridFilter.autocompleterAddCategories(this) : GridFilter.autocompleterAdd(this)
        })
    }, ea = function() {
        $("#filterForm").find('input[name^="dynamic"]').on("focus", function() {
            var w = $(this).attr("name").split("-").pop();
            if ("buyBoxSellerIdHistory" === w) {
                var B = $(this).attr("type")
                  , Q = $(this).val();
                "radio" === B ? (w = $("#dynamicAnyOfDetail-" + w),
                1 == Q ? (w.focus(),
                w.prop("required", !0)) : (w.val(""),
                w.prop("required", !1))) : $("#dynamicAnyOf-" + w + "-radio").prop("checked", !0)
            }
        })
    }, ra = function() {
        var w = Number(storage.domain)
          , B = GridApi.getRowsPerPage(a);
        hasDataAccessSubscription && a.paginationPageSize !== B && (a.paginationPageSize = B,
        a.cacheBlockSize = B);
        a.api.setDatasource({
            rowCount: null,
            getRows: function(Q) {
                a.api.showLoadingOverlay();
                za();
                if ("undefined" === typeof a.api.rowModel.datasource)
                    isTest && console.info("%cGrid:", "color:#6666bf;", "assumes source has not been initialized!", a.api.rowModel.datasource),
                    Q.successCallback([], 0);
                else {
                    var fa = Q.filterModel
                      , R = Q.sortModel;
                    if (0 == Object.keys(fa).length || 1 == Object.keys(fa).length && "undefined" !== typeof fa.allowOutdatedOfferData)
                        Q.successCallback([], 0),
                        n();
                    else {
                        var T = P();
                        T.page = Q.startRow / B;
                        T.perPage = B;
                        var oa = "No results found for Amazon." + tld
                          , Z = 0;
                        isTest && console.info("%cGrid: submitting dataQuery \u27fc ", "color:#6666bf;font-weight:bold;", T, [JSON.stringify(T)]);
                        network.request({
                            path: "pro/finder",
                            query: T,
                            domainId: w,
                            version: 3
                        }).done(function(ja) {
                            isTest && console.info("%cGrid: done \u27fc ", "color:green;font-weight:bold;", ja);
                            Z = ja.tokens;
                            var W = ja.totalResults;
                            if (0 === W) {
                                za();
                                Q.successCallback([], 0);
                                var Aa = showPopup(oa, "No products were found. Please adjust your filter settings.", !0);
                                Aa.promise && Aa.promise.always(function() {
                                    n(!0)
                                })
                            }
                            if (ja.error)
                                Q.failCallback(),
                                showErrorPopup("[" + ja.error.type + "] " + ja.error.message);
                            else {
                                var Ca = {}, Ba;
                                for (Ba in ja.queryResult)
                                    7 != Ba && (Ca[Ba] = ja.queryResult[Ba].splice(0, B));
                                networkHelper.loadASINs({
                                    history: !1,
                                    includeDeals: !0,
                                    maxAge: 60,
                                    offerPages: 0,
                                    path: "pro/product",
                                    refreshProduct: !1,
                                    type: "finder"
                                }, Ca, "#loadingFlipper").done(function(ta) {
                                    if (0 == ta.length)
                                        0 >= Z ? (showPopup("Quota exceeded", quotaExceeded, !0),
                                        insertPage('<div class="paper">' + quotaExceeded + "</div>"),
                                        addDataUpdateHandler()) : (showPopup(oa, "No products were found. Please adjust your filter settings.", !0),
                                        za()),
                                        Q.successCallback([], 0);
                                    else {
                                        var Ea = 0 < Math.floor(W / T.perPage) - T.page ? T.perPage : W - T.page * T.perPage
                                          , va = ta.length;
                                        na(ta, Ca[w], Ea).done(function(da) {
                                            GridHelper.addContextMenu(a);
                                            var Y = Math.min(W, hasDataAccessSubscription ? 1E4 : 5);
                                            za(va, W, Ea);
                                            Q.successCallback(da, Y);
                                            !0 === a.pagination && (1 === a.api.paginationGetTotalPages() ? $(".ag-paging-page-summary-panel").hide() : $(".ag-paging-page-summary-panel").show());
                                            a.api.hideOverlay()
                                        })
                                    }
                                    getBucketInformation()
                                }).fail(function(ta) {
                                    isTest && console.info("%cGrid: fail \u27fc ", "color:red;font-weight:bold;", ta);
                                    if (429 == ta.status) {
                                        var Ea = quotaExceeded;
                                        "undefined" != typeof ta.products && 0 < ta.products.length ? (Ea += "<br>" + quotaLastedFor.replace("#count#", ta.products.length).replace("#type#", "products"),
                                        showPopup("Quota exceeded", Ea, !0),
                                        na(ta.products, Ca[w], ta.products.length).done(function(va) {
                                            GridHelper.addContextMenu(a);
                                            var da = Math.min(W, hasDataAccessSubscription ? 1E4 : 5);
                                            za(va.length, W);
                                            Q.successCallback(va, da);
                                            !0 === a.pagination && (1 === a.api.paginationGetTotalPages() ? $(".ag-paging-page-summary-panel").hide() : $(".ag-paging-page-summary-panel").show());
                                            a.api.hideOverlay()
                                        })) : (pa(ta),
                                        Q.failCallback())
                                    } else
                                        showErrorPopup("Status: " + ta.status);
                                    getBucketInformation()
                                });
                                N(fa, R, !0)
                            }
                        }).fail(function(ja) {
                            pa(ja);
                            Q.failCallback()
                        }).always(function(ja) {
                            "undefined" === typeof ja.queryResult && (ja.msg = "No products were found. Please adjust your filter settings.",
                            pa(ja),
                            Q.failCallback());
                            GridFinder.handleSpecialFilters()
                        })
                    }
                }
            }
        })
    }, pa = function(w) {
        429 == w.status ? (showPopup("Quota exceeded", quotaExceeded, !0),
        insertPage('<div class="paper">' + quotaExceeded + "</div>"),
        addDataUpdateHandler()) : showErrorPopup(w.msg)
    }, ua = function(w, B) {
        B.length > GridConfig.maxValuesPerFinderFilter && (B = B.slice(0, GridConfig.maxValuesPerFinderFilter),
        w = a.columnApi.getColumn(w),
        f.push((w.colDef.headerNameGroup && "[hidden]" !== w.colDef.headerNameGroup ? w.colDef.headerNameGroup + ": " : "") + w.colDef.headerName));
        return B
    }, na = function(w, B, Q) {
        isTest && console.info("%cGrid:", "color:#6666bf; ", "loaded products \u27fc " + w.length);
        return $.Deferred(function(fa) {
            if (0 == w.length)
                fa.resolve(w);
            else {
                var R = w.map(function(W, Aa) {
                    return {
                        index: Aa,
                        value: B.indexOf(W.asin),
                        asin: W.asin
                    }
                });
                R.sort(function(W, Aa) {
                    return W.value > Aa.value ? 1 : W.value < Aa.value ? -1 : 0
                });
                var T = R.map(function(W) {
                    return w[W.index]
                });
                R = [];
                var oa = a.api.getFilterInstance("categories")
                  , Z = oa.getModel() || {};
                oa.isFilterActive() && (Z = Z.filter.split("###").map(function(W) {
                    return parseInt(W)
                }),
                R = [].concat($jscomp.arrayFromIterable(R), $jscomp.arrayFromIterable(Z)));
                R = Array.from(new Set(R)).filter(function(W) {
                    return !isNaN(W)
                });
                var ja = function(W) {
                    if (W.length < Q) {
                        for (var Aa; qa.length < CsvType.length; )
                            qa.push(-1),
                            ka.push(null);
                        for (Aa = {
                            asin: null,
                            domainId: null,
                            stats: {
                                avg30: qa,
                                avg90: qa,
                                avg180: qa,
                                current: qa,
                                min: ka,
                                max: ka,
                                outOfStockPercentage90: qa
                            }
                        }; W.length < Q; )
                            W.push(Aa)
                    }
                    for (Aa = 0; Aa < W.length; Aa++)
                        W[Aa] = GridHelper.prepareProduct(W[Aa]);
                    fa.resolve(W)
                };
                GridHelperCategory.load(T, T[0].domainId, R).done(function(W) {
                    oa.isFilterActive() && $(oa.wrapper).find("p > span").each(function() {
                        var Aa = parseInt($(this).find("i").data("id"));
                        Aa = GridHelperCategory.getName(T[0].domainId, Aa);
                        $(this).find("span").html(Aa)
                    });
                    ja(T)
                }).fail(function() {
                    ja(T)
                })
            }
        }).promise()
    }, qa = [], ka = [], za = function(w, B, Q) {
        var fa = $("#grid-tools-finder .tool__results");
        if (fa.length) {
            var R = '<i class="fa fa-info-circle fa-lg"></i>&ensp;Displaying <b>' + NumberUtil.format(w) + "</b> rows";
            B && Q && Q !== w ? (Q === B && (R += " (out of a total result of " + NumberUtil.format(B) + ", failed to load: " + NumberUtil.format(Q - w) + ' - <span class="trigger reload">try to reload</span>)'),
            Q < B && (R += " of " + Q + " (out of a total result of " + NumberUtil.format(B) + ", failed to load: " + NumberUtil.format(Q - w) + ' - <span class="trigger reload">try to reload</span>)')) : B && (R += " (out of a total result of " + NumberUtil.format(B) + ")");
            fa.html(R + " &emsp;");
            w = $(".tool__results .reload");
            if (w.length)
                w.on("click", function() {
                    a.api.onFilterChanged()
                })
        }
    }, J = 0, g = function() {
        var w = ++J
          , B = $("#filterForm");
        B[0].checkValidity() ? (B = B.serializeArray(),
        p(B),
        B = a.api.getFilterModel(),
        0 == Object.keys(B).length || 1 == Object.keys(B).length && "undefined" !== typeof B.allowOutdatedOfferData ? D(-1) : (P(),
        t.perPage = 0,
        t.page = 0,
        B = t,
        isTest && console.info("%cGrid: sendTotalResultsQuery \u27fc ", "color:orange;font-weight:bold;", B, [JSON.stringify(B)]),
        network.request({
            path: "pro/finder",
            query: B,
            domainId: Number(storage.domain),
            version: 3
        }).done(function(Q) {
            w != J ? isTest && console.log("%cGrid: discarding prev. query result", "color:darkorange;font-weight:bold;", Q) : D(Q && "undefined" !== typeof Q.totalResults ? Q.totalResults : -1)
        }).fail(function(Q) {
            D(-1)
        }))) : D(-1)
    }, D = function(w) {
        var B = $("#totalResultsQuery");
        0 <= w ? B.show() : B.hide();
        B.find("span").html(NumberUtil.format(w))
    }, N = function(w, B, Q) {
        var fa = "#!finder";
        null != w && (w = {
            f: w,
            s: B,
            t: Q ? "g" : "f"
        },
        B = encodeURIComponent(JSON.stringify(w)),
        6E4 > B.length ? fa += "/" + B : isTest && console.info("%cBookmark: encodedHash too long \u27fc ", "color:pink;font-weight:bold;", w));
        history.pushState({
            page: "finder"
        }, "Product Finder " + (Q ? "Grid" : "Form"), getBaseUrl() + fa);
        preOverlayUrl = fa
    }, ba = function() {
        $("#filterQuery").on("click", function() {
            var w = $("#filterForm").serializeArray();
            p(w);
            P();
            M()
        })
    }, q = function() {
        var w = $("#filterForm");
        w.find(".filter--reset").on("click", function() {
            var B = $(this)
              , Q = B.closest(".filter-row")
              , fa = B.closest("section")
              , R = !0
              , T = Q;
            B.hasClass("filter-section--reset") ? (R = !1,
            T = fa) : B.hasClass("filter-form--reset") && (R = !1,
            T = w);
            var oa = !0;
            if (R) {
                var Z = $(Q).data("csvtype");
                ["NEW_FBA", "NEW_FBM_SHIPPING"].includes(Z) ? (Z = $(w).find("input#boolean-NEW_outOfStock-checkbox"),
                $(Z).prop("checked") && (oa = !1)) : ["WAREHOUSE", "USED_NEW_SHIPPING", "USED_VERY_GOOD_SHIPPING", "USED_GOOD_SHIPPING", "USED_ACCEPTABLE_SHIPPING"].includes(Z) && (Z = $(w).find("input#boolean-USED_outOfStock-checkbox"),
                $(Z).prop("checked") && (oa = !1))
            }
            T.find("input, select").each(function() {
                "radio" === this.type ? ("-1" === $(this).val() || "0,1" === $(this).val()) && $(this).prop("checked", !0) : "checkbox" === this.type && this.name.includes("set-") ? $(this).prop("checked", !0) : "checkbox" === this.type && oa ? $(this).prop("checked", !1).prop("disabled", !1) : "select-one" === this.type && this.name.includes("Type-") ? $(this).val("isOneOf") : "select-one" === this.type ? $(this).val("-1") : $(this).val("")
            });
            T.find(".filter-text--autocomplete .mdc-text-field-helper-text--persistent").each(function() {
                $(this).html("&thinsp;")
            });
            B.hide();
            B.hasClass("filter-form--reset") && w.find(".filter--reset").hide();
            B.hasClass("filter-section--reset") && B.closest("div").find(".filter--reset").hide();
            O(null, Q, fa);
            oa && (B = [],
            R && enableSubcategorySalesRankFilter ? Q.hasClass("filter-row--matrix") ? GridFinderFormMatrix.resetRow(Q) : B = w.find(".filter-row:not(.filter-row--matrix) .filter-range--label.disabled, .filter-row:not(.filter-row--matrix) .filter-range--input.disabled, .filter-row:not(.filter-row--matrix) .filter-text--autocomplete.disabled") : B = w.find(".filter-range--label.disabled, .filter-range--input.disabled, .filter-text--autocomplete.disabled"),
            B.length && B.each(function() {
                $(this).hasClass("disabled") && ($(this).removeClass("disabled"),
                $(this).find("input").prop("readonly", !1))
            }));
            g()
        });
        w.find(".filter-row").each(function() {
            O(null, $(this), $(this).closest("section"))
        });
        w.find(".section-strings").each(function() {
            O(null, null, $(this))
        })
    };
    setupChangeListener = function() {
        $("#filterForm").find("input, select").on("change", function() {
            var w = $(this).closest(".filter-row")
              , B = $(this).closest("section");
            O(this, w, B);
            w.hasClass("filter-row--matrix") && GridFinderFormMatrix.apply(this);
            g()
        });
        GridFinderFormMatrix.init(a)
    }
    ;
    var L = function() {
        var w = function(fa) {
            if (!$(fa).prop("disabled")) {
                var R = $(fa).closest(".filter-row")
                  , T = R.data("csvtype")
                  , oa = fa.name.includes("outOfStock")
                  , Z = $(R).find("input[name$='current'], input[name$='deltaPercent90']");
                R = $(R).find('input[type="checkbox"]:not([name="' + fa.name + '"])');
                if (oa) {
                    if (["NEW_FBA", "NEW_FBM_SHIPPING"].includes(T)) {
                        var ja = $(B).find("input#boolean-NEW_outOfStock-checkbox");
                        if ($(ja).prop("checked"))
                            return
                    } else if (["WAREHOUSE", "USED_NEW_SHIPPING", "USED_VERY_GOOD_SHIPPING", "USED_GOOD_SHIPPING", "USED_ACCEPTABLE_SHIPPING"].includes(T) && (ja = $(B).find("input#boolean-USED_outOfStock-checkbox"),
                    $(ja).prop("checked")))
                        return;
                    "NEW" === T ? (Z = [].concat($jscomp.arrayFromIterable(Z), $jscomp.arrayFromIterable($(B).find("\n                    input[name$='NEW_FBA_current'],\n                    input[name$='NEW_FBA_deltaPercent90'],\n                    input[name$='NEW_FBM_SHIPPING_current'],\n                    input[name$='NEW_FBM_SHIPPING_deltaPercent90']"))),
                    R = [].concat($jscomp.arrayFromIterable(R), $jscomp.arrayFromIterable($(B).find("\n                    input[type=\"checkbox\"][name$='NEW_FBA_isLowest'],\n                    input[type=\"checkbox\"][name$='NEW_FBA_outOfStock'],\n                    input[type=\"checkbox\"][name$='NEW_FBM_SHIPPING_isLowest'],\n                    input[type=\"checkbox\"][name$='NEW_FBM_SHIPPING_outOfStock']")))) : "USED" === T && (Z = [].concat($jscomp.arrayFromIterable(Z), $jscomp.arrayFromIterable($(B).find("\n                    input[name$='WAREHOUSE_current'],\n                    input[name$='WAREHOUSE_deltaPercent90'],\n                    input[name$='USED_NEW_SHIPPING_current'],\n                    input[name$='USED_NEW_SHIPPING_deltaPercent90'],\n                    input[name$='USED_VERY_GOOD_SHIPPING_current'],\n                    input[name$='USED_VERY_GOOD_SHIPPING_deltaPercent90'],\n                    input[name$='USED_GOOD_SHIPPING_current'],\n                    input[name$='USED_GOOD_SHIPPING_deltaPercent90'],\n                    input[name$='USED_ACCEPTABLE_SHIPPING_current'],\n                    input[name$='USED_ACCEPTABLE_SHIPPING_deltaPercent90']"))),
                    R = [].concat($jscomp.arrayFromIterable(R), $jscomp.arrayFromIterable($(B).find("\n                    input[type=\"checkbox\"][name$='WAREHOUSE_isLowest'],\n                    input[type=\"checkbox\"][name$='WAREHOUSE_outOfStock'],\n                    input[type=\"checkbox\"][name$='USED_NEW_SHIPPING_isLowest'],\n                    input[type=\"checkbox\"][name$='USED_NEW_SHIPPING_outOfStock'],\n                    input[type=\"checkbox\"][name$='USED_VERY_GOOD_SHIPPING_isLowest'],\n                    input[type=\"checkbox\"][name$='USED_VERY_GOOD_SHIPPING_outOfStock'],\n                    input[type=\"checkbox\"][name$='USED_GOOD_SHIPPING_isLowest'],\n                    input[type=\"checkbox\"][name$='USED_GOOD_SHIPPING_outOfStock'],\n                    input[type=\"checkbox\"][name$='USED_ACCEPTABLE_SHIPPING_isLowest'],\n                    input[type=\"checkbox\"][name$='USED_ACCEPTABLE_SHIPPING_outOfStock']"))))
                }
                if ($(fa).prop("checked"))
                    $(R).prop("checked", !1).prop("disabled", !0),
                    oa && ($(Z).val("").prop("readonly", !0),
                    $(Z).closest(".filter-range--input").addClass("disabled"),
                    $(Z).closest(".filter-range--input").prev().addClass("disabled"));
                else if ($(R).prop("disabled", !1),
                oa || !oa && !$(R[0]).prop("checked"))
                    $(Z).prop("readonly", !1),
                    $(Z).closest(".filter-range--input").removeClass("disabled"),
                    $(Z).closest(".filter-range--input").prev().removeClass("disabled")
            }
        }
          , B = $(".section-csv")
          , Q = B.find(".filter-row:not(.filter-row--matrix)").find('input[type="checkbox"]');
        Q.each(function() {
            w(this)
        });
        Q.on("change", function() {
            w(this)
        })
    }
      , A = function() {
        $("#numberFrom-LIGHTNING_DEAL_current, #numberTo-LIGHTNING_DEAL_current").on("change", function() {
            $(this).val().length && $("#booleanAll-LIGHTNING_DEAL_upcoming-radio").prop("checked", !0)
        });
        $('input[name="boolean-LIGHTNING_DEAL_upcoming"]').on("change", function() {
            -1 < $(this).val() && $("#numberFrom-LIGHTNING_DEAL_current, #numberTo-LIGHTNING_DEAL_current").val("")
        })
    }
      , O = function(w, B, Q) {
        var fa = $("#filterForm")
          , R = function(oa) {
            var Z = $(oa).val();
            return "checkbox" === oa.type && oa.checked && !oa.name.includes("set-") || "checkbox" === oa.type && !oa.checked && oa.name.includes("set-") || "radio" === oa.type && oa.checked && "-1" !== Z && "0,1" !== Z || "select-one" === oa.type && !oa.name.includes("Type-") && "-1" !== Z || !["checkbox", "radio", "select-one"].includes(oa.type) && "" !== Z
        }
          , T = !1;
        null !== w && R(w) ? (T = !0,
        B = B || $(w).closest(".filter-row"),
        Q = Q || $(w).closest("section")) : (null !== B ? B : null !== Q ? Q : fa).find("input, select").each(function() {
            if (R(this))
                return B = B || $(w).closest(".filter-row"),
                Q = Q || $(w).closest("section"),
                T = !0,
                !1
        });
        T ? (null !== B && B.find(".filter--reset").show(),
        Q.find(".filter-section--reset").show(),
        fa.find(".filter-form--reset").show()) : (null !== B && B.find(".filter--reset").hide(),
        null !== B ? (Q = Q || B.closest("section"),
        1 > Q.find(".filter--reset:visible").not(".filter-section--reset").length && Q.find(".filter-section--reset").hide(),
        B.hasClass("readonly") && (B.removeClass("readonly"),
        B.find("input").prop("readonly", !1))) : Q.find(".filter-section--reset").hide(),
        1 > fa.find(".filter--reset:visible").not(".filter-form--reset").length && fa.find(".filter-form--reset").hide())
    }
      , P = function() {
        var w = {}
          , B = GridConfig.csvTypesEnableOutOfStock
          , Q = GridConfig.csvTypesEnableLowestEver
          , fa = a.api.getFilterModel()
          , R = "current avg30 avg90 avg180 deltaPercent30 deltaPercent90".split(" ")
          , T = GridHelper.getCurrentUnitSystem()
          , oa = fa.hasOwnProperty("allowOutdatedOfferData")
          , Z = fa.hasOwnProperty("COUNT_REVIEWS_current") || fa.hasOwnProperty("RATING_current")
          , ja = fa.hasOwnProperty("EBAY_NEW_SHIPPING_current") || fa.hasOwnProperty("EBAY_USED_SHIPPING_current")
          , W = !1
          , Aa = !1
          , Ca = !1
          , Ba = !1
          , ta = []
          , Ea = [];
        f = [];
        var va = {}, da;
        for (da in fa) {
            va.$jscomp$loop$prop$colId$719 = da;
            var Y = fa[va.$jscomp$loop$prop$colId$719];
            switch (Y.filterType) {
            case "text":
                "contains" == Y.type && (w[va.$jscomp$loop$prop$colId$719] = Y.filter);
                if ("isOneOf" == Y.type)
                    if ("sellerIds" === va.$jscomp$loop$prop$colId$719) {
                        var ma = Y.filter.split(",").map(function(X) {
                            return X.trim()
                        }).filter(function(X) {
                            return "" != X
                        });
                        ma = ua(va.$jscomp$loop$prop$colId$719, ma);
                        w[va.$jscomp$loop$prop$colId$719] = ma;
                        ta.push(va.$jscomp$loop$prop$colId$719)
                    } else
                        ma = Y.filter.split("###").map(function(X) {
                            return X.trim()
                        }).filter(function(X) {
                            return "" != X
                        }),
                        ma = ua(va.$jscomp$loop$prop$colId$719, ma),
                        w[va.$jscomp$loop$prop$colId$719] = ma;
                "isNoneOf" == Y.type && (Y = Y.filter.split("###").map(function(X) {
                    return X.trim()
                }).filter(function(X) {
                    return "" != X
                }),
                Y = ua(va.$jscomp$loop$prop$colId$719, Y),
                w[va.$jscomp$loop$prop$colId$719] = Y.map(function(X) {
                    return "\u271c" + X
                }));
                break;
            case "number":
                ma = va.$jscomp$loop$prop$colId$719;
                var ca = Y.filter
                  , ha = Y.filterTo
                  , C = GridHelper.getCsvObjectName(va.$jscomp$loop$prop$colId$719)
                  , U = R.filter(function(X) {
                    return function(sa) {
                        if (X.$jscomp$loop$prop$colId$719.includes(sa))
                            return !0
                    }
                }(va))[0];
                "undefined" != typeof U && U.length && (va.$jscomp$loop$prop$colId$719.includes(U) && (ma = U + "_" + va.$jscomp$loop$prop$colId$719.replace("_" + U, "")),
                !va.$jscomp$loop$prop$colId$719.includes(U) || va.$jscomp$loop$prop$colId$719.includes("SALES") || va.$jscomp$loop$prop$colId$719.includes("COUNT") || va.$jscomp$loop$prop$colId$719.includes("deltaPercent90") || va.$jscomp$loop$prop$colId$719.includes("salesRankReference") || "RATING_current" === va.$jscomp$loop$prop$colId$719 || 5 == Number(storage.domain) || (ca = ca ? 100 * ca : ca,
                ha = ha ? 100 * ha : ha),
                "RATING_current" == va.$jscomp$loop$prop$colId$719 && (ca = ca ? 10 * ca : ca,
                ha = ha ? 10 * ha : ha),
                CsvType[C] && CsvType[C].currency && GridHelper.isOfferData(C) && ma.includes("current") && ta.push(ma));
                ["packageDimension", "itemDimension"].includes(va.$jscomp$loop$prop$colId$719) && ("IMPERIAL" === T ? (ca = ca ? ca / 6.1024E-5 : ca,
                ha = ha ? ha / 6.1024E-5 : ha) : (ca = ca ? 1E3 * ca : ca,
                ha = ha ? 1E3 * ha : ha));
                "packageLength packageHeight packageWidth itemLength itemHeight itemWidth".split(" ").includes(va.$jscomp$loop$prop$colId$719) && ("IMPERIAL" === T ? (ca = ca ? ca / .03937 : ca,
                ha = ha ? ha / .03937 : ha) : (ca = ca ? 10 * ca : ca,
                ha = ha ? 10 * ha : ha));
                ["packageWeight", "itemWeight"].includes(va.$jscomp$loop$prop$colId$719) && "IMPERIAL" === T && (ca = ca ? ca / .0022046 : ca,
                ha = ha ? ha / .0022046 : ha);
                ["couponOneTimeAbsolute", "fbaFees"].includes(va.$jscomp$loop$prop$colId$719) && 5 != Number(storage.domain) && (ca = ca ? 100 * ca : ca,
                ha = ha ? 100 * ha : ha);
                (ma.includes("coupon") || ma.includes("offerCount")) && ta.push(ma);
                ca = 0 == ca || ca ? parseInt(ca) : null;
                ha = 0 == ha || ha ? parseInt(ha) : null;
                ca = 2147483647 < ca ? 1E9 : ca;
                ha = 2147483647 < ha ? 1E9 : ha;
                "AMAZON_outOfStockPercentage90" === ma ? ma = "outOfStockPercentage90" : "BUY_BOX_SHIPPING_outOfStockPercentage90" === ma ? ma = "outOfStockPercentage90_BB" : ["NEW_outOfStockPercentage90", "USED_outOfStockPercentage90"].includes(ma) && (ma = "outOfStockPercentage90_" + va.$jscomp$loop$prop$colId$719.replace("_outOfStockPercentage90", ""));
                if ("inRange" == Y.type)
                    w[ma + "_gte"] = ca,
                    w[ma + "_lte"] = ha;
                else if ("greaterThanOrEqual" == Y.type)
                    w[ma + "_gte"] = ca;
                else {
                    Y = 0;
                    if ("undefined" != typeof C && C.length && !va.$jscomp$loop$prop$colId$719.includes("COUNT") || va.$jscomp$loop$prop$colId$719.includes("package"))
                        Y = 1;
                    w[ma + "_gte"] = Y;
                    w[ma + "_lte"] = ca
                }
                break;
            case "boolean":
                if (-1 < Y.filter || "on" === Y.filter)
                    ma = GridHelper.getCsvObjectName(va.$jscomp$loop$prop$colId$719),
                    (B.includes(ma) || Q.includes(ma)) && [ma + "_outOfStock", ma + "_isLowest"].includes(va.$jscomp$loop$prop$colId$719) ? "on" === Y.filter && (va.$jscomp$loop$prop$colId$719 === ma + "_outOfStock" ? (w["current_" + ma + "_gte"] = -1,
                    w["current_" + ma + "_lte"] = -1,
                    Ea.push("deltaPercent90_" + ma + "_lte"),
                    Ea.push("deltaPercent90_" + ma + "_gte"),
                    Y = [],
                    "NEW" === ma ? Y = ["NEW_FBA", "NEW_FBM_SHIPPING"] : "USED" === ma && (Y = ["WAREHOUSE", "USED_NEW_SHIPPING", "USED_VERY_GOOD_SHIPPING", "USED_GOOD_SHIPPING", "USED_ACCEPTABLE_SHIPPING"]),
                    Y.length && Y.forEach(function(X) {
                        Ea.push("current_" + X + "_lte");
                        Ea.push("current_" + X + "_gte");
                        Ea.push("deltaPercent90_" + X + "_lte");
                        Ea.push("deltaPercent90_" + X + "_gte")
                    })) : va.$jscomp$loop$prop$colId$719 === ma + "_isLowest" && (w["isLowest_" + ma] = !0),
                    CsvType[ma].currency && GridHelper.isOfferData(ma) && ta.push(va.$jscomp$loop$prop$colId$719)) : "LIGHTNING_DEAL_upcoming" === va.$jscomp$loop$prop$colId$719 ? w.lightningStart_gte = keepaTime.now() : w[va.$jscomp$loop$prop$colId$719] = "promotions" === va.$jscomp$loop$prop$colId$719 ? 1 == Y.filter ? [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] : [] : "singleVariation" === va.$jscomp$loop$prop$colId$719 ? !0 : 1 == Y.filter;
                break;
            case "date":
                ma = Y.dateFrom;
                ca = Y.dateTo;
                ["lastPriceChange", "listedSince", "publicationDate", "releaseDate", "trackingSince"].includes(va.$jscomp$loop$prop$colId$719) && (C = (new Date("1900-01-01")).setUTCHours(0, 0, 0, 0),
                ha = (new Date("2999-12-31")).setUTCHours(23, 59, 59, 999),
                ma && (ma = (new Date(ma)).setHours(0, 0, 0, 0)),
                ca && (ca = (new Date(ca)).setHours(23, 59, 59, 999)),
                ma = ma ? keepaTime.epochToMinutes(Math.max(C, ma)) : ma,
                ca = ca ? keepaTime.epochToMinutes(Math.min(ha, ca)) : ca);
                "inRange" == Y.type ? (w[va.$jscomp$loop$prop$colId$719 + "_gte"] = ma,
                w[va.$jscomp$loop$prop$colId$719 + "_lte"] = ca) : w[va.$jscomp$loop$prop$colId$719 + "_" + ("greaterThanOrEqual" == Y.type ? "gte" : "lte")] = ma;
                break;
            case "singleChoice":
                -1 < Y.filter && (w[va.$jscomp$loop$prop$colId$719] = parseInt(Y.filter));
                break;
            case "autocomplete":
                ma = Y.filter.split("###").map(function(X) {
                    return X.trim()
                }).filter(function(X) {
                    return "" != X
                });
                ma = ua(va.$jscomp$loop$prop$colId$719, ma);
                "isNoneOf" == Y.type ? w[va.$jscomp$loop$prop$colId$719] = ma.map(function(X) {
                    return "\u271c" + X
                }) : w["categories" === va.$jscomp$loop$prop$colId$719 ? va.$jscomp$loop$prop$colId$719 + "_include" : va.$jscomp$loop$prop$colId$719] = ma;
                break;
            case "dynamic":
                "buyBoxSellerIdHistory" === va.$jscomp$loop$prop$colId$719 && -1 != Y.filter && (Y = (1 != Y.filter ? Y.filter : Y.filterDetail).split(",").map(function(X) {
                    return X.trim()
                }).filter(function(X) {
                    return "" != X
                }),
                Y = ua(va.$jscomp$loop$prop$colId$719, Y),
                w.buyBoxSellerId = Y,
                w.hasOwnProperty("current_BUY_BOX_SHIPPING_gte") || -1 == w.buyBoxSellerId[0] || (w.current_BUY_BOX_SHIPPING_gte = 0));
                break;
            case "set":
                w[va.$jscomp$loop$prop$colId$719] = Y.values;
                break;
            default:
                isTest && console.info("%cGrid filterModel \u27fc ", "color:#6666bf;", fa)
            }
            va = {
                $jscomp$loop$prop$colId$719: va.$jscomp$loop$prop$colId$719
            }
        }
        Ea.length && Ea.forEach(function(X) {
            delete w[X];
            X.includes("current") && (ta = ta.filter(function(sa) {
                var wa = X.replace("_gte", "").replace("_lte");
                return sa !== wa
            }))
        });
        f.length && u(f);
        var ia = [];
        a.api.getSortModel().forEach(function(X) {
            var sa = X.colId
              , wa = sa;
            X = X.sort;
            var xa = R.filter(function(Ia) {
                if (sa.includes(Ia))
                    return !0
            })[0];
            sa.includes(xa) && (wa = xa + "_" + sa.replace("_" + xa, ""));
            "LIGHTNING_DEAL_upcoming" === sa && (wa = "lightningStart");
            "AMAZON_outOfStockPercentage90" === wa ? wa = "outOfStockPercentage90" : "BUY_BOX_SHIPPING_outOfStockPercentage90" === wa ? wa = "outOfStockPercentage90_BB" : ["NEW_outOfStockPercentage90", "USED_outOfStockPercentage90"].includes(wa) && (wa = "outOfStockPercentage90_" + sa.replace("_outOfStockPercentage90", ""));
            "lastPriceChange" === sa && (X = "asc" === X ? "desc" : "asc");
            ia.push([wa, X]);
            0 === ta.length && (xa = GridHelper.getCsvObjectName(sa),
            "undefined" != typeof CsvType[xa] && CsvType[xa].currency && GridHelper.isOfferData(xa) && sa.includes("current") && ta.push(wa),
            (sa.includes("coupon") || sa.includes("offerCount")) && ta.push(wa));
            Z || (Z = "COUNT_REVIEWS_current" === sa || "RATING_current" === sa);
            ja || (ja = "EBAY_NEW_SHIPPING_current" === sa || "EBAY_USED_SHIPPING_current" === sa);
            "outOfStockPercentage90" === wa && "desc" === X && "undefined" == typeof w.outOfStockPercentage90_lte && (W = !0);
            "outOfStockPercentage90_NEW" === wa && "desc" === X && "undefined" == typeof w.outOfStockPercentage90_NEW_lte && (Aa = !0);
            "outOfStockPercentage90_USED" === wa && "desc" === X && "undefined" == typeof w.outOfStockPercentage90_USED_lte && (Ca = !0);
            "outOfStockPercentage90_BB" === wa && "desc" === X && "undefined" == typeof w.outOfStockPercentage90_BB_lte && (Ba = !0)
        });
        0 == ia.length && ia.push(["current_SALES", "asc"]);
        w.sort = ia;
        0 < ta.length && !oa && (B = new Date,
        B = B.setDate(B.getDate() - 3),
        w.lastOffersUpdate_gte = keepaTime.epochToMinutes(B));
        Z && !oa && (oa = new Date,
        oa = oa.setDate(oa.getDate() - 14),
        w.lastRatingUpdate_gte = keepaTime.epochToMinutes(oa));
        W && (w.outOfStockPercentage90_lte = 100);
        Aa && (w.outOfStockPercentage90_NEW_lte = 100);
        Ca && (w.outOfStockPercentage90_USED_lte = 100);
        Ba && (w.outOfStockPercentage90_BB_lte = 100);
        (w.current_LIGHTNING_DEAL_lte || w.current_LIGHTNING_DEAL_gte) && delete w.lightningEnd_gte;
        "undefined" == typeof w.productType && (w.productType = [0, 1]);
        "undefined" !== typeof w.allowOutdatedOfferData && delete w.allowOutdatedOfferData;
        "current_SALES_gte current_SALES_lte isLowest_SALES outOfStock_SALES avg30_SALES_gte avg30_SALES_lte avg90_SALES_gte avg90_SALES_lte avg180_SALES_gte avg180_SALES_lte deltaPercent90_SALES_gte deltaPercent90_SALES_lte".split(" ").some(function(X) {
            return "undefined" !== typeof w[X]
        }) && (delete w.current_salesRankReference_gte,
        delete w.current_salesRankReference_lte,
        delete w.salesRankReference);
        return t = m = w
    }
      , M = function() {
        "undefined" === typeof m.perPage && (m.perPage = GridApi.getRowsPerPage(a));
        m.perPage = Math.max(50, m.perPage);
        m.page = 0;
        var w = m;
        w = '<div style="width:500px;">\n\t\t\t\t\t<span>If you have Keepa API access you can use the following JSON to \n\t\t\t\t\t\t<a href="https://keepa.com/#!discuss/t/product-finder/5473">query our product database</a> via our API:\n\t\t\t\t\t</span>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<pre style="height:300px;overflow:auto;background-color:#fff4e0;">' + JSON.stringify(w, null, 4) + '</pre><br>\n\t\t\t\t\t\tComplete API URL:\n\t\t\t\t\t\t<div style="width:100%;overflow:auto;background-color:#fff4e0;white-space:nowrap;">\n\t\t\t\t\t\t\thttps://api.keepa.com/query?key=<span style="color:red">YOUR_API_KEY</span>&domain=' + Number(storage.domain) + "&selection=" + encodeURIComponent(JSON.stringify(w)) + "\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>";
        showPopup("Product Finder API query for current selection", w, !0)
    }
      , u = function(w) {
        var B = "";
        w && w.length && (B += '<br><p class="mdc-typography--body2">The following filter fields have been limited to ' + GridConfig.maxValuesPerFinderFilter + ' entries:</p>\n                <ul class="mdc-typography--body2">\n                    <li>&bull; ' + w.join("</li><li>&bull; ") + "</li>\n                </ul>");
        showPopup("Filter value restriction", '<p class="mdc-typography--body2">Fields where multiple entries are possible (e.g. Manufacturer) a maximum of ' + GridConfig.maxValuesPerFinderFilter + " entries are supported.</p>" + B, !0)
    }
      , v = function() {
        var w = GridConfig.csvTypesEnableLowestEver
          , B = GridConfig.csvTypesEnableOutOfStock
          , Q = "allowOutdatedOfferData categories_exclude hasParentASIN productType sellerIds salesRankReference salesRankReference_current singleVariation".split(" ")
          , fa = ""
          , R = ""
          , T = ""
          , oa = ""
          , Z = ""
          , ja = ""
          , W = ""
          , Aa = ""
          , Ca = ""
          , Ba = ""
          , ta = ""
          , Ea = ""
          , va = ""
          , da = ""
          , Y = ""
          , ma = ""
          , ca = ""
          , ha = a.api.getFilterModel()
          , C = Object.keys(ha);
        ha = a.columnApi.getAllColumns();
        var U = []
          , ia = getCurrencyByDomain(Number(storage.domain))
          , X = ""
          , sa = ""
          , wa = ""
          , xa = !1
          , Ia = !1
          , Fa = !1
          , Ga = !1
          , Da = !1
          , Ma = !1;
        ha.forEach(function(Oa) {
            var Ha = Oa.colDef;
            if (!(!1 === Ha.filter || Ha.hide && Ha.lockVisible && !Q.includes(Ha.field))) {
                var ya = a.api.getFilterInstance(Oa.colId)
                  , Na = ya.getModel() || {}
                  , La = Na.type
                  , Sa = ""
                  , Ka = "";
                Ka = "";
                var Ra = [];
                Sa = Ka = Ka = null;
                var Ua = "";
                switch (Ha.filter) {
                case "agTextColumnFilter":
                    if (!ya.isFilterActive())
                        break;
                    Ka = Na.filter;
                    "isOneOf" == ya.textFilterParams.defaultOption ? "sellerIds" === Ha.field ? Ea += "<p><span>Seller:</span>&emsp;<b>" + Ka + "</b></p>" : Z += "<p><span>" + Ha.headerName + ("isNoneOf" == La ? " (is none of)" : "") + ":</span>&emsp;<b>" + Ka.split("###").join("</b> | <b>") + "</b></p>" : oa += "<p><span>" + Ha.headerName + ":</span>&emsp;<b>" + Ka + "</b></p>";
                    break;
                case "agNumberColumnFilter":
                    xa = Ha.type && Ha.type.includes("priceColumn") || Oa.colId.includes("deltaPercent90") && "SALES_deltaPercent90" !== Oa.colId;
                    Ia = Ha.type && Ha.type.includes("salesRankColumn") || "SALES_deltaPercent90" === Oa.colId;
                    Fa = "salesRankReference_current" === Oa.colId;
                    Ga = Ha.type && Ha.type.includes("offerCountColumn");
                    Da = ["offerCountFBA", "offerCountFBM"].includes(Oa.colId);
                    Ma = ["AMAZON_outOfStockPercentage90", "NEW_outOfStockPercentage90", "USED_outOfStockPercentage90", "BUY_BOX_SHIPPING_outOfStockPercentage90"].includes(Oa.colId);
                    X = GridHelper.getCsvObjectName(Oa.colId);
                    if (X.length && !Fa && !Ma) {
                        sa = CsvType[X].index;
                        "undefined" === typeof U[X] && (U[X] = C.some(function(Ta) {
                            return GridHelper.getCsvObjectName(Ta) === X && !Ta.includes("outOfStockPercentage90")
                        }));
                        if (!0 !== U[X] && !["RATING", "COUNT_REVIEWS"].includes(X))
                            break;
                        if ("RATING" === X && !C.some(function(Ta) {
                            return ["RATING", "COUNT_REVIEWS"].includes(GridHelper.getCsvObjectName(Ta))
                        }) || "COUNT_REVIEWS" === X && !C.some(function(Ta) {
                            return ["RATING", "COUNT_REVIEWS"].includes(GridHelper.getCsvObjectName(Ta))
                        }))
                            break
                    } else if (!ya.isFilterActive()) {
                        if (["fbaFees", "itemWeight", "couponSNSPercent", "packageWeight"].includes(Oa.colId))
                            break;
                        if ("offerCountFBA" === Oa.colId && -1 === C.indexOf("offerCountFBM") || "offerCountFBM" === Oa.colId && -1 === C.indexOf("offerCountFBA") || "numberOfItems" === Oa.colId && -1 === C.indexOf("numberOfPages") || "numberOfPages" === Oa.colId && -1 === C.indexOf("numberOfItems") || "couponOneTimeAbsolute" === Oa.colId && -1 === C.indexOf("couponOneTimePercent") || "couponOneTimePercent" === Oa.colId && -1 === C.indexOf("couponOneTimeAbsolute"))
                            break;
                        if (["packageDimension", "packageLength", "packageWidth", "packageHeight"].includes(Oa.colId) && !C.some(function(Ta) {
                            return Ta.includes("package")
                        }) || ["itemDimension", "itemLength", "itemWidth", "itemHeight"].includes(Oa.colId) && !C.some(function(Ta) {
                            return Ta.includes("item")
                        }) || ["salesRankDrops30", "salesRankDrops90", "salesRankDrops180"].includes(Oa.colId) && !C.some(function(Ta) {
                            return Ta.includes("salesRankDrops")
                        }) || Ma && !C.some(function(Ta) {
                            return Ta.includes("outOfStockPercentage90")
                        }) || "salesRankReference_current" === Oa.colId && !C.some(function(Ta) {
                            return Ta.includes("salesRankReference")
                        }))
                            break
                    }
                    "inRange" == La ? (Ka = "undefined" === typeof Na.filter ? null : Na.filter,
                    Sa = "undefined" === typeof Na.filterTo ? null : Na.filterTo) : "greaterThanOrEqual" === La ? (Ka = "undefined" === typeof Na.filter ? null : Na.filter,
                    Sa = null) : (Ka = null,
                    Sa = "undefined" === typeof Na.filter ? null : Na.filter);
                    "RATING_current" === Oa.colId && (Ka = 0 == Ka || Ka ? 1 > Ka ? "1.0" : 5 < Ka ? "5.0" : Ka : "",
                    Sa = 0 == Sa || Sa ? 1 > Sa ? "1.0" : 5 < Sa ? "5.0" : Sa : "");
                    if (Ha.type && Ha.type.includes("priceColumn") || Oa.colId.includes("fbaFees"))
                        Ka = 0 !== Ka % 1 ? Ka.toFixed(2) : Ka,
                        Sa = 0 !== Sa % 1 ? Sa.toFixed(2) : Sa;
                    Ka = 2147483647 < parseInt(Ka) ? 1E9 : Ka;
                    Sa = 2147483647 < parseInt(Sa) ? 1E9 : Sa;
                    Ha.headerNameGroup = getHeaderNameGroup(Oa.colId, Ha.headerNameGroup);
                    Ma && (Ka = 0 == Ka || Ka ? 0 > Ka ? "0" : 100 < Ka ? "100" : Ka : "",
                    Sa = 0 == Sa || Sa ? 0 > Sa ? "0" : 100 < Sa ? "100" : Sa : "");
                    ya = getRangeLabel(Oa.colId, Ha.headerName);
                    Ua = null !== Ka && 0 !== Ka.length || null !== Sa && 0 !== Sa.length ? "" : " inactive";
                    Ka = '<div class="filter-range--label' + Ua + '">' + ya + '</div>\n\t\t\t\t\t<div class="filter-range--input' + Ua + '">\n\t\t\t\t\t\t<div>From<br>' + (Ka ? "<b>" + Ka + "</b>" : "-") + "</div><div>To<br>" + (Sa ? "<b>" + Sa + "</b>" : "-") + "</div>\n\t\t\t\t\t</div>";
                    Ma ? (Ba.length || (Ba += '<div class="filter-row">\n                                <p class="filter-row--label"><b>' + Ha.headerNameGroup + "</b></p>\n                                <div>\n                            "),
                    Ba += Ka) : wa !== Ha.headerNameGroup ? (wa = Ha.headerNameGroup,
                    xa || Ia ? (Sa = CsvType.getNameWithCircle(sa) + " " + ("SALES" === X ? "#" : ia),
                    ya = "",
                    B.includes(X) && (ya = a.api.getFilterInstance(X + "_outOfStock").filterActive ? Ha.type.includes("salesRankColumn") ? "&check; No Sales Rank" : "&check; Out of stock" : ""),
                    La = "",
                    w.includes(X) && (La = a.api.getFilterInstance(X + "_isLowest").filterActive ? "&check; Lowest ever" : ""),
                    ya = ya.length || La.length ? '<div class="filter-row--label filter-row--label-extended">\n\t\t\t\t\t\t\t\t<span><b>' + Sa + '</b></span>\n\t\t\t\t\t\t\t\t<span class="filter--checkbox">' + ya + ' </span>\n\t\t\t\t\t\t\t\t<span class="filter--checkbox">' + La + " </span>\n\t\t\t\t\t\t\t</div>" : '<p class="filter-row--label"><b>' + Sa + "</b></p>",
                    xa ? (fa.length && (fa += "</div></div>"),
                    fa += '<div class="filter-row" data-csvtype="' + X + '">\n                                    ' + ya + "\n                                    <div>" + Ka + "\n\t\t\t\t\t\t\t\t") : Ia && (R.length && (R += "</div></div>"),
                    R += '<div class="filter-row" data-csvtype="' + X + '">\n                                    ' + ya + "\n                                    <div>" + Ka + "\n\t\t\t\t\t\t\t\t")) : (Sa = Ha.headerNameGroup,
                    Fa ? (T.length && (T += "</div></div>"),
                    T += '<div class="filter-row">\n                                    <p class="filter-row--label"><b>' + Sa + "</b></p>\n                                    <div>" + Ka + "\n\t\t\t\t\t\t\t\t") : Ga ? (da.length && (da += "</div></div>"),
                    da += '<div class="filter-row">\n                                    <p class="filter-row--label"><b>' + Sa + "</b></p>\n                                    <div>" + Ka + "\n\t\t\t\t\t\t\t\t") : Da ? (Y.length && (Y += "</div></div>"),
                    Y += '<div class="filter-row">\n                                    <p class="filter-row--label"><b>' + Sa + "</b></p>\n                                    <div>" + Ka + "\n\t\t\t\t\t\t\t\t") : (ma.length && (ma += "</div></div>"),
                    ma += '<div class="filter-row">\n                                    <p class="filter-row--label"><b>' + Sa + "</b></p>\n                                    <div>" + Ka + "\n\t\t\t\t\t\t\t\t"))) : xa ? fa += Ka : Ia ? R += Ka : Fa ? T += Ka : Ga ? da += Ka : Da ? Y += Ka : ma += Ka;
                    break;
                case "agDateColumnFilter":
                    if (!ya.isFilterActive())
                        break;
                    "inRange" == La ? (Ka = (new Date(Na.dateFrom)).formatDate("Y-m-d"),
                    Sa = (new Date(Na.dateTo)).formatDate("Y-m-d")) : "greaterThanOrEqual" === La ? (Ka = (new Date(Na.dateFrom)).formatDate("Y-m-d"),
                    Sa = null) : (Ka = null,
                    Sa = Na.dateFrom ? (new Date(Na.dateFrom)).formatDate("Y-m-d") : "");
                    Ca += "<p><span>" + Ha.headerName + ":</span>&emsp;From " + (Ka ? "<b>" + Ka + "</b> " : " - ") + " to " + (Sa ? "<b>" + Sa + "</b> " : "-") + "</p>";
                    break;
                case "agSetColumnFilter":
                    if (!ya.isFilterActive())
                        break;
                    if ("productType" === Ha.field) {
                        var Va = ya.valueModel;
                        Ra = [];
                        Va.availableUniqueValues.forEach(function(Ta) {
                            "undefined" !== typeof Va.selectedValuesMap[Ta] && Ra.push(Ha.filterParams.valueMap[Ta])
                        });
                        va += "<p><span>" + Ha.headerName + "</span>&emsp;<b>" + Ra.join("</b> | <b>") + "</b></p>"
                    }
                    if ("availabilityAmazon" === Ha.field) {
                        ma.length && (ma += "</div></div>");
                        var Wa = ya.valueModel;
                        Ra = [];
                        Wa.availableUniqueValues.forEach(function(Ta) {
                            "undefined" !== typeof Wa.selectedValuesMap[Ta] && Ra.push(Ha.filterParams.valueMap[Ta])
                        });
                        ma += '<div class="filter-category--wrapper"><p><span>' + Ha.headerName + "</span>&emsp;<b>" + Ra.join("</b> | <b>") + "</b></p></div>"
                    }
                    break;
                case "customBooleanColumnFilter":
                    "LIGHTNING_DEAL_upcoming" === Ha.field && 1 === parseInt(Na.filter) && (fa += '<div class="filter-boolean--label">&check; ' + Ha.headerName + "</div>");
                    if ("allowOutdatedOfferData" === Ha.field) {
                        if (!ya.isFilterActive())
                            break;
                        ca += "<p>&check; " + Ha.headerName + "</p>";
                        break
                    }
                    if ("hasParentASIN" === Ha.field) {
                        La = "";
                        (Oa = a.api.getFilterInstance("singleVariation").filterActive) && (La = "&check; Show only one variation per product");
                        if (!ya.isFilterActive() && !Oa)
                            break;
                        va += "<p><span>" + Ha.headerName + ":</span>&emsp;<b>" + (0 === parseInt(Na.filter) ? "No Variations" : 1 === parseInt(Na.filter) ? "Is Variation" : "") + (Oa ? "&emsp;|&emsp;" + La : "") + "</p>";
                        break
                    }
                    if ("singleVariation" === Ha.field)
                        break;
                    if (["buyBoxIsFBA", "buyBoxIsUnqualified"].includes(Ha.field)) {
                        if (!ya.isFilterActive())
                            break;
                        Aa += '<span style="width: auto;">' + Ha.headerName + ":</span>&emsp;" + (1 === parseInt(Na.filter) ? "<b>Yes</b>" : "<b>No</b>") + "&emsp;&emsp;";
                        break
                    }
                    if (!ya.isFilterActive())
                        break;
                    W += '<span style="width: auto;">' + Ha.headerName + ":</span>&emsp;" + (1 === parseInt(Na.filter) ? "<b>Yes</b>" : "<b>No</b>") + "&emsp;&emsp;";
                    break;
                case "customSingleChoiceColumnFilter":
                    if (!ya.isFilterActive())
                        break;
                    "rootCategory" === Ha.field && (ya = ya.valueOptions.find(function(Ta) {
                        return Ta.value == Na.filter
                    }),
                    ta += "<p><span>Root category:</span>&emsp;<b>" + ya.label.replace(/ \(\d*\)/, "") + "</b></p>");
                    break;
                case "customAutocompleteColumnFilter":
                    if (!ya.isFilterActive())
                        break;
                    ya = Na.filter.split("###").map(function(Ta) {
                        return Ta.trim()
                    }).filter(function(Ta) {
                        return "" != Ta
                    });
                    ["categories", "categories_exclude"].includes(Ha.field) ? (Ka = "categories" === Ha.field ? "Include sub categories" : Ha.headerName,
                    ya = ya.map(function(Ta) {
                        return GridHelperCategory.getName(Number(storage.domain), Ta)
                    }),
                    ta += "<p><span>" + Ka + ":</span>&emsp;<b>" + ya.join("</b> | <b>") + "</b></p>") : "salesRankReference" === Ha.field ? (ya = ya.map(function(Ta) {
                        return GridHelperCategory.getName(Number(storage.domain), Ta)
                    }),
                    T += '<p style="margin-top: 17px; margin-bottom: 7px;"><span>' + Ha.headerName + ":</span>&emsp;<b>" + ya.join("</b> | <b>") + "</b></p>") : ja += "<p><span>" + Ha.headerName + ("isNoneOf" == La ? " (is none of)" : "") + ":</span>&emsp;<b>" + ya.join("</b> | <b>") + "</b></p>";
                    break;
                case "customDynamicColumnFilter":
                    ya.isFilterActive() && "buyBoxSellerIdHistory" === Ha.field && (Ka = Number(storage.domain),
                    ya = Na.filter,
                    La = Na.filterDetail,
                    Oa = [],
                    AmazonSellerIds[Ka].length && Oa.push(AmazonSellerIds[Ka]),
                    AltAmazonSellerIds[Ka].length && Oa.push(AltAmazonSellerIds[Ka]),
                    Ka = Array.from(Oa, function(Ta) {
                        return "-" + Ta
                    }),
                    Oa = Oa.join(","),
                    Ka = Ka.join(","),
                    [Oa, Ka, "1"].includes(ya) || (ya = -1),
                    Sa = "",
                    ya === Oa ? Sa = "<b>Amazon</b>" : ya === Ka ? Sa = "<b>3rd Party</b>" : 1 == ya && (Sa = "Seller IDs: <b>" + La + "</b>"),
                    Ea = "<p><span>Buy Box Seller:</span>&emsp;" + Sa + "</p>")
                }
            }
        });
        fa = fa.length ? fa + "</div></div>" : fa;
        R = R.length ? R + "</div></div>" : R;
        T = T.length ? T + "</div></div>" : T;
        da = da.length ? da + "</div></div>" : da;
        Y = Y.length ? Y + "</div></div>" : Y;
        Ba = Ba.length ? Ba + "</div></div>" : Ba;
        ma = ma.length ? ma + "</div></div>" : ma;
        Aa = Aa.length ? '<p class="filter-row--label"><b>Additional Buy Box switches</b></p>\n\t\t\t\t<div>' + Aa + "</div>" : "";
        Ca = Ca.length ? '<div class="filter-row">' + Ca + "</div>" : "";
        W = W.length ? '<p class="filter-row">\n\t\t\t<p class="filter-row--label"><b>Additional switches</b></p>\n\t\t\t<p>' + W + "</p>\n\t\t</div>" : "";
        ta = ta.length ? '<div class="filter-category--wrapper">\n\t\t' + ta + "\n\t\t</div>" : "";
        ca = ca.length ? '<div class="filter-row">\n\t\t\t<p class="filter-row--label"><b>Additional settings</b></p>\n\t\t\t' + ca + "\n\t\t</div>" : "";
        ha = R.length || T.length || fa.length ? '<div>\n            <h6 class="mdc-typography--subtitle1">Sales Rank & Price Types</h6>\n            ' + R + "\n            " + T + "\n            " + fa + "\n        </div>" : "";
        var Qa = ta || oa || ja || Z ? '<div>\n\t\t<h6 class="mdc-typography--subtitle1">Title, Brand and more!</h6>\n\t\t' + (ta ? '<p class="filter-row--label"><b>Categories</b></p>' + ta : "") + "\n\t\t" + (oa || ja || Z ? '<p class="filter-row--label"><b>Text fields</b>:</p>' : "") + "\n\t\t" + (oa ? '<div class="filter-text--wrapper">' + oa + "</div>" : "") + "\n\t\t" + (ja ? '<div class="filter-text--wrapper">' + ja + "</div>" : "") + "\n\t\t" + (Z ? '<div class="filter-text--wrapper">' + Z + "</div>" : "") + "\n\t</div>" : ""
          , Ja = da || Y ? '<div>\n\t\t<h6 class="mdc-typography--subtitle1">Offer Counts</h6>\n\t\t' + da + "\n        " + Y + "\n\t</div>" : ""
          , Pa = Ea.length || Aa.length || va.length || Ca.length || Ba.length || ma.length || W.length || ca.length ? '<div>\n\t\t<h6 class="mdc-typography--subtitle1">More filters!</h6>\n\t\t' + (Ea.length || Aa.length || va.length || Ca.length ? '<div class="filter-category--wrapper">\n\t\t\t' + Ea + "\n\t\t\t" + Aa + "\n\t\t\t" + va + "\n\t\t\t" + Ca + "\n\t\t</div>" : "") + "\n\t\t" + Ba + "\n\t\t" + ma + "\n\t\t" + (W.length || ca.length ? '<div class="filter-category--wrapper">\n\t\t\t' + W + "\n\t\t\t" + ca + "\n\t\t</div>" : "") + "\n\t</div>" : "";
        return "<div>\n\t\t" + (ha.length ? '<section class="section-csv">' + ha + "</section>" : "") + "\n\t\t" + (Qa.length ? '<section class="section-strings">' + Qa + "</section>" : "") + "\n\t\t" + (Ja.length ? '<section class="section-offer-counts">' + Ja + "</section>" : "") + "\n\t\t" + (Pa.length ? '<section class="section-other">' + Pa + "</section>" : "") + "\n\t</div>"
    };
    getHeaderNameGroup = function(w, B) {
        return ["packageDimension", "packageLength", "packageWidth", "packageHeight"].includes(w) ? "Package Dimensions" : ["itemDimension", "itemLength", "itemWidth", "itemHeight"].includes(w) ? "Item Dimensions" : ["AMAZON_outOfStockPercentage90", "NEW_outOfStockPercentage90", "USED_outOfStockPercentage90", "BUY_BOX_SHIPPING_outOfStockPercentage90"].includes(w) ? "90 days out of stock percentage (OOS %)" : ["salesRankDrops30", "salesRankDrops90", "salesRankDrops180"].includes(w) ? "Sales Rank Drops" : "fbaFees" === w ? "FBA Pick&Pack Fee " + getCurrencyByDomain(Number(storage.domain)) : ["numberOfItems", "numberOfPages"].includes(w) ? "Number of ..." : B
    }
    ;
    getRangeLabel = function(w, B) {
        if ("LIGHTNING_DEAL_current" === w)
            return la._344;
        if ("fbaFees" === w)
            return "Total";
        if (["salesRankDrops30", "salesRankDrops90", "salesRankDrops180"].includes(w))
            return B.replace("Drops last", "Last");
        if ("packageDimension packageLength packageWidth packageHeight packageWeight itemDimension itemLength itemWidth itemHeight itemWeight".split(" ").includes(w)) {
            var Q = GridHelper.getCurrentUnits();
            Q = w.includes("Weight") ? Q.weight : Q.measure;
            w.includes("Dimension") && (Q += "\u00b3");
            return B + " (" + Q + ")"
        }
        return ["AMAZON_outOfStockPercentage90", "NEW_outOfStockPercentage90", "USED_outOfStockPercentage90"].includes(w) ? (w = GridHelper.getCsvObjectName(w),
        CsvType.getName(CsvType[w].index)) : "BUY_BOX_SHIPPING_outOfStockPercentage90" === w ? "Buy Box out of stock / suppressed" : B
    }
    ;
    var G = function(w) {
        switch (w) {
        case "SALES":
            w = "Amazon Best Sellers rank<br>Disables all Subcategory Sales Rank filters below.";
            break;
        case "AMAZON":
            w = "Sold and fulfilled by Amazon";
            break;
        case "NEW":
            w = "New price by 3rd party seller<br>or Amazon, shipping not included";
            break;
        case "NEW_FBA":
            w = "New price by a 3rd party seller<br>with Fulfillment By Amazon (Prime)";
            break;
        case "NEW_FBM_SHIPPING":
            w = "New price by a 3rd party seller<br>with Fulfillment By Merchant,<br>shipping included";
            break;
        case "USED":
            w = "Used price by 3rd party seller or<br>Amazon (Warehouse), shipping<br>not included";
            break;
        case "LISTPRICE":
            w = "List Price";
            break;
        case "LIGHTNING_DEAL":
            w = "Lightning Deals";
            break;
        case "WAREHOUSE":
            w = "Warehouse Deals";
            break;
        case "COLLECTIBLE":
            w = "Collectible price, shipping not included";
            break;
        case "REFURBISHED":
            w = "Refurbished price, shipping not included";
            break;
        case "BUY_BOX_SHIPPING":
            w = "Price of the New Buy Box offer, shipping included.\n\t\t\t\t\t\t<br>The Buy Box is the box on a product detail page\n\t\t\t\t\t\t<br>where customers can add the item to their shopping carts.";
            break;
        case "USED_NEW_SHIPPING":
            w = "Used, like new price, shipping included";
            break;
        case "USED_VERY_GOOD_SHIPPING":
            w = "Used, very good price, shipping included";
            break;
        case "USED_GOOD_SHIPPING":
            w = "Used, good price, shipping included";
            break;
        case "USED_ACCEPTABLE_SHIPPING":
            w = "Used, acceptable price, shipping included";
            break;
        case "REFURBISHED_SHIPPING":
            w = "Refurbished price, shipping included";
            break;
        case "EBAY_NEW_SHIPPING":
            w = "eBay Fixed Price New, shipping included";
            break;
        case "EBAY_USED_SHIPPING":
            w = "eBay Fixed Price Used, shipping included";
            break;
        case "TRADE_IN":
            w = "Amazon Trade-In Value";
            break;
        case "RENT":
            w = "Rental price";
            break;
        case "salesRankReference_current":
            w = "Amazon Best Sellers rank for a specific subcategory.<br>To activate please choose a subcategory in addition to your desired range.<br>Disables all other Sales Rank filters above.";
            break;
        case "salesRankReference":
            w = "Sales Rank subcategory - only one is supported. Mandatory if subcategory range is set. Will be ignored without a range.";
            break;
        case "author":
            w = "Names of authors. Example: <i>anonymous<i>";
            break;
        case "binding":
            w = "Names of bindings. Example: <i>paperback</i>";
            break;
        case "brand":
            w = "Names of brands. Example: <i>canon</i>";
            break;
        case "categories":
            w = "Amazon subcategories products are listed directly in.";
            break;
        case "categories_exclude":
            w = "Amazon subcategories products are not directly listed in.";
            break;
        case "color":
            w = "Names of colors. Example: <i>black</i>";
            break;
        case "edition":
            w = "Names of editions. Example: <i>first edition</i>";
            break;
        case "format":
            w = "Names of formats. Example: <i>cd-rom</i>";
            break;
        case "languages":
            w = "Names of languages. Example: <i>english</i>";
            break;
        case "manufacturer":
            w = "Names of manufacturers. Example: <i>canon</i>";
            break;
        case "model":
            w = "Names of models. Example: <i>2016</i>";
            break;
        case "partNumber":
            w = "Names of partNumbers. Example: <i>DSC-H300/BM-RB</i>.<br>Filter for exact matches within the <i>PartNumber</i> field.<br>Separate multiple values by: <i>###</i>";
            break;
        case "productGroup":
            w = "Names of productGroups. Example: <i>apparel</i>";
            break;
        case "rootCategory":
            w = "Amazon root categories products are listed in.";
            break;
        case "size":
            w = "Names of sizes. Example: <i>large</i>";
            break;
        case "title":
            w = "Title of the product. Works on a keyword basis, which means the product\u2019s title must contain \n\t\t\t\t\t\t<br>the specified string\u2019s keywords, which are to be separated by a white space. The search is \n\t\t\t\t\t\t<br>case-insensitive. Partial keyword matches are not supported.\n\t\t\t\t\t\t<br>Examples:\n\t\t\t\t\t\t<br><i>Digital Camera Canon</i> - Title must contain all three keywords, in any order or position.\n\t\t\t\t\t\t<br><i>&quot;Digital Camera&quot; Canon</i> - Title must contain the keyword <i>Digital Camera</i> and <i>Canon</i>.\n\t\t\t\t\t\t<br><i>-digital camera</i> - Title must not contain the keyword <i>digital</i> and must contain <i>camera</i>.";
            break;
        case "buyBoxSellerIdHistory":
            w = "Seller id of the current Buy Box holder.<br>To search for suppressed Buy Box provide -1 as seller id.";
            break;
        case "productType":
            w = "Determines what data for the product is available.\n\t\t\t\t\t\t<br>- Physical Product: everything accessible\n\t\t\t\t\t\t<br>- Digital Product: no marketplace/3rd party price data";
            break;
        case "hasParentASIN":
            w = "Whether a product has variations or not";
            break;
        case "sellerIds":
            w = "The seller id of the merchant,<br>prepending a - to a seller id<br>will exclude it from the results.";
            break;
        case "lastPriceChange":
            w = "Last time we have registered a price change (any price type)";
            break;
        case "trackingSince":
            w = "The time we have started tracking a product";
            break;
        case "listedSince":
            w = "The time the product was first listed on Amazon";
            break;
        case "RATING_current":
            w = "A product's rating and review count";
            break;
        case "outOfStockPercentage90":
            w = "The higher the number, the less time an offer of the specific type (condition, merchant type) was in stock.";
            break;
        case "availabilityAmazon":
            w = "Availability of the Amazon offer";
            break;
        case "COUNT_NEW_current":
            w = "Count of marketplace merchants selling a product as new.";
            break;
        case "offerCountFBA":
            w = "Count of retrieved live offers for a specific type (condition, merchant type).";
            break;
        case "COUNT_USED_current":
            w = "Count of marketplace merchants selling a product as used.";
            break;
        case "COUNT_REFURBISHED_current":
            w = "Count of marketplace merchants selling a product as refurbished.";
            break;
        case "COUNT_COLLECTIBLE_current":
            w = "Count of marketplace merchants selling a product as Collectible.";
            break;
        case "itemDimension":
            w = "Item dimensions";
            break;
        case "itemWeight":
            w = "Item weight";
            break;
        case "numberOfItems":
            w = "The number of items or pages a product contains";
            break;
        case "packageDimension":
            w = "Package dimensions";
            break;
        case "packageWeight":
            w = "Package weight";
            break;
        case "couponOneTimeAbsolute":
            w = "Discount of a one time coupon";
            break;
        case "couponSNSPercent":
            w = "Discount of a subscribe and save coupon";
            break;
        case "newPriceIsMAP":
            w = "Whether or not the lowest new price (either price\n\t\t\t\t\t\t<br>type Amazon or New) is restricted by MAP\n\t\t\t\t\t\t<br>(Minimum Advertised Price). Use this to differentiate\n\t\t\t\t\t\t<br>out of stock vs. MAP restriction";
            break;
        case "isAdultProduct":
            w = "Indicates if a product is considered to be for adults only.";
            break;
        case "isEligibleForTradeIn":
            w = "Whether or not a product is eligible for trade-in.";
            break;
        case "isEligibleForSuperSaverShipping":
            w = "Whether or not the product\u2019s buy box is eligible for free shipping.";
            break;
        case "isSNS":
            w = "Indicates if the product\u2019s Buy Box is available for subscribe and save.";
            break;
        case "promotions":
            w = "Whether or not a product has active promotions.";
            break;
        case "fbaFees":
            w = "FBA Pick&Pack Fee for an ASIN.";
            break;
        case "salesRankDrops30":
            w = "The count of sales rank drops (from high value to low value)\n                    <br>within the last X days which are considered to indicate sales.";
            break;
        case "publicationDate":
            w = "The product's publication date";
            break;
        case "releaseDate":
            w = "The product's release date";
            break;
        case "buyBoxIsFBA":
            w = "Whether or not the buy box is fulfilled by Amazon";
            break;
        case "buyBoxIsUnqualified":
            w = "Whether or not a seller won the buy box. If there are only sellers with bad offers none qualifies for the buy box.";
            break;
        case "launchpad":
            w = "Whether or not a product belongs to Amazon Launchpad.";
            break;
        default:
            isTest && console.log("missing tooltip for >>> ", w),
            w = ""
        }
        return w.length ? '<i class="fa fa-question" title="' + w + '"></i>' : ""
    };
    return {
        init: function(w) {
            var B = GridApi.load()
              , Q = Number(storage.domain)
              , fa = network.request({
                path: "pro/category",
                domainId: Q,
                categoryIds: [-1],
                version: 3
            }).done(function(R) {
                GridHelperCategory.setRootHashMap(Q, R.categories)
            });
            return $.when(B, fa).done(function() {
                var R = function(W, Aa, Ca) {
                    var Ba = GridConfig.get(b.type);
                    Ba.pageId = b.pageId;
                    hasDataAccessSubscription || (Ba.gridOptions.pinnedBottomRowData = [{
                        freeAccessRow: !0,
                        message: '<a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to load up to 5000 rows and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>."
                    }],
                    Ba.gridOptions.pagination = !1,
                    Ba.gridOptions.paginationPageSize = 5);
                    b.gridWrapperId = Ba.gridWrapperId;
                    GridPage.init(b);
                    GridPage.initGridContainer(Ba);
                    a = GridApi.init(Ba);
                    if (null !== a) {
                        a.context.config = b;
                        !1 !== b.showTools && GridTools.init(a);
                        d = $("#grid-tools-" + b.pageId).closest(".data-container");
                        if (null != W) {
                            f = [];
                            for (var ta in W)
                                "autocomplete" === W[ta].filterType && (Ba = W[ta].filter.split("###").map(function(Ea) {
                                    return Ea.trim()
                                }).filter(function(Ea) {
                                    return "" != Ea
                                }),
                                Ba = ua(ta, Ba),
                                W[ta].filter = Ba.join("###")),
                                "dynamic" === W[ta].filterType && "buyBoxSellerIdHistory" === ta && -1 != W[ta].filter && (Ba = (1 != W[ta].filter ? W[ta].filter : W[ta].filterDetail).split(",").map(function(Ea) {
                                    return Ea.trim()
                                }).filter(function(Ea) {
                                    return "" != Ea
                                }),
                                Ba = ua(ta, Ba),
                                1 == W[ta].filter ? W[ta].filterDetail = Ba.join(",") : W[ta].filter = Ba.join(",")),
                                "text" === W[ta].filterType && ("isOneOf" == W[ta].type && ("sellerIds" === ta ? (Ba = W[ta].filter.split(",").map(function(Ea) {
                                    return Ea.trim()
                                }).filter(function(Ea) {
                                    return "" != Ea
                                }),
                                Ba = ua(ta, Ba),
                                W[ta].filter = Ba.join(",")) : (Ba = W[ta].filter.split("###").map(function(Ea) {
                                    return Ea.trim()
                                }).filter(function(Ea) {
                                    return "" != Ea
                                }),
                                Ba = ua(ta, Ba),
                                W[ta].filter = Ba.join("###"))),
                                "isNoneOf" == W[ta].type && (Ba = W[ta].filter.split("###").map(function(Ea) {
                                    return Ea.trim()
                                }).filter(function(Ea) {
                                    return "" != Ea
                                }),
                                Ba = ua(ta, Ba),
                                W[ta].filter = Ba.join("###")));
                            f.length && !Ca && u(f);
                            a.api.setFilterModel(W)
                        }
                        null != Aa && a.api.setSortModel(Aa);
                        Ca ? (isTest && console.info("%cGrid: onFilterChanged", "color:#6666bf;font-weight:bold;"),
                        a.api.onFilterChanged(),
                        "undefined" === typeof a.api.rowModel.datasource && (isTest && console.info("%cGrid: initDatasource", "color:#6666bf;font-weight:bold;"),
                        ra())) : (d.hide(),
                        n());
                        GridFilter.setGridApi(a)
                    }
                }
                  , T = !1
                  , oa = null
                  , Z = null;
                if (null != lastSubUrl && !0 !== w) {
                    var ja = decodeURIComponent(lastSubUrl);
                    0 == ja.indexOf("{") && (ja = tryParseJSON(ja),
                    null != ja && (oa = ja.f,
                    Z = ja.s,
                    T = "g" === ja.t,
                    oa.productType && "set" !== oa.productType.filterType && ("0" === oa.productType.filter ? oa.productType = {
                        filter: [0, 1],
                        filterType: "set",
                        values: ["0"]
                    } : "1" === oa.productType.filter ? oa.productType = {
                        filter: [0, 1],
                        filterType: "set",
                        values: ["1"]
                    } : delete oa.productType)))
                }
                window.onpopstate = function(W) {
                    null == W.state && "#!finder" === window.location.hash && "#!finder" === lastUrl && (R(null, null, !1),
                    isTest && console.log("window.onpopstate refresh"))
                }
                ;
                R(oa, Z, T)
            }).fail(showErrorPopup)
        },
        initDatasource: ra,
        initFilter: n,
        showApiQuery: M,
        showFilterInfo: function() {
            var w = function() {
                var fa = v();
                showPopup("Active Product Finder filters", '<div class="popup--medium grid-filter-form grid-filter-form--view-only">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t' + fa + "\n\t\t\t\t\t</div>\n\t\t\t\t</div>", !0)
            }
              , B = []
              , Q = a.api.getFilterInstance("categories");
            Q.isFilterActive() && (Q = Q.getModel() || {},
            B = Array.from(new Set([].concat($jscomp.arrayFromIterable(B), $jscomp.arrayFromIterable(Q.filter.split("###"))))));
            Q = a.api.getFilterInstance("categories_exclude");
            Q.isFilterActive() && (Q = Q.getModel() || {},
            B = Array.from(new Set([].concat($jscomp.arrayFromIterable(B), $jscomp.arrayFromIterable(Q.filter.split("###"))))));
            enableSubcategorySalesRankFilter && (Q = a.api.getFilterInstance("salesRankReference"),
            Q.isFilterActive() && (Q = Q.getModel() || {},
            B = Array.from(new Set([].concat($jscomp.arrayFromIterable(B), $jscomp.arrayFromIterable(Q.filter.split("###")))))));
            GridHelperCategory.load(null, Number(storage.domain), B).done(function() {
                w()
            }).fail(function() {
                w()
            })
        },
        showPopupMaxValuesPerFinderFilter: u,
        handleSpecialFilters: function() {
            $("div.ag-header-cell .ag-header-cell-menu-button").show();
            GridConfig.csvTypesEnableOutOfStock.forEach(function(w) {
                if (a.api && a.api.getFilterInstance(w + "_outOfStock").filterActive) {
                    var B = [w + "_current", w + "_deltaPercent90"];
                    "NEW" === w ? (B.push("NEW_FBA_current"),
                    B.push("NEW_FBA_deltaPercent90"),
                    B.push("NEW_FBM_SHIPPING_current"),
                    B.push("NEW_FBM_SHIPPING_deltaPercent90")) : "USED" === w && (B.push("WAREHOUSE_current"),
                    B.push("WAREHOUSE_deltaPercent90"),
                    B.push("USED_NEW_SHIPPING_current"),
                    B.push("USED_NEW_SHIPPING_deltaPercent90"),
                    B.push("USED_VERY_GOOD_SHIPPING_current"),
                    B.push("USED_VERY_GOOD_SHIPPING_deltaPercent90"),
                    B.push("USED_GOOD_SHIPPING_current"),
                    B.push("USED_GOOD_SHIPPING_deltaPercent90"),
                    B.push("USED_ACCEPTABLE_SHIPPING_current"),
                    B.push("USED_ACCEPTABLE_SHIPPING_deltaPercent90"));
                    B.forEach(function(Q) {
                        $('div.ag-header-cell[col-id="' + Q + '"] .ag-header-cell-menu-button').hide()
                    })
                }
            });
            GridFinderFormMatrix.disableGridFilter(a)
        }
    }
}()
  , GridFinderFormMatrix = function() {
    var a = "numberFrom-SALES_current numberTo-SALES_current numberFrom-SALES_avg30 numberTo-SALES_avg30 numberFrom-SALES_avg90 numberTo-SALES_avg90 numberFrom-SALES_avg180 numberTo-SALES_avg180 numberFrom-SALES_deltaPercent90 numberTo-SALES_deltaPercent90".split(" ")
      , b = ["numberFrom-salesRankReference_current", "numberTo-salesRankReference_current", "autocomplete-salesRankReference", "autocompleteReal-salesRankReference"]
      , d = {
        "boolean-SALES_outOfStock": ["boolean-SALES_isLowest", "numberFrom-SALES_current", "numberTo-SALES_current", "numberFrom-SALES_deltaPercent90", "numberTo-SALES_deltaPercent90"].concat($jscomp.arrayFromIterable(b)),
        "boolean-SALES_isLowest": ["boolean-SALES_outOfStock"].concat($jscomp.arrayFromIterable(b)),
        "numberFrom-SALES_current": b,
        "numberTo-SALES_current": b,
        "numberFrom-SALES_avg30": b,
        "numberTo-SALES_avg30": b,
        "numberFrom-SALES_avg90": b,
        "numberTo-SALES_avg90": b,
        "numberFrom-SALES_avg180": b,
        "numberTo-SALES_avg180": b,
        "numberFrom-SALES_deltaPercent90": b,
        "numberTo-SALES_deltaPercent90": b,
        "numberFrom-salesRankReference_current": ["boolean-SALES_isLowest", "boolean-SALES_outOfStock"].concat($jscomp.arrayFromIterable(a)),
        "numberTo-salesRankReference_current": ["boolean-SALES_isLowest", "boolean-SALES_outOfStock"].concat($jscomp.arrayFromIterable(a)),
        "autocomplete-salesRankReference": ["boolean-SALES_isLowest", "boolean-SALES_outOfStock"].concat($jscomp.arrayFromIterable(a)),
        "autocompleteReal-salesRankReference": ["boolean-SALES_isLowest", "boolean-SALES_outOfStock"].concat($jscomp.arrayFromIterable(a))
    }
      , h = {
        "filter-row--matrix-SALES": ["filter-row--matrix-salesRankReference"],
        "filter-row--matrix-salesRankReference": ["filter-row--matrix-SALES"]
    }
      , m = function(r) {
        var p = r.name;
        d[p] && d[p].length && ($(r).hasClass("ui-autocomplete-input") ? $(r).val("") : f(d[p], t(r)))
    }
      , t = function(r) {
        if ("undefined" === typeof r)
            return !1;
        var p = r.type;
        if ("checkbox" === p)
            return $(r).prop("checked");
        if ("text" === p || "hidden" === p)
            return 0 < $(r).val().length;
        isTest && console.log("missing formField isActive handling:", p);
        return !1
    }
      , f = function(r, p) {
        var z = {};
        r = $jscomp.makeIterator(r);
        for (var F = r.next(); !F.done; z = {
            $jscomp$loop$prop$formFieldName$723: z.$jscomp$loop$prop$formFieldName$723
        },
        F = r.next())
            if (z.$jscomp$loop$prop$formFieldName$723 = F.value,
            F = $('input[name="' + z.$jscomp$loop$prop$formFieldName$723 + '"]').get(0))
                if (!0 === p)
                    n(F, !0);
                else {
                    var I = Object.keys(d).filter(function(E) {
                        return function(K) {
                            return d[K].includes(E.$jscomp$loop$prop$formFieldName$723)
                        }
                    }(z)).filter(function(E) {
                        return t($('input[name="' + E + '"]').get(0))
                    });
                    I && 0 !== I.length || n(F, !1)
                }
    }
      , n = function(r, p) {
        if (r) {
            var z = r.type;
            "checkbox" === z ? !0 === p ? $(r).prop("checked", !1).prop("disabled", !0) : $(r).prop("disabled", !1) : "hidden" === z ? !0 === p ? $(r).val("").prop("readonly", !0) : $(r).prop("readonly", !1) : "text" === z ? !0 === p ? ($(r).val("").prop("readonly", !0),
            r.name.includes("autocomplete") ? (r = $(r).closest(".filter-text--autocomplete"),
            r.addClass("disabled"),
            $(r).find(".filter-text--autocomplete .mdc-text-field-helper-text--persistent").html("&thinsp;")) : ($(r).closest(".filter-range--input").addClass("disabled"),
            $(r).closest(".filter-range--input").prev().addClass("disabled"))) : ($(r).prop("readonly", !1),
            r.name.includes("autocomplete") ? $(r).closest(".filter-text--autocomplete").removeClass("disabled") : ($(r).closest(".filter-range--input").removeClass("disabled"),
            $(r).closest(".filter-range--input").prev().removeClass("disabled"))) : isTest && console.log("missing formField toggleFormField handling:", z, r.name)
        }
    };
    return {
        apply: m,
        disableGridFilter: function(r) {
            if (null != r.api && "undefined" !== typeof r.api) {
                var p = r.api.getFilterModel();
                if (p) {
                    r = [];
                    var z = {}, F;
                    for (F in p) {
                        z.$jscomp$loop$prop$filterKey$721 = F;
                        if ((p = Object.keys(d).filter(function(K) {
                            return function(H) {
                                return H.includes(K.$jscomp$loop$prop$filterKey$721)
                            }
                        }(z))) && p.length) {
                            p = $jscomp.makeIterator(p);
                            for (var I = p.next(); !I.done; I = p.next()) {
                                I = I.value;
                                if (!d[I] || !d[I].length)
                                    return;
                                I = $jscomp.makeIterator(d[I]);
                                for (var E = I.next(); !E.done; E = I.next())
                                    r.push(E.value.split("-")[1])
                            }
                        }
                        z = {
                            $jscomp$loop$prop$filterKey$721: z.$jscomp$loop$prop$filterKey$721
                        }
                    }
                    r = Array.from(new Set(r)).filter(function(K) {
                        return K.length
                    });
                    r.length && r.forEach(function(K) {
                        $('div.ag-header-cell[col-id="' + K + '"] .ag-header-cell-menu-button').hide()
                    })
                }
            }
        },
        init: function(r) {
            if (r.api && (r = r.api.getFilterModel()))
                for (var p in r)
                    $('input[name*="' + p + '"]').each(function(z, F) {
                        return m(F)
                    })
        },
        resetRow: function(r) {
            r = $(r).attr("id");
            if (h[r] && h[r].length) {
                r = [r].concat($jscomp.arrayFromIterable(h[r]));
                r = $jscomp.makeIterator(r);
                for (var p = r.next(); !p.done; p = r.next())
                    p = $("#" + p.value).find("input").map(function(z, F) {
                        return F.name
                    }),
                    f(p, !1)
            } else
                isTest && console.log("no row dependencies: ", r)
        }
    }
}()
  , GridLightningDeal = function() {
    var a, b = {
        containerId: "grid-container-lightning-deal",
        pageId: "lightningdeal",
        resizeToViewport: !0,
        showTools: !1,
        template: "lightningdeal",
        type: "lightningDeal"
    }, d = function(t) {
        var f = [];
        t = $jscomp.makeIterator(t);
        for (var n = t.next(); !n.done; n = t.next())
            f.push(GridHelper.prepareProductLightningDeal(n.value));
        h(f.length);
        GridApi.setData(a, f)
    }, h = function(t, f) {
        f = void 0 === f ? !1 : f;
        var n = $("#" + b.gridWrapperId)
          , r = GridConfig.rowHeight.balham + (2 * (GridConfig.rowHeight.balham - 8) + 8) * (f ? t : Math.min(5, t));
        900 >= n.width() && (r += 8);
        r !== n.height() && n.animate({
            height: r + "px"
        }, 400);
        m(t, f)
    }, m = function(t, f) {
        f = (void 0 === f ? 0 : f) ? t : 5;
        var n = GridConfig.rowHeight.balham
          , r = 2 * (GridConfig.rowHeight.balham - 8) + 8;
        $("#grid-tools-fab-manage").animate({
            top: 40 + (n + r * Math.min(f, t)) + "px"
        }, 400)
    };
    return {
        init: function(t) {
            return GridApi.load().then(function() {
                networkHelper.loadASINs({
                    path: "product",
                    offerPages: 0,
                    history: !1,
                    maxAge: 15,
                    type: "manage",
                    refreshProduct: !1
                }, t, "").done(function(f) {
                    if (0 !== f.length) {
                        var n = '<div id="grid-pre-lightning-deal">\n\t\t\t\t\t<i class="fa fa-bolt"></i>&emsp;' + la._402 + '&emsp;<i class="fa fa-bolt"></i>\t\t\t\t\t\t\n\t\t\t\t\t<span class="grid-lightning-deal-actions">\n\t\t\t\t\t\t<i class="fa fa-eye-slash action-toggle"></i>\n\t\t\t\t\t\t' + (5 < f.length ? '<i class="fa fa-expand action-expand"></i>' : "") + '\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div id="grid-container-lightning-deal"></div>';
                        document.getElementById("grid-tools-fab-manage").insertAdjacentHTML("beforebegin", n);
                        n = GridConfig.get(b.type);
                        n.pageId = b.pageId;
                        b.gridWrapperId = n.gridWrapperId;
                        GridPage.initContainer(b);
                        GridPage.initGridContainer(n);
                        a = GridApi.init(n);
                        null !== a && (a.context.config = b,
                        d(f),
                        $(".grid-lightning-deal-actions i").on("click", function(r) {
                            if ($(this).hasClass("action-toggle")) {
                                r = $(this).hasClass("fa-eye");
                                var p = $("#grid-container-lightning-deal")
                                  , z = $(".grid-lightning-deal-actions .action-expand");
                                r ? (p.slideDown(),
                                z.fadeIn(),
                                m(f.length, $(".grid-lightning-deal-actions .fa-compress").length)) : (p.slideUp(),
                                z.fadeOut(),
                                m(0));
                                $(this).toggleClass("fa-eye fa-eye-slash")
                            } else
                                h(f.length, $(this).hasClass("fa-expand")),
                                $(this).toggleClass("fa-expand fa-compress")
                        }))
                    }
                })
            }).fail(showErrorPopup)
        }
    }
}()
  , GridManage = function() {
    var a, b = {
        DEFAULT: 0,
        COMFORTABLE: 1,
        COMPACT: 2
    }, d = {
        TRACKING: 0,
        CUSTOM: 1
    }, h = {
        DAY: 24,
        WEEK: 168,
        MONTH: 744,
        QUARTER: 2160,
        YEAR: 8760,
        ALL: -1
    }, m = {
        DEFAULT: 0,
        PERCENTAGE: 1
    }, t = {
        activeViewMode: b.DEFAULT,
        defaultGraphMode: d.TRACKING,
        graphRange: h.QUARTER,
        sortFilterReference: m.DEFAULT,
        pageId: "manage",
        resizeToViewport: !0,
        showTools: !1,
        template: "manage",
        title: "Tracking Overview",
        type: "manage"
    }, f = function() {
        return GridApi.load().then(function() {
            var J = isMobile ? b.COMPACT : b.DEFAULT
              , g = isMobile ? storage.manageGridViewMobile : storage.manageGridView;
            t.activeViewMode = g ? Number(g) : J;
            Object.values(b).includes(t.activeViewMode) || (t.activeViewMode = J);
            t.graphRange = storage.manageGridGraphRange ? Number(storage.manageGridGraphRange) : Number(storage.s_range) || h.QUARTER;
            Object.values(h).includes(t.graphRange) || (t.graphRange = h.QUARTER);
            J = "undefined" !== typeof storage.manageGridDefaultGraphMode ? JSON.parse(storage.manageGridDefaultGraphMode) : {
                mode: d.TRACKING
            };
            t.defaultGraphMode = J.mode;
            t.defaultGraphModeTypes = J.types ? J.types : [];
            Object.values(d).includes(t.defaultGraphMode) && 0 !== t.defaultGraphModeTypes.length || (t.defaultGraphMode = d.TRACKING);
            t.sortFilterReference = storage.manageSortFilterReference ? Number(storage.manageSortFilterReference) : m.DEFAULT;
            Object.values(m).includes(t.sortFilterReference) || (t.sortFilterReference = m.DEFAULT);
            GridFilter.initCustomNumberArrayColumnFilter();
            J = GridConfig.get(t.type);
            J.pageId = t.pageId;
            t.gridWrapperId = J.gridWrapperId;
            GridPage.init(t);
            GridPage.initGridContainer(J);
            a = GridApi.init(J);
            null !== a && (t.maxHeight = $("#" + t.gridWrapperId).height(),
            a.context.config = t,
            $(".ag-paging-page-summary-panel").hide(),
            $(".ag-paging-row-summary-panel").hide(),
            n())
        }).fail(showErrorPopup)
    }, n = function() {
        if (storage.token && "" != storage.token) {
            var J = Date.now()
              , g = Number(storage.lastManageVisit) || J;
            7E4 > J - g && (g = J - 7E4);
            network.request({
                path: "user/trackingoverview",
                perPage: maxTrackingAllowed,
                startIndex: -1,
                stats: g + "," + J,
                version: 3
            }).done(function(D) {
                var N = keepaTime.now();
                if ("undefined" === typeof D.trackings)
                    na();
                else {
                    var ba = []
                      , q = D.trackings
                      , L = D.wishLists
                      , A = D.categoriesPerDomain
                      , O = {}
                      , P = {};
                    D = $jscomp.makeIterator(D.noHistoryProducts ? D.noHistoryProducts : D.products);
                    for (var M = D.next(); !M.done; M = D.next()) {
                        M = M.value;
                        O[M.asin] || (O[M.asin] = {});
                        O[M.asin][M.domainId] = M;
                        var u = M.stats.lightningDealInfo && M.stats.lightningDealInfo[0] >= N;
                        if (-1 < M.stats.current[CsvType.LIGHTNING_DEAL.index] || u)
                            P[M.domainId] || (P[M.domainId] = []),
                            P[M.domainId].push(M.asin)
                    }
                    GridLightningDeal.init(P);
                    N = {};
                    L = $jscomp.makeIterator(L);
                    for (P = L.next(); !P.done; P = L.next())
                        P = P.value,
                        N[P.id] = {
                            domain: P.domain,
                            id: P.id,
                            items: P.items,
                            name: P.name
                        };
                    L = {};
                    A = $jscomp.makeIterator(A);
                    for (P = A.next(); !P.done; P = A.next())
                        if (P = P.value,
                        null != P)
                            for (var v in P)
                                L[v] = P[v].name;
                    a.context.categoryHashMap = L;
                    a.context.wishListHashMap = N;
                    P = [];
                    L = [];
                    A = v = !1;
                    q = $jscomp.makeIterator(q);
                    for (D = q.next(); !D.done; D = q.next()) {
                        D = D.value;
                        u = [];
                        var G = D.asin
                          , w = D.mainDomainId
                          , B = O[G];
                        if (null == B)
                            isTest && console.info("%cManage \u27fc No products found", "color:orange;", G);
                        else if (M = B[w],
                        null == M)
                            isTest && console.info("%cManage \u27fc No product found", "color:orange;", G, w);
                        else {
                            M = GridHelper.prepareProductTracking(M, D, w, N);
                            P = Array.from(new Set([].concat($jscomp.arrayFromIterable(P), $jscomp.arrayFromIterable(M.csvTypesWithData))));
                            L = Array.from(new Set([].concat($jscomp.arrayFromIterable(L), $jscomp.arrayFromIterable(M.csvTypesWithTracking))));
                            u = Array.from(new Set([].concat($jscomp.arrayFromIterable(u), $jscomp.arrayFromIterable(M.conditionsMet))));
                            delete M.conditionsMet;
                            var Q = [getTldByDomain(w)]
                              , fa = [];
                            for (T in B)
                                if (T != w) {
                                    var R = B[T];
                                    R = {
                                        asin: R.asin,
                                        domainId: R.domainId,
                                        title: R.title,
                                        stats: R.stats
                                    };
                                    R = GridHelper.prepareProductTracking(R, D, w);
                                    R.csvTypesWithTracking.length && (Q.push(getTldByDomain(T)),
                                    P = Array.from(new Set([].concat($jscomp.arrayFromIterable(P), $jscomp.arrayFromIterable(R.csvTypesWithData)))),
                                    L = Array.from(new Set([].concat($jscomp.arrayFromIterable(L), $jscomp.arrayFromIterable(R.csvTypesWithTracking)))),
                                    M.csvTypesWithTracking = Array.from(new Set([].concat($jscomp.arrayFromIterable(M.csvTypesWithTracking), $jscomp.arrayFromIterable(R.csvTypesWithTracking)))),
                                    u = Array.from(new Set([].concat($jscomp.arrayFromIterable(u), $jscomp.arrayFromIterable(R.conditionsMet)))),
                                    delete R.conditionsMet,
                                    fa.push(R))
                                }
                            B = D.createDate + 60 * D.ttl;
                            D.expiresOn = 5256E3 < B - keepaTime.now() ? null : B;
                            D.expiresSoon = 10080 > B - keepaTime.now();
                            u = {
                                asin: G,
                                domainId: w,
                                tracking: D,
                                product: M,
                                multiDomainIds: Q,
                                multiLocaleProductsReduced: fa,
                                lowestDomainIdsPerCsv: aa([].concat($jscomp.arrayFromIterable(fa), [M]), w, !0),
                                highestDomainIdsPerCsv: aa([].concat($jscomp.arrayFromIterable(fa), [M]), w, !1),
                                wishLists: N,
                                conditionsMet: u,
                                detailRowData: [],
                                detailDomainId: w,
                                detailRowHeight: V(M)
                            };
                            ba.push(u);
                            v = v || M.hasPriceIncreaseTracking;
                            A = A || D.expiresSoon
                        }
                    }
                    O = P;
                    var T = L;
                    N = t.activeViewMode === b.COMPACT;
                    q = ["AMAZON", "NEW", "USED"];
                    "true" !== storage.sendUpcomingLightningDealsAlert && "true" !== storage.sendStartLightningDealsAlert || q.push("LIGHTNING_DEAL");
                    L = [];
                    P = a.columnDefs;
                    D = [];
                    M = [];
                    for (var oa in P) {
                        u = P[oa];
                        if (u.children) {
                            w = GridHelper.getCsvObjectName(u.children[0].field);
                            if (!O.includes(w) && !T.includes(w) && !q.includes(w)) {
                                isTest && L.push(w);
                                continue
                            }
                            G = u.children.length - 1;
                            for (Q = 0; Q <= G; Q++)
                                M.push(u.children[Q].field);
                            if (!T.includes(w))
                                for (q.includes(w) || (u.children[0].hide = !0,
                                N && CsvType[w].graphAPI && (u.children[1].hide = !0)),
                                w = N && CsvType[w].graphAPI ? 2 : 1; w <= G; w++)
                                    u.children[w].hide = !0
                        } else
                            M.push(u.field);
                        D.push(u)
                    }
                    a.api && a.api.setColumnDefs(D);
                    GridState.restoreColumnState(a, M);
                    isTest && L.length && console.info("%cManage \u27fc removed column groups due to no data at all", "color:orange;", L);
                    GridState.restoreSortModel(a, [{
                        colId: "MAX_delta",
                        sort: "desc"
                    }]);
                    a.context.totalRowCount = ba.length;
                    a.context.hasPriceIncreaseTracking = v;
                    a.context.hasExpiresSoon = A;
                    a.api && a.api.setRowData(ba);
                    S();
                    ba = lastSubUrl.split("-");
                    6 === ba.length && (ba = ba[5],
                    oa = a.context.wishListHashMap,
                    oa[ba] && oa[ba].name && a.api.setFilterModel({
                        wishListName: {
                            type: "set",
                            values: [oa[ba].name]
                        }
                    }));
                    H();
                    r();
                    ka()
                }
            }).fail(showErrorPopup)
        } else
            na()
    }, r = function(J) {
        J = void 0 === J ? !1 : J;
        if (null != a.api && null != a.columnApi) {
            var g = $("#grid-tools-fab-" + t.pageId);
            J && g.length && g.remove();
            var D = [];
            [{
                field: "trackingCreateDate",
                label: la._197,
                icon: "numeric",
                defaultSort: "asc"
            }, {
                field: "MAX_delta",
                label: la._198,
                icon: "numeric",
                defaultSort: "asc"
            }, {
                field: "MAX_deltaCustom",
                label: la._701,
                icon: "numeric",
                defaultSort: "asc"
            }, {
                field: "MAX_deltaTrackingCreated",
                label: la._702,
                icon: "numeric",
                defaultSort: "asc"
            }, {
                field: "MAX_lastPriceChange",
                label: la._977,
                icon: "numeric",
                defaultSort: "asc"
            }, {
                field: "title",
                label: la._676,
                icon: "alpha",
                defaultSort: "asc"
            }].forEach(function(O) {
                (isTest || "MAX_lastPriceChange" !== O.field) && D.push({
                    content: '<i class="fa fa-fw fa-sort-' + (O.icon + "-" + O.defaultSort) + '" data-default-sort="' + O.defaultSort + '"></i>&emsp;' + O.label,
                    value: "sort." + O.field,
                    disabled: !1
                })
            });
            D.push({
                divider: !0
            });
            D.push({
                content: "<span>" + la._667 + "</span>",
                value: "grid",
                disabled: !0
            });
            g = material.getMenu("fab-sort-menu", D);
            var N = material.getMenu("fab-search-menu", [{
                content: '<div class="mdc-text-field mdc-text-field--dense">\n\t\t\t\t\t\t\t<input id="fab-search-input" class="mdc-text-field__input" type="text" placeholder="' + la._19 + '" autofocus />\n\t\t\t\t\t\t</div>'
            }])
              , ba = 200;
            540 > $("#bodyPanel").height() && (ba = 82);
            ba = [{
                content: p("multiDomainIds"),
                value: "multiDomainIds",
                disabled: !1
            }, {
                divider: !0
            }, {
                content: p("rootCategoryName"),
                value: "rootCategoryName",
                disabled: !1,
                style: "max-height:" + ba + "px;overflow-y:auto;"
            }, {
                divider: !0
            }, {
                content: p("conditionsMet"),
                value: "conditionsMet",
                disabled: !1
            }, {
                divider: !0
            }, {
                content: p("csvTypesWithTracking"),
                value: "csvTypesWithTracking",
                disabled: !1
            }, {
                divider: !0
            }, {
                content: p("tags"),
                value: "tags",
                disabled: !1,
                style: "max-height:" + ba + "px;overflow-y:auto;"
            }, {
                divider: !0
            }, {
                content: p("wishListName"),
                value: "wishListName",
                disabled: !1
            }];
            a.context.hasPriceIncreaseTracking && (ba.splice(8, 0, {
                content: p("trackingTypes"),
                value: "",
                disabled: !1
            }),
            ba.splice(9, 0, {
                divider: !0
            }));
            a.context.hasExpiresSoon && (ba.splice(8, 0, {
                content: p("expiresSoon"),
                value: "",
                disabled: !1
            }),
            ba.splice(9, 0, {
                divider: !0
            }));
            ba = material.getMenu("fab-filter-menu", ba);
            var q = material.getMenu("fab-tasks-menu", [{
                content: la._378,
                disabled: !0
            }, {
                divider: !0
            }, {
                content: '<i class="fa fa-fw fa-trash"></i>&emsp;' + la._379 + ' (<span class="manage-active-results">0</span>)',
                value: "task.delete",
                disabled: !1
            }, {
                content: '<i class="fa fa-fw fa-floppy-o"></i>&emsp;' + la._393 + ' (<span class="manage-active-results">0</span>)',
                value: "task.export",
                disabled: !1
            }, {
                content: '<i class="fa fa-fw fa-th"></i>&emsp;' + la._670 + ' (<span class="manage-active-results">0</span>)',
                value: "task.viewer",
                disabled: !1
            }])
              , L = [{
                content: I(),
                value: "",
                disabled: !1
            }, {
                divider: !0
            }, {
                content: z(),
                value: "",
                disabled: !1
            }, {
                divider: !0
            }];
            t.activeViewMode === b.DEFAULT && (L.splice(2, 0, {
                content: E(),
                value: "defaultgraphmode",
                disabled: !1
            }),
            L.splice(3, 0, {
                divider: !0
            }));
            L.push({
                content: K(),
                value: "",
                disabled: !1
            }, {
                divider: !0
            });
            L.push({
                content: '<span style="font-size:small;font-style:italic;"><i class="fa fa-fw fa-hand-o-left"></i>&emsp;&ensp;' + la._691 + "</span>",
                value: "legacyMode",
                disabled: !1
            }, {
                divider: !0
            });
            L = material.getMenu("fab-settings-menu", L);
            g = '<div id="grid-tools-fab-' + t.pageId + '" class="grid-wrapper-tools-fab"><ul class="tools-fab-floating">\t\t\n\t\t\t\t<li class="mdc-menu-anchor">\n\t\t\t\t\t<button id="fab-search" class="mdc-fab mdc-fab--mini" aria-label="' + (la._19 + '">\n\t\t\t\t\t\t<i class="fa fa-search mdc-fab__icon" title="' + la._19 + '"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t' + N + '\n\t\t\t\t</li>\t\n\t\t\t\t<li class="mdc-menu-anchor">\n\t\t\t\t\t<button id="fab-sort" class="mdc-fab mdc-fab--mini" aria-label="' + la._178 + '">\n\t\t\t\t\t\t<i class="fa fa-sort-numeric-asc mdc-fab__icon" title="' + la._178 + '"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t' + g + '\n\t\t\t\t</li>\t\t\t\t\n\t\t\t\t<li class="mdc-menu-anchor">\n\t\t\t\t\t<button id="fab-filter" class="mdc-fab mdc-fab--mini" aria-label="' + la._177 + '">\n\t\t\t\t\t\t<i class="fa fa-filter mdc-fab__icon" title="' + la._177 + '"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t' + ba + '\n\t\t\t\t</li>\t\n\t\t\t\t<li class="mdc-menu-anchor">\n\t\t\t\t\t<button id="fab-tasks" class="mdc-fab mdc-fab--mini" aria-label="' + la._387 + '">\n\t\t\t\t\t\t<i class="fa fa-tasks mdc-fab__icon" title="' + la._387 + '"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t' + q + '\n\t\t\t\t</li>\n\t\t\t\t<li class="mdc-menu-anchor">\n\t\t\t\t\t<button id="fab-settings" class="mdc-fab mdc-fab--mini" aria-label="' + la._8 + '">\n\t\t\t\t\t\t<i class="fa fa-cog mdc-fab__icon" title="' + la._8 + '"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t' + L + '\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<button id="fab-reset" class="mdc-fab mdc-fab--mini" aria-label="' + la._684 + '" style="display:none;">\n\t\t\t\t\t\t<i class="fa fa-undo mdc-fab__icon" title="' + la._684 + '"></i>\n\t\t\t\t\t</button>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<button id="fab-refresh" class="mdc-fab mdc-fab--mini" aria-label="' + la._817 + '" style="display:none;">\n\t\t\t\t\t\t<i class="fa fa-refresh mdc-fab__icon" title="' + la._817 + '"></i>\n\t\t\t\t\t</button>\n\t\t\t\t</li>\n\t\t\t</ul></div>');
            document.getElementById(t.gridWrapperId).insertAdjacentHTML("beforebegin", g);
            $(".mdc-fab__icon").colorTip({
                color: "manage-fab"
            });
            J && (J = $("#grid-lightning-deal"),
            J.length && $("#grid-tools-fab-manage").css({
                top: 40 + J.height() + "px"
            }));
            var A = [];
            $(".grid-wrapper-tools-fab").find(".mdc-menu").each(function() {
                var O = $(this).attr("id")
                  , P = new mdc.menu.MDCMenu(this);
                ["fab-sort-menu", "fab-tasks-menu"].includes(O) && this.addEventListener("MDCMenu:selected", function(M) {
                    ua(M.detail.item.dataset.value)
                });
                A.push({
                    buttonId: $(this).attr("id").replace("-menu", ""),
                    menuEl: this,
                    menu: P
                })
            });
            $("#fab-search-input").keydown(function(O) {
                O.stopPropagation();
                return !0
            });
            $("#fab-search-input").on("input", function() {
                var O = $(this);
                setTimeout(function() {
                    var P = O.val();
                    a.api.setQuickFilter(P)
                }, 500)
            });
            $('#fab-filter-menu input[type="checkbox"]').on("change", F);
            $('#fab-settings-menu input[name="viewmode"]').on("change", function(O) {
                isMobile ? storage.manageGridViewMobile = "undefined" !== typeof b[this.value] ? b[this.value] : b.COMPACT : storage.manageGridView = "undefined" !== typeof b[this.value] ? b[this.value] : b.DEFAULT;
                settings.send();
                za();
                f()
            });
            $('#fab-settings-menu input[name="graphrange"]').on("change", function(O) {
                storage.manageGridGraphRange = "undefined" !== typeof h[this.value] ? h[this.value] : h.QUARTER;
                settings.send();
                za();
                f()
            });
            $('#fab-settings-menu input[name="defaultgraphmode"]').on("change", function(O) {
                O = "undefined" !== typeof storage.manageGridDefaultGraphMode ? JSON.parse(storage.manageGridDefaultGraphMode) : {};
                var P = "undefined" !== typeof d[this.value] ? d[this.value] : d.TRACKING;
                P === d.TRACKING ? ($('li[data-value="defaultgraphmode"] .types').hide(),
                P !== t.defaultGraphMode && (O.mode = P,
                storage.manageGridDefaultGraphMode = JSON.stringify(O),
                settings.send(),
                za(),
                f())) : $('li[data-value="defaultgraphmode"] .types').show()
            });
            $("button#defaultgraphmode").on("click", function(O) {
                O.preventDefault();
                O = "undefined" !== typeof storage.manageGridDefaultGraphMode ? JSON.parse(storage.manageGridDefaultGraphMode) : {};
                var P = d.CUSTOM
                  , M = $('.tools-fab-floating input[name="defaultgraphmode-types"]:checked').map(function() {
                    return $(this).val()
                }).get();
                O.mode = P;
                O.types = M;
                storage.manageGridDefaultGraphMode = JSON.stringify(O);
                settings.send();
                za();
                f()
            });
            $('#fab-settings-menu input[name="sortfilterreference"]').on("change", function(O) {
                storage.manageSortFilterReference = "undefined" !== typeof m[this.value] ? m[this.value] : m.DEFAULT;
                settings.send();
                za();
                f()
            });
            $('#fab-settings-menu [data-value="legacyMode"]').on("click", function(O) {
                storage.manageGrid = !1;
                settings.send();
                generateManage()
            });
            $(".grid-wrapper-tools-fab").find("ul button").on("click", function(O) {
                var P = $(O.currentTarget).attr("id");
                O = A.find(function(M) {
                    return M.buttonId === P
                });
                "undefined" !== typeof O ? (O = O.menu,
                O.open ? O.hide() : (O.show(),
                "fab-search" === P && setTimeout(function() {
                    $("#fab-search-input").focus()
                }, 100),
                "fab-tasks" === P && qa())) : "fab-reset" === P ? (a.api.setFilterModel(null),
                a.api.setQuickFilter(""),
                r(!0)) : "fab-refresh" === P && (a.api.refreshClientSideRowModel("filter"),
                a.api.refreshClientSideRowModel("sort"),
                r(!0))
            });
            $.ctrl = function(O) {
                var P = !1;
                $(document).on("keydown.ctrlF", function(M) {
                    if (M.ctrlKey || M.metaKey)
                        P = !0;
                    M.keyCode == O.charCodeAt(0) && P && ($("#fab-search").click(),
                    M.preventDefault())
                }).on("keyup.ctrlF", function(M) {
                    M.ctrlKey && (P = !1)
                })
            }
            ;
            $.ctrl("F");
            onPageNavigation.progress(function() {
                $(document).off("keydown.ctrlF");
                $(document).off("keyup.ctrlF")
            })
        }
    }, p = function(J) {
        if (null != a.api && null != a.columnApi) {
            var g = a.context.filterResultCounts[J]
              , D = a.api.getFilterInstance(J)
              , N = D.valueModel.allUniqueValues
              , ba = Object.keys(D.valueModel.selectedValuesMap);
            D = "";
            var q = "fa-filter";
            "multiDomainIds" === J && (D = la._203,
            q = "fa-amazon");
            "rootCategoryName" === J && (D = la._202,
            q = "fa-folder-o");
            "conditionsMet" === J && (D = la._87,
            q = "fa-check");
            "csvTypesWithTracking" === J && (D = la._668,
            q = "fa-bell-o");
            "trackingTypes" === J && (D = la._710,
            q = "fa-arrows-v");
            "expiresSoon" === J && (D = la._889.replace("!", ""),
            q = "fa-clock-o");
            "tags" === J && (D = la._807,
            q = "fa-tags");
            "wishListName" === J && (D = la._419,
            q = "fa-heart-o");
            var L = '<span><i class="fa fa-fw ' + q + '"></i>&emsp;' + D + ":</span>";
            3 < N.length && (L += material.getCheckbox(J + "-all", la._671, ba.length === N.length, !1, J, -1));
            N.forEach(function(A, O) {
                var P = A;
                "tags" === J && null == A && (P = "(" + la._809 + ")");
                "wishListName" === J && "-" == A && (P = "(" + la._669 + ")");
                if ("undefined" !== typeof g) {
                    var M = g.find(function(u) {
                        return u.value === A
                    });
                    M && (P += " <span>(" + M.count + ")</span>")
                }
                M = !0;
                ba.length !== N.length && (M = ba.includes(null == A ? "___NULL___" : A));
                L += material.getCheckbox(J + "-" + O, P, M, !1, J, null == A ? "#null#" : A)
            });
            return L
        }
    }, z = function() {
        var J = '<span><i class="fa fa-fw fa-calendar"></i>&emsp;' + la._135 + ":</span>", g;
        for (g in h) {
            var D = la._136;
            h[g] == h.WEEK ? D = la._137 : h[g] == h.MONTH ? D = la._139 : h[g] == h.QUARTER ? D = la._140 : h[g] == h.YEAR ? D = la._141 : h[g] == h.ALL && (D = la._142);
            J += material.getRadio("graphrange-" + h[g], D, h[g] === t.graphRange, "graphrange", !1, g)
        }
        return J
    }, F = function(J) {
        var g = J.currentTarget;
        J = $(g).attr("name");
        if ($(g).attr("id").includes("-all-checkbox"))
            J = $('.tools-fab-floating input[name="' + J + '"]'),
            J.each(function() {
                $(this).prop("checked", g.checked)
            }),
            $(J[1]).change();
        else {
            var D = $('.tools-fab-floating input[name="' + J + '"]:checked').map(function() {
                return $(this).val()
            }).get();
            -1 < D.indexOf("#null#") && (D[D.indexOf("#null#")] = null);
            a.api.getFilterInstance(J).setModel({
                type: "set",
                values: D
            });
            a.api.onFilterChanged()
        }
    }, I = function() {
        var J = '<span><i class="fa fa-fw fa-eye"></i>&emsp;' + la._179 + ":</span>", g;
        for (g in b) {
            var D = la._693
              , N = la._696;
            b[g] == b.COMFORTABLE ? (D = la._694,
            N = la._697) : b[g] == b.COMPACT && (D = la._695,
            N = la._698);
            J += material.getRadio("viewmode-" + b[g], D, b[g] === t.activeViewMode, "viewmode", !1, g, N)
        }
        return J
    }, E = function() {
        var J = '<span><i class="fa fa-fw fa-line-chart"></i>&emsp;' + la._810 + ":</span>";
        for (N in d) {
            var g = la._811
              , D = la._696;
            d[N] == d.CUSTOM && (g = la._812,
            D = "");
            J += material.getRadio("defaultgraphmode-" + d[N], g, d[N] === t.defaultGraphMode, "defaultgraphmode", !1, N, D)
        }
        g = t.defaultGraphMode === d.CUSTOM;
        var N = "undefined" !== typeof storage.manageGridDefaultGraphMode ? JSON.parse(storage.manageGridDefaultGraphMode).types : [];
        N = N.map(function(q) {
            return Number(q)
        });
        J += '<div class="types"' + (g ? "" : ' style="display:none;"') + ">";
        for (var ba in CsvType)
            "object" === typeof CsvType[ba] && CsvType[ba].isEnabled && CsvType[ba].isTopGraph && (g = N.length ? -1 < N.indexOf(CsvType[ba].index) : CsvType[ba].showDefault,
            J += material.getCheckbox("defaultgraphmode-types-" + CsvType[ba].index, CsvType.getName(CsvType[ba].index), g, !1, "defaultgraphmode-types", CsvType[ba].index));
        J += material.getButton("defaultgraphmode", la._225, "", "", !0, !1);
        return J + "</div>"
    }, K = function() {
        var J = '<span><i class="fa fa-fw fa-calculator"></i>&emsp;' + la._937 + ":</span>", g;
        for (g in m) {
            var D = la._853
              , N = "";
            m[g] == m.PERCENTAGE && (D = la._486,
            N = la._938);
            J += material.getRadio("sortfilterreference-" + m[g], D, m[g] === t.sortFilterReference, "sortfilterreference", !1, g, N)
        }
        return J
    }, H = function() {
        var J = a.context.config.maxHeight
          , g = $("#" + t.gridWrapperId)
          , D = g.height()
          , N = $("#grid-wrapper-manage .ag-body-container");
        N = N[0];
        N = $(N).height();
        N += 2 * GridConfig.rowHeight.balham;
        N += GridConfig.rowHeight.balham + 8;
        N += a.scrollbarWidth;
        a.context.config.neededHeight = N;
        J = Math.min(N, J);
        J !== D && g.height(J + "px")
    }, V = function(J) {
        var g = t.activeViewMode === GridManage.viewModes.DEFAULT;
        if (g)
            J = 130;
        else {
            var D = Date.now()
              , N = parseInt((D - keepaTime.minutesToEpoch(J.trackingSince)) / 36E5)
              , ba = parseInt((D - keepaTime.minutesToEpoch(J.lastUpdate)) / 36E5);
            parseInt((D - keepaTime.minutesToEpoch(J.lastPriceChange)) / 36E5);
            D = 1;
            24 < N && 24 > ba && D++;
            168 < N && 168 > ba && D++;
            744 < N && 744 > ba && D++;
            2160 < N && 2160 > ba && D++;
            8760 < N && 8760 > ba && D++;
            J = 14 * J.countTypesTopGraph + (14 * D + 2) + 63;
            J = Math.max(175, J)
        }
        return J + (g ? 32 : 50) + 5 + 10
    }, S = function() {
        if (null != a.api && null != a.columnApi) {
            a.context.filterResultCounts = {
                multiDomainIds: [],
                rootCategoryName: [],
                conditionsMet: [],
                csvTypesWithTracking: [],
                trackingTypes: [],
                expiresSoon: [],
                tags: [],
                wishListName: []
            };
            var J = {}
              , g = {}
              , D = {}
              , N = {}
              , ba = {}
              , q = {}
              , L = {}
              , A = {};
            a.api.forEachNode(function(Q) {
                Q = Q.data;
                Q.multiDomainIds.forEach(function(T) {
                    J[T] = J[T] ? J[T] + 1 : 1
                });
                var fa = Q.product.rootCategory > invalidIfLargerCatId ? -1 : Q.product.rootCategory;
                g[fa] = g[fa] ? g[fa] + 1 : 1;
                fa = Q.conditionsMet.length ? 1 : 0;
                D[fa] = D[fa] ? D[fa] + 1 : 1;
                Q.product.csvTypesWithTracking.forEach(function(T) {
                    N[T] = N[T] ? N[T] + 1 : 1
                });
                Q.product.hasPriceDropTracking && (ba[0] = ba[0] ? ba[0] + 1 : 1);
                Q.product.hasPriceIncreaseTracking && (ba[1] = ba[1] ? ba[1] + 1 : 1);
                fa = Q.tracking.expiresSoon ? 1 : 0;
                q[fa] = q[fa] ? q[fa] + 1 : 1;
                fa = [];
                try {
                    var R = JSON.parse(Q.tracking.metaData);
                    fa = R.tags ? R.tags : []
                } catch (T) {}
                fa.length ? fa.forEach(function(T) {
                    L[T] = L[T] ? L[T] + 1 : 1
                }) : L[-1] = L[-1] ? L[-1] + 1 : 1;
                R = null === Q.tracking.wishListId ? -1 : Q.tracking.wishListId;
                A[R] = A[R] ? A[R] + 1 : 1
            });
            for (var O in J)
                a.context.filterResultCounts.multiDomainIds.push({
                    value: O,
                    count: J[O]
                });
            for (var P in g)
                a.context.filterResultCounts.rootCategoryName.push({
                    value: -1 == P ? "-" : a.context.categoryHashMap[P],
                    count: g[P]
                });
            for (var M in D)
                a.context.filterResultCounts.conditionsMet.push({
                    value: 1 == M ? la._88 : la._89,
                    count: D[M]
                });
            for (var u in N)
                a.context.filterResultCounts.csvTypesWithTracking.push({
                    value: CsvType.getName(CsvType[u].index),
                    count: N[u]
                });
            for (var v in ba)
                a.context.filterResultCounts.trackingTypes.push({
                    value: 0 == v ? la._711 : la._712,
                    count: ba[v]
                });
            for (var G in q)
                a.context.filterResultCounts.expiresSoon.push({
                    value: 1 == G ? la._254 : la._255,
                    count: q[G]
                });
            for (var w in L)
                a.context.filterResultCounts.tags.push({
                    value: -1 == w ? null : w,
                    count: L[w]
                });
            for (var B in A)
                a.context.filterResultCounts.wishListName.push({
                    value: -1 == B ? "-" : a.context.wishListHashMap[B] ? a.context.wishListHashMap[B].name : "-",
                    count: A[B]
                })
        }
    }, aa = function(J, g, D) {
        D = void 0 === D ? !0 : D;
        var N = {}, ba;
        for (ba in CsvType)
            if ("object" === typeof CsvType[ba]) {
                for (var q = CsvType[ba].index, L = [], A = {}, O = [], P = $jscomp.makeIterator(J), M = P.next(); !M.done; M = P.next()) {
                    M = M.value;
                    var u = Number(M.domainId)
                      , v = M.stats.current[q];
                    -1 < v && (CsvType[ba].currency && u !== Number(g) && (v = Money.raw(v, {
                        sourceDomainId: M.domainId,
                        targetDomainId: g,
                        keepUnit: !0,
                        noDigits: !0
                    })),
                    A[v] || (A[v] = []),
                    A[v].push(u),
                    O.push(v))
                }
                O.length && (L = D ? Math.min.apply(Math, $jscomp.arrayFromIterable(O)) : Math.max.apply(Math, $jscomp.arrayFromIterable(O)),
                L = A[L]);
                N[q] = L
            }
        return N
    }, ea = function() {
        if (null == a.api)
            return 0;
        var J = a.api.getDisplayedRowCount();
        !0 === a.masterDetail && (J /= 2);
        return J
    }, ra = function() {
        var J = $.Deferred()
          , g = material.getButton("deleteSubmit", la._379, null, "trash")
          , D = material.getButton("deleteCancel", la._380, null, "ban", !1, !0);
        g = '<div style="width:400px;margin-bottom:20px;">' + la._381.replace("0", ea()) + '</div>\n\t\t\t\t\t<form name="deleteForm" id="deleteForm">\t\t\t\t\t\n\t\t\t\t\t\t' + g + "&emsp;" + D + "\n\t\t\t\t\t</form>";
        material.init("#deleteForm");
        setTimeout(function() {
            $("#deleteForm button").on("click", function(N) {
                J.resolve({
                    action: $(N.currentTarget).attr("id").replace("delete", "").toLowerCase()
                });
                N.preventDefault()
            })
        }, 0);
        return {
            onDelete: J.promise(),
            html: g
        }
    }, pa = function() {
        var J = $.Deferred()
          , g = material.getCheckbox("exportFormatted", la._813, !0, !1, "exportFormatted", 1)
          , D = material.getButton("exportSubmit", "Export", null, "download");
        g = '<div class="mdc-typography--caption" style="margin-top:15px;">' + la._8 + '</div>\n\t\t\t\t\t\t\t   <section style="width:400px;">' + g + "</section>";
        D = '<div style="width:400px;margin-bottom:10px;">' + la._686.replace("0", ea()) + '</div>\n\t\t\t\t\t<form name="exportForm" id="exportForm">\n\t\t\t\t\t\t' + g + "\n\t\t\t\t\t\t<br>\n\t\t\t\t\t\t" + D + "\n\t\t\t\t\t</form>";
        material.init("#exportForm");
        setTimeout(function() {
            $("#exportForm").on("submit", function(N) {
                var ba = $("#exportForm input:checkbox:checked").map(function() {
                    return $(this).attr("name")
                }).get();
                storage.manageExportFormat = "csv";
                J.resolve({
                    format: "csv",
                    exportOptions: ba
                });
                N.preventDefault()
            })
        }, 0);
        return {
            onExport: J.promise(),
            html: D
        }
    }, ua = function(J) {
        var g = J.split(".");
        if ("sort" === g[0]) {
            J = "asc";
            var D = a.api.getSortModel().find(function(ba) {
                return ba.colId === g[1]
            });
            D && (J = "asc" === D.sort ? "desc" : "asc");
            a.api.setSortModel([{
                colId: g[1],
                sort: J
            }])
        }
        if ("task" === g[0])
            switch (g[1]) {
            case "delete":
                (function() {
                    var ba = ra()
                      , q = showPopup("Delete trackings", ba.html, !0);
                    ba.onDelete.done(function(L) {
                        "submit" == L.action ? (L = $("#deleteSubmit"),
                        L.prop("disabled", !0),
                        L.html(la._379 + ' &ensp;<i class="fa fa-spinner fa-spin"></i>'),
                        $("#deleteCancel").remove(),
                        $.Deferred(function(A) {
                            setTimeout(function() {
                                var O = []
                                  , P = [];
                                a.api.forEachNodeAfterFilterAndSort(function(M) {
                                    O.push(M.data);
                                    P.push(M.data.asin)
                                });
                                network.request({
                                    path: "track",
                                    type: "deleteTracking",
                                    asinBatch: P,
                                    version: 3
                                }).done(function(M) {
                                    null == M.error && (a.api.updateRowData({
                                        remove: O
                                    }),
                                    a.context.totalRowCount -= O.length,
                                    a.api.setFilterModel(null),
                                    a.api.setQuickFilter(""),
                                    r(!0),
                                    0 === ea() && na());
                                    A.resolve()
                                }).fail(showErrorPopup)
                            }, 0)
                        }).promise().done(function() {
                            q.close()
                        }).fail(showErrorPopup)) : (q.close(),
                        $.Deferred().resolve())
                    })
                }
                )();
                break;
            case "export":
                (function() {
                    var ba = pa()
                      , q = showPopup("Export Data", ba.html, !0);
                    ba.onExport.done(function(L) {
                        var A = $("#exportSubmit");
                        A.prop("disabled", !0);
                        A.html(la._600 + ' &ensp;<i class="fa fa-spinner fa-spin"></i>');
                        switch (L.format) {
                        case "csv":
                            a.context.exportOptions = L.exportOptions;
                            L = ["trackingID", "asin", "title", "domainId", "currency"];
                            A = ["metaData", "imagesCSV", "title", "wishListNameInfo"];
                            var O = a.columnApi.getColumnState();
                            for (var P in O) {
                                var M = O[P];
                                M.hide || A.includes(M.colId) || M.colId.includes("_graph") || L.push(M.colId)
                            }
                            L.push("lastUpdate");
                            L.push("lastPriceChange");
                            L.push("internalHref");
                            L.push("externalHref");
                            O = GridApi.exportData(a, 0 < L.length ? {
                                columnKeys: L
                            } : {});
                            break;
                        case "xls":
                            O = $.Deferred(function(u) {
                                setTimeout(function() {
                                    u.resolve()
                                }, 0)
                            }).promise()
                        }
                        O.done(function() {
                            q.close()
                        }).fail(showErrorPopup)
                    })
                }
                )();
                break;
            case "viewer":
                var N = {};
                a.api.forEachNodeAfterFilterAndSort(function(ba) {
                    N[ba.data.domainId] || (N[ba.data.domainId] = []);
                    N[ba.data.domainId].push(ba.data.asin)
                });
                N.listId = Guid.newGuid();
                window.location.href = "#!viewer/" + encodeURIComponent(JSON.stringify(N))
            }
    }, na = function() {
        za();
        insertPage('<div class="paper"><h6 class="mdc-typography--subtitle1">' + (la._27 + '</h6>\n\t\t\t\t<p class="mdc-typography--body2">' + (storage.username ? la._85 : la._871) + '</p>\n\t\t\t\t<br>\n\t\t\t\t<p class="mdc-typography--body2">' + la._86 + " " + la._872 + "</p></div>"))
    }, qa = function(J) {
        J = void 0 === J ? !1 : J;
        var g = a.context.deletedAsins;
        if ("undefined" !== typeof g && 0 !== g.length) {
            var D = [];
            a.api.forEachNode(function(N) {
                g.includes(N.data.asin) && D.push(N.data)
            });
            D.length && (a.api.updateRowData({
                remove: D
            }),
            a.context.deletedAsins = [],
            a.context.totalRowCount -= D.length,
            !0 !== J && (H(),
            ka()),
            S())
        }
    }, ka = function() {
        var J = t.activeViewMode === GridManage.viewModes.COMPACT
          , g = ea()
          , D = a.context.totalRowCount;
        $("span.manage-active-results").html(g);
        var N = $("#grid-manage .ag-pinned-left-header > .ag-header-row:first-child > .ag-header-group-cell-no-group .ag-header-group-text");
        N = J ? N[1] : N[0];
        $(N).html(la._675.replace("#current#", g).replace("#total#", D))
    }, za = function() {
        "undefined" !== typeof a && a.api.destroy()
    };
    return {
        pageConfig: t,
        sortFilterReferences: m,
        graphRanges: h,
        viewModes: b,
        init: f,
        adjustGridHeight: H,
        calculateDetailRowHeight: V,
        getTrackingCreationObject: function(J, g, D) {
            var N = J.asin
              , ba = J.mainDomainId
              , q = J.metaData
              , L = [];
            if (!0 === g && (g = J.thresholdValues,
            "undefined" !== g && null != g)) {
                g = $jscomp.makeIterator(g);
                for (var A = g.next(); !A.done; A = g.next())
                    A = A.value,
                    L.push({
                        domain: A.domain,
                        csvType: A.csvType,
                        isDrop: A.isDrop,
                        thresholdValue: A.thresholdValueCSV[A.thresholdValueCSV.length - 1]
                    })
            }
            g = [];
            if (!0 === D && (D = J.notifyIf,
            "undefined" !== D && null != D))
                for (D = $jscomp.makeIterator(D),
                A = D.next(); !A.done; A = D.next())
                    A = A.value,
                    g.push({
                        domain: A.domain,
                        csvType: A.csvType,
                        notifyIfType: A.notifyIfType
                    });
            D = -1 * TrackingComponent.getDefaultTtl();
            return {
                asin: N,
                desiredPrices: L,
                lightningDealsAlerts: J.lightningDealsAlerts,
                mainDomainId: ba,
                metaData: q,
                desiredPricesInMainCurrency: !0,
                expireNotify: !0,
                individualNotificationInterval: -1,
                isOneTimeImport: !0,
                minChangeBetweenNotifications: null,
                notifyIf: g,
                notificationType: [],
                overwriteExistingTrackings: !0,
                removeTrackingWhenDeleted: !1,
                removeTrackingWhenPurchased: !1,
                skipIfNotInStock: !0,
                ttl: D
            }
        },
        getTrackingUpdateObject: function() {
            return {
                expireNotify: null,
                individualNotificationInterval: null,
                isActive: null,
                lightningDealsAlerts: null,
                metaData: null,
                notificationType: null,
                onlyPrime: null,
                ttl: -1 * TrackingComponent.getDefaultTtl(),
                updateInterval: null
            }
        },
        removeDeletedRows: qa,
        updateFilterToolbar: function(J) {
            var g = $("#grid-tools-fab-manage");
            J.forEach(function(D) {
                var N = g.find('[data-value="' + D + '"]');
                N.length && (N[0].innerHTML = p(D));
                N.find('input[type="checkbox"]').on("change", F)
            })
        },
        updateRowCount: ka,
        updateSortToolbar: function() {
            var J = a.api ? a.api.getSortModel() : null
              , g = $("#fab-sort-menu i");
            $(g).each(function(D, N) {
                N = $(N);
                D = N.data("default-sort");
                var ba = "asc" === D ? "desc" : "asc";
                N.addClass("inactive");
                N.attr("class", N.attr("class").replace(ba, D));
                var q = N.parent().data("value").split(".")[1];
                if (J && 1 === J.length) {
                    var L = J.find(function(A) {
                        return A.colId === q
                    });
                    L && (N.removeClass("inactive"),
                    L.sort === ba && N.attr("class", N.attr("class").replace(D, ba)))
                }
            })
        }
    }
}()
  , GridOffer = function() {
    var a, b = {
        pageId: "offer",
        resizeToIframeTab: !0,
        showFilterTop: !0,
        showTools: {
            column: !0,
            export: !0,
            graph: !0,
            results: !0
        },
        template: "offer",
        title: "Marketplace Offers",
        type: "offer"
    }, d = {}, h = !1, m = {}, t = function(I) {
        var E = keepaTime.now()
          , K = I.products[0]
          , H = I.sellers;
        I = [];
        var V = []
          , S = 0
          , aa = 0
          , ea = !1
          , ra = 0
          , pa = 0
          , ua = {
            hasPrime: !1,
            hasFreeShipping: !1,
            hasFBM: !1
        }
          , na = []
          , qa = {
            hasHistorical: !1,
            hasScam: !1
        };
        if (!hasDataAccessSubscription) {
            for (var ka = [], za = 0; za < K.offers.length; za++) {
                var J = K.offers[za];
                null != K.liveOffersOrder && K.liveOffersOrder.includes(za) && ka.length < GridConfig.maxRowsFreeUser && (J.originalIdx = za,
                ka.push(J))
            }
            K.offers = ka
        }
        (new Date("2017-12-11")).setUTCHours(0, 0, 0, 0);
        ka = (new Date("2018-06-07")).setUTCHours(0, 0, 0, 0);
        for (za = 0; za < K.offers.length; za++) {
            J = K.offers[za];
            J.asin = K.asin;
            J.domainId = K.domainId;
            J.updateCSV = K.csv[CsvType.EXTRA_INFO_UPDATES.index];
            var g = H[J.sellerId];
            if (g) {
                var D = g.csv || [];
                J.sellerName = g.sellerName;
                J.sellerCurrentRating = g.currentRating ? g.currentRating : D[0] ? D[0][D[0].length - 1] : -1;
                J.sellerCurrentRatingCount = g.currentRatingCount ? g.currentRatingCount : D[1] ? D[1][D[1].length - 1] : -1
            } else
                J.sellerName = "(just launched)",
                J.sellerCurrentRating = -1,
                J.sellerCurrentRatingCount = -1;
            g = J.offerCSV;
            D = J.stockCSV;
            if (!0 !== disableStockFeatures) {
                J.stock = null;
                var N = J.lastSeen;
                N && 1440 >= E - N && D && (J.stock = D[D.length - 1]);
                aa += J.stock ? J.stock : 0;
                J.stockIsMax = isStockMax(J.stock, J.stockLimit);
                ea = ea ? ea : J.stockIsMax
            }
            J.price = g[g.length - 2];
            J.shipping = g[g.length - 1];
            S += J.price + J.shipping;
            !0 !== disableStockFeatures && !0 !== disableSoldNumbers && (J.sold = getAggregatedDrop(D, 0, 800),
            0 < J.sold && (ra += J.sold),
            J.sold30Day = getAggregatedDrop(D, keepaTime.now() - 43200, 800),
            0 < J.sold30Day && (pa += J.sold30Day));
            D = "undefined" != typeof J.originalIdx ? J.originalIdx : za;
            J.isLiveOffer = null != K.liveOffersOrder && K.liveOffersOrder.includes(D);
            keepaTime.minutesToEpoch(J.lastSeen) < ka && J.isPrime && !J.isAmazon && !J.isWarehouseDeal && (J.isFBA = !0);
            na.includes(J.condition) || na.push(J.condition);
            J.isPrime && (ua.hasPrime = !0,
            ua.hasFreeShipping = !0);
            J.isAmazon || J.isWarehouseDeal || J.isFBA || (ua.hasFBM = !0);
            0 >= J.shipping && (ua.hasFreeShipping = !0);
            J.isLiveOffer || (qa.hasHistorical = !0);
            J.isScam && (qa.hasScam = !0);
            J.ageInHours = Math.ceil((keepaTime.now() - g[0]) / 60);
            I[za] = J
        }
        E = S / K.offers.length;
        na = na.sort(function(ba, q) {
            return ba - q
        });
        !0 !== disableStockFeatures ? !0 !== disableSoldNumbers ? V.push({
            domainId: K.domainId,
            offerCSV: E,
            stockCSV: aa,
            stockHasMax: ea,
            totalSold: ra,
            totalSold30Day: pa
        }) : V.push({
            domainId: K.domainId,
            offerCSV: E,
            stockCSV: aa,
            stockHasMax: ea
        }) : V.push({
            domainId: K.domainId,
            offerCSV: E
        });
        hasDataAccessSubscription || V.push({
            freeAccessRow: !0,
            message: '<a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to view all available variations and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>."
        });
        return {
            filter: {
                shipping: ua,
                conditions: na,
                state: qa
            },
            pinnedBottomRows: V,
            rows: I
        }
    }, f = function(I) {
        if ("undefined" !== typeof d[I])
            return d[I];
        var E = {}
          , K = 0
          , H = 0
          , V = 0
          , S = !1
          , aa = 0
          , ea = 0
          , ra = 0;
        a.api.forEachNodeAfterFilter(function(pa) {
            pa = pa.data;
            E.domainId = pa.domainId;
            H += pa.price + pa.shipping;
            !0 !== disableStockFeatures && (V += pa.stock ? pa.stock : 0,
            S = S ? S : pa.stockIsMax,
            !0 !== disableSoldNumbers && (0 < pa.sold && (aa += pa.sold),
            0 < pa.sold30Day && (ea += pa.sold30Day)));
            ra = Math.max(ra, pa.ageInHours);
            K++
        });
        K ? (E.offerCSV = H / K,
        !0 !== disableStockFeatures && (E.stockCSV = V,
        E.stockHasMax = S,
        !0 !== disableSoldNumbers && (E.totalSold = aa,
        E.totalSold30Day = ea)),
        E.countFilteredRows = K,
        E.oldestOfferAgeInHours = ra,
        d[I] = E) : d[I] = !1;
        return d[I]
    }, n = function(I) {
        var E = {
            shipping: {
                title: "Shipping",
                children: [{
                    label: '<span style="color:#2692c2;font-style: italic;">Prime</span>',
                    field: "isPrime",
                    value: 1
                }, {
                    label: "Free shipping",
                    field: "isFreeShipping",
                    value: 1
                }, {
                    label: "FBM only",
                    field: "isFBMOnly",
                    value: 1
                }]
            },
            condition: {
                title: "Condition",
                children: {
                    NEW: {
                        children: []
                    },
                    USED: {
                        children: []
                    },
                    REFURBISHED: {
                        children: []
                    },
                    COLLECTIBLE: {
                        children: []
                    },
                    RENTAL: {
                        children: []
                    },
                    UNKNOWN: {
                        children: []
                    }
                }
            },
            state: {
                title: "Additional options",
                children: [{
                    label: "Include historical offers",
                    field: "includeHistoricalOffers",
                    value: 1,
                    checked: !0
                }, {
                    label: "Show potential scam offers",
                    field: "includeScamOffers",
                    value: 1,
                    checked: !0
                }]
            }
        }
          , K = I.filter.conditions
          , H = 1 == K.length;
        K.forEach(function(qa) {
            var ka = ConditionType.getName(qa).split("-")
              , za = ka[0].trim();
            ka = 1 < ka.length ? ka[1].toString().trim() : za;
            var J = ConditionType.getMetaCondition(qa);
            E.condition.children[J] && (E.condition.children[J].label = za,
            E.condition.children[J].children.push({
                label: ka,
                field: qa,
                value: 1,
                checked: !0,
                disabled: H
            }))
        });
        var V = '<form id="offer-filter">';
        K = {};
        for (var S in E) {
            K.$jscomp$loop$prop$groupIdx$726 = S;
            var aa = E[K.$jscomp$loop$prop$groupIdx$726];
            V += '<div class="ft-group-' + K.$jscomp$loop$prop$groupIdx$726 + '"><p>' + aa.title + "</p><div>";
            if (aa.children)
                if (aa.children instanceof Array)
                    aa.children.forEach(function(qa) {
                        return function(ka) {
                            var za = qa.$jscomp$loop$prop$groupIdx$726 + "-" + ka.field;
                            V += "<div>";
                            V += '<input id="ft-' + ka.field + '" name="' + za + '" value="' + ka.value + '" ' + (ka.checked ? ' checked="checked"' : "") + (ka.disabled ? ' disabled="disabled"' : "") + ' type="checkbox" /> <label for="ft-' + ka.field + '">' + ka.label + "</label>";
                            V += "</div>"
                        }
                    }(K));
                else {
                    var ea = {}, ra;
                    for (ra in aa.children) {
                        var pa = aa.children[ra];
                        pa.children.length && (ea.$jscomp$loop$prop$showMeta$728 = "USED" == ra || "COLLECTIBLE" == ra,
                        V += "<div>",
                        ea.$jscomp$loop$prop$showMeta$728 && (V += '<input class="meta" id="ft-' + ra + '" name="' + ra + '" value="' + ra + '" checked="checked" type="checkbox" /> <label for="ft-' + ra + '">' + pa.label + '</label><div class="sub-conditions">'),
                        pa.children.forEach(function(qa, ka) {
                            return function(za) {
                                var J = qa.$jscomp$loop$prop$groupIdx$726 + "-" + za.field
                                  , g = ka.$jscomp$loop$prop$showMeta$728 ? ' data-meta="1"' : ""
                                  , D = za.checked ? ' checked="checked"' : ""
                                  , N = za.disabled ? ' disabled="disabled"' : "";
                                ka.$jscomp$loop$prop$showMeta$728 && (V += "<div>");
                                V += '\n\t\t\t\t\t\t\t\t\t<input id="ft-' + za.field + '" name="' + J + '" value="' + za.value + '"' + D + N + g + ' type="checkbox" /> \n\t\t\t\t\t\t\t\t\t<label for="ft-' + za.field + '">' + za.label + "</label>\n\t\t\t\t\t\t\t\t";
                                ka.$jscomp$loop$prop$showMeta$728 && (V += "</div>")
                            }
                        }(K, ea)),
                        ea.$jscomp$loop$prop$showMeta$728 && (V += "</div>"),
                        V += "</div>");
                        ea = {
                            $jscomp$loop$prop$showMeta$728: ea.$jscomp$loop$prop$showMeta$728
                        }
                    }
                }
            V += "</div></div>";
            K = {
                $jscomp$loop$prop$groupIdx$726: K.$jscomp$loop$prop$groupIdx$726
            }
        }
        V += '<input id="ft-json" name="" value="" type="hidden" />';
        V += "</form>";
        replaceHtml(b.gridWrapperId + "-filter", V);
        I = I.filter;
        I.shipping.hasPrime || $("#ft-isPrime").attr("disabled", !0);
        I.shipping.hasFreeShipping || $("#ft-isFreeShipping").attr("disabled", !0);
        I.shipping.hasFBM || $("#ft-isFBMOnly").attr("disabled", !0);
        I.state.hasHistorical || $("#ft-includeHistoricalOffers").attr("disabled", !0);
        I.state.hasScam || $("#ft-includeScamOffers").attr("disabled", !0);
        S = $("#grid-wrapper-offer-filter");
        I = S.find('input[type="checkbox"][class="meta"]');
        S = S.find('input[type="checkbox"]:not([class="meta"])');
        var ua = !0
          , na = !0;
        I.on("change", function() {
            if (na) {
                ua = !1;
                var qa = $(this).parent().find('input[type="checkbox"]:not([class="meta"])');
                $(this).prop("checked") ? qa.each(function() {
                    $(this).prop("checked", !0)
                }) : qa.each(function() {
                    $(this).prop("checked", !1)
                });
                r();
                ua = !0
            }
        });
        S.on("change", function() {
            if (ua && (r(),
            $(this).data("meta"))) {
                var qa = $(this).parent().parent()
                  , ka = qa.find('input[type="checkbox"][class="meta"]')
                  , za = qa.find('input[type="checkbox"]:not([class="meta"])');
                qa = qa.find('input[type="checkbox"]:not([class="meta"]):checked');
                na = !1;
                za.length == qa.length ? ka.prop("checked", !0) : ka.prop("checked", !1);
                na = !0
            }
        });
        $("#ft-includeScamOffers").prop("checked", !1);
        $("#ft-includeHistoricalOffers").prop("checked", !1).change()
    }, r = function() {
        var I = $("#grid-wrapper-offer-filter").find("form")
          , E = I.serializeArray();
        E = E.concat(I.find("input[type=checkbox]:not(:checked)").map(function() {
            return {
                name: this.name,
                value: 0
            }
        }).get());
        E = E.concat(I.find("input[type=checkbox]:disabled").map(function() {
            var S = $(this).prop("checked") ? this.value : 0;
            return {
                name: this.name,
                value: S
            }
        }).get());
        m.conditions = [];
        E.forEach(function(S) {
            var aa = S.name.split("-");
            switch (aa[0]) {
            case "condition":
                S.value && m.conditions.push(parseInt(aa[1]));
                break;
            case "shipping":
            case "state":
                m[aa[1]] = !!S.value
            }
        });
        h = !0;
        a.api.onFilterChanged();
        I = a.api.getSortModel();
        m.includeHistoricalOffers ? I.some(function(S) {
            return "offerCSV" == S.colId
        }) && 1 == I.length && a.api.setSortModel(null) : 0 == I.length && a.api.setSortModel([{
            colId: "offerCSV",
            sort: "asc"
        }]);
        E = [];
        (I = f(JSON.stringify(m))) && E.push(I);
        hasDataAccessSubscription || E.push({
            freeAccessRow: !0,
            message: '<a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to view all available rows and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>."
        });
        a.api.setPinnedBottomRowData(E);
        a.context.oldestOfferAgeInHours = I.oldestOfferAgeInHours;
        F(Math.min(a.context.oldestOfferAgeInHours, 2160));
        var K = a.context.oldestOfferAgeInHours / 24;
        E = $(".tool__graph .trigger");
        var H = !1;
        E.css({
            "font-weight": "normal"
        });
        E.each(function(S, aa) {
            S = $(aa).data("range");
            "all" != S && (K > S ? $(aa).css({
                display: ""
            }) : ($(aa).css({
                display: H ? "none" : ""
            }),
            H = !0))
        });
        90 < K ? $('.tool__graph .trigger[data-range="90"]').css({
            "font-weight": "500"
        }) : [7, 30, 90, 180, 365].includes(K) ? $('.tool__graph .trigger[data-range="' + K + '"]').css({
            "font-weight": "500"
        }) : $('.tool__graph .trigger[data-range="all"]').css({
            "font-weight": "500"
        });
        var V = $("#" + a.context.gridWrapperId);
        E = 2 * a.headerHeight + a.scrollbarWidth + 38;
        E += 6;
        GridTools.updateResults(a.context.pageId, I.countFilteredRows);
        I.countFilteredRows && (E += Math.min(5, I.countFilteredRows) * a.getRowHeight());
        hasDataAccessSubscription || (E += GridConfig.rowHeight.balham + 8 + 4);
        V.height(E);
        if (I = "grid-tools-" + a.context.pageId)
            I = $("#" + I).find(".scroll"),
            E -= 120,
            $(I).css({
                maxHeight: Math.min(350, E) + "px"
            });
        addon()
    }, p = function() {
        return h
    }, z = function(I) {
        I = I.data;
        var E = !0;
        m.isPrime && m.isFreeShipping ? (E = I.offerCSV[I.offerCSV.length - 1],
        E = I.isPrime || 0 >= E) : m.isPrime && m.isFBMOnly ? E = I.isPrime && !I.isAmazon && !I.isWarehouseDeal && !I.isFBA : m.isPrime ? E = I.isPrime : m.isFreeShipping && m.isFBMOnly ? (E = I.offerCSV[I.offerCSV.length - 1],
        E = !I.isAmazon && !I.isWarehouseDeal && !I.isFBA && 0 >= E) : m.isFreeShipping ? E = 0 >= I.offerCSV[I.offerCSV.length - 1] : m.isFBMOnly && (E = !I.isAmazon && !I.isWarehouseDeal && !I.isFBA);
        var K = m.conditions.includes(I.condition)
          , H = !0;
        m.includeHistoricalOffers || (H = I.isLiveOffer);
        var V = !0;
        m.includeScamOffers || (V = !I.isScam);
        return E && K && H && V
    }, F = function(I) {
        0 > I && (I = a.context.oldestOfferAgeInHours);
        var E = [];
        a.api.forEachNode(function(K) {
            K = K.data;
            K.priceHistory && K.priceHistory == I || (K.priceHistory = I,
            delete K.priceCache,
            !0 !== disableStockFeatures && (K.stockHistory = I,
            delete K.stockCache),
            E.push(K))
        });
        E.length && (GridHelper.addContextMenu(a),
        a.api.updateRowData({
            update: E
        }))
    };
    return {
        init: function(I, E) {
            return GridApi.load().then(function() {
                d = {};
                h = !1;
                m = {
                    conditions: []
                };
                if (null == I.products[0].offers)
                    replaceHtml(E, "No active listing offers found.");
                else {
                    var K = t(I)
                      , H = GridConfig.get(b.type);
                    H.pageId = b.pageId;
                    H.gridOptions.columnDefs = GridHelper.removeColumnsOffer(H.gridOptions.columnDefs, K.rows, !1 !== b.showTools);
                    H.gridOptions.isExternalFilterPresent = p;
                    H.gridOptions.doesExternalFilterPass = z;
                    b.gridWrapperId = H.gridWrapperId;
                    E ? (b.containerId = E,
                    GridPage.initContainer(b)) : GridPage.init(b);
                    GridPage.initGridContainer(H);
                    a = GridApi.init(H);
                    null !== a && (a.context.config = b,
                    !1 !== b.showTools && GridTools.init(a),
                    0 <= K.rows.length && GridApi.setData(a, K.rows, K.pinnedBottomRows),
                    n(K))
                }
            }).fail(showErrorPopup)
        },
        updateGraphIntervalData: F
    }
}()
  , GridProductDetail = function() {
    var a, b = {
        showFilterTop: !1,
        showTools: !1,
        template: "productDetail",
        title: "Product Details",
        type: "productDetail"
    }, d = function(n, r) {
        n = GridHelper.prepareProduct(n, r);
        r = GridConfig.getColumns("asin");
        a.context.lookup = {
            packageLength: n.packageLength,
            packageWidth: n.packageWidth,
            packageHeight: n.packageHeight,
            packageWeight: n.packageWeight,
            itemLength: n.itemLength,
            itemWidth: n.itemWidth,
            itemHeight: n.itemHeight,
            itemWeight: n.itemWeight
        };
        var p = []
          , z = {};
        r.forEach(function(F) {
            F.children ? F.children.forEach(function(I) {
                I.headerName = F.headerName + " - " + I.headerName;
                z = f(I, n);
                Object.keys(z).length && p.push(z)
            }) : (z = f(F, n),
            Object.keys(z).length && p.push(z))
        });
        GridApi.setData(a, p)
    }, h = ["sellerIdsLowestFBA", "sellerIdsLowestFBM"], m = ["offerCountColumn", "priceColumn", "salesRankColumn", "stockSingleColumn"], t = "LIGHTNING_DEAL_upcoming AMAZON_outOfStockPercentage90 NEW_outOfStockPercentage90 USED_outOfStockPercentage90 BUY_BOX_SHIPPING_outOfStockPercentage90 packageLength packageWidth packageHeight itemLength itemWidth itemHeight salesRankReference subcategorySalesRanks salesRankDrops30 salesRankDrops90 salesRankDrops180".split(" "), f = function(n, r) {
        if (n.hide && !h.includes(n.field))
            return {};
        n.type && (n = $.extend(!0, a.columnTypes[n.type], n));
        if ("undefined" !== typeof n.type)
            for (var p = $jscomp.makeIterator(n.type), z = p.next(); !z.done; z = p.next())
                if (m.includes(z.value))
                    return {};
        if (t.includes(n.field))
            return {};
        p = n.field;
        z = r[p];
        n.type && n.type.includes("dateColumn") && (z = GridHelper.valueGetterDateKeepaTime({
            colDef: {
                field: p
            },
            data: r
        }));
        if (n.type && n.type.includes("booleanColumn") && (["buyBoxIsFBA", "buyBoxIsUnqualified"].includes(p) && (z = GridHelper.valueGetterStats({
            colDef: {
                field: p
            },
            data: r
        })),
        !1 === z) || null === z || -1 === z)
            return {};
        if (p.includes("_current") || p.includes("_avg")) {
            var F = {
                colDef: {
                    field: p
                },
                data: {
                    domainId: r.domainId
                },
                value: z
            };
            F.data[p] = z;
            var I = GridHelper.valueFormatterCsvType(F)
        } else
            switch (p) {
            case "packageDimension":
                F = {
                    isDetailTable: !0,
                    colDef: {
                        field: p
                    },
                    data: {}
                };
                F.data[p] = z;
                F.data.packageLength = r.packageLength;
                F.data.packageWidth = r.packageWidth;
                F.data.packageHeight = r.packageHeight;
                z = GridHelper.valueGetterDimension(F);
                F.value = z;
                I = GridHelper.valueFormatterDimension(F);
                break;
            case "itemDimension":
                F = {
                    isDetailTable: !0,
                    colDef: {
                        field: p
                    },
                    data: {}
                };
                F.data[p] = z;
                F.data.itemLength = r.itemLength;
                F.data.itemWidth = r.itemWidth;
                F.data.itemHeight = r.itemHeight;
                z = GridHelper.valueGetterDimension(F);
                F.value = z;
                I = GridHelper.valueFormatterDimension(F);
                break;
            case "packageLength":
            case "packageWidth":
            case "packageHeight":
            case "itemLength":
            case "itemWidth":
            case "itemHeight":
                F = {
                    isDetailTable: !0,
                    colDef: {
                        field: p
                    },
                    data: {}
                };
                F.data[p] = z;
                z = GridHelper.valueGetterMeasure(F);
                F.value = z;
                I = GridHelper.valueFormatterMeasure(F);
                break;
            case "packageWeight":
            case "itemWeight":
                F = {
                    isDetailTable: !0,
                    colDef: {
                        field: p
                    },
                    data: {}
                };
                F.data[p] = z;
                z = GridHelper.valueGetterWeight(F);
                F.value = z;
                I = GridHelper.valueFormatterWeight(F);
                break;
            case "buyBoxSellerIdHistory":
            case "couponOneTimeAbsolute":
            case "couponOneTimePercent":
            case "couponSNSPercent":
                F = {
                    colDef: {
                        field: p
                    },
                    data: {
                        asin: r.asin,
                        domainId: r.domainId,
                        stats: r.stats
                    }
                };
                "buyBoxSellerIdHistory" === p && (F.data.buyBoxSellerId = r.buyBoxSellerId,
                F.data.buyBoxSeller = r.buyBoxSeller);
                F.data[p] = r[p];
                z = "function" === typeof n.valueGetter ? n.valueGetter(F) : F.data[p];
                F.value = z;
                I = "function" === typeof n.valueFormatter ? n.valueFormatter(F) : z;
                break;
            case "sellerIdsLowestFBA":
            case "sellerIdsLowestFBM":
                F = {
                    colDef: {
                        field: p
                    },
                    data: {
                        asin: r.asin,
                        domainId: r.domainId,
                        offersOutdated: r.offersOutdated,
                        offersNeverUpdated: r.offersNeverUpdated,
                        NEW_FBA_current: r.NEW_FBA_current,
                        NEW_FBM_SHIPPING_current: r.NEW_FBM_SHIPPING_current,
                        sellerIdsLowestFBA: r.sellerIdsLowestFBA,
                        sellerIdsLowestFBM: r.sellerIdsLowestFBM,
                        stats: {}
                    }
                };
                z = "function" === typeof n.valueGetter ? n.valueGetter(F) : F.data[p];
                F.value = z;
                I = "function" === typeof n.valueFormatter ? n.valueFormatter(F) : z;
                break;
            case "fbaFees":
                F = {
                    colDef: {
                        field: p
                    },
                    data: {
                        domainId: r.domainId,
                        fbaFees: r.fbaFees,
                        fbaFeesTotal: r.fbaFeesTotal
                    }
                };
                F.data[p] = z;
                F.value = "function" === typeof n.valueGetter ? n.valueGetter(F) : z;
                I = GridHelper.valueFormatterMoney(F);
                break;
            case "availabilityAmazon":
                I = GridHelper.availabilityAmazonValueMap[z];
                break;
            case "variationAttributes":
                I = "";
                var E = z;
                if (E) {
                    E = $jscomp.makeIterator(E);
                    for (var K = E.next(); !K.done; K = E.next())
                        K = K.value,
                        I += K.dimension + ": " + K.value + "; "
                }
                I = I.trim();
                break;
            default:
                I = z
            }
        "RATING_current" == p && (z = GridHelper.valueGetterRating(F),
        F.value = z,
        I = GridHelper.valueFormatterRating(F));
        if (null == z || -1 == z)
            return {};
        E = "undefined" === typeof n.cellClass ? !1 : n.cellClass;
        if ("cell-icon" === E || "cell-number" === E)
            E += " cell-left";
        K = n.headerName.replace(/<i [\w ="-;]+><\/i> /g, "");
        if (["packageDimension", "packageWeight", "itemDimension", "itemWeight"].includes(n.field)) {
            var H = GridHelper.getCurrentUnits();
            H = n.field.includes("Weight") ? '<span class="toggle-unit" title="Toggle unit">' + H.weight + "</span>" : '<span class="toggle-unit" title="Toggle unit">' + H.measure + "</span>\u00b3";
            K = K + " (" + H + ")"
        }
        n = {
            productKey: K,
            productValue: z,
            productValueFormatted: I,
            cellClass: E,
            realField: p,
            realType: n.type,
            domainId: r.domainId,
            asin: r.asin
        };
        "undefined" !== typeof F && "undefined" !== typeof F.data && (n = $.extend(!0, n, F.data));
        return n
    };
    return {
        init: function(n, r) {
            var p = GridApi.load()
              , z = n.products[0]
              , F = GridHelperCategory.load([z]);
            return $.when(p, F).done(function() {
                var I = GridConfig.get(b.type);
                I.pageId = b.pageId;
                b.gridWrapperId = I.gridWrapperId;
                r ? (b.containerId = r,
                GridPage.initContainer(b)) : GridPage.init(b);
                GridPage.initGridContainer(I);
                a = GridApi.init(I);
                null !== a && (a.context.config = b,
                d(z, n.sellers))
            }).fail(showErrorPopup)
        }
    }
}()
  , GridProductPrice = function() {
    var a, b = {
        showFilterTop: !1,
        showTools: !1,
        template: "productPrice",
        title: "Product Prices",
        type: "productPrice"
    }, d = function(p) {
        var z = GridConfig.getColumns("asin")
          , F = z.filter(function(K, H) {
            return "groupSalesRank" == K.groupId ? (K.index = H,
            !0) : !1
        });
        F = F[0];
        F.children.splice(2, 0, {
            headerName: "60 days avg.",
            headerNameGroup: CsvType.getName(CsvType.SALES.index),
            field: "SALES_avg60",
            type: ["salesRankColumn"],
            width: 107
        });
        z[F.index] = F;
        var I = []
          , E = {};
        z.forEach(function(K) {
            K.children ? K.children.forEach(function(H) {
                H.headerName = K.headerName + " - " + H.headerName;
                E = n(H, p);
                Object.keys(E).length && I.push(E)
            }) : (E = n(K, p),
            Object.keys(E).length && I.push(E))
        });
        GridApi.setData(a, I)
    }, h = "SALES_avg30 SALES_avg60 SALES_avg180 newPriceIsMAP offerCountFBA offerCountFBM salesRankDrops30 salesRankDrops90 salesRankDrops180".split(" "), m = ["_current", "_avg90", "_outOfStockPercentage90"], t = ["offerCountColumn", "stockSingleColumn", "salesRankDropColumn"], f = ["RATING_current", "COUNT_REVIEWS_current"], n = function(p, z) {
        p.type && (p = $.extend(!0, p, a.columnTypes[p.type]));
        var F = !1
          , I = !1;
        if (f.includes(p.field))
            F = !0;
        else {
            if ("undefined" !== typeof p.type)
                for (var E = $jscomp.makeIterator(p.type), K = E.next(); !K.done; K = E.next())
                    t.includes(K.value) && (I = !0);
            h.includes(p.field) && (I = !0);
            I || (I = m.some(function(V) {
                return -1 < p.field.indexOf(V)
            }))
        }
        if (!I || F)
            return {};
        F = p.field;
        I = {
            colDef: {
                field: F
            },
            data: {
                stats: z.stats,
                domainId: z.domainId,
                offersOutdated: z.offersOutdated,
                offersOutworn: z.offersOutworn
            }
        };
        I.data[F] = z[F];
        E = "function" === typeof p.valueGetter ? p.valueGetter(I) : I.data[F];
        if (null == E || -1 == E)
            return {};
        I.value = E;
        K = "function" === typeof p.valueFormatter ? p.valueFormatter(I) : E;
        var H = p.headerName.replace(/<i [\w ="-;]+><\/i> /g, "");
        if (["AMAZON_outOfStockPercentage90", "NEW_outOfStockPercentage90", "USED_outOfStockPercentage90", "BUY_BOX_SHIPPING_outOfStockPercentage90", "newPriceIsMAP"].includes(p.field)) {
            if (!1 === I.value)
                return {};
            p.cellClass = "cell-icon cell-number";
            H = '<span title="' + p.headerTooltip.replace(/<br>/g, "\n") + '">' + H + ' <i class="fa fa-info"></i></span>'
        }
        I = {
            productKey: H,
            productValue: E,
            productValueFormatted: K,
            cellClass: "undefined" === typeof p.cellClass ? "" : p.cellClass,
            realCellRenderer: "function" === typeof p.cellRenderer ? p.cellRenderer : !1,
            realField: F,
            realType: p.type,
            domainId: z.domainId,
            asin: z.asin,
            offersOutdated: z.offersOutdated,
            offersOutworn: z.offersOutworn
        };
        I[F] = z[F];
        return I
    }, r = function(p) {
        p = GridHelper.prepareProduct(p);
        p.SALES_avg60 = getWeightedMean(p.csv[CsvType.SALES.index], p.lastUpdate, 60, "SALES");
        return p
    };
    return {
        init: function(p, z) {
            var F = GridApi.load()
              , I = r(p.products[0]);
            return $.when(F).done(function() {
                var E = GridConfig.get(b.type);
                E.pageId = b.pageId;
                b.gridWrapperId = E.gridWrapperId;
                z ? (b.containerId = z,
                GridPage.initContainer(b)) : GridPage.init(b);
                GridPage.initGridContainer(E);
                a = GridApi.init(E);
                null !== a && (a.context.config = b,
                d(I))
            }).fail(showErrorPopup)
        }
    }
}()
  , GridSearch = function() {
    var a, b = {
        pageId: "search",
        resizeToViewport: !0,
        showTools: !1,
        template: "search",
        title: "Search",
        type: "search"
    };
    return {
        init: function(d, h) {
            return GridApi.load().then(function() {
                for (var m = d, t = 0; t < m.length; t++)
                    m[t] = GridHelper.prepareProductSearch(m[t]);
                d = m;
                m = GridConfig.get(b.type);
                m.pageId = b.pageId;
                m.gridOptions.columnDefs = GridHelper.removeColumnsEmpty(m.gridOptions.columnDefs, d);
                b.gridWrapperId = m.gridWrapperId;
                h ? (b.containerId = h,
                GridPage.initContainer(b)) : GridPage.init(b);
                GridPage.initGridContainer(m);
                a = GridApi.init(m);
                null !== a && (a.context.config = b,
                d.length && GridApi.setData(a, d))
            }).fail(showErrorPopup)
        }
    }
}()
  , GridSellerBrandStatistic = function() {
    var a, b = {
        containerId: "grid-container-seller-brand-statistic",
        pageId: "sellerbrandstatistic",
        resizeToViewport: !1,
        showTools: !1,
        template: "sellerbrandstatistic",
        type: "sellerbrandstatistic"
    };
    return {
        init: function(d, h) {
            var m = d.sellerBrandStatistics;
            if (m && 0 !== m.length)
                return GridApi.load().then(function() {
                    var t = GridConfig.get(b.type);
                    t.pageId = b.pageId;
                    b.gridWrapperId = t.gridWrapperId;
                    h ? (b.containerId = h,
                    GridPage.initContainer(b)) : GridPage.init(b);
                    GridPage.initGridContainer(t);
                    a = GridApi.init(t);
                    if (null !== a) {
                        a.context.config = b;
                        a.context.data = {
                            sellerId: d.sellerId,
                            sellerName: d.sellerName
                        };
                        t = 0;
                        for (var f = $jscomp.makeIterator(m), n = f.next(); !n.done; n = f.next())
                            n = n.value,
                            null != n && (t += n.productCount);
                        f = [];
                        var r = $jscomp.makeIterator(m);
                        for (n = r.next(); !n.done; n = r.next())
                            n = n.value,
                            null != n && (n.productCountPercentage = Math.round(1E4 * n.productCount / t) / 100,
                            n.productCountWithAmazonOfferPercentage = Math.round(1E4 * n.productCountWithAmazonOffer / n.productCount) / 100,
                            f.push(n));
                        GridApi.setData(a, f);
                        t = GridConfig.rowHeight.balham + GridConfig.rowHeight.balham * f.length + 1;
                        $("#" + b.gridWrapperId).height(t + "px")
                    }
                }).fail(showErrorPopup)
        }
    }
}()
  , GridSellerCategoryStatistic = function() {
    var a, b = {
        containerId: "grid-container-seller-category-statistic",
        pageId: "sellercategorystatistic",
        resizeToViewport: !1,
        showTools: !1,
        template: "sellercategorystatistic",
        type: "sellercategorystatistic"
    }, d = function(h, m) {
        for (var t = [], f = 0, n = $jscomp.makeIterator(m), r = n.next(); !r.done; r = n.next())
            r = r.value,
            null != r && (t.push(r.catId),
            f += r.productCount);
        network.request({
            path: "pro/category",
            domainId: h,
            categoryIds: t,
            version: 3
        }).done(function(p) {
            p = p.categories || [];
            for (var z = [], F = $jscomp.makeIterator(m), I = F.next(); !I.done; I = F.next())
                I = I.value,
                null != I && (I.catName = I.catId > invalidIfLargerCatId ? null : p[I.catId] ? p[I.catId].name : "-",
                I.productCountPercentage = Math.round(1E4 * I.productCount / f) / 100,
                I.productCountWithAmazonOfferPercentage = Math.round(1E4 * I.productCountWithAmazonOffer / I.productCount) / 100,
                z.push(I));
            GridApi.setData(a, z);
            p = GridConfig.rowHeight.balham + GridConfig.rowHeight.balham * z.length + 1;
            $("#" + b.gridWrapperId).height(p + "px")
        }).fail(showErrorPopup)
    };
    return {
        init: function(h, m) {
            var t = h.sellerCategoryStatistics;
            if (t && 0 !== t.length)
                return GridApi.load().then(function() {
                    var f = GridConfig.get(b.type);
                    f.pageId = b.pageId;
                    b.gridWrapperId = f.gridWrapperId;
                    m ? (b.containerId = m,
                    GridPage.initContainer(b)) : GridPage.init(b);
                    GridPage.initGridContainer(f);
                    a = GridApi.init(f);
                    null !== a && (a.context.config = b,
                    a.context.data = {
                        sellerId: h.sellerId,
                        sellerName: h.sellerName
                    },
                    d(h.domainId, t))
                }).fail(showErrorPopup)
        }
    }
}()
  , GridStorefront = function() {
    var a, b = {
        pageId: "storefront",
        resizeToViewport: !0,
        showTools: {
            column: !0,
            columnPresets: !0,
            export: !0,
            row: !0,
            track: GridConfig.gridTypesWithCheckboxSelection.includes("asin")
        },
        template: "asin",
        title: "Seller Storefront",
        type: "asin"
    }, d = function(m) {
        var t = m.context.config.domainId
          , f = m.context.config.sellerId;
        m = GridApi.getRowsPerPage(m);
        network.request({
            path: "pro/seller",
            domainId: t,
            seller: f,
            page: 0,
            perPage: m,
            storefront: -1,
            history: !0,
            version: 3
        }).done(function(n) {
            n = n.merchants[f];
            var r = {};
            r[n.domainId] = n.asinList;
            null == n.asinList ? showErrorPopup() : networkHelper.loadASINs({
                history: !1,
                includeDeals: !0,
                maxAge: 60,
                offerPages: 0,
                path: "pro/product",
                refreshProduct: !1,
                type: "storefront"
            }, r, ".loadingFlipper").done(function(p) {
                h(p)
            }).fail(function(p) {
                if (429 == p.status) {
                    var z = quotaExceeded;
                    "undefined" != typeof p.products && 0 < p.products.length ? (z += "<br>" + quotaLastedFor.replace("#count#", p.products.length).replace("#type#", "products"),
                    showPopup("Quota exceeded", z, !0),
                    h(p.products)) : showPopup("Quota exceeded", z, !0);
                    addDataUpdateHandler()
                } else
                    showErrorPopup("Status: " + p.status)
            })
        }).fail(showErrorPopup)
    }, h = function(m) {
        for (var t = [], f = 0; f < m.length; f++)
            3 !== m[f].productType && 4 !== m[f].productType && t.push(m[f]);
        GridHelperCategory.load(t).done(function() {
            for (var n = 0; n < t.length; n++)
                t[n] = GridHelper.prepareProduct(t[n]);
            GridApi.setData(a, t)
        }).fail(showErrorPopup)
    };
    return {
        init: function(m, t) {
            return GridApi.load().then(function() {
                var f = GridConfig.get(b.type);
                f.pageId = b.pageId;
                hasDataAccessSubscription || (f.gridOptions.pinnedBottomRowData = [{
                    freeAccessRow: !0,
                    message: '<a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to view up to 5000 rows and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>."
                }]);
                b.gridWrapperId = f.gridWrapperId;
                t ? (b.containerId = t,
                GridPage.initContainer(b)) : GridPage.init(b);
                GridPage.initGridContainer(f);
                a = GridApi.init(f);
                null !== a && (a.context.config = b,
                !1 !== b.showTools && GridTools.init(a),
                a.context.config.domainId = m.domainId,
                a.context.config.sellerId = m.sellerId,
                d(a))
            }).fail(showErrorPopup)
        },
        initData: d
    }
}()
  , GridTopSeller = function() {
    var a, b = {
        pageId: "topseller",
        resizeToViewport: !0,
        showTools: {
            export: !0,
            row: !0
        },
        template: "topseller",
        title: "Top Seller List",
        type: "seller"
    }, d = function(m) {
        var t = Number(storage.domain)
          , f = GridApi.getRowsPerPage(m);
        network.request({
            path: "pro/topseller",
            domainId: t,
            page: 0,
            perPage: f,
            version: 3
        }).done(function(n) {
            if ("undefined" === typeof n.topSellerList)
                h(n);
            else {
                var r = [];
                n = n.topSellerList.sellerIdList.reduce(function(z, F, I) {
                    0 == I % 100 && 0 !== I && z.push([]);
                    z[z.length - 1].push(F);
                    return z
                }, [[]]);
                for (var p = 0; p < n.length; p += 1)
                    r.push(n[p].join(","));
                networkHelper.loadSellers({
                    path: "pro/seller",
                    history: !1,
                    version: 3
                }, t, r, "#loadingFlipper").done(function(z) {
                    var F = [], I = [], E = 1, K;
                    for (K in z) {
                        var H = z[K];
                        H.rank = E++;
                        H.totalProductCountFromStatistics = null;
                        if (H.sellerCategoryStatistics && null != H.sellerCategoryStatistics[0]) {
                            I.push(H.sellerCategoryStatistics[0].catId);
                            H.topCategory = H.sellerCategoryStatistics[0].catId;
                            for (var V = 0, S = !1, aa = $jscomp.makeIterator(H.sellerCategoryStatistics), ea = aa.next(); !ea.done; ea = aa.next())
                                ea = ea.value,
                                null != ea && (V += ea.productCount,
                                S = !0);
                            H.totalProductCountFromStatistics = S ? V : null;
                            H.topCategoryProductCountPercentage = Math.round(1E4 * H.sellerCategoryStatistics[0].productCount / V) / 100
                        }
                        F.push(H)
                    }
                    delete m.context.config.perPage;
                    GridHelperCategory.load(null, t, I).always(function() {
                        GridApi.setData(m, F)
                    })
                }).fail(showErrorPopup)
            }
        }).fail(function(n) {
            h(n)
        })
    }, h = function(m) {
        a.api.destroy();
        429 == m.status ? (insertPage('<div class="paper">' + quotaExceeded + "</div>"),
        showPopup("Quota exceeded", quotaExceeded, !0),
        addDataUpdateHandler()) : showErrorPopup("Status: " + m.status)
    };
    return {
        init: function() {
            return GridApi.load().then(function() {
                var m = GridConfig.get(b.type);
                m.pageId = b.pageId;
                hasDataAccessSubscription || (m.gridOptions.pagination = !1,
                m.gridOptions.paginationPageSize = GridConfig.maxRowsFreeUser,
                m.gridOptions.pinnedBottomRowData = [{
                    freeAccessRow: !0,
                    message: '<a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to view up to 100000 rows and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>."
                }]);
                b.gridWrapperId = m.gridWrapperId;
                GridPage.init(b);
                GridPage.initGridContainer(m);
                a = GridApi.init(m);
                null !== a && (a.context.config = b,
                !1 !== b.showTools && GridTools.init(a),
                d(a))
            }).fail(showErrorPopup)
        },
        initData: d
    }
}()
  , GridVariation = function() {
    var a, b = {
        pageId: "variation",
        resizeToIframeTab: !0,
        showFilterTop: !0,
        showTools: {
            export: !0,
            results: !0,
            track: GridConfig.gridTypesWithCheckboxSelection.includes("variation"),
            viewer: !0
        },
        template: "variation",
        title: "Product Variations",
        type: "variation"
    }, d = {}, h = function(r) {
        var p = keepaTime.now()
          , z = r.find(function(V) {
            return V.asin === V.parentAsin
        });
        r = r.map(function(V) {
            return V.asin !== V.parentAsin ? V : null
        }).filter(function(V) {
            return V
        });
        for (var F = 0, I = 0, E = 0, K = 0; K < r.length; K++)
            if (r[K].variations = z ? z.variations : null,
            r[K] = GridHelper.prepareProduct(r[K]),
            F = Math.max(F, r[K].COUNT_REVIEWS_current),
            r[K].reviews && 20160 >= p - r[K].reviews.lastUpdate) {
                var H = r[K].reviews.ratingCount[r[K].reviews.ratingCount.length - 1];
                E += 0 < H ? H : 0;
                I = Math.max(I, H)
            }
        return r = r.map(function(V) {
            V.ratingCountAcrossVariations = Math.max(F, E);
            V.reviewsRatingIsMax = V.reviews && I === V.reviews.ratingCount[V.reviews.ratingCount.length - 1];
            return V
        })
    }, m = function(r) {
        0 != r.length && (replaceHtml(b.gridWrapperId + "-filter", '<form id="variation-filter"><div>\n\t\t\t\t\t<input id="ft-includeInternational" name="includeInternational" value="1" type="checkbox"> \n\t\t\t\t\t<label for="ft-includeInternational">Include international Amazon prices</label>\n\t\t\t\t</div></form>'),
        $("#" + b.gridWrapperId + "-filter").find('input[type="checkbox"]').on("change", function(p) {
            var z = $(this);
            if ("includeInternational" === $(this).attr("name"))
                if ($(this).prop("disabled", !0),
                $(this).prop("checked")) {
                    p = Number(r[0].domainId);
                    for (var F = {}, I = continents[domainIdToContinent[p]], E = 1; E < numberOfDomains; E++)
                        if (7 != E && -1 < I.indexOf(E) && E != p) {
                            F[E] = [];
                            for (var K = 0; K < r.length; K++)
                                F[E].push(r[K].asin)
                        }
                    if (0 === Object.keys(F).length)
                        r = f(r),
                        n(r),
                        $(this).prop("disabled", !1);
                    else {
                        var H = $(this).next("label");
                        H.html("Loading international Amazon prices ...");
                        0 < Object.keys(d).length ? (r = t(r),
                        n(r),
                        H.html("Include international Amazon prices"),
                        z.prop("disabled", !1)) : networkHelper.loadASINs({
                            path: "product",
                            offerPages: 0,
                            maxAge: 1440,
                            history: !1,
                            stats: 90,
                            type: "casin",
                            refreshProduct: !1
                        }, F).done(function(V) {
                            for (var S = r, aa = Number(S[0].domainId), ea = 0; ea < V.length; ea++) {
                                var ra = V[ea]
                                  , pa = ra.asin
                                  , ua = ra.domainId;
                                ra = ra.stats;
                                "undefined" === typeof d[pa] && (d[pa] = {});
                                d[pa][ua] = {
                                    AMAZON: Money.raw(ra.current[CsvType.AMAZON.index], {
                                        sourceDomainId: ua,
                                        targetDomainId: aa,
                                        keepUnit: !0
                                    }),
                                    NEW: Money.raw(ra.current[CsvType.NEW.index], {
                                        sourceDomainId: ua,
                                        targetDomainId: aa,
                                        keepUnit: !0
                                    }),
                                    USED: Money.raw(ra.current[CsvType.USED.index], {
                                        sourceDomainId: ua,
                                        targetDomainId: aa,
                                        keepUnit: !0
                                    })
                                }
                            }
                            for (V = 0; V < S.length; V++)
                                pa = S[V],
                                ea = pa.asin,
                                pa = pa.stats,
                                "undefined" === typeof d[ea] && (d[ea] = {}),
                                d[ea][aa] = {
                                    AMAZON: Money.raw(pa.current[CsvType.AMAZON.index], {
                                        sourceDomainId: aa,
                                        targetDomainId: aa,
                                        keepUnit: !0
                                    }),
                                    NEW: Money.raw(pa.current[CsvType.NEW.index], {
                                        sourceDomainId: aa,
                                        targetDomainId: aa,
                                        keepUnit: !0
                                    }),
                                    USED: Money.raw(pa.current[CsvType.USED.index], {
                                        sourceDomainId: aa,
                                        targetDomainId: aa,
                                        keepUnit: !0
                                    })
                                };
                            S = t(S);
                            n(S);
                            H.html("Include international Amazon prices");
                            z.prop("disabled", !1)
                        }).fail(function(V) {
                            showErrorPopup("Status: " + V.status)
                        })
                    }
                } else
                    r = f(r),
                    n(r),
                    $(this).prop("disabled", !1)
        }))
    }, t = function(r) {
        for (var p = 0; p < r.length; p++)
            "undefined" != d[r[p].asin] && (r[p].casin = d[r[p].asin]);
        return r
    }, f = function(r) {
        for (var p = 0; p < r.length; p++)
            delete r[p].casin;
        return r
    }, n = function(r) {
        var p = [];
        a.api.forEachNode(function(z) {
            z = z.data;
            var F = z.asin
              , I = r.find(function(E) {
                return E.asin === F
            });
            "undefined" !== typeof I && (z.casin = I.casin,
            p.push(z))
        });
        GridHelper.addContextMenu(a);
        a.api.updateRowData({
            update: p
        })
    };
    return {
        init: function(r, p, z) {
            z = void 0 === z ? !0 : z;
            return GridApi.load().then(function() {
                d = {};
                r = h(r);
                var F = GridConfig.get(b.type);
                F.pageId = b.pageId;
                F.gridOptions.columnDefs = GridHelper.removeColumnsEmpty(F.gridOptions.columnDefs, r);
                z || (b.showFilterTop = !1,
                b.showTools = !1);
                b.gridWrapperId = F.gridWrapperId;
                p ? (b.containerId = p,
                GridPage.initContainer(b)) : GridPage.init(b);
                GridPage.initGridContainer(F);
                a = GridApi.init(F);
                if (null !== a) {
                    a.context.config = b;
                    !1 !== b.showTools && GridTools.init(a);
                    F = $("#" + a.context.gridWrapperId);
                    var I = 2 * GridConfig.rowHeight.balham;
                    I += Math.min(5, r.length) * a.getRowHeight();
                    F.height(I + 17 + 1);
                    F = r;
                    F.length && (GridTools.updateResults(a.context.pageId, F.length),
                    GridApi.setData(a, F));
                    b.showFilterTop && m(r)
                }
            }).fail(showErrorPopup)
        }
    }
}()
  , GridViewer = function() {
    var a = 1E4, b = 0, d = 0, h = {}, m = !0, t = "", f = "", n = !1, r, p = {
        pageId: "viewer",
        resizeToViewport: !0,
        showTools: {
            column: !0,
            columnPresets: !0,
            delete: !0,
            export: !0,
            import: !0,
            track: GridConfig.gridTypesWithCheckboxSelection.includes("asinViewer"),
            update: !0
        },
        template: "asin",
        title: "Product Viewer",
        type: "asinViewer"
    }, z = function(na) {
        var qa = $.Deferred()
          , ka = material.getRadio("asinCh", "List of ASINs", m, "type")
          , za = material.getRadio("upcCh", "List of UPC / EAN codes", !m, "type")
          , J = material.getInput(!0, ".*(" + verifyRegExp.asin.source + ").*", "importInputAsin", "A list of ASINs\u2026 (up to " + a + ")", null, "text", "no valid ASIN found", null, !0, "font-size:15px")
          , g = material.getInput(!0, ".*(\\d{8,}).*", "importInputUpc", "A list of UPC or EANs\u2026 (up to " + a + ")", null, "text", "no valid UPC / EAN found", null, !0, "font-size:15px")
          , D = material.getButton("importSubmit", "Load List", null, "upload")
          , N = function(L) {
            return '<span style="position: absolute;width:400px;">' + L + "</span>"
        }
          , ba = material.getInputFile("importInputFile", "importInputFile", "Choose text file (e.g. *.txt, *.csv, ...)", ".txt, .csv, .md", !0, !0, "font-size:15px")
          , q = '<div style="height:50px;">' + material.getCheckbox("includeInaccessibleAsins", "Include products we currently are unable to collect fresh information for", !1, !1, "includeInaccessibleAsins", 1) + "</div>";
        na = '<div style="width:400px;">\n\t\t\t\t<p>You can load up to ' + a + ' products* to view. Once loaded you can create a bookmark** \n\t\t\t\t\tof your list.</p><br>\n\t\t\t\t\t<form name="loadForm" id="importForm">\n\t\t\t\t\t\t<section id="typeRadio">' + ka + za + '</section>\n\t\t\t\t\t<div style="height:110px;margin-top: -10px;">' + N(J) + N(g) + '</span></div>\n\t\t\t\t\t<p>Alternatively you can upload a text file containing a list of ASINs or UPC / EAN codes:</p>\n\t\t\t\t\t<div style="height:110px;">' + N(ba) + "</div>\n\t\t\t\t\t" + q + "\n\t\t\t\t\t" + (na ? '<div class="red" style="margin-bottom:10px;">' + na + "</div>" : "") + "\n\t\t\t\t\t" + D + '\n\t\t\t\t</form><br>\n\t\t\t\t<p style="font-size:11px;">\n\t\t\t\t' + (hasDataAccessSubscription ? "* Recommended: 5000, larger lists may take some time to load!" : '* <a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to load up to 10000 rows and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>.") + "\n\t\t\t\t<br>** Currently bookmarks are only possible if the result contains a maximum<br>of ~3000 products.</p>\n\t\t\t</div>";
        material.init("#importForm");
        setTimeout(function() {
            var L = $("#importInputAsin,#importInputUpc")
              , A = $("#typeRadio")
              , O = $("#importInputFile")
              , P = $("#importInputFileTrigger")
              , M = null
              , u = function() {
                return "asinCh-radio" == A.find(":checked")[0].id
            };
            L.on("input", function() {
                u() && $(this).val($(this).val().toUpperCase());
                L.not(this).prop("required", !$(this).val().length);
                $(this).val().length && (O.val(""),
                P.val(""),
                P.prop("required", !1),
                P.parent().removeClass("mdc-text-field--invalid"),
                M = null)
            });
            var v = function() {
                var G = u()
                  , w = function(B, Q) {
                    return $("#" + B).parent().parent()[Q ? "fadeIn" : "fadeOut"](250)
                };
                w("importInputAsin", G);
                w("importInputUpc", !G)
            };
            A.on("change", v);
            v();
            P.on("click", function(G) {
                L.val("");
                L.parent().removeClass("mdc-text-field--invalid");
                O.click();
                G.preventDefault()
            });
            O.on("change", function() {
                for (var G = $jscomp.makeIterator(this.files), w = G.next(); !w.done; w = G.next())
                    if (w = w.value,
                    M = null,
                    null === w.type || "" === w.type)
                        M = w;
                    else {
                        var B = ["csv", "md"]
                          , Q = w.name.split(".").pop();
                        if (w.type.startsWith("text/") || B.includes(Q))
                            M = w
                    }
                $(P).prop("required", !0);
                L.prop("required", !1);
                M && ($(P).val(M.name),
                $(P).parent().removeClass("mdc-text-field--invalid"))
            });
            $("#importForm").on("submit", function(G) {
                G.preventDefault();
                var w = u();
                n = (G = $("#includeInaccessibleAsins-checkbox")[0]) ? G.checked : !1;
                if (M) {
                    var B = new FileReader;
                    B.onload = function() {
                        var Q = B.result;
                        w && (Q = Q.toUpperCase());
                        qa.resolve({
                            isAsin: w,
                            input: Q
                        })
                    }
                    ;
                    B.onerror = function() {
                        qa.resolve({
                            isAsin: w,
                            input: ""
                        })
                    }
                    ;
                    B.readAsText(M)
                } else
                    qa.resolve({
                        isAsin: w,
                        input: $("#" + (w ? "importInputAsin" : "importInputUpc")).val()
                    })
            })
        }, 0);
        return {
            onImport: qa.promise(),
            html: na
        }
    }, F = function() {
        var na = $.Deferred()
          , qa = !1
          , ka = 1
          , za = 12
          , J = r.context.asinCountForUpdate && Object.keys(r.context.asinCountForUpdate).length ? Math.max.apply(Math, $jscomp.arrayFromIterable(Object.keys(r.context.asinCountForUpdate).map(function(g) {
            return parseInt(g)
        }))) : 0;
        za = Math.min(za, J);
        J = I(za);
        for (J.tokens > d && (ka = za); J.tokens > d && 24 > za; )
            za++,
            ka++,
            J = I(za);
        if (J.tokens > d || 0 == J.tokens)
            qa = !0;
        ka = material.getInputNumber("updateHours", za, ka, 24, qa, "Refresh if older than", "hour(s)", "width:40px;padding-top:0;");
        za = material.getButton("updateSubmit", "Update", null, "refresh");
        J = '<div id="quota-force" style="width:400px;margin-bottom:10px;">Force a product offer data refresh by choosing a max age in hours.</div>\n\t\t\t<form id="updateForm">\n\t\t\t\t<section style="margin-bottom:20px;">' + ka + '</section>\n\t\t\t\t<section style="margin-bottom:20px;">\n\t\t\t\t\t' + (qa ? 0 == J.tokens ? "No need to force a refresh, none of your product's data is older than 1 hour." : "Your current quota is not sufficient to force a product data refresh.<br>Please wait until it is refilled." : 'This will consume <span id="quota-cost" style="color:#cc0079;font-weight:bold;">' + J.quota + " %</span> of your complete Data quota.") + "\n\t\t\t\t\t</section>\n\t\t\t\t" + za + "\n\t\t\t</form>\n\t\t";
        material.init("#updateForm");
        setTimeout(function() {
            qa && $("#updateSubmit").prop("disabled", !0);
            var g = $("#updateHours")
              , D = $("#quota-cost");
            g.on("input", function() {
                var N = $(this).val();
                N = Math.min(24, N);
                N = I(N);
                D.text(N.quota + " %")
            });
            r.context.asinYoungerThanMaxAgeFound || (g.val(24),
            g.parent().parent().hide(),
            $("#quota-force").hide());
            $("#updateForm").on("submit", function(N) {
                var ba = g.val();
                ba = Math.min(24, ba);
                na.resolve({
                    hours: ba
                });
                N.preventDefault()
            })
        }, 0);
        return {
            onUpdate: na.promise(),
            html: J
        }
    }, I = function(na) {
        var qa = 0;
        (r.context.asinCountForUpdate && Object.keys(r.context.asinCountForUpdate).length ? Object.keys(r.context.asinCountForUpdate).filter(function(za) {
            return za >= na
        }) : []).forEach(function(za) {
            qa += r.context.asinCountForUpdate[za].length
        });
        var ka = 15 * qa;
        return {
            quota: 0 < b ? 100 * ka / b : 100,
            tokens: ka
        }
    }, E = function(na, qa, ka) {
        "object" === typeof na && (h = na);
        na = !0;
        for (var za = $jscomp.makeIterator(Object.values(h)), J = za.next(); !J.done; J = za.next())
            if (0 <= J.value.length) {
                na = !1;
                break
            }
        na ? ("object" === typeof ka && null !== ka && ka.close(),
        ea([]),
        setTimeout(function() {
            V("No valid " + (m ? "ASINs" : "UPC / EAN codes") + " found.")
        }, 500)) : K(h, qa, !1)
    }, K = function(na, qa, ka) {
        qa && r.api.showLoadingOverlay();
        var za = Number(storage.lastViewerVisit) || Date.now()
          , J = Date.now();
        7E4 > J - za && (za = J - 7E4);
        r.context.statsStart = za;
        r.context.statsEnd = J;
        networkHelper.loadASINs({
            history: !1,
            includeDeals: !0,
            maxAge: 0,
            offerPages: qa ? 2 : 0,
            path: "pro/product",
            refreshProduct: qa,
            stats: za + "," + J,
            type: "viewer"
        }, na, ".loadingFlipper").done(function(g) {
            network.request({
                path: "user/settings",
                type: "getSettings",
                version: 3
            }).done(function(D) {
                d = D.tokens ? D.tokens : 0;
                b = D.tokenBucketSize ? D.tokenBucketSize : 0;
                0 === g.length && !hasDataAccessSubscription && 0 >= d && (setTimeout(function() {
                    showPopup("Quota exceeded", quotaExceeded, !0)
                }, 200),
                0 == r.api.getDisplayedRowCount() && (r.api.destroy(),
                insertPage('<div class="paper">' + quotaExceeded + "</div>")),
                addDataUpdateHandler());
                D = g.map(function(N, ba) {
                    var q = na[N.domainId].indexOf(N.asin);
                    if (!m) {
                        var L = [];
                        null != N.upcList && (L = L.concat(N.upcList));
                        for (null != N.eanList && (L = L.concat(N.eanList)); L.length && !(q = L.shift(),
                        q = na[N.domainId].indexOf(q),
                        -1 < q); )
                            ;
                    }
                    return {
                        index: ba,
                        value: 1E4 * N.domainId + q,
                        asin: N.asin
                    }
                });
                D.sort(function(N, ba) {
                    return N.value > ba.value ? 1 : N.value < ba.value ? -1 : 0
                });
                D = D.map(function(N) {
                    return g[N.index]
                });
                0 < g.length && !ka && pa(na, D);
                aa(D, ka)
            })
        }).fail(function(g) {
            network.request({
                path: "user/settings",
                type: "getSettings",
                version: 3
            }).done(function(D) {
                d = D.tokens ? D.tokens : 0;
                b = D.tokenBucketSize ? D.tokenBucketSize : 0;
                429 == g.status ? setTimeout(function() {
                    var N = quotaExceeded;
                    "undefined" != typeof g.products && 0 < g.products.length ? (N += "<br>" + quotaLastedFor.replace("#count#", g.products.length).replace("#type#", "products"),
                    showPopup("Quota exceeded", N, !0),
                    aa(g.products, ka)) : (showPopup("Quota exceeded", N, !0),
                    0 == r.api.getDisplayedRowCount() && (r.api.destroy(),
                    insertPage('<div class="paper">' + quotaExceeded + "</div>")));
                    addDataUpdateHandler()
                }, 200) : showErrorPopup("Status: " + g.status)
            })
        })
    }, H = function(na) {
        var qa = {};
        Object.keys(r.context.asinCountForUpdate).filter(function(ka) {
            return ka >= na
        }).forEach(function(ka) {
            r.context.asinCountForUpdate[ka].forEach(function(za) {
                za = za.split("#");
                qa[za[0]] || (qa[za[0]] = []);
                qa[za[0]].push(za[1])
            })
        });
        0 < Object.keys(qa).length && K(qa, !0, !0, !1)
    }, V = function(na) {
        var qa = Number(storage.domain);
        na = z(na);
        var ka = showPopup('Load <img src="' + flags[qa] + '" /> <span style="font-weight:500;color:#666;">Amazon.' + tld + "</span> Products", na.html, !0);
        na.onImport.done(function(za) {
            ka.promise.resolve(za)
        });
        ka.promise.done(function(za) {
            za = S(za);
            E(za, !1, ka);
            ka.close()
        }).fail(function(za) {})
    }, S = function(na) {
        m = na.isAsin;
        var qa = na.input, ka = m ? verifyRegExp.globalAsin : verifyRegExp.globalProductCode, za;
        na = {};
        var J = {};
        na[storage.domain] = [];
        if (za = tryParseJSON(qa, !0))
            na = za,
            null != na.listId && (f = na.listId),
            na.includeInaccessibleAsins && !0 === na.includeInaccessibleAsins && (n = na.includeInaccessibleAsins);
        else {
            do
                (za = ka.exec(qa)) && na[storage.domain].push(za[1]);
            while (za)
        }
        qa = 0;
        ka = m ? verifyRegExp.asin : verifyRegExp.productCode;
        for (za = 1; za < numberOfDomains; za++)
            if (7 != za && na[za] && na[za].length) {
                na[za] = Array.from(new Set(na[za]));
                J[za] = [];
                for (var g = $jscomp.makeIterator(na[za]), D = g.next(); !D.done; D = g.next())
                    D = D.value,
                    ka.test(D) && qa++ < a && J[za].push(D)
            }
        return J
    }, aa = function(na, qa) {
        if (0 !== na.length || qa) {
            for (var ka = [2, 3, 4], za = keepaTime.now(), J = [], g = [], D = {}, N = !1, ba = 0; ba < na.length; ba++) {
                var q = na[ba].asin;
                if (-1 === g.indexOf(q)) {
                    var L = na[ba]
                      , A = L.domainId;
                    if (-1 === ka.indexOf(na[ba].productType)) {
                        if (!qa) {
                            var O = Math.floor((za - L.stats.lastOffersUpdate) / 60);
                            0 < O && (24 > O && (N = !0),
                            A = A + "#" + q,
                            D[O] ? D[O].push(A) : D[O] = [A])
                        }
                        g.push(q);
                        J.push(L)
                    } else
                        n && 3 === na[ba].productType ? (g.push(q),
                        J.push(L)) : isTest && console.log("non trackable product type", na[ba].asin, na[ba].productType)
                }
            }
            na = J;
            J = null;
            qa || (r.context.asinYoungerThanMaxAgeFound = N,
            r.context.asinCountForUpdate = D);
            if (0 === na.length)
                ua();
            else {
                if (!qa) {
                    ka = {};
                    za = $jscomp.makeIterator(na);
                    for (J = za.next(); !J.done; J = za.next())
                        J = J.value,
                        ka[J.domainId] = ka[J.domainId] || [],
                        ka[J.domainId].push(J.asin);
                    ka.listId = f || Guid.newGuid();
                    ka.includeInaccessibleAsins = n;
                    t = ka.listId;
                    ka = encodeURIComponent(JSON.stringify(ka));
                    window.location.hash = "!viewer" + (6E4 > ka.length ? "/" + ka : "");
                    preOverlayUrl = window.location.hash
                }
                GridHelperCategory.load(na).done(function() {
                    for (var P = 0; P < na.length; P++)
                        na[P] = GridHelper.prepareProduct(na[P]);
                    qa ? ra(na) : ea(na)
                }).fail(showErrorPopup)
            }
        } else
            ua()
    }, ea = function(na) {
        0 === na.length ? ($('[data-tool="column"]').hide(),
        $('[data-tool="update"]').hide()) : ($('[data-tool="column"]').show(),
        $('[data-tool="update"]').show());
        GridApi.setData(r, na)
    }, ra = function(na) {
        var qa = keepaTime.now()
          , ka = {}
          , za = []
          , J = []
          , g = !1;
        r.api.forEachNode(function(N) {
            N = N.data;
            var ba = N.domainId
              , q = N.asin
              , L = na.filter(function(O) {
                return O.asin == q && O.domainId == ba
            });
            if (L.length) {
                L = L[0];
                L.offersSuccessful || J.push(q);
                for (var A in L)
                    N[A] = L[A];
                za.push(N)
            }
            A = Math.floor((qa - N.stats.lastOffersUpdate) / 60);
            0 < A && (24 > A && (g = !0),
            N = ba + "#" + q,
            ka[A] ? ka[A].push(N) : ka[A] = [N])
        });
        r.context.asinYoungerThanMaxAgeFound = g;
        r.context.asinCountForUpdate = ka;
        GridHelper.addContextMenu(r);
        r.api.updateRowData({
            update: za
        });
        getBucketInformation();
        if (J.length) {
            var D = '<div style="width:400px;margin-bottom:10px;">The following products could not be updated at the moment - no quota was consumed for those.\n\t\t\t\t<br><br>' + J.join(", ") + "\n\t\t\t\t<br><br>Please try again at a later time.</div>\n\t\t\t";
            showPopPopup("Refresh products", D, !0)
        }
    }, pa = function(na, qa) {
        for (var ka = [], za = {
            $jscomp$loop$prop$domainId$367$733: 1
        }; za.$jscomp$loop$prop$domainId$367$733 < numberOfDomains; za = {
            $jscomp$loop$prop$domainId$367$733: za.$jscomp$loop$prop$domainId$367$733
        },
        za.$jscomp$loop$prop$domainId$367$733++)
            if (7 != za.$jscomp$loop$prop$domainId$367$733 && na[za.$jscomp$loop$prop$domainId$367$733] && na[za.$jscomp$loop$prop$domainId$367$733].length)
                for (var J = {}, g = $jscomp.makeIterator(na[za.$jscomp$loop$prop$domainId$367$733]), D = g.next(); !D.done; J = {
                    $jscomp$loop$prop$code$734: J.$jscomp$loop$prop$code$734
                },
                D = g.next())
                    J.$jscomp$loop$prop$code$734 = D.value,
                    D = !1,
                    (D = m ? qa.some(function(N, ba) {
                        return function(q) {
                            return q.domainId === N.$jscomp$loop$prop$domainId$367$733 && q.asin === ba.$jscomp$loop$prop$code$734
                        }
                    }(za, J)) : qa.some(function(N, ba) {
                        return function(q) {
                            var L = null == q.upcList ? [] : q.upcList
                              , A = null == q.eanList ? [] : q.eanList;
                            return q.domainId === N.$jscomp$loop$prop$domainId$367$733 && (-1 !== L.indexOf(ba.$jscomp$loop$prop$code$734) || -1 !== A.indexOf(ba.$jscomp$loop$prop$code$734))
                        }
                    }(za, J))) || ka.push(J.$jscomp$loop$prop$code$734);
        ka = Array.from(new Set(ka));
        ka.length && (na = '<div style="width:400px;margin-bottom:10px;">The following ' + ka.length + " " + (m ? " ASIN" : " UPC / EAN code") + (1 < ka.length ? "s" : "") + " did not return any result from our database:\n\t\t\t\t\t\t\t<br><br>" + ka.join(", ") + "\n\t\t\t\t\t\t\t<br><br></div>\n\t\t\t\t\t\t",
        showPopPopup("Search result", na, !0))
    }, ua = function() {
        ea([]);
        setTimeout(function() {
            V("No products found for the given input.")
        }, 100)
    };
    return {
        init: function() {
            return GridApi.load().then(function() {
                var na = 'Load <img src="' + flags[Number(storage.domain)] + '" /> <span style="font-weight:500;">Amazon.' + tld + "</span> Products";
                a = hasDataAccessSubscription ? 1E4 : GridConfig.maxRowsFreeUser;
                var qa = function(J) {
                    J = S(J);
                    var g = GridConfig.get(p.type);
                    g.gridOptions.pagination = !0;
                    g.gridOptions.paginationPageSize = 1E3;
                    hasDataAccessSubscription || (g.gridOptions.pagination = !1,
                    g.gridOptions.paginationPageSize = GridConfig.maxRowsFreeUser,
                    g.gridOptions.pinnedBottomRowData = [{
                        freeAccessRow: !0,
                        message: '<a href="' + rootURL + '#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + '>Subscribe now</a> to load up to 10000 rows and get full access to all <a href="' + rootURL + '#!data"' + (iframe.isIframe ? ' target="_blank"' : "") + ">Data features</a>."
                    }]);
                    g.pageId = p.pageId;
                    p.gridWrapperId = g.gridWrapperId;
                    var D = Date.now();
                    if ("undefined" === typeof storage.lastViewerVisit || null == storage.lastViewerVisit)
                        storage.lastViewerVisit = D,
                        storage.lastViewerVisitUpdate = D;
                    var N = Number(storage.lastViewerVisitUpdate);
                    36E5 < D - N && (storage.lastViewerVisit = N,
                    storage.lastViewerVisitUpdate = D);
                    GridPage.init(p);
                    GridPage.initGridContainer(g);
                    r = GridApi.init(g);
                    null !== r && (r.context.config = p,
                    !1 !== p.showTools && GridTools.init(r),
                    r.context.importListId = f,
                    r.context.includeInaccessibleAsins = n,
                    r.api.setSortModel(null),
                    E(J, !1))
                }
                  , ka = !1;
                if (null != lastSubUrl) {
                    var za = decodeURIComponent(lastSubUrl);
                    0 == za.indexOf("{") && (0 >= za.indexOf(t) && qa({
                        isAsin: !0,
                        input: za
                    }),
                    ka = !0)
                }
                ka || (ka = z(),
                replaceHtml("bodyPanel", '<div class="paper"><h6 class="mdc-typography--subtitle1">' + na + "</h6>" + ka.html + "</div>"),
                ka.onImport.done(qa));
                onPageNavigation.progress(function(J) {
                    "#!product" != J && (t = f = "",
                    n = !1)
                })
            }).fail(showErrorPopup)
        },
        initData: E,
        initImportPopup: V,
        initUpdatePopup: function() {
            var na = F()
              , qa = showPopup("Refresh Products", na.html, !0);
            na.onUpdate.done(function(ka) {
                qa.promise.resolve(ka)
            });
            qa.promise.done(function(ka) {
                H(ka.hours);
                qa.close()
            }).fail(function(ka) {})
        }
    }
}();
var docTitlePrefix = ""
  , lastUrlCache = ""
  , onPageNavigation = $.Deferred();
function loadPage(a) {
    if (overlayClosed)
        overlayClosed = !1;
    else {
        0 < $("#disqus_thread").length && ($commentsCache = $("#disqus_thread").detach());
        if ($("#productOverlay").is(":visible")) {
            if ($("#detailProductPage").remove(),
            $("#overlayShadow").hide(),
            $("#productOverlay").hide(),
            lastUrlCache === a)
                return
        } else if ("#!product" !== a || "#!track" !== a)
            lastUrlCache = a;
        setupQuotaWidget();
        sendHelloGraph();
        if ("#!widgets" === a)
            window.location.hash = "#!imageapi";
        else
            switch ($("#contentAlign").css({
                display: ""
            }),
            onPageNavigation.notify(a),
            onPageNavigation = $.Deferred(),
            a) {
            case "#!":
                generateStartPage();
                break;
            case "#!addon":
                generateAddon();
                break;
            case "#!android":
            case "#!app":
                generateApp();
                break;
            case "#!api":
                generatePriceDataAPI();
                break;
            case "#!bestseller":
                generateBestSeller();
                break;
            case "#!bot":
                generateApp();
                break;
            case "#!categorytree":
                generateCategoryTree();
                break;
            case "#!channels":
            case "#!settings":
                generateSettings();
                break;
            case "#!comment":
            case "#!community":
            case "#!discuss":
                generateDiscuss();
                break;
            case "#!data":
                generateData();
                break;
            case "#!deals":
                generateDeals();
                break;
            case "#!disclaimer":
                generateDisclaimer();
                break;
            case "#!faq":
                generateFAQ();
                break;
            case "#!features":
                generateFeatures();
                break;
            case "#!finder":
                generateFinder();
                break;
            case "#!imageapi":
                generateImageAPI();
                break;
            case "#!import":
                generateImport();
                break;
            case "#!manage":
                generateManage();
                break;
            case "#!news":
                generateNews();
                break;
            case "#!notification":
            case "#!notificationAPI":
                generateNotification();
                break;
            case "#!product":
                generateProduct();
                break;
            case "#!search":
                generateSearch();
                break;
            case "#!seller":
                generateSeller();
                break;
            case "#!topseller":
                generateTopSeller();
                break;
            case "#!tracking":
                generateTracking();
                break;
            case "#!viewer":
                generateViewer()
            }
    }
}
function callSubPage(a) {
    var b = window.location.hash.split("/");
    if ("" == b[0])
        $("#topPanel").show();
    else if (0 === a)
        switch (b[0]) {
        case "#!addon":
            generateAddon();
            break;
        case "#!android":
        case "#!app":
            generateApp();
            break;
        case "#!api":
            generatePriceDataAPI();
            break;
        case "#!bestseller":
            generateBestSeller();
            break;
        case "#!bot":
            generateApp();
            break;
        case "#!comment":
        case "#!community":
        case "#!discuss":
            updateDiscuss();
            break;
        case "#!categorytree":
            generateCategoryTree();
            break;
        case "#!channels":
        case "#!settings":
            SettingsPage.init();
            break;
        case "#!deals":
            dealWrapperInstance.get().init();
            break;
        case "#!disclaimer":
            generateDisclaimer();
            break;
        case "#!faq":
            generateFAQ();
            break;
        case "#!finder":
            generateFinder(!0);
            break;
        case "#!imageapi":
            generateImageAPI();
            break;
        case "#!import":
            generateImport();
            break;
        case "#!manage":
            manageUpdate(!1);
            break;
        case "#!product":
            productUpdate();
            break;
        case "#!search":
            searchUpdate();
            break;
        case "#!seller":
            generateSeller();
            break;
        case "#!topseller":
            generateTopSeller();
            break;
        case "#!viewer":
            generateViewer()
        }
    else
        switch (b[0]) {
        case "#!addon":
            generateAddon();
            break;
        case "#!android":
        case "#!app":
            generateApp();
            break;
        case "#!api":
            generatePriceDataAPI();
            break;
        case "#!bestseller":
            generateBestSeller();
            break;
        case "#!bot":
            generateApp();
            break;
        case "#!categorytree":
            generateCategoryTree();
            break;
        case "#!channels":
        case "#!settings":
            generateSettings();
            break;
        case "#!deals":
            generateDeals();
            break;
        case "#!disclaimer":
            generateDisclaimer();
            break;
        case "#!faq":
            generateFAQ();
            break;
        case "#!features":
            generateFeatures();
            break;
        case "#!finder":
            generateFinder();
            break;
        case "#!imageapi":
            generateImageAPI();
            break;
        case "#!manage":
            generateManage();
            break;
        case "#!product":
            generateProduct();
            break;
        case "#!search":
            generateSearch();
            break;
        case "#!seller":
            generateSeller();
            break;
        case "#!topseller":
            generateTopSeller();
            break;
        case "#!viewer":
            generateViewer()
        }
}
var contentAlignCss = {
    marginTop: "160px",
    minWidth: "650px",
    maxWidth: "850px",
    marginRight: "5%",
    marginLeft: "5%",
    position: "relative"
};
function insertPage(a) {
    replaceHtml("bodyPanel", a);
    a = $("bodyPanel");
    a.attr("style", "");
    a.hide();
    $("#contentAlign").css(contentAlignCss);
    a.show()
}
function tabSwitcher(a) {
    var b = new mdc.tabs.MDCTabBar(document.querySelector("#" + (a ? a : "icon-text-tab-bar")))
      , d = document.querySelector(".panels");
    b.preventDefaultOnClick = !0;
    b.updatePanel = function(h) {
        if (!isNaN(h)) {
            var m = d.querySelector(".panel.active");
            m && m.classList.remove("active");
            (h = d.querySelector(".panel:nth-child(" + (Number(h) + 1) + ")")) && h.classList.add("active")
        }
    }
    ;
    b.listen("MDCTabBar:change", function(h) {
        b.updatePanel(h.detail.activeTabIndex)
    });
    return b
}
PageLayoutGrid = function() {
    var a = function(h) {
        if (h.matches) {
            $("#subPanel").css({
                "margin-top": "40px"
            });
            h = '\t\t\t\n\t\t\t<aside class="mdc-drawer mdc-drawer--temporary mdc-typography drawer drawer--menu">\n\t\t\t\t<nav class="mdc-drawer__drawer">\n\t\t\t\t\t<div class="mdc-drawer__toolbar-spacer"></div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<nav class="mdc-drawer__content mdc-list">\n\t\t\t\t\t\t<a class="mdc-list-item" href="#!deals">\n\t\t\t\t\t\t\t<i class="fa fa-fw fa-shopping-bag mdc-list-item__graphic"></i>' + la._12 + '\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<a class="mdc-list-item list-item--tracking" href="#!tracking">\n\t\t\t\t\t\t\t<i class="fa fa-fw fa-bell-o mdc-list-item__graphic"></i>' + la._13 + '\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<a class="mdc-list-item list-item--tracking-sub ' + ("#!tracking" === lastUrl ? "" : "list-item--hidden") + '" href="#!manage">&raquo; ' + la._20 + '</a>\n\t\t\t\t\t\t<a class="mdc-list-item list-item--tracking-sub ' + ("#!tracking" === lastUrl ? "" : "list-item--hidden") + '" href="#!import">&raquo; ' + la._22 + '</a>\n\t\t\t\t\t\t<a class="mdc-list-item list-item--tracking-sub ' + ("#!tracking" === lastUrl ? "" : "list-item--hidden") + '" href="#!notification">&raquo; ' + la._412 + "</a>\n\t\t\t\t\t\t" + (storage.hasAPI && 1 == storage.hasAPI ? '<a class="mdc-list-item list-item--tracking-sub ' + ("#!tracking" === lastUrl ? "" : "list-item--hidden") + '" href="#!notificationAPI">&raquo; API ' + la._412 + "</a>" : "") + '\t\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t<a class="mdc-list-item" href="#!addon">\n\t\t\t\t\t\t\t<i class="fa fa-fw fa-cloud-download mdc-list-item__graphic"></i>' + la._14 + "\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t" + (7 != Number(storage.domain) ? '\n\t\t\t\t\t\t<a class="mdc-list-item" href="#!data">\n\t\t\t\t\t\t\t<i class="fa fa-fw fa-cube mdc-list-item__graphic"></i>Data\n\t\t\t\t\t\t</a>' : "") + '\n\t\t\t\t\t\t<a class="mdc-list-item" href="#!features">\n\t\t\t\t\t\t\t<i class="fa fa-fw fa-info mdc-list-item__graphic"></i>' + la._15 + '\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<a class="mdc-list-item" href="#!discuss">\n\t\t\t\t\t\t\t<i class="fa fa-fw fa-comments mdc-list-item__graphic"></i>' + la._24 + '\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<span role="separator" class="mdc-list-divider"></span>\n\t\t\t\t\t\t<a class="mdc-list-item" href="#!search">\n\t\t\t\t\t\t\t<i class="fa fa-fw fa-search mdc-list-item__graphic"></i>' + la._19 + "\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</nav>\n\t\t\t\t</nav>\n\t\t\t</aside>\n\t\t";
            $("#content").before(h);
            var m = new mdc.drawer.MDCTemporaryDrawer(document.querySelector(".mdc-drawer--temporary"));
            $("#logo").on("click.drawer", function() {
                m.open = !m.open
            });
            h = $("#logo a");
            h.before('<i class="fa fa-bars fa-2x"></i>');
            h.hide()
        } else
            d()
    };
    initBodyPanel = function(h) {
        replaceHtml("bodyPanel", h);
        $("bodyPanel").attr("style", "")
    }
    ;
    var b = function(h) {
        insertPage("");
        document.querySelector('meta[name="viewport"]').content = "";
        $("#content").removeAttr("class");
        $("#contentAlign").removeAttr("class");
        $("#bodyPanel").removeClass("mdc-layout-grid__inner content--" + h);
        d();
        $("#searchBarForm").off("submit.onLayoutGrid")
    }
      , d = function() {
        $("body").removeAttr("class");
        $(".drawer--menu").remove();
        $("#logo").off("click.drawer");
        $("#logo i.fa").remove();
        $("#logo a").show();
        "#!tracking" === lastUrl && $("#subPanel").css({
            "margin-top": "80px"
        })
    };
    return {
        init: function(h) {
            document.querySelector('meta[name="viewport"]').content = "width=device-width, initial-scale=1.0";
            $("#content").addClass("-grid");
            var m = window.matchMedia("(max-width: 600px)");
            a(m);
            m.addListener(a);
            m = $("#contentAlign");
            m.removeAttr("style");
            m.addClass("mdc-layout-grid container");
            $("#bodyPanel").addClass("mdc-layout-grid__inner content--" + h);
            onPageNavigation.progress(function() {
                b(h)
            });
            $("#searchBarForm").on("submit.onLayoutGrid", function() {
                b(h)
            })
        },
        initBodyPanel: initBodyPanel
    }
}();
function generateIndex() {
    try {
        storage.getItem("token")
    } catch (b) {
        reportBug(b, "No localStorage"),
        alert("Keepa.com works best in modern browsers. Please update your browser. [Error: No localStorage access possible. If your browser is up to date, please check your browser settings to allow localStorage access.]")
    }
    var a = '<div id="productOverlay" class="hidden">\n\t<div id="productOverlay-close" title="' + la._193 + '"><i class="fa fa-times-circle fa-2x"></i></div>\n</div>\n<div id="overlayShadow" class="hidden"></div>\n' + getLoginForm() + '\n<div id="topPanel" class="flex topPanel unselectable">\n\t<div id="logo" class="flex"><a href="#!" style="cursor: default;">' + logosvg + '</a></div>\n\t<ul id="topMenu" class="flex">\n\t\t<li>\n\t\t\t<a href="#!deals"><i id="menuDeals" class="fa fa-shopping-bag"></i><span>' + la._12 + '</span></a>\n\t\t<li>\n\t\t\t<a href="#!tracking"><i id="menuTrack" class="fa fa-bell-o"></i><span>' + la._13 + '</span></a>\n\t\t<li>\n\t\t\t<a href="#!addon"><i id="menuApps" class="fa fa-cloud-download"></i><span>' + la._14 + "</span></a>\n\t\t" + (7 != storage.domain ? '<li><a href="#!data"><i id="menuData" class="fa fa-cube"></i><span>Data</span></a>' : "") + '\n\t\t<li>\n\t\t\t<a href="#!features"><i id="menuInfo" class="fa fa-info"></i><span>' + la._15 + '</span></a>\n\t\t<li>\n\t\t\t<a href="#!discuss"><i id="menuChat" class="fa fa-comments"></i><span>' + la._24 + '</span></a>\n\t\t<li style="display:none">\n\t\t\t<a href="#!product"></a><a href="#!"></a><a href="#!track"></a>\n\t\t\t<a href="#!channels"></a>\n\t\t<li>\n\t\t\t<a id="showSearchBar" href="javascript:void(0)"><i id="menuSearch" class="fa fa-search"></i><span>' + la._19 + '</span></a>\n\t</ul>\n\t<div class="flexClass flex"></div>\n\t<div id="panelLanguage" class="flex">\n\t\t<div>\n\t\t\t<div id="currentLanguage"></div>\n\t\t\t<div class="keepa" id="languageOverlay" style="display:none">\n\t\t\t\t<div>\n\t\t' + la._158 + ':\n\t\t</div>\n\t\t<div id="language_language" class="flex" style="justify-content: space-around;-webkit-justify-content: space-around;">\n\t\t<span>\n\t\t<img id="lang_en" src="' + englishFlagLarge + '" rel="language" setting="1"/>\n\t\t</span>\n\t\t<span>\n\t\t<img id="lang_de" src="' + flag_3l + '" rel="language" setting="3"/>\n\t\t</span>\n\t\t<span>\n\t\t<img id="lang_fr" src="' + flag_4l + '" rel="language" setting="4"/>\n\t\t</span>\n\t\t<span>\n\t\t<img id="lang_jp" src="' + flag_5l + '" rel="language" setting="5"/>\n\t\t</span>\n\t\t<span>\n\t\t<img id="lang_cn" src="' + flag_7l + '" rel="language" setting="7"/>\n\t\t</span>\n\t\t<span>\n\t\t<img id="lang_it" src="' + flag_8l + '" rel="language" setting="8"/>\n\t\t</span>\n\t\t<span>\n\t\t<img id="lang_es" src="' + flag_9l + '" rel="language" setting="9"/>\n\t\t</span>\n\t\t</div>\n\t\t<div>\n\t\t<span colspan="3" style="line-height: 12px;  padding: 6px 0;white-space: break-spaces;">\n\t\t<br><br>' + la._157 + ':\n\t\t</span>\n\t\t</div>\n\t\t<div id="language_domains">\n\t\t<label>' + la._352 + '</label><div><span rel="domain" setting="1">.com</span><span rel="domain" setting="6">.ca</span><span rel="domain" setting="11">.mx</span><span rel="domain" setting="12">.br</span></div>\n\t\t<label>' + la._353 + '</label><div><span rel="domain" setting="2">.uk</span><span rel="domain" setting="3">.de</span><span rel="domain" setting="4">.fr</span><span rel="domain" setting="8">.it</span><span rel="domain" setting="9">.es</span></div>\n\t\t<label>' + la._354 + '</label><div><span rel="domain" setting="5">.jp</span><span rel="domain" setting="10">.in</span></div>\n\x3c!--\t\t<label>' + la._663 + '</label><div><span rel="domain" setting="13">.au</span></div>--\x3e\n\t\t</div>\n\t\t<div style="text-align:center;">\n\t\t\t<span class="switch__currency" colspan="3">\n\t\t\t<br>Currency Settings&ensp;<i class="fa fa-wrench"></i>\n\t\t\t</span>\n\t\t</div>\n\t\t</div>\n\t\t</div>\n\t\t</div>\n\t\t<div id="panelUser" class="flex">\n\t\t<div style=" padding-right: 25px;margin-left: auto;">\n\t\t<div id="userMenuPanel">\n\t\t<span id="panelUserRegisterLogin" style="display:none">' + la._9 + '</span>\n\t\t<div id="panelUserMenu" style="display:none; text-align: right">\n\t\t<span style="margin-right: 4px">\n\t\t<i class="fa fa-user"></i>\n\t\t</span>\n\t\t<span id="panelUsername">' + la._43 + '\n\t\t</span><i class="fa fa-fw fa-caret-down"></i>\n\t\t</div>\n\t\t</div>\n\t\t<span id="userMenuOverlay"></span>\n\t\t</div>\n\t\t</div>\n\t\t</div>\n\t\t<div id="subPanel" class="subPanel unselectable">\n\t\t<span id="searchBar" style="display: none">\n\t\t<form id="searchBarForm" method="post">\n\t\t<input type="text" rel="search" class="ui-autocomplete-input" autocomplete="off" maxlength="200" name="search" id="searchInput" placeholder="' + la._159 + '"/>\n\t\t<i id="submitSearch" class="fa fa-search"></i></form></span>\n\t\t<ul class="subMenu" rel="#!tracking">\n\t\t<li>\n\t\t<a href="#!manage"><span>' + la._20 + '</span></a>\n\t\t</li>\n\t\t<li>\n\t\t<a href="#!import"><span>' + la._22 + '</span></a>\n\t\t</li><li><a href="#!notification"><span>' + la._412 + "</span></a></li>" + (storage.hasAPI && 1 == storage.hasAPI ? '<li><a href="#!notificationAPI"><span>API ' + la._412 + "</span></a></li>" : "") + '</ul>\n\t\t<ul class="subMenu" rel="#!addon">\n\t\t<li>\n\t\t<a href="#!addon"><span>' + la._32 + '</span></a>\n\t\t</li>\n\t\t<li>\n\t\t<a href="#!app"><span>' + la._35 + '</span></a>\n\t\t</li>\n\t\t\x3c!--<li>--\x3e\n\t\t\x3c!--<a href="#!imageapi"><span>' + la._294 + '</span></a>--\x3e\n\t\t\x3c!--</li>--\x3e\n\t\t<li class="menuDataAPI">\n\t\t<a href="#!api"><span>Keepa API</span></a>\n\t\t</li>\n\t\t</ul>\n\t\t</ul>\n\t\t<ul class="subMenu" rel="#!data">\n\t\t<li>\n\t\t\t<a href="#!finder"><span>Product Finder</span></a>\n\t\t</li>\n\t\t<li>\n\t\t\t<a href="#!viewer"><span>Product Viewer</span></a>\n\t\t</li>\t\n\t\t<li>\n\t\t\t<a href="#!bestseller"><span>Product Best Sellers</span></a>\n\t\t</li>\n\t\t<li>\n\t\t<a href="#!topseller"><span>Top Seller List</span></a>\n\t\t</li>\n\t\t<li>\n\t\t<a href="#!categorytree"><span>Category Tree</span></a>\n\t\t</li>\n\t\t<li class="menuDataAPI">\n\t\t<a href="#!api"><span>Keepa API</span></a>\n\t\t</li>\n\t\t</ul>\n\t\t</ul>\n\t\t<ul class="subMenu" rel="#!features">\n\t\t<li>\n\t\t<a href="#!features"><span>' + la._23 + '</span></a>\n\t\t</li>\n\t\t<li>\n\t\t<a href="#!faq"><span>FAQ</span></a>\n\t\t</li>\n\t\t<li>\n\t\t<a href="#!news"><span>' + la._25 + '</span></a>\n\t\t</li>\n\t\t<li>\n\t\t<a href="#!disclaimer"><span>' + la._26 + "</span></a>\n\t\t</li>\n\t\t</ul>\n\t\t</div>\n\t\t" + (isNewPage ? '<div id="leftPanel"></div>' : "") + '\n\t\t<div id="contentAlign" style="margin-top: 220px; width: 95%; margin-right: 5%; margin-left: 5%;">\n\t\t<div id="bodyPanel" class="content"></div>\n\t\t</div>';
    replaceHtmlEl($("#content")[0], a);
    isMobile && ($("#topPanel").css("position", "absolute"),
    $("#subPanel").css("position", "absolute"))
}
function generateStartPage() {
    "" !== window.location.hash && StartPage.init()
}
function generateDeals() {
    document.title = docTitlePrefix + la._16;
    var a = '<div id="dealsNotice" class="hidden" style="font-size:12px;position:absolute;"><aside style="margin-left: 50px;"><span id="betaNotice"></span></aside></div>\n\t\t<div class="filterContainer unselectable"><div style="text-align: right; width: 90%; minWidth: 740px; margin: auto; position: relative;"><input style="width: 200px;" maxlength="28" id="dealCategorySearchBar" placeholder="' + (la._534 + '"><span style="right: 3px;" id="submitDealCategorySearch"></span></div>\n\t\t<div id="filterBar" class="filterBar lightShadow"><div id="categorySearchResults"></div><div id="filterBarContent">\n\t\t') + (isNewPage ? "" : '<div class="filterFlex flex">\x3c!-- Merchant Select --\x3e<div id="multiSelectMerchant" class="multiSelect flex merchant"><ul><li id="amazon" class="selected"><a href="#!deals/amazon-day-m" class="button">Amazon</a></li><li id="new"><a href="#!deals/new-day-m" class="button">' + la._148 + '</a></li><li id="used"><a href="#!deals/used-day-m" class="button">' + la._149 + '</a></li></ul></div>\x3c!-- Interval Select --\x3e<div id="multiSelectInterval" class="multiSelect flex interval"><ul><li id="day" class="selected"><a href="#!deals/amazon-day-m" class="button">' + la._155 + '</a></li><li id="week"><a href="#!deals/amazon-week-m" class="button">' + la._137 + '</a></li><li id="month"><a href="#!deals/amazon-month-m" class="button">' + la._139 + '</a></li></ul></div>\x3c!-- Vertical Line --\x3e<div class="verticalLine"></div>\x3c!-- Size Select --\x3e<div id="multiSelectSize" class="multiSelect flex size"><ul><li id="s"><a href="#!deals/amazon-day-s" class="button">S</a></li><li id="m" class="selected"><a href="#!deals/amazon-day-m" class="button">M</a></li><li id="l"><a href="#!deals/amazon-day-l" class="button">L</a></li></ul></div></div>') + '\n\t\t<div id="filterCats">\n\t\t</div>\n\t\t<div id="removedCats">\n\t\t</div>\n\t\t</div></div></div>\n\t\t</div><div style="font-size:12px;color:#999;padding-left:36px;" id="dealsTitleSearchResults"></div>\n\t\t<div id="productPage0" class="productPage' + (showReferencePrice(Number(storage.domain)) ? " with-reference" : "") + '">\n\t\t</div><div id="loadingIcon"></div><div class="button" id="submitDealQuery">Find Deals!</div></div>\n\t';
    insertPage(a);
    dealWrapperInstance.get().addSaveSlots();
    dealWrapperInstance.get().init();
    $("#contentAlign").css({
        "minWidth:": "",
        maxWidth: "",
        width: "auto",
        marginRight: "5px",
        marginLeft: "180px"
    })
}
var TrackingPage = function() {
    var a = function() {
        var b = 1
          , d = function(h, m, t, f) {
            return '<li class="mdc-list-item" data-link="' + h + '" tabIndex="' + b++ + '">\n                <span class="mdc-list-item__ripple"></span>\n                <i class="fa fa-fw ' + f + ' mdc-list-item__graphic"></i>\n                <span class="mdc-list-item__text">\n                    <span class="mdc-list-item__primary-text">' + m + '</span>\n                    <span class="mdc-list-item__secondary-text">' + t + "</span>\n                </span>\n            </li>"
        };
        d = '\n                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6 mdc-elevation--z3 block block--elevated">\n                    <h6 class="mdc-typography--headline6">' + la._944 + '</h6>\n                   \n                    <ul class="mdc-list mdc-list--variable-line">\n                        ' + d("search", la._19, la._946, "fa-search") + "\n                        " + d("deals", la._12, la._33, "fa-shopping-bag") + "</a>\n                        " + d("addon", "Amazon " + la._32, la._32_2, "fa-cloud-download") + '\n                    </ul>\n                </div>\n                \n                \n                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6 mdc-elevation--z3 block block--elevated">\n                    <h6 class="mdc-typography--headline6">' + la._945 + '</h6>\n                    <ul class="mdc-list mdc-list--variable-line">\n                        ' + d("manage", la._20, la._153, "fa fa-bell") + "\n                        " + d("notification", la._412, la._519, "fa-bell-o") + "\n                        " + d("import", la._22, la._184, "fa-upload") + "\n                    </ul>\n                </div>\n            ";
        PageLayoutGrid.initBodyPanel(d);
        $("[data-link]").on("click", function() {
            window.location.hash = "#!" + $(this).data("link")
        })
    };
    return {
        init: function() {
            PageLayoutGrid.init("tracking");
            document.title = docTitlePrefix + la._13;
            a()
        }
    }
}();
function generateTracking() {
    TrackingPage.init()
}
function generateManage() {
    "undefined" === typeof storage.manageGrid && (storage.manageGrid = !0,
    settings.send());
    var a = "false" !== storage.manageGrid;
    setupManageSwitcher(a);
    a ? GridManage.init() : (document.title = docTitlePrefix + la._20,
    a = '<div id="managePage" style="min-width: 880px;margin-right:25px;display:none;"><div class="flex" style="width: 100%;text-align: right; flex-wrap:wrap;flex-direction: row-reverse;justify-content: space-between;align-items: self-end;"><section id="filter" class="lightShadow" style="display:none;"><h1 id="filterSortView" class="subHeadline hRed">' + la._19 + "&ensp;&#x271C;&ensp;" + la._178 + "&ensp;&#x271C;&ensp;" + la._177 + "&ensp;&#x271C;&ensp;" + la._387 + "&ensp;&#x271C;&ensp;" + la._179 + '</h1><h1 class="subsubHeadline">' + la._19 + '</h1><div id="trackingSearch" rel="search"><input maxlength="18" class="trackSearch" id="trackSearchBar"><br><div style="height: 20px; width: 230px;text-align: right;"><span id="trackingSearchNone" style="color: tomato; display:none;">nothing found</span><span id="trackingSearchFeedback" class="settings-chpw" style="display:none;"></span></div></div><h1 class="subsubHeadline"><i class="fa fa-sort"></i><span>' + la._180 + '</span></h1><div id="sortList" rel="sort"></div><div id="showFilter">' + la._181 + '</div><div style="display:none"><h1 class="subsubHeadline"><i class="fa fa-filter"></i><span>' + la._182 + '</span><span id="manageShowall"></span></h1><ul id="filterList" rel="filter"></ul><h1 class="subsubHeadline"><i class="fa fa-tasks"></i><span>' + la._378 + '</span></h1><div id="operationsList" rel="operations"></div><h1 class="subsubHeadline"><i class="fa fa-cog"></i><span>' + la._183 + '</span></h1><div id="defaultList" rel="default"></div></div></section></div><a id="manage-rss"></a><table style="width: 100%;" class="shadow"><tbody id="manage-productList" ></tbody></table></div><div id="loadingIcon" style="text-align:center;clear: both;"></div><div class="unselectable" style="line-height:50px;">&nbsp;</div>',
    $("#loadingIcon").show(),
    insertPage(a),
    manage())
}
function setupManageSwitcher(a) {
    $("#manage-switcher").length && $("#manage-switcher").remove();
    onPageNavigation.progress(function(d) {
        $("#manage-switcher").length && $("#manage-switcher").remove()
    });
    if (!a && 0 != storage.accountType) {
        var b = '<div id="manage-switcher" class="mdc-typography--body2">';
        b = a ? b + ('<div><i class="fa fa-info-circle"></i>&emsp;' + la._689 + '</div>\n\t\t\t<div><i class="fa fa-bug"></i>&emsp;' + la._690 + "</div>\n\t\t\t<div><i class=\"fa fa-hand-o-left\"></i>&emsp;<span id='switch-manage'>" + la._691 + "</span></div>") : b + ('<div><i class="fa fa-info-circle"></i>&emsp;' + la._688 + '&emsp;<i class="fa fa-info-circle"></i></div>');
        b += "</div>";
        $("#subPanel").after(b);
        $("#switch-manage").on("click", function() {
            storage.manageGrid = !a;
            settings.send();
            generateManage()
        })
    }
}
function generateImport() {
    document.title = docTitlePrefix + la._22;
    insertPage('<h1 class="headline hRed">' + la._184 + '</h1><span class="paper"><div id="settingsBox"></div></span>');
    $("#contentAlign").css({
        minWidth: "650px",
        maxWidth: "850px",
        marginRight: "5%",
        marginLeft: "5%",
        position: "relative"
    });
    importWish()
}
function generateNotification() {
    var a = "#!notificationAPI" == document.location.hash;
    document.title = docTitlePrefix + (a ? "API" : "") + la._412;
    insertPage('<h1 class="headline hRed">' + la._519 + '</h1>\n\t\t<span class="paper">\n\t\t\t<div id="notificationContent">\n\t\t\t\t<div id="loadingIcon" style="text-align: center; clear: both;"></div>\n\t\t\t</div>\n\t\t</span>');
    $("#contentAlign").css({
        minWidth: "650px",
        maxWidth: "",
        marginRight: "40px",
        marginLeft: "40px",
        position: "relative"
    });
    network.request({
        path: "user/notification",
        type: "website",
        isAPI: a,
        sinceCreateDate: 0,
        version: 3
    }).done(function(b) {
        b = b.notifications;
        var d = "";
        if (null != b && 0 < b.length) {
            try {
                var h = JSON.parse(get("showGraphs"))
            } catch (aa) {
                h = graph.getDefaultShowGraphSetting(),
                reportBug(aa, get("showGraphs") + " " + aa)
            }
            for (var m = 0; m < b.length; m++) {
                var t = b[m]
                  , f = CsvType.getObjectName(t.csvType)
                  , n = CsvType[f].currency
                  , r = t.image && 0 < t.image.length ? imageServer + t.image.replace(".", "._SS100_.") : imgCDNUrl + "no-photo-available.png"
                  , p = getAmazonRedirectByDomain(t.notificationDomainId, t.asin)
                  , z = void 0
                  , F = "";
                try {
                    var I = JSON.parse(t.metaData);
                    z = I.tags && I.tags.length ? I.tags.join(", ") : "";
                    F = I.memo ? I.memo : ""
                } catch (aa) {}
                var E = "";
                if (["AMAZON", "NEW", "USED", "SALES"].includes(f)) {
                    E = Number("SALES" === f);
                    var K = Number("AMAZON" === f || h[CsvType.AMAZON.index] && !E)
                      , H = Number("NEW" === f || h[CsvType.NEW.index] && !E)
                      , V = Number("USED" === f || h[CsvType.USED.index] && !E)
                      , S = GraphService.getWebGraphTypeAllOff();
                    S[CsvType.AMAZON.index] = K;
                    S[CsvType.NEW.index] = H;
                    S[CsvType.USED.index] = V;
                    S[CsvType.SALES.index] = E;
                    E = '<div class="notification__item-graph" style="background-image: url(' + GraphService.getUrl(t.asin, t.notificationDomainId, 800, 150, S, 90) + ');"></div>'
                }
                H = "";
                K = '<i class="fa fa-circle" style="color:' + CsvType.getObject(t.csvType).color + ';"></i>';
                n ? (null != t.currentPrices && (f = Money.format(t.currentPrices[t.csvType], {
                    sourceDomainId: t.notificationDomainId,
                    targetDomainId: t.notificationDomainId
                }),
                H = la._522 + ":&emsp;<span>" + K + " " + CsvType.getName(t.csvType) + "</span>\n\t\t\t\t\t\t\t\t<span> (" + la._531 + ": " + (-1 == t.currentPrices[t.csvType] ? la._134 : f) + ")</span>"),
                f = la._523 + ":&emsp;<span>" + NotificationCause.getName(t.trackingNotificationCause) + "</span>") : (null != t.currentPrices && (f = CsvType.format(f, t.currentPrices[t.csvType], t.notificationDomainId),
                H = la._862 + ":&emsp;<span>" + K + " " + CsvType.getName(t.csvType) + "</span>\n\t\t\t\t\t\t\t\t<span> (" + la._863 + ": " + (-1 == t.currentPrices[t.csvType] ? la._134 : f) + ")</span>"),
                f = la._523 + ":&emsp;<span>" + NotificationCause.getName(t.trackingNotificationCause, !1) + "</span>");
                d += '<div class="notification__item flex">\n\t\t\t\t\t\t<div class="notification__item-image"><img src="' + r + '"></div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class="manage-productTitle"><a href="#!product/' + t.notificationDomainId + "-" + t.asin + '">' + t.title + "</a></div>\n\t\t\t\t\t\t\t<div>" + la._520 + ":&emsp;<span>" + (new Date(6E4 * (t.createDate + offsetMinutes))).formatDate("M j, Y H:i") + "</span><span> (" + prettyDate(Date.now() / 6E4 - (t.createDate + offsetMinutes)) + ")</span></div>\n\t\t\t\t\t\t\t<div>" + la._521 + ':&emsp;<a href="' + p + '" title="' + la._99 + ' Amazon" target="_blank" class="external">Amazon.' + getTldByDomain(t.notificationDomainId) + '&emsp;<i class="fa fa-external-link"></i></a></div>\n\t\t\t\t\t\t\t' + (null == t.currentPrices ? "" : "<div>" + H + "</div>") + "\n\t\t\t\t\t\t\t<div>" + f + "</div>\n\t\t\t\t\t\t\t" + (F ? "<div>" + la._808 + ":&emsp;<span>" + F + "</span></div>" : "") + "\n\t\t\t\t\t\t\t" + (z ? "<div>" + la._807 + ":&emsp;<span>" + z + "</span></div>" : "") + "\n\t\t\t\t\t\t\t<div>" + la._524 + ":&emsp;<span>" + (null == t.sentNotificationVia ? "not notified" : NotificationType.getNotifiedViaText(t.sentNotificationVia)) + "</span></div>\n\t\t\t\t\t\t\t" + E + "\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>"
            }
        } else
            d = '<p class="mdc-typography--body2">' + la._947 + "</p>";
        replaceHtml("notificationContent", '<div id="notificationsBox">\n\t\t\t\t\t' + d + "\n\t\t\t\t</div>")
    }).fail(function() {
        replaceHtml("notificationContent", "<div>" + la._error + "</div>")
    })
}
function generateAddon() {
    document.title = docTitlePrefix + la._32;
    var a = "233639719";
    3 == storage.language && (a = "233639692");
    insertPage('<div class="block block--elevated block--mdc-typography block--no-margin-collapse mdc-elevation--z3">\n\t\t\t<h3 class="mdc-typography--subtitle1">' + la._32 + '</h3>\n\t\t\t<p class="mdc-typography--body2">' + la._290 + '</p>\n\t\t\t<div id="browserAddons" style="text-align: center">\n\t\t\t\t<a href="https://addons.mozilla.org/firefox/addon/keepa/" title="Goto Mozilla Add-ons"><img src="' + imgCDNUrl + 'firefox_128x128.png" style="height: 64px; width: 64px;" /></a>&emsp;&emsp;\n\t\t\t\t<a href="https://chrome.google.com/webstore/detail/neebplgakaahbhdphmkckjjcegoiijjo" title="Goto Chrome Web Store"><img src="' + imgCDNUrl + 'chrome_128x128.png" style="height: 64px; width: 64px;" /></a>&emsp;&emsp;\n\t\t\t\t<a id="opera" href="#!" title="Our Chrome extension is compatible with Opera"><img src="' + imgCDNUrl + 'opera_128x128.png" style="height: 64px; width: 64px;" /></a>&emsp;&emsp;\n\t\t\t\t<a href="https://microsoftedge.microsoft.com/addons/detail/ejefaeioamebhekmfaclajddbpnnobje" title="Install on Edge for Windows 10"><img src="' + imgCDNUrl + 'edgechromium_128x128.png" style="height: 64px; width: 64px;" /></a>&emsp;&emsp;\n\t\t\t\t<a href="https://apps.apple.com/us/app/id1533805339" title="Install on Safari 14"><img src="' + imgCDNUrl + 'safari_128x128.png" style="height: 64px; width: 64px;" /></a>&emsp;&emsp;\n\t\t\t</div>\n\t\t\t<p class="mdc-typography--body2">' + la._291 + '</p>\n\t\t\t<div style="padding: 16px 0;">\n\t\t\t\t<iframe src="https://player.vimeo.com/video/' + a + '" width="818" height="460" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>\n\t\t\t</div>\n\t\t</div>');
    $("#browserAddons").children().each(function(b, d) {
        return $(d).colorTip({
            color: "black"
        })
    });
    $("#opera").on("click", function(b) {
        showPopup("How to use Keepa in Opera", 'Our extension is not available on the Opera add-ons website. How to get it: <br><br>1. Install the <a target="_blank" href="https://addons.opera.com/en/extensions/details/download-chrome-extension-9/?display=en">Download Chrome Extension</a> add-on<br>2. Install our <a target="_blank" href="https://chrome.google.com/webstore/detail/neebplgakaahbhdphmkckjjcegoiijjo">Chrome extension</a>', !0);
        return !1
    })
}
function generateApp() {
    document.title = docTitlePrefix + " " + la._35;
    var a = getAppLinksAndBadges();
    insertPage('<div class="block block--elevated block--mdc-typography block--no-margin-collapse mdc-elevation--z3">\n\t\t\t<h3 class="mdc-typography--subtitle1">' + la._35 + '</h3>\n\t\t\t<p class="mdc-typography--body2">' + la._36 + '</p>\n\t\t\t<div class="app-store-icons">\n\t\t\t\t<a class="app-store--android" href="' + a.linkGooglePlay + '" target="_blank">' + a.badgeGooglePlay + '</a>\n\t\t\t\t<a class="app-store--ios" href="' + a.linkAppStore + '" target="_blank">' + a.badgeAppStore + '</a>\n\t\t\t</div>\n\t\t\t<p class="mdc-typography--body2">&rarr; ' + la._929 + ' &larr;</p>\n\t\t\t<p class="mdc-typography--body2">' + la._930 + '</p>\n\t\t\t<p class="mdc-typography--body2">\n\t\t\t\t\u271c\u2003' + la._931 + "<br>\n\t\t\t\t\u271c\u2003" + la._934 + "<br>\n\t\t\t\t\u271c\u2003" + la._932 + "<br>\n\t\t\t\t\u271c\u2003" + la._933 + "<br>\n\t\t\t\t\u271c\u2003" + la._935 + '\n\t\t\t</p>\n\t\t\t<div class="app-store-screens">\n\t\t\t\t<img alt="Product overview" src="' + imgCDNUrl + 'app-store/en-product-overview.png" /> \n\t\t\t\t<img alt="Search" src="' + imgCDNUrl + 'app-store/en-search.png" /> \n\t\t\t\t<img alt="Product details" src="' + imgCDNUrl + 'app-store/en-product-details.png" /> \n\t\t\t\t<img alt="Product current prices and averages" src="' + imgCDNUrl + 'app-store/en-product-stats.png" /> \n\t\t\t\t<img alt="Dashboard" src="' + imgCDNUrl + 'app-store/en-dashboard.png" /> \n\t\t\t\t<img alt="Push notification" src="' + imgCDNUrl + 'app-store/en-push.png" /> \n\t\t\t</div>\n\t\t</div>');
    isMobile || $(".app-store-screens img").each(function(b, d) {
        ProductImageHover.preview.add_events(d, d.src)
    })
}
function generateImageAPI() {
    document.title = docTitlePrefix + la._294;
    var a = GraphService.getShareUrl(" B001GZ6QEC B001CEE1WG B001G73S50 B001DJF26E B003GQSYCG B001HBAPC4 B00CMMTVJ0 B0041KW5W6 B0053CAB9A B00CSS90ZI B00KWF366S".split(" ")[storage.domain], getDomainByTld(tld));
    insertPage('<div class="block block--mdc-typography paper appsContent">\n\t\t\t<h3 class="mdc-typography--subtitle1">Image API</h3>\n\t\t\t<p class="mdc-typography--body2">' + la._295 + '</p>\n\t\t\t<p class="mdc-typography--body2 mdc-typography--bold">\n\t\t\t\t' + la._902 + '\n\t\t\t</p>\n\t\t\t<ul class="mdc-typography--body2 mdc-typography--bold">\n\t\t\t\t<li>' + la._903 + "</li>\n\t\t\t\t<li>" + la._904 + "</li>\n\t\t\t\t<li>" + la._905 + '</li>\n\t\t\t</ul>\n\t\t\t<p class="mdc-typography--body2">' + la._296 + '</p>\n\t\t\t<div style="text-align: center;">\n\t\t\t\t<img id="priceChartImageExample" src="' + a + '" />\n\t\t\t</div>\n\t\t\t<p class="mdc-typography--body2">' + la._298 + '</p>\n\t\t\t<input class="selectable" id="shareChartInput" style="display: inline-block; margin-bottom: 20px;" type="text" rel="site" autocomplete="off" class="site" role="textbox" readonly="readonly">\n\t\t\t<p class="mdc-typography--body2">' + la._299 + '</p>\n\t\t\t<hr style="border-color:mediumSeaGreen !important">\n\t\t<p class="mdc-typography--body2">' + (la._300 + '</p>\n\t\t<table id="explanationTable" style="font-size: 12px; width: 710px; margin: 10px 0 0 25px">\n\t\t\t<tr>\n\t\t\t\t<td colspan="2"><span class="chartUrlPart" style="color:#009000">' + la._301 + '</span></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td style="width: 60px;"><i>asin</i></td>\n\t\t\t\t<td>' + la._302 + "</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><i>domain</i></td>\n\t\t\t\t<td>" + la._303 + '</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>&nbsp;</td>\n\t\t\t\t<td>&nbsp;</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td colspan="2"><span class="chartUrlPart" style="color:#009000">' + la._304 + "</span></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><i>width</i></td>\n\t\t\t\t<td>" + la._305 + "</span></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><i>height</i></td>\n\t\t\t\t<td>" + la._306 + "</span></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><i>amazon</i></td>\n\t\t\t\t<td>" + la._307 + "</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><i>new</i></td>\n\t\t\t\t<td>" + la._308 + "</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><i>used</i></td>\n\t\t\t\t<td>" + la._309 + "</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><i>salesrank</i></td>\n\t\t\t\t<td>" + la._309_2 + "</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><i>range</i></td>\n\t\t\t\t<td>" + la._310 + '</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>&nbsp;</td>\n\t\t\t\t<td>&nbsp;</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td colspan="2"><span class="chartUrlPart" style="color:#009000">' + la._346 + '</span></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td colspan="2">' + la._345 + '</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t<p class="mdc-typography--body2">' + la._311 + '</p>\n\t\t<p class="mdc-typography--body2" style="color: green;">\n\t\t\t<span class="chartUrlPart">' + graphBaseUrl + graphBaseFileName + '?</span> + <span class="chartUrlPart">parameterName=value</span> + <span class="chartUrlPart">&additionalParameterName=value</span> + <span class="chartUrlPart">&hellip;</span>\n\t\t</p>\n\t\t<p class="mdc-typography--body2">' + la._312 + '</p>\n\t\t<p class="mdc-typography--body2">\n\t\t\t<a style="font-size:12px" target="_blank" href="' + a + '&width=800&height=250&amazon=1&new=1&used=1&salesrank=1&range=31&cBackground=000000&cFont=cdcdcd&cAmazon=ffba63&cNew=8888dd&cUsed=ffffff">' + a + "&width=800&height=250&amazon=1&new=1&used=1&range=31<br>&salesrank=1&cBackground=000000&cFont=cdcdcd&cAmazon=ffba63&cNew=8888dd&cUsed=ffffff</a>\n\t\t</p>\n\t\t</div>"));
    $("#contentAlign").css({
        minWidth: "650px",
        maxWidth: "850px",
        marginRight: "5%",
        marginLeft: "5%",
        position: "relative"
    });
    $("#shareChartInput").val(a);
    $("#shareChartInput").click(function() {
        $(this).select()
    })
}
function generatePriceDataAPI() {
    document.title = docTitlePrefix + "API";
    $("#contentAlign").css({
        minWidth: "650px",
        maxWidth: "850px",
        marginRight: "5%",
        marginLeft: "5%",
        position: "relative"
    });
    isAWS || storage.email && 0 < storage.email.indexOf("@amazon.") ? ($(".menuDataAPI").hide(),
    insertPage(""),
    window.location.hash = "#!") : priceDataAPI.init()
}
var infoQuotaGeneral = 'Your <b>subscription based</b> Data access is governed by an hourly quota:\n\t<ul style="list-style: none;line-height:19px;text-indent:-1.8em;padding-left: 1.8em;">\n\t\t<li>&emsp;-&ensp;When making data requests your available quota will slowly decrease.</li>\n\t\t<li>&emsp;-&ensp;Quota is restored by 5% per hour until it reaches 100%.</li>\n\t\t<li>&emsp;-&ensp;Once your quota is depleted you will not be able to request new data until it is replenished.</li>\n\t\t<li>&emsp;-&ensp;Requesting the same data again within an hour will not decrease your quota.</li>\n\t\t<li>&emsp;<b>-&ensp;Viewing our interactive price and Sales Rank graphs will not decrease your quota.</b></li>\n\t\t<li>&emsp;-&ensp;Your daily quota will allow you, for example, to import and export up to 24,000 products <br>via the Product Viewer each day.</li>\n\t\t<li>&emsp;-&ensp;The quota system is in place to prevent abuse.</li>\n\t\t<li>&emsp;-&ensp;You can provide feedback through our comment section or via info@keepa.com.</li>\n\t</ul>\n\t<p><br>More details: <a href="https://discuss.keepa.com/t/data-features-access-free-vs-monthly-subscription/5845" class="href" target="_blank">Data Features Access - Free vs. Monthly Subscription</a></p>'
  , quotaLastedFor = "Your remaining quota lasted for ~ #count# #type# which will be displayed."
  , quotaExceeded = "";
function generateData() {
    if (7 != storage.domain) {
        var a = function(b, d, h, m) {
            var t = '<a href="' + m + '">'
              , f = "</a>";
            m || (t = f = "");
            return '<section>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h6 class="mdc-typography--headline6">' + t + b + f + '</h6>\t\t\t\t\t\t\n\t\t\t\t\t\t<p class="mdc-typography--body2">' + d + "</p>\n\t\t\t\t\t</div>\t\t\t\t\t\t\n\t\t\t\t\t<div>\n\t\t\t\t\t\t" + t + '<img srcset="' + imgCDNUrl + "data/" + h + "_1x.jpg 1x, " + imgCDNUrl + "data/" + h + '_2x.jpg 2x" src="' + imgCDNUrl + "data/" + h + '_1x.jpg" alt="' + b + '" />' + f + "\t\n\t\t\t\t\t</div>\t\t\t\t\t\t\n\t\t\t\t</section>"
        };
        a = (0 == storage.accountType ? '<div class="mdc-elevation--z3 block block--elevated block--data">\n\t\t\t\t<p class="mdc-typography--body2">' + la._925 + '</p>\n\t\t\t\t<p class="mdc-typography--body2">\n\t\t\t\t\t<button class="mdc-button mdc-button--raised" id="openLogin"><i class="fa fa-shopping-bag" ></i>&ensp; ' + la._927 + "</button>\n\t\t\t\t</p>\n\t\t\t</div>" : "") + (0 == storage.accountType || hasDataAccessSubscription ? "" : '<div class="mdc-elevation--z3 block block--elevated block--data">\n\t\t\t\t<p class="mdc-typography--body2">\n\t\t\t\t\t<button class="mdc-button mdc-button--raised" id="openSubscription"><i class="fa fa-shopping-bag" ></i>&ensp; ' + la._928 + "</button>\n\t\t\t\t</p>\n\t\t\t</div>") + '\n\t\t\t<div class="mdc-elevation--z3 block block--elevated block--data">\n\t\t\t\t' + a(la._734, la._735 + "<br>" + la._961, "finder", "#!finder") + "\n\t\t\t\t" + a(la._738, la._739, "viewer", "#!viewer") + "\n\t\t\t\t" + a(la._962, la._963, "bestseller", "#!bestseller") + "\n\t\t\t\t" + a(la._964, la._965, "topseller", "#!topseller") + "\n\t\t\t\t" + a(la._966, la._967, "categorytree", "#!categorytree") + "\n\t\t\t\t" + a(la._968, "- " + la._969 + "<br>- " + la._970 + "<br>- " + la._971 + "<br>- " + la._972, "datatab_v2") + "\n\t\t\t\t" + a(la._742, la._743, "tracking") + '\n\t\t\t\t<hr>\n\t\t\t\t<p class="mdc-typography--body2">' + la._744 + "<br>" + la._973 + " " + la._974 + "</p>\n\t\t\t</div>";
        insertPage(a);
        $("#openLogin").on("click", function() {
            $("#loginOverlay").show()
        });
        $("#openSubscription").on("click", function() {
            window.open("https://keepa.com/#!settings/1")
        });
        isMobile || $("#bodyPanel img").each(function(b, d) {
            ProductImageHover.preview.add_events(d, d.src.replace("1x.", "2x."))
        })
    } else
        document.location.hash = ""
}
function generateFinder(a) {
    7 != storage.domain ? 0 == storage.accountType ? document.location.hash = "#!data" : GridFinder.init(a) : document.location.hash = ""
}
function generateViewer() {
    7 != storage.domain ? 0 == storage.accountType ? document.location.hash = "#!data" : GridViewer.init() : document.location.hash = ""
}
function generateBestSeller() {
    7 != storage.domain ? 0 == storage.accountType ? document.location.hash = "#!data" : GridBestSeller.init() : document.location.hash = ""
}
function generateSeller() {
    if (7 != storage.domain)
        if (0 == storage.accountType)
            document.location.hash = "#!data";
        else {
            document.title = docTitlePrefix + " Seller Overview";
            insertPage('<h1 id="sellerName" class="headline hPink" style="padding-top: 0px;">Seller Overview</h1><div class="paper" style="min-width: 880px;"><div id="sellerPage"><div id="loadingIcon" style="text-align:center"></div></div></div>');
            $("#loadingIcon").show();
            $("#contentAlign").css({
                minWidth: "650px",
                maxWidth: "98%",
                marginRight: "2%",
                marginLeft: "2%",
                position: "relative"
            });
            var a = function() {
                $("#sellerPage").parent().html('<div style="padding: 17px;">You can look up seller information through the <a href="#!topseller">top seller list</a>.</div>')
            }
              , b = lastSubUrl.split("-");
            if (2 !== b.length)
                a();
            else {
                var d = b[0];
                b = b[1];
                (b = b.match(verifyRegExp.sellerId)) ? (b = b[1],
                Seller.init(d, b)) : a()
            }
        }
    else
        document.location.hash = ""
}
function generateTopSeller() {
    7 != storage.domain ? 0 == storage.accountType ? document.location.hash = "#!data" : GridTopSeller.init() : document.location.hash = ""
}
function generateCategoryTree() {
    7 != storage.domain ? 0 == storage.accountType ? document.location.hash = "#!data" : GridCategoryTree.init() : document.location.hash = ""
}
function setupQuotaWidget(a) {
    var b = "#!bestseller #!categorytree #!data #!finder #!seller #!topseller #!viewer".split(" ")
      , d = window.location.hash.split("/")[0]
      , h = $("#widget__bucket_quota");
    if (0 != storage.accountType && (a || b.includes(d)))
        if (0 == h.length) {
            a ? $("#more").prepend('<div id="widget__bucket_quota" class="widget__bucket-quota">\n\t\t\t\t<span class="bucket-quota__caption mdc-typography--caption">Quota left: <span>0%</span></span>\n\t\t\t\t<div class="bucket-quota__wrapper mdc-elevation--z1"><div class="bucket-quota__tracker" style="width:0%;"></div></div>\n\t\t\t</div>') : $("#subPanel").after('<div id="widget__bucket_quota" class="widget__bucket-quota">\n\t\t\t\t<span class="bucket-quota__caption mdc-typography--caption">Quota left: <span>0%</span></span>\n\t\t\t\t<div class="bucket-quota__wrapper mdc-elevation--z1"><div class="bucket-quota__tracker" style="width:0%;"></div></div>\n\t\t\t</div>');
            var m = 0;
            getBucketInformation().done(function(t) {
                "undefined" != typeof t.tokenBucketSize && (m = t.tokenBucketSize)
            });
            h = $("#widget__bucket_quota");
            h.on("click", function() {
                var t = 'Full Data access requires a <a href="https://keepa.com/#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + ">subscription</a>. Until you subscribe your access to Data features is very limited, but you can test all services provided.<br><br>";
                showPopup("Data Access Quota", 5E3 < m ? "Thank you for using our Data features!<br><br>" + infoQuotaGeneral : t + infoQuotaGeneral, !0)
            })
        } else
            a ? $("#more").prepend(h) : $("#subPanel").after(h),
            getBucketInformation();
    else
        0 < h.length && h.remove()
}
function updateQuotaWidget(a) {
    if (0 != storage.accountType) {
        quotaExceeded = "undefined" != typeof a.tokenBucketSize && 5E3 < a.tokenBucketSize ? 'You have exceeded your data quota.<br>\n\t\t\t\t\t\tPlease wait until it is refilled or <a href="#" class="link--data-update">upgrade here</a>.' : 'Your <b>free trial quota</b> for the Data features is now depleted.<br>To fully enjoy all aspects of the Data features please get a <a href="https://keepa.com/#!settings/1"' + (iframe.isIframe ? ' target="_blank"' : "") + ">monthly subscription</a>.\n\t\t\t\t\t\t<br>More information about the <b>subscription based</b> data quota can be obtained by clicking on the quota indicator.";
        var b = 2E4 < a.tokenBucketSize
          , d = b ? 2E4 : a.tokenBucketSize;
        d = 0 < a.tokenBucketSize && 0 < a.tokens ? 100 * a.tokens / d : 0;
        var h = NumberUtil.format(d)
          , m = $("#widget__bucket_quota");
        if (0 < m.length) {
            m.addClass("updating");
            var t = m.find(".bucket-quota__caption")
              , f = m.find(".bucket-quota__tracker");
            t.addClass("updating").text("Quota left: " + h + "%");
            f.width((100 < d ? 100 : h) + "%");
            setTimeout(function() {
                m.removeClass("updating")
            }, 2E3);
            d = "";
            5E3 < a.tokenBucketSize && (a = a.tokenBucketSize / 2E4,
            d = b ? a + " active Data subscriptions\nTotal quota size: " + 100 * a + "%" : "1 active Data subscription");
            d && $(".bucket-quota__caption").prop("title", d)
        }
    }
}
function generateFeatures() {
    document.title = docTitlePrefix + la._152;
    insertPage('<span class="paper">\n\t\t\t<ul style="list-style:none;line-height:19px;padding-left: 1.8em;text-indent:-1.8em;">\n\t\t\t\t<li>&#x271C;&emsp;' + la._30 + "</li>\n\t\t\t\t<li>&#x271C;&emsp;" + la._31 + "</li>\n\t\t\t\t<li>&#x271C;&emsp;" + la._32_2 + "</li>\n\t\t\t\t<li>&#x271C;&emsp;" + la._315 + "</li>\n\t\t\t\t<li>&#x271C;&emsp;" + la._186 + " [ .com | .co.uk | .de | .co.jp | .fr | .ca | .it | .es | .in | .com.mx | .com.br ]</li>\n\t\t\t\t<li>&#x271C;&emsp;" + la._187 + "</li>\n\t\t\t\t<li>&#x271C;&emsp;" + la._188 + "</li>\n\t\t\t\t<li>&#x271C;&emsp;" + la._33 + "</li>\n\t\t\t</ul>\n\t\t\t<br><br>\n\t\t\t" + la._189 + '\n\t\t\t<div id="productCountEntries"></div>\n\t\t</span>');
    $("#contentAlign").css({
        minWidth: "650px",
        maxWidth: "850px",
        marginRight: "5%",
        marginLeft: "5%",
        position: "relative"
    });
    var a, b = function() {
        window_focus && "#!features" == lastHash && network.request({
            path: "service/features",
            type: "website",
            version: 3
        }).done(function(d) {
            if (0 != parseInt(d)) {
                var h = $("#productCount");
                0 == h.length && clearInterval(a);
                var m = ""
                  , t = 0;
                d = d.data;
                d = d.productCount;
                for (var f = [7, 13], n = 1; n < numberOfDomains; n++)
                    -1 < f.indexOf(n) || (t += d[n],
                    m += '<span title="Amazon.' + getTldByDomain(n) + '" style="display:inline-block;white-space:nowrap">\n\t\t\t\t\t\t\t<img style="margin-bottom:-1px;" src="' + flags[n] + '">\n\t\t\t\t\t\t\t&nbsp;' + NumberUtil.format(d[n]) + "&emsp;&emsp;\n\t\t\t\t\t\t</span>");
                h.text(NumberUtil.format(t));
                $("#productCountEntries").html('<div style="line-height:25px;margin-top:10px;text-align:center;">' + m + "</div>");
                a = setTimeout(b, 2E3)
            }
        })
    };
    b()
}
function generateFAQ() {
    document.title = docTitlePrefix + "FAQ";
    for (var a = "", b = $jscomp.makeIterator([[la._319, la._320], [la._321, la._322], [la._323, la._324], [la._325, la._326], [la._327, la._328], [la._329, la._330], [la._331, la._332], [la._333, la._334], [la._335, la._336], [la._337, la._338], [la._339, la._340]]), d = b.next(); !d.done; d = b.next())
        d = d.value,
        a += '<li class="mdc-list-item">\n                <span class=""mdc-list-item__text">\n                  ' + d[0] + '\n                  <span class="mdc-list-item__secondary-text" style="white-space:normal;">' + d[1] + "</span>\n                </span>\n              </li>";
    insertPage('\n\t<span class="paper" style="width: 800px;">\n\t<ul id="faqList" class="mdc-list mdc-list--two-line mdc-list--variable-line mdc-list--dense">\n             ' + a + "\n            </ul>\n\t</span>");
    $("#contentAlign").css({
        minWidth: "650px",
        maxWidth: "850px",
        marginRight: "5%",
        marginLeft: "5%",
        position: "relative"
    })
}
function generateNews() {
    if (!isTest) {
        var a = -1 == location.hash.indexOf("news");
        a || (document.title = docTitlePrefix + la._25);
        insertPage('<h1 class="headline ' + (a ? "hGrey" : "hOrange") + '">' + la._25 + '</h1><div id="newsContainer"></div><div class="unselectable" style="line-height:40px;">&nbsp;</div>');
        replaceHtml("newsContainer", '<div id="ds-content"><div id="ds-content-main" class="ds-main" role="main"></div><div id="ds-content-sub" class="ds-sub ds-sidebar ds-widgets" role="complementary"><aside id="ds-text-3" class="ds-widget ds-widget_text"></aside></div></div>');
        (function(b) {
            discourseApi.category("announcements", function(d) {
                if (d) {
                    for (var h = d.topic_list.topics.length, m = {}, t = 0; t < h; t++)
                        m[(new Date(d.topic_list.topics[t].created_at)).getTime()] = d.topic_list.topics[t];
                    d = Object.keys(m).sort().reverse();
                    h = {};
                    for (t = 0; t < d.length && 8 > t; h = {
                        $jscomp$loop$prop$hasNavigated$737: h.$jscomp$loop$prop$hasNavigated$737
                    },
                    t++) {
                        var f = m[d[t]]
                          , n = discourseBaseUrl + "/t/" + f.slug + "/" + f.id;
                        document.getElementById("ds-content-main").innerHTML += '<article id="' + f.id + '" class="ds-post"><header class="ds-entry-header"><a href="' + n + '"><span>' + f.title + '</span><span class="ds-post-date">' + (new Date(f.created_at)).formatDate("M j, Y") + "</span>&emsp;</a></header>";
                        h.$jscomp$loop$prop$hasNavigated$737 = !1;
                        onPageNavigation.progress(function(r) {
                            return function() {
                                r.$jscomp$loop$prop$hasNavigated$737 = !0
                            }
                        }(h));
                        discourseApi.topic(f.id, function(r) {
                            return function(p) {
                                if (!r.$jscomp$loop$prop$hasNavigated$737)
                                    try {
                                        if (p) {
                                            var z = discourseBaseUrl + "/t/" + p.slug + "/" + p.id
                                              , F = p.posts_count - 1
                                              , I = (discourseUrl + p.post_stream.posts[0].avatar_template).replace("{size}", "45")
                                              , E = discourseBaseUrl + "/users/" + p.post_stream.posts[0].username
                                              , K = p.post_stream.posts[0].username;
                                            p.post_stream.posts[0].name && (K = p.post_stream.posts[0].name);
                                            b && (document.getElementById(p.id).firstChild.innerHTML += '<address class="ds-vcard"><cite class="ds-author ds-fn"><a class="ds-url" href="' + E + '"><img class="ds-avatar ds-avatar-24 ds-photo" width="26" height="26" src="' + I + '" alt="" />' + K + "</a></cite></address>");
                                            var H = p.post_stream.posts[0].cooked;
                                            H = H.replace(/src="\/uploads/g, 'src="//discuss.keepa.com/uploads');
                                            I = '<div class="ds-entry-content">' + H + "</div>";
                                            I += '<footer class="ds-entry-meta"><span class="ds-entry-meta-box"><span ><a href="' + z + '/2">' + F + "&ensp;<span>replies</span></a></span>&emsp;<span>" + p.views + "&ensp;<span>views</span>&emsp;</span><span>" + p.like_count + '&ensp;<span class="likes">likes</span></span></span></footer></article>';
                                            document.getElementById(p.id).innerHTML += I
                                        }
                                    } catch (V) {
                                        console.log(V)
                                    }
                            }
                        }(h))
                    }
                    document.getElementById("ds-content-main").innerHTML += '<nav class="ds-nav-paging"><ul><li class="prev"><a href="' + discourseBaseUrl + '/c/announcements">All posts</a></li></ul></nav>'
                }
            })
        }
        )(!1);
        $("#contentAlign").css({
            minWidth: "750px",
            maxWidth: "850px",
            marginRight: "5%",
            marginLeft: "5%",
            position: "relative"
        })
    }
}
function generateDisclaimer() {
    document.title = docTitlePrefix + la._26;
    var a = "";
    3 != storage.language && (a = " - Germany");
    a = '<div class="paper block block--mdc-typography">\n\t\t\t<h3 class="mdc-typography--subtitle1">' + la._165 + '</h3>\n\t\t\t<p class="mdc-typography--body2">' + la._166 + '</p>\n\t\t\t<h3 class="mdc-typography--subtitle1">' + la._168 + '</h3>\n\t\t\t<p class="mdc-typography--body2">' + la._169 + '</p>\n\t\t\t<h3 class="mdc-typography--subtitle1">' + la._26 + '</h3>\n\t\t\t<p class="mdc-typography--body2">' + la._150 + '</p>\n\t\t\t<h3 class="mdc-typography--subtitle1" style="font-weight:bold;">' + la._900 + '</h3>\n\t\t\t<p class="mdc-typography--body2" style="font-weight:bold;">' + la._901 + '</p>\n\t\t\t<h3 class="mdc-typography--subtitle1">' + la._170 + '</h3>\n\t\t\t<p class="mdc-typography--body2">\n\t\t\t\tKeepa GmbH<br>\n\t\t\t\tVogelsangstr. 7<br>\n\t\t\t\t74382 Neckarwestheim' + a + '<br><br>\n\t\t\t\tAmtsgericht Stuttgart HRB 762373<br>\n\t\t\t\tGesch\u00e4ftsf\u00fchrer: Julian Johann, Sascha Arthur<br>\n\t\t\t\tUSt-IdNr. (VAT-ID): DE313904564<br><br>\n\t\t\t\t<span style="font-weight:bold;">' + la._5 + ': <a class="href" href="mailto:info@keepa.com?subject=Question about Keepa" target="_blank">info@keepa.com</a></span>\t\t\t\n\t\t\t</p>\n\t\t\t<p class="mdc-typography--body2">' + la._171 + '</p>\n\t\t\t<div style="width: 50%;">\n\t\t\t\t<div contenteditable="true" style="white-space: normal;" id="contactForm" type="text">' + la._172 + '</div>\n\t\t\t\t<br>\n\t\t\t\t<span class="mdc-button mdc-button--raised" id="sendcontact">' + la._225 + '</span>\n\t\t\t</div>\n\t\t\t<p class="mdc-typography--body2">\t\n\t\t\t\t&copy; 2011-' + (new Date).getFullYear() + " " + getLogoSVG(60) + '<span style="font-size: 15px;">&reg;</span><br>\n\t\t\t\t<a class="gcblink" href="https://cdn.keepa.com/Keepa_Logo.zip">Keepa_Logo.zip</a>\n\t\t\t</p>\n\t\t</div>';
    insertPage(a);
    var b = !1;
    $("#sendcontact").click(function(d) {
        d.preventDefault();
        if (b || $("#contactForm").html() == la._172)
            return !1;
        b = !0;
        $("#sendcontact").val(la._45);
        d = getDebugInfos();
        network.ajax({
            url: "service/feedback/?type=sendFeedback&user=" + storage.token,
            type: "POST",
            data: {
                message: $("#contactForm").html() + "<br><br>DEBUG: <br>" + d[0] + "<br><br>" + d[1] + "<br><br>" + d[2] + "<br><br>" + (new Date).toLocaleString()
            },
            dataType: "json"
        }, !0).always(function(h) {
            b = !1;
            $("#sendcontact").parent().html(la._190)
        })
    });
    $("#contentAlign").css({
        minWidth: "650px",
        maxWidth: "850px",
        marginRight: "5%",
        marginLeft: "5%",
        position: "relative"
    })
}
var iframeTimeout = -1;
function generateDiscuss() {
    document.title = docTitlePrefix + "Forum";
    insertPage("");
    $("#content").prepend(window.loader(1, 0));
    $("#contentAlign").css("position", "");
    var a = document.createElement("div");
    a.setAttribute("style", "width: 100%; height: 85%; display:none; height: calc(100% - 80px);  border:0 none; position: absolute;top: 80px;left: 0px;");
    a.setAttribute("id", "discussContainer");
    var b = document.createElement("iframe");
    b.setAttribute("style", "width: 100%; height: 100%; border:0 none;");
    var d = location.hash.indexOf("/")
      , h = lastHash.substr(d + 1);
    0 < d && ("" == h || "/" == h) && (d = -1);
    b.setAttribute("src", "//discuss.keepa.com/" + (-1 < d ? h : 2 == storage.accountType && settings.isEmailVerified ? "login" : ""));
    b.setAttribute("scrolling", "yes");
    b.setAttribute("id", "discussiFrame");
    b.onload = function(m) {
        iframeTimeout = setTimeout(function() {
            0 < $(".pL").length && "#!discuss" == lastUrl && ($(".pL").remove(),
            insertPage('<h1 class="headline hGrey" style="padding-top: 0;">' + la._24 + '</h1><span class="paper" style="width: 800px;">Our discussion forums are currently down for maintenance. If you want to contact us or report any issues, please do not hesitate to write us an email to info@keepa.com or leave a message <a href="#!disclaimer">here</a>.</span>'))
        }, 2E4)
    }
    ;
    a.appendChild(b);
    $("#bodyPanel")[0].appendChild(a)
}
function updateDiscuss() {
    var a = location.hash.indexOf("/")
      , b = lastHash.substr(a + 1);
    0 < a && ("" == b || "/" == b) && (a = -1);
    a = -1 < a ? b : 2 == storage.accountType && settings.isEmailVerified ? "login" : "";
    $("#discussiFrame").attr("src", "//discuss.keepa.com/" + a)
}
function generateSearch() {
    document.title = docTitlePrefix + la._19;
    insertPage('<div id="searchPage">' + la._176 + '</div>\n\t\t<div id="searchPageContinue"></div>');
    searchUpdate()
}
function generateProduct() {
    "" != $("#bodyPanel").html() && 0 == $("#detailProductPage").length && 0 == $("#startPage").length ? ($("#productOverlay").append('<div id="detailProductPage" class="detailProductPage shadow">\n\t\t\t<table id="productTable">\n\t\t\t\t<tr>\n\t\t\t\t\t<td id="productTableImageBox">\n\t\t\t\t\t\t<div id="productTableImageBoxThumbs"></div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td style="vertical-align: top;">\n\t\t\t\t\t\t<div id="productTableImageBoxMain"></div>\n\t\t\t\t\t\t<div id="productTableDescription"><div id="loadingIcon" style="display: block; text-align: center; clear: both; margin-top: 100px;"></div></div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>').css({
        opacity: 1,
        display: "block"
    }),
    $("#overlayShadow").show(),
    $(document).on("click.overlay", function(a) {
        (a.srcelement ? a.srcelement : a.target) == document.getElementById("overlayShadow") && ($(document).off("click.overlay"),
        closeProductOverlay())
    })) : (insertPage('<div id="detailProductPage" class="detailProductPage shadow">\n\t\t\t<table id="productTable">\n\t\t\t\t<tr>\n\t\t\t\t\t<td id="productTableImageBox">\n\t\t\t\t\t\t<div id="productTableImageBoxThumbs"></div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td style="vertical-align: top;">\n\t\t\t\t\t\t<div id="productTableImageBoxMain"></div>\n\t\t\t\t\t\t<div id="productTableDescription"><div id="loadingIcon" style="display: block; text-align: center; clear: both; margin-top: 100px;"></div></div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div><div class="unselectable" style="line-height:50px;">&nbsp;</div>'),
    $("#contentAlign").css({
        maxWidth: "",
        width: "98%",
        marginRight: "auto",
        marginLeft: "auto",
        position: "relative",
        minWidth: "850px"
    }));
    productUpdate()
}
function generateSettings() {
    document.title = docTitlePrefix + la._8;
    var a = material.getTabs({
        tabs: [{
            tab: {
                icon: "bell-o",
                id: "channels",
                label: la._587
            },
            panel: {
                id: "notification-channels"
            },
            isActive: !0
        }, {
            tab: {
                icon: "unlock",
                id: "subscriptions",
                label: la._647
            },
            panel: {
                id: "subscriptions-tab"
            }
        }, {
            tab: {
                icon: "user-circle",
                id: "account",
                label: la._516
            },
            panel: {
                id: "settingsBox"
            }
        }, {
            tab: {
                icon: "cog",
                id: "website",
                label: la._517
            },
            panel: {
                id: "settingsContent"
            }
        }],
        panelsClass: "appsContent"
    });
    insertPage('<div id="settingsPage"><div class="paper" style="width: 900px">' + a + '</div></div><div class="unselectable" style="line-height:50px;">&nbsp;</div>');
    SettingsPage.init()
}
function generateVerifyEmail() {
    document.title = docTitlePrefix + la._358;
    insertPage('<h1 class="headline hOrange" style="padding-top: 0px;">' + la._24 + '</h1><div id="disqus_thread" style="display:none" class="shadow"></div><div class="unselectable" style="line-height:50px;">&nbsp;</div><div id="loadingIcon" style="text-align:center"></div>');
    $("#loadingIcon").show();
    $("#contentAlign").css({
        minWidth: "650px",
        maxWidth: "850px",
        marginRight: "5%",
        marginLeft: "5%",
        position: "relative"
    });
    var a = function(h) {
        $("#loadingIcon").hide();
        insertPage('<h1 class="headline hBlue">' + la._358 + '</h1><span class="paper">' + h + "</span><br/><br/>");
        $("#contentAlign").css({
            minWidth: "650px",
            maxWidth: "850px",
            marginRight: "5%",
            marginLeft: "5%",
            position: "relative"
        })
    };
    if (isNewPage) {
        var b = lastSubUrl;
        switch (b) {
        case "IS_VERIFIED":
            var d = la._359;
            break;
        case "WAS_VERIFIED":
            d = la._360;
            break;
        default:
            d = la._error,
            reportBug(null, "verify failed: " + b)
        }
        a(d)
    } else
        b = lastSubUrl,
        64 != b.length ? (a("The verify token is missing from the URL or incomplete. Please try to select, copy and paste the whole link from the email you received instead of clicking on it. If the problem persists, contact info@keepa.com."),
        reportBug(null, "verify: token missing/short " + b)) : network.ajax({
            type: "GET",
            url: "user/verify/?type=verify&user=" + lastSubUrl,
            dataType: "json"
        }, !0).done(function(h) {
            if (0 != parseInt(h)) {
                switch (h.status) {
                case 0:
                case 2:
                    var m = la._359;
                    break;
                case 1:
                    m = la._360;
                    break;
                case -1:
                case 3:
                    m = la._error,
                    reportBug(null, "verify failed: " + JSON.stringify(h))
                }
                a(m)
            }
        }).fail(function() {
            a(la._error);
            reportBug(null, "verify: " + textStatus + "<br>" + errorThrown)
        })
}
function generatePWreset() {
    document.title = docTitlePrefix + la._373;
    var a = '<div id="settingsPage">\n\t\t\t<h1 class="headline hGrey">' + la._373 + '</h1>\n\t\t\t<div class="paper" id="settingsBox">\n\t\t\t<form action="" id="addTrackForm" method="post" name="addTrackForm">\n\t\t\t\t' + getNewPasswordHtml() + '\n\t\t\t\t<input type="submit" id="submit" value="' + la._225 + '">\n\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="unselectable" style="line-height:50px;">&nbsp;</div>';
    insertPage(a);
    $("#contentAlign").css(contentAlignCss);
    $("#passBox").find(".trackFormTable").width("440px");
    $("#passBox").find("tr").each(function() {
        var d = $(this).children().first()
          , h = d.next()
          , m = h.next();
        d.remove();
        h.remove();
        "trackFormTable-empty" == m.attr("class") && m.remove()
    });
    $("#passBox").show();
    var b = !1;
    $("#addTrackForm").submit(function(d) {
        d.preventDefault();
        if (b)
            return !1;
        b = !0;
        $("#submit").val(la._45);
        $("#newPW").val().trim() != $("#newPW2").val().trim() ? ($("label[for=newPW]").append('<span class="error">' + la._236 + "</span>"),
        b = !1,
        $("#submit").val(la._225)) : (d = lastSubUrl,
        null == d || 64 != d.length ? showPopup("Error", "Missing reset token. Please use the reset link provided in the email. In doubt, contact info@keepa.com.", !0) : network.request({
            path: "user/session",
            type: "resetpw",
            version: 3,
            token: d,
            password: $("#newPW").val().trim()
        }).done(function(h) {
            b = !1;
            if ("undefined" === typeof h.error || null === h.error)
                $("#settingsBox").text(la._376);
            else
                switch ("undefined" !== typeof h.error.type ? h.error.type : "undefined" !== typeof h.error.code ? h.error.code : -1) {
                case 1:
                case "invalidPassword":
                    $('label[for="newPW"]').find(".error").remove();
                    $('label[for="newPW"]').append('<span class="error">' + la._74 + "</span>");
                    $("#submit").val(la._225);
                    break;
                case 2:
                case "invalidToken":
                    $("#settingsBox").text(la._377);
                    break;
                case 3:
                case "userNotFound":
                    $("#settingsBox").text(la._912);
                    break;
                default:
                    reportBug(null, "resetpassword: " + JSON.stringify(h)),
                    showErrorPopup()
                }
        }).fail(function(h) {
            b = !1;
            replaceHtml("resetForm", '<div style="width: 420px; text-align: justify; margin-right: 30px;">' + la._error + "</div>");
            reportBug(null, "resetpassForm fail: " + h.status)
        }))
    })
}
function getLoginForm() {
    var a = '<form id="resetForm" class="hidden">\n\t\t\t<div style="font-size: 16px; color: #000;">' + la._373 + '</div><br>\n\t\t\t<label style="width: 200px;" class="grey" for="emailReset">' + la._374 + '</label>\n\t\t\t<input class="field" type="email" name="emailReset" id="emailReset">\n\t\t\t<div class="flex unselectable" style="justify-content: space-between;">\n\t\t\t\t<div id="PWresetBack" class="button submitButton bt_login" value="" style="background-color: tomato;" >\n\t\t\t\t\t' + la._380 + '\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<input id="submitPWreset" type="submit" name="submit" value="' + la._225 + '" class="bt_login">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</form>';
    return '<div id="loginOverlay" class="hidden">\n\t\t<div id="loginOverlayBox"' + ([4, 5].includes(Number(storage.language)) ? ' class="popup__login--wide"' : "") + '>\n\t\t\t<div id="loginOverlay-close"><i class="fa fa-times-circle fa-2x"></i></div>\n\t\t\t<table id="loginTable">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div class="flex" style="justify-content: space-around;-webkit-justify-content: space-around;">\n\t\t\t\t\t\t\t<div id="loginTab">' + la._2 + '</div>\n\t\t\t\t\t\t\t<div id="registerTab" class="inactive">' + la._42 + '</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<br>\n\t\t\t\t\t\t<form id="loginForm" action="" method="post">\n\t\t\t\t\t\t\t<label class="grey" for="username">' + la._4 + '</label>\n\t\t\t\t\t\t\t<input class="field" type="text" autocapitalize="off" autocorrect="off" name="username" autocomplete="username" id="username">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<label class="grey" for="password">' + la._6 + '</label>\n\t\t\t\t\t\t\t<span style="display: inline-block;"><input type="password" maxlength="1024" name="password" id="password" autocomplete="current-password" class="field">\n\t\t\t\t\t\t\t<span style="color: #555;" class="fa fa-fw fa-eye field-icon toggle-password"></span></span>\n\t\t\t\t\t\t\t<a class="settings-chpw" id="pwreset" style="display: block;font-size: smaller;text-decoration: none;padding: 5px;margin-bottom: -12px;text-align: right;">' + la._372 + '</a>\n\t\t\t\t\t\t\t<div id="registerEmailBox" class="hidden"><label class="grey" for="email">' + la._5 + '</label>\n\t\t\t\t\t\t\t\t<input disabled class="field" type="text" name="email" autocomplete="email" id="emailRegister"></div>\n\t\t\t\t\t\t\t<table style="width:' + ([4, 5].includes(Number(storage.language)) ? "260px" : "220px") + ';" class="grey">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td colspan="2">\n\t\t\t\t\t\t\t\t\t\t<span style="margin-top: 15px; font-size: 14px; display: block;" id="orOpenId">' + la._161 + '</span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td colspan="2" class="socialButtons">\n\t\t\t\t\t\t\t\t\t\t<i id="openIDmazon" class="fa fa-amazon" style="color:#29425a"></i>\n\t\t\t\t\t\t\t\t\t\t<i id="openIDacebook" class="fa fa-acebook" style="color:#3B5998"></i>\n\t\t\t\t\t\t\t\t\t\t<i id="openIDwitter" class="fa fa-witter" style="color:#0CF"></i>\n\t\t\t\t\t\t\t\t\t\t<img id="openIDoogle" src="' + imgCDNUrl + 'social/oogle.svg">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr style="text-align:right;">\n\t\t\t\t\t\t\t\t\t<td style="text-align:left;"></td>\n\t\t\t\t\t\t\t\t\t<td style="text-align:right;"><input id="submitLogin" type="submit" name="submit" value="' + la._2 + '" class="button"/></td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t<div id="loginError" style="color: red;width: 165px;"></div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t\t' + a + "\n\t\t</div>\n\t</div>"
}
var toggleLoginRegister = function(a) {
    a ? ($("#registerEmailBox").show(),
    $("#emailRegister").removeAttr("disabled"),
    $("#orOpenId").text(la._160),
    $("#orOpenId").hide(),
    $("#pwreset").hide(),
    $("#submitLogin").val(la._42),
    $("#openIDwitter").hide(),
    $("#openIDacebook").hide(),
    $("#openIDoogle").hide(),
    $("#openIDmazon").hide(),
    $("#submitLogin").val(la._42),
    $("#pwreset").velocity({
        opacity: 0
    }, {
        duration: 300
    })) : ($("#emailRegister").attr("disabled", "disabled"),
    $("#registerEmailBox").hide(),
    $("#pwreset").show(),
    $("#orOpenId").text(la._161),
    $("#orOpenId").show(),
    $("#submitLogin").val(la._2),
    $("#openIDwitter").show(),
    $("#openIDacebook").show(),
    $("#openIDoogle").show(),
    $("#openIDmazon").show(),
    $("#pwreset").velocity({
        opacity: 1
    }, {
        duration: 300
    }))
};
var serverTimeStamp = 0
  , manageEndlessBusy = !1;
function manage() {
    $("#contentAlign").css({
        "margin-top": "160px",
        "min-width:": "",
        maxWidth: "",
        width: "auto",
        "margin-right": "50px",
        "margin-left": "50px"
    });
    loadManage(!0)
}
var manageCurrentPage = 0
  , manageData = null
  , manageDataSearchBackup = []
  , manageFilter = null
  , manageFilterCats = null
  , manageFilterDomain = null
  , manageFilterMerchant = null
  , manageFilterWishlist = null
  , manageFilterCondition = null
  , manageFilter_domain = 0
  , manageFilter_rootcat = 0
  , manageFilter_condition = 0
  , manageFilter_wishlist = 0
  , manageFilter_merchant = 0
  , manageProductsPerPage = 30
  , manageSortType = 0;
try {
    manageSortType = storage.sortDefault
} catch (a) {}
var manageHasMultipleDomains = !1;
function addLightningBox(a) {
    if (a) {
        var b = CsvType.LIGHTNING_DEAL.index
          , d = []
          , h = []
          , m = CsvType.getName(CsvType.LIGHTNING_DEAL.index);
        a = $jscomp.makeIterator(a);
        for (var t = a.next(); !t.done; t = a.next()) {
            t = t.value;
            var f = t.csv[b];
            if (null !== f) {
                var n = "";
                var r = t.imagesCSV.split(",")[0];
                var p = r.substring(r.length - 4, r.length);
                ".gif" === p || ".jpg" === p || ".png" === p ? r = r.substring(0, r.length - 4) : p = ".jpg";
                n += '<div class="productIcon" style="flex-shrink: 0;margin-right: 20px;width: 55px; height: 55px; background:url(' + ("" !== r ? imageServer + r + "._SL55_" + p : imgCDNUrl + "no-photo-available.png") + ') no-repeat center center"></div>';
                p = getValueAtTime(f, keepaTime.now(), CsvType.LIGHTNING_DEAL);
                if (0 < p) {
                    r = Money.format(p, {
                        sourceDomainId: t.domainId,
                        targetDomainId: t.domainId
                    });
                    var z = ""
                      , F = ""
                      , I = "";
                    showReferencePrice(t.domainId) && (z = "" + Money.format(p, {
                        sourceDomainId: t.domainId
                    }),
                    F = ' <span class="price__reference">',
                    I = "</span>");
                    d.push('<div class="flex" style="align-items: center;font-size: 14px;width: 100%;text-align:left;margin-top:5px">' + n + '<div><a href="#!product/' + t.domainId + "-" + t.asin + '">' + truncate(t.title, 150) + '</a><div style="font-size:16px; color: ' + CsvType.LIGHTNING_DEAL.color + ';">' + z + F + r + I + "</div></div></div>")
                }
                p = f.length;
                if (3 < p && -1 === f[p - 1] && -1 === f[p - 3]) {
                    r = 0;
                    try {
                        for (; -1 === f[p - 5]; )
                            p -= 2;
                        r = f[p - 2];
                        for (z = p; r < keepaTime.now() && z + 2 <= f.length; )
                            z += 2,
                            r = f[z - 2]
                    } catch (E) {
                        console.error(E, f, p)
                    }
                    keepaTime.now() > r || (r = (new Date(keepaTime.minutesToEpoch(r))).formatDate("M j, G:i"),
                    z = "",
                    5 < p && 0 < f[p - 5] && (z = keepaTime.now() - f[p - 6],
                    f = Money.format(f[p - 5], {
                        sourceDomainId: t.domainId,
                        targetDomainId: t.domainId
                    }),
                    z = '<span style="color:#303030;font-size:12px;">' + la._649 + " (" + prettyDate(z) + ") " + la._650 + " " + f + "</span>"),
                    h.push('<div class="flex" style="align-items:center;font-size:14px;width:100%;text-align:left;margin-top:5px">\n\t\t\t\t\t' + n + '\n\t\t\t\t\t<div>\n\t\t\t\t\t<a href="#!product/' + t.domainId + "-" + t.asin + '">' + truncate(t.title, 150) + '</a>\n\t\t\t\t\t<div style="color:#6b4a4a;">' + la._648 + " " + r + "</div>\n\t\t\t\t\t" + z + "\n\t\t\t\t\t</div>\n\t\t\t\t\t</div>"))
                }
            }
        }
        if (0 < d.length || 0 < h.length)
            b = '<div style="color:tomato;font-size: 19px;width: 100%;margin:10px 0 10px 46px"><span><i class="fa fa-bolt" ></i>&emsp;' + m + '&emsp;<i class="fa fa-bolt" ></i></span></div>' + ('<div class="flex" style="flex-wrap: wrap;flex-direction: column;">' + d.join("") + h.join("") + "</div>"),
            $("#filter").after('<div id="manageLightningBox" class="text_long shadow" style="flex: 1 1 300px;max-width: 600px;min-width:300px;margin-right: 25px;">' + b + "</div>")
    }
}
function manageSorter(a) {
    var b = manageData.tracking;
    if (0 != b.length) {
        var d = b[0].domainId;
        for (h in b) {
            var h = b[h];
            h.domainId != d && (manageHasMultipleDomains = !0);
            if (void 0 !== h.deltaA && !1 === a)
                break;
            var m = h.lastVisitPrices[CsvType.AMAZON.index]
              , t = h.lastVisitPrices[CsvType.NEW.index]
              , f = h.lastVisitPrices[CsvType.USED.index];
            h.deltaA = 0 >= m || 0 >= h.AMAZON_LAST ? 0 : h.AMAZON_LAST - m;
            h.deltaN = 0 >= t || 0 >= h.MARKET_NEW_LAST ? 0 : h.MARKET_NEW_LAST - t;
            h.deltaU = 0 >= f || 0 >= h.MARKET_USED_LAST ? 0 : h.MARKET_USED_LAST - f;
            m = h.createDatePrices[CsvType.AMAZON.index];
            t = h.createDatePrices[CsvType.NEW.index];
            f = h.createDatePrices[CsvType.USED.index];
            h.deltaCA = 0 >= m || 0 >= h.AMAZON_LAST ? 0 : h.AMAZON_LAST - m;
            h.deltaCN = 0 >= t || 0 >= h.MARKET_NEW_LAST ? 0 : h.MARKET_NEW_LAST - t;
            h.deltaCU = 0 >= f || 0 >= h.MARKET_USED_LAST ? 0 : h.MARKET_USED_LAST - f;
            h.unavailableAmazon = -1 == h.AMAZON_LAST || -1 == h.PRICE_AMAZON;
            h.unavailableNew = -1 == h.MARKET_NEW_LAST || -1 == h.PRICE_NEW;
            h.unavailableUsed = -1 == h.MARKET_USED_LAST || -1 == h.PRICE_USED;
            h.diffAmazon = h.unavailableAmazon ? 0 : h.AMAZON_LAST - h.PRICE_AMAZON;
            h.diffNew = h.unavailableNew ? 0 : h.MARKET_NEW_LAST - h.PRICE_NEW;
            h.diffUsed = h.unavailableUsed ? 0 : h.MARKET_USED_LAST - h.PRICE_USED
        }
        switch (Number(manageSortType)) {
        case 5:
        case 0:
            b.sort(function(n, r) {
                n = n.CDATE == r.CDATE ? 0 : n.CDATE > r.CDATE ? -1 : 1;
                return 5 == manageSortType ? -1 * n : n
            });
            break;
        case 6:
        case 1:
            b.sort(function(n, r) {
                var p = n.unavailableAmazon ? 9999999999 : n.diffAmazon;
                p = n.unavailableNew || n.diffNew > p ? p : n.diffNew;
                p = n.unavailableUsed || n.diffUsed > p ? p : n.diffUsed;
                n = r.unavailableAmazon ? 9999999999 : r.diffAmazon;
                n = r.unavailableNew || r.diffNew > n ? n : r.diffNew;
                n = r.unavailableUsed || r.diffUsed > n ? n : r.diffUsed;
                r = p == n ? 0 : p < n ? -1 : 1;
                return 6 == manageSortType ? -1 * r : r
            });
            break;
        case 7:
        case 2:
            b.sort(function(n, r) {
                var p = 0 == n.deltaA ? 9999999999 : n.deltaA;
                p = 0 == n.deltaN || n.deltaN > p ? p : n.deltaN;
                p = 0 == n.deltaU || n.deltaU > p ? p : n.deltaU;
                var z = 0 == r.deltaA ? 9999999999 : r.deltaA;
                z = 0 == r.deltaN || r.deltaN > z ? z : r.deltaN;
                z = 0 == r.deltaU || r.deltaU > z ? z : r.deltaU;
                p == z && (p = 0 == n.deltaCA ? 9999999999 : n.deltaA,
                p = 0 == n.deltaCN || n.deltaCN > p ? p : n.deltaCN,
                p = 0 == n.deltaCU || n.deltaCU > p ? p : n.deltaCU,
                z = 0 == r.deltaCA ? 9999999999 : r.deltaA,
                z = 0 == r.deltaCN || r.deltaCN > z ? z : r.deltaCN,
                z = 0 == r.deltaCU || r.deltaCU > z ? z : r.deltaCU);
                n = p == z ? 0 : p > z ? 1 : -1;
                return 7 == manageSortType ? -1 * n : n
            });
            break;
        case 8:
        case 3:
            b.sort(function(n, r) {
                var p = 0 == n.deltaCA ? 9999999999 : n.deltaCA;
                p = 0 == n.deltaCN || n.deltaCN > p ? p : n.deltaCN;
                p = 0 == n.deltaCU || n.deltaCU > p ? p : n.deltaCU;
                var z = 0 == r.deltaCA ? 9999999999 : r.deltaCA;
                z = 0 == r.deltaCN || r.deltaCN > z ? z : r.deltaCN;
                z = 0 == r.deltaCU || r.deltaCU > z ? z : r.deltaCU;
                p == z && (p = 0 == n.deltaA ? 9999999999 : n.deltaA,
                p = 0 == n.deltaN || n.deltaN > p ? p : n.deltaN,
                p = 0 == n.deltaU || n.deltaU > p ? p : n.deltaU,
                z = 0 == r.deltaA ? 9999999999 : r.deltaA,
                z = 0 == r.deltaN || r.deltaN > z ? z : r.deltaN,
                z = 0 == r.deltaU || r.deltaU > z ? z : r.deltaU);
                n = p == z ? 0 : p > z ? 1 : -1;
                return 8 == manageSortType ? -1 * n : n
            });
            break;
        case 9:
        case 4:
            b.sort(function(n, r) {
                var p = 0;
                n = n.TITLE.toLowerCase();
                r = r.TITLE.toLowerCase();
                n < r && (p = -1);
                n > r && (p = 1);
                return 9 == manageSortType ? -1 * p : p
            })
        }
    }
}
function manageUpdate(a) {
    if (null == manageData)
        a || loadManage();
    else {
        graph.removeAll();
        manageCurrentPage = 0;
        a = lastSubUrl.split("-");
        if (5 == a.length || 6 == a.length)
            manageFilter_domain = a[0],
            manageFilter_condition = a[1],
            manageFilter_merchant = a[2],
            manageFilter_rootcat = a[3],
            manageSortType = a[4],
            6 == a.length && (manageFilter_wishlist = a[5]);
        $(document).off("scroll.endless-manage");
        $(document).endlessScroll({
            bottomPixels: 2E3,
            eventName: "endless-manage",
            callback: function(b) {
                bulkOperationInProgress || (0 == $("#managePage").length ? $(document).off("scroll.endless-manage") : manageEndlessBusy || (manageEndlessBusy = !0,
                manageCurrentPage++,
                insertManageProductsPage(manageCurrentPage)))
            }
        });
        manageActiveProducts.length = 0;
        manageFilterCats = {};
        manageFilterDomain = {};
        manageFilterMerchant = {};
        manageFilterCondition = {};
        manageFilterWishlist = {};
        manageFilter = {};
        manageFilter.rootcat = manageFilterCats;
        manageFilter.domain = manageFilterDomain;
        manageFilter.merchant = manageFilterMerchant;
        manageFilter.condition = manageFilterCondition;
        manageFilter.wishlist = manageFilterWishlist;
        replaceHtml("manage-productList", "");
        manageSorter();
        try {
            if (null != manageData && null != manageData.tracking)
                for (a = 0; a < manageData.tracking.length; a++)
                    insertProductFilterListing(a) && manageActiveProducts.push(a)
        } catch (b) {
            reportBug(b)
        }
        manageEndlessBusy = !0;
        insertManageProductsPage(0);
        insertFilter()
    }
}
var deletionPromise = $.Deferred();
function deleteTrackings(a) {
    var b = "";
    for (d in a) {
        var d = a[d];
        if (b = $("#manage-productList").find(".manage-tableRow[rel='" + d + "']"))
            deleteProductFilterListing(d),
            b.hide("hide", function() {
                "" != b && b.remove()
            })
    }
    var h = 2
      , m = function() {
        0 >= h ? deletionPromise.reject() : (h--,
        setTimeout(function() {
            network.request({
                path: "track",
                type: "deleteTracking",
                asinBatch: a,
                version: 3
            }).done(function(t) {
                null == t.error ? deletionPromise.resolve() : m()
            }).fail(m).always(function() {
                0 == $(".manage-tableRow").length && (lastSubUrl != "0-0-0-0-" + manageSortType && "" != lastSubUrl ? window.location.hash = "#!manage/0-0-0-0-" + manageSortType : noTrackings())
            })
        }, 10))
    };
    m(!0)
}
function deleteTracking(a) {
    if (null == a) {
        a = lastSubUrl.split("-");
        if (2 != a.length)
            return showPopup(),
            !1;
        a = a[1];
        var b = a.match(verifyRegExp.asin);
        if (!b || 10 > b[1].length)
            return replaceHtml("productTableDescription", "Error:<br>" + la._216),
            showPopup(),
            !1
    }
    return network.request({
        path: "track",
        asinBatch: [a],
        type: "deleteTracking",
        version: 3
    })
}
function manageUndo(a) {
    if (a.is(":visible")) {
        var b = a.html()
          , d = /(\d+)/.exec(b)
          , h = Number(d[1]);
        1 == h ? (b = a.closest(".manage-tableRow").attr("rel"),
        deleteTrackings([b])) : (a.html(b.replace(d[1], h - 1)),
        window.setTimeout(function() {
            manageUndo(a)
        }, 1E3))
    }
}
function toogleEvents(a) {
    if (!a.hasClass("tabAmazon") && !a.hasClass("tabTrack")) {
        a.parent().children().off("click.toggle");
        a.siblings().removeClass("active");
        a.addClass("active");
        var b = a.closest(".manage-productOverviewDiv").find(".manage-tabContent");
        b.children().addClass("inactive");
        "history" == a.attr("rel") ? b.children().first().removeClass("inactive") : b.children(".inactive[rel=" + a.attr("rel") + "]").removeClass("inactive");
        a.siblings().on("click.toggle", function() {
            toogleEvents($(this))
        })
    }
}
function manage_event_notification(a) {}
function manage_addEvents(a) {
    a.find(".manage-graph").find("label").colorTip({
        color: "grey"
    });
    a.find("#multipleTrackingHelp").colorTip({
        color: "greyTrackingHelp"
    });
    a.find(".manage-tabItem:not(active)").on("click.toggle", function() {
        toogleEvents($(this))
    });
    a.find(".trackFormTable-price > input").focus(function() {
        $(this).removeClass().addClass("borderShadowCoralInput")
    });
    a.find(".priceAmazon").focus(function() {
        $(this).removeClass().addClass("borderShadowCoralInput");
        $(this).parent().siblings(".trackFormTable-price").children().removeClass()
    });
    a.find(".priceNew").focus(function() {
        $(this).removeClass().addClass("borderShadowBlueInput");
        $(this).parent().siblings(".trackFormTable-price").children().removeClass()
    });
    a.find(".priceUsed").focus(function() {
        $(this).parent().siblings(".trackFormTable-price").children().removeClass();
        $(this).removeClass().addClass("borderShadowBlackInput")
    });
    a.find(".trackFormTable-price").children().focusout(function() {
        if (0 < $(this).val().length) {
            var b = $(this).parent().parent().attr("domain");
            $(this).val(NumberUtil.format($(this).val(), 5 == b ? 0 : 2))
        }
    });
    a.find(".manage-remove").click(function() {
        $(this).parent().hide();
        var b = $(this).closest(".manage-tableRow").find(".manage-productOverviewDiv");
        b.hide("slide", "fast", function() {
            var d = $(this).closest(".manage-tableRow").find(".manage-productOverviewUndo");
            d.parent().height(b.height());
            d.show();
            d.on("click.remove", function() {
                var h = $(this).closest(".manage-tableRow");
                $(this).off("click.remove");
                $(this).hide();
                $(this).html(la._84);
                $(this).css("color", "#000");
                h.find(".manage-productOverviewDiv").show("slide", "fast", function() {
                    h.find(".manage-removeDiv").show()
                })
            });
            window.setTimeout(function() {
                manageUndo(d)
            }, 1E3);
            return !1
        });
        return !1
    });
    a.find(".manage-remove").hover(function() {
        $(this).parent().addClass("manage-removeDiv-hover").parent().addClass("manage-removeDiv-hover");
        return !1
    }, function() {
        $(this).parent().removeClass("manage-removeDiv-hover").parent().removeClass("manage-removeDiv-hover");
        return !1
    })
}
var historyGraphs = [], historyGraphInterval, updatePlotIntervals = [];
function noTrackings() {
    var a = '<div id="manage-empty">\n\t\t\t<h6 class="mdc-typography--subtitle1">' + la._27 + '</h6>\n\t\t\t<p class="mdc-typography--body2">' + (storage.username ? la._85 : la._871) + '</p>\n\t\t\t<br>\n\t\t\t<p class="mdc-typography--body2">' + la._86 + " " + la._872 + "</p>\n\t\t</div>";
    $("#manage-productList").html(a)
}
function droppedSinceLastVisit(a, b, d, h) {
    return 0 != a ? (d = 0 < a ? '&nbsp;<img src="' + imgCDNUrl + 'price-up.gif" />&emsp;&emsp;' : '&nbsp;<img src="' + imgCDNUrl + 'price-down.gif" />&emsp;&emsp;',
    '<span class="manage-lastVisit ' + (1 == h ? "priceAmazon" : 2 == h ? "priceNew" : "priceUsed") + '">' + Money.format(a, {
        sourceDomainId: b,
        targetDomainId: b,
        absolute: !0
    }) + d + "</span>") : ""
}
function getProduct(a, b, d, h) {
    for (var m = null, t = a.products.length; h < t; h++) {
        var f = a.products[h];
        if (null != f && f.asin === b && f.domainId === d) {
            m = f;
            break
        }
    }
    return m
}
function loadManage() {
    if (storage.token && "" != storage.token) {
        $("#loadingIcon").after('<div id="loadingIconAdv" style="position: absolute !important;left: 185px;top: 80px;"><div id="loadingProgress" style="top: -15px; position: relative;"></div></div>');
        $("#loadingIconAdv").show();
        var a = {}, b, d = function(m) {
            network.request({
                path: "user/manage",
                type: "overview",
                version: 3,
                startIndex: m,
                lastVisit: storage.lastManageVisit || Date.now()
            }).done(function(t) {
                "undefined" == typeof t.wishLists && (t.wishLists = []);
                "undefined" == typeof t.products && (t.products = []);
                t.products && (t.completeProducts = t.products);
                if (0 === m)
                    t.products = t.noHistoryProducts,
                    delete t.noHistoryProducts,
                    a = t;
                else {
                    a.completeProducts = a.completeProducts.concat(t.completeProducts);
                    a.products = a.products.concat(t.noHistoryProducts);
                    a.trackings = a.trackings.concat(t.trackings);
                    a.wishLists = a.wishLists.concat(t.wishLists);
                    for (var f in t.categoriesPerDomain)
                        for (var n in t.categoriesPerDomain[f])
                            a.categoriesPerDomain[f][n] = t.categoriesPerDomain[f][n]
                }
                b = t.trackingCount;
                m += 500;
                $("#loadingProgress").text(m + " / " + b);
                m < b ? d(m) : ($("#loadingIconAdv").remove(),
                h(a))
            }).fail(showErrorPopup)
        };
        d(0);
        var h = function(m) {
            $("#loadingIcon").hide();
            $("#managePage").show();
            replaceHtml("detailProductPage", "");
            $("#detailProductPage").remove();
            $("#productOverlay").hide();
            if (null == m.trackings || 0 == m.trackings.length)
                noTrackings(),
                $("#filter").hide();
            else {
                manageData = m;
                m.exchange && (currencies = m.exchange);
                m.productHashMap = {};
                for (var t = 0, f = m.products.length; t < f; t++) {
                    var n = m.products[t];
                    m.productHashMap[n.asin + n.domainId] = n
                }
                delete m.products;
                m.rssHash = storage.rssHash;
                m.lastVisit = storage.lastManageVisit;
                m.tracking = [];
                for (t = 0; t < m.trackings.length; t++) {
                    n = m.trackings[t];
                    var r = m.productHashMap[n.asin + n.mainDomainId];
                    if (null == r)
                        console.log("no product found.");
                    else {
                        null == r.title && (r.title = "Delete me");
                        var p = {}
                          , z = [];
                        if (null != n.thresholdValues)
                            for (f = 0; f < n.thresholdValues.length; f++) {
                                var F = n.thresholdValues[f]
                                  , I = F.thresholdValueCSV[F.thresholdValueCSV.length - 1];
                                if (-1 != I) {
                                    var E = m.productHashMap[n.asin + F.domain];
                                    if (null != E) {
                                        null == E.title && (E.title = "Delete me");
                                        F.domain == n.mainDomainId && (z[F.csvType] = {
                                            desired: I,
                                            current: E.csv[E.csv.length - 1][CsvType.AMAZON.index]
                                        });
                                        "undefined" == typeof p[F.domain] && (p[F.domain] = {});
                                        "undefined" == typeof r.trackedDomains && (r.trackedDomains = {});
                                        r.trackedDomains[F.domain] = F.domain;
                                        var K = Money.raw(I, {
                                            sourceDomainId: n.mainDomainId,
                                            targetDomainId: F.domain,
                                            keepUnit: !0
                                        })
                                          , H = Money.raw(E.csv[E.csv.length - 1][F.csvType], {
                                            sourceDomainId: F.domain,
                                            targetDomainId: n.mainDomainId,
                                            keepUnit: !0
                                        });
                                        p[F.domain][F.csvType] = {
                                            desired: I,
                                            current: E.csv[E.csv.length - 1][F.csvType],
                                            desiredInNativeCurrency: K,
                                            currentInMainCurrency: H
                                        }
                                    }
                                }
                            }
                        F = [];
                        I = [];
                        for (f = 0; f < r.csv.length - 1; f++)
                            F[f] = r.csv[r.csv.length - 1][f + r.csv.length - 1],
                            I[f] = r.csv[r.csv.length - 1][f + 2 * (r.csv.length - 1)];
                        m.tracking.push({
                            AMAZON_LAST: r.csv[r.csv.length - 1][CsvType.AMAZON.index],
                            ASIN: n.asin,
                            CDATE: 6E4 * (n.createDate + offsetMinutes),
                            domainId: n.mainDomainId,
                            EMAIL: null == n.notificationType ? !1 : n.notificationType[0],
                            FACEBOOK: null == n.notificationType ? !1 : n.notificationType[2],
                            IMAGES: null == r.imagesCSV ? "" : r.imagesCSV.split(","),
                            LASTNOTIFY: null == n.notificationCSV ? 0 : n.notificationCSV[n.notificationCSV.length - 1],
                            LASTUPDATE: r.lastUpdate,
                            MARKET_NEW_LAST: r.csv[r.csv.length - 1][CsvType.NEW.index],
                            MARKET_USED_LAST: r.csv[r.csv.length - 1][CsvType.USED.index],
                            MULTI_CSV: p,
                            PRICE_AMAZON: null == z[CsvType.AMAZON.index] ? -1 : z[CsvType.AMAZON.index].desired,
                            PRICE_NEW: null == z[CsvType.NEW.index] ? -1 : z[CsvType.NEW.index].desired,
                            PRICE_USED: null == z[CsvType.USED.index] ? -1 : z[CsvType.USED.index].desired,
                            ROOTCAT: r.rootCategory,
                            SALESRANK: r.csv[CsvType.SALES.index],
                            TID: n.asin,
                            TITLE: r.title,
                            TWITTER: null == n.notificationType ? !1 : n.notificationType[1],
                            TYPE: r.productType,
                            wishListId: n.wishListId,
                            wishListItemId: n.wishListItemId,
                            createDatePrices: F,
                            lastVisitPrices: I,
                            trackedDomains: r.trackedDomains,
                            tracking: n
                        })
                    }
                }
                delete m.trackings;
                t = {};
                for (var V in m.wishLists)
                    n = m.wishLists[V],
                    t[n.id] = n;
                m.wishLists = t;
                serverTimeStamp = m.timeStamp;
                0 === m.tracking.length ? (noTrackings(),
                $("#filter").hide()) : ($("#manage-rss").attr("href", ajaxURL + "user/rss/?feed=" + m.rssHash),
                manageHasMultipleDomains = !1,
                manageUpdate(!0),
                10 < m.tracking.length || lastSubUrl != "0-0-0-0-" + manageSortType && (manageHasMultipleDomains || 0 != manageFilter_rootcat || 0 != manageFilter_condition || 0 != manageFilter_merchant) ? ($("#showFilter").hide(),
                $("#showFilter").next().show()) : $("#showFilter").click(function() {
                    $(this).hide();
                    $(this).next().fadeIn()
                }),
                addLightningBox(m.completeProducts))
            }
        }
    } else
        $("#managePage").show(),
        $("#detailProductPage").remove(),
        $("#productOverlay").hide(),
        noTrackings(),
        $("#filter").hide()
}
function deleteProductFilterListing(a) {
    for (var b = 0; b < manageData.tracking.length; b++)
        if (manageData.tracking[b].TID == a) {
            var d;
            a: for (d in manageActiveProducts)
                if (manageActiveProducts[d] == b) {
                    manageActiveProducts.splice(d, 1);
                    for (a = d; a < manageActiveProducts.length; a++)
                        manageActiveProducts[a]--;
                    break a
                }
            manageData.tracking.splice(b, 1);
            break
        }
    for (var h in manageFilter)
        for (var m in manageFilter[h])
            for (a = 0; a < manageFilter[h][m].length; a++)
                if (manageFilter[h][m][a] == b) {
                    manageFilter[h][m].splice(a, 1);
                    break
                }
    manageSorter(!0);
    insertFilter()
}
var manageActiveProducts = [];
function insertManageProductsPage(a) {
    var b = a * manageProductsPerPage;
    (function m(h) {
        var t = !1;
        h < manageData.tracking.length && h < b + manageProductsPerPage ? void 0 !== manageActiveProducts[h] ? insertManageProduct(manageActiveProducts[h], h, function(f) {
            setTimeout(function() {
                m(f)
            }, 0)
        }) : ($(document).off("scroll.endless-manage"),
        $("#manage-productList").find(".manage-tableProduct").last().css("borderBottom", "none"),
        t = !0) : (t = !0,
        manageEndlessBusy = !1);
        t && b >= manageActiveProducts.length && ($("#manage-productList").find(".manage-tableProduct").last().css("borderBottom", "none"),
        $(document).off("scroll.endless-manage"))
    }
    )(b)
}
function filterSort(a, b) {
    var d = a.charAt(18)
      , h = b.charAt(18);
    if (d === h)
        return a = a.substr(a.indexOf(">")),
        b = b.substr(b.indexOf(">")),
        a < b ? -1 : 1;
    if (d < h)
        return -1;
    if (d > h)
        return 1
}
var prevTrackSearchText = "";
function insertFilter() {
    if (2 > manageData.tracking.length && 0 == manageDataSearchBackup.length)
        $("#filter").hide(),
        $("#manage-productList").find(".manage-tableProduct").last().css("borderBottom", "none");
    else {
        $("#filter").show();
        for (var a = manageFilter_domain, b = manageFilter_rootcat, d = manageFilter_merchant, h = manageFilter_condition, m = manageFilter_wishlist, t = "", f = "", n = "", r = "", p = "", z = 0 != b ? ' <a href="#!manage/' + a + "-" + h + "-" + d + "-0-" + manageSortType + "-" + m + '">&emsp;<i class="fa fa-times red"></i></a>' : "", F = 0 != d ? ' <a href="#!manage/' + a + "-" + h + "-0-" + b + "-" + manageSortType + "-" + m + '">&emsp;<i class="fa fa-times red"></i></a>' : "", I = 0 != a ? ' <a href="#!manage/0-' + h + "-" + d + "-" + b + "-" + manageSortType + "-" + m + '">&emsp;<i class="fa fa-times red"></i></a>' : "", E = 0 != h ? ' <a href="#!manage/' + a + "-0-" + d + "-" + b + "-" + manageSortType + "-" + m + '">&emsp;<i class="fa fa-times red"></i></a>' : "", K = 0 != m ? ' <a href="#!manage/' + a + "-" + h + "-" + d + "-" + b + "-" + manageSortType + '-0">&emsp;<i class="fa fa-times red"></i></a>' : "", H = 0, V = ["&nbsp;&#x2193;", "&nbsp;&#x2191;"], S = [la._197, la._198, la._199, la._200, "Name", '&ensp;<span id="saveDefault">(' + la._201 + ")</span>"], aa = "", ea = 0; ea < S.length; ea++)
            ea == manageSortType || ea == manageSortType - 5 || 5 == ea ? 5 != ea ? (aa += ' <a href="#!manage/' + a + "-" + h + "-" + d + "-" + b + "-" + (4 < manageSortType ? ea : ea + 5) + '" id="sortListActive">' + S[ea],
            aa = 4 < manageSortType ? aa + V[1] : aa + V[0],
            aa += "</a>&emsp;") : aa += S[ea] : aa += ' <a href="#!manage/' + a + "-" + h + "-" + d + "-" + b + "-" + ea + '">' + S[ea] + "</a>&emsp;";
        replaceHtml("sortList", aa);
        $("#saveDefault").on("click", function() {
            $(this).text(la._44);
            storage.sortDefault = manageSortType;
            settings.send();
            window.setTimeout(function() {
                $("#saveDefault").hide(1E3)
            }, 3E3)
        });
        if (null != manageData.categoriesPerDomain) {
            V = [];
            for (var ra in manageFilterCats)
                if (H++,
                "length" != ra) {
                    S = ra.split("_");
                    var pa = S[0];
                    S = S[1];
                    if (0 != manageFilterCats[ra].length) {
                        aa = manageData.categoriesPerDomain[pa];
                        ea = void 0;
                        try {
                            ea = aa[S].name
                        } catch (za) {
                            ea = "?"
                        }
                        b == S ? (V.push(ea + " (" + manageFilterCats[ra].length + ")&emsp;"),
                        H = 2) : V.push(' <a href="#!manage/' + pa + "-" + h + "-" + d + "-" + S + "-" + manageSortType + "-" + m + '">' + ea + " (" + manageFilterCats[ra].length + ")</a>&emsp;")
                    }
                }
            if (1 < H) {
                V.sort(filterSort);
                for (H = 0; H < V.length; H++)
                    t += V[H];
                t = '<li id="manageFilterCats"><span class="manageFilterLabel">' + la._202 + z + "</span>" + t + "</li>"
            }
        }
        H = 0;
        for (pa in manageFilterDomain)
            H++,
            "length" != pa && 0 != manageFilterDomain[pa].length && (a == pa ? (f += getTldByDomain(pa) + " (" + manageFilterDomain[pa].length + ")&emsp;",
            H = 2) : f += ' <a href="#!manage/' + pa + "-" + h + "-" + d + "-" + b + "-" + manageSortType + "-" + m + '">' + getTldByDomain(pa) + " (" + manageFilterDomain[pa].length + ")</a>&emsp;");
        f = '<li id="manageFilterDomain"><span class="manageFilterLabel">' + la._203 + I + "</span>" + f + "</li>";
        if (2 > H || !manageHasMultipleDomains)
            f = "";
        H = la._88;
        z = la._89;
        for (var ua in manageFilterCondition)
            "length" != ua && 0 != manageFilterCondition[ua].length && (I = 1 == ua ? H : z,
            r = h == ua ? r + (I + " (" + manageFilterCondition[ua].length + ")&emsp;") : r + (' <a href="#!manage/' + a + "-" + ua + "-" + d + "-" + b + "-" + manageSortType + "-" + m + '">' + I + " (" + manageFilterCondition[ua].length + ")</a>&emsp;"));
        r = '<li id="manageFilterCondition"><span class="manageFilterLabel">' + la._204 + E + "</span>" + r + "</li>";
        H = 0;
        for (var na in manageFilterMerchant)
            H++,
            "length" != na && 0 != manageFilterMerchant[na].length && (E = "Amazon" == na ? 1 : na == la._93 ? 2 : na == la._94 ? 3 : 4,
            d == E ? (n += na + " (" + manageFilterMerchant[na].length + ")&emsp;",
            H = 2) : n += ' <a href="#!manage/' + a + "-" + h + "-" + E + "-" + b + "-" + manageSortType + "-" + m + '">' + na + " (" + manageFilterMerchant[na].length + ")</a>&emsp;");
        n = '<li id="manageFilterMerchant"><span class="manageFilterLabel">' + la._205 + F + "</span>" + n + "</li>";
        2 > H && (n = "");
        H = 0;
        F = {};
        for (var qa in manageFilterWishlist)
            "null" != qa && manageData.wishLists[qa] && (F[manageData.wishLists[qa].name] = qa);
        na = Object.keys(F).sort();
        for (var ka in na)
            qa = F[na[ka]],
            null != qa && "null" != qa && 0 != qa && "length" != qa && 0 != manageFilterWishlist[qa].length && (H++,
            E = (E = manageData.wishLists[qa]) ? E.name : "?",
            m == qa ? (p += E + " (" + manageFilterWishlist[qa].length + ")&emsp;",
            H = 2) : p += ' <a href="#!manage/' + a + "-" + h + "-" + d + "-" + b + "-" + manageSortType + "-" + qa + '">' + E + " (" + manageFilterWishlist[qa].length + ")</a>&emsp;");
        p = '<li id="manageFilterWishlist"><span class="manageFilterLabel">' + la._419 + K + "</span>" + p + "</li>";
        1 > H && (p = "");
        a = "";
        a = "0-0-0-0-0-0" != lastSubUrl ? ' <a href="#!manage/0-0-0-0-0-0">' + la._82 + " (" + manageData.tracking.length + ")</a>" : '<span style="color:#C66">' + la._82 + " (" + manageData.tracking.length + ")</span>";
        replaceHtml("manageShowall", a);
        replaceHtml("filterList", t + f + r + n + p);
        replaceHtml("defaultList", '<span rel="0" ' + (0 == storage.manageView ? 'style="color: tomato"' : 'style="cursor: pointer;"') + ">" + la._97 + '</span>&emsp;<span rel="1" ' + (1 == storage.manageView ? 'style="color: tomato"' : 'style="cursor: pointer;"') + ">" + la._96 + "</span>");
        replaceHtml("operationsList", '<span class="operations" id="deleteOp"><i class="fa fa-trash" ></i> ' + la._379 + " (" + manageActiveProducts.length + ')</span>&emsp;<span class="operations" id="exportOp"><i class="fa fa-floppy-o" ></i> ' + la._393 + " (" + manageActiveProducts.length + ')</span>&emsp;<span class="operations" id="viewerOp"><i class="fa fa-th" ></i> Open in Viewer (' + (manageActiveProducts.length + ")</span>"));
        $("#trackSearchBar").off().on("change", function(za) {
            try {
                var J = za.srcElement.value
            } catch (A) {
                J = $("#trackSearchBar").val()
            }
            var g = function() {
                $("#trackClearSearch").remove();
                $("#trackingSearchFeedback").hide(0);
                0 < manageDataSearchBackup.length && (manageData.tracking = manageDataSearchBackup)
            };
            g();
            if ("" == J)
                0 < manageDataSearchBackup.length && manageUpdate(!0);
            else {
                prevTrackSearchText = J;
                za = [];
                var D = J.split(" ");
                J = [];
                for (var N = 0; N < D.length; N++)
                    J.push(new RegExp(".*" + RegExp.escape(D[N]) + ".*","i"));
                D = 0;
                for (N = manageData.tracking.length; D < N; D++) {
                    for (var ba = manageData.tracking[D], q = 0, L = 0; L < J.length; L++)
                        J[L].test(ba.TITLE) && q++;
                    q == J.length && za.push(D)
                }
                if (0 == za.length)
                    $("#trackingSearchFeedback").hide(0),
                    $("#trackingSearchNone").show(0);
                else {
                    $("#trackingSearchNone").hide(0);
                    J = 1 == za.length ? la._389 : la._390.replace("X", za.length);
                    $("#trackingSearchFeedback").text(J).show(0);
                    $("#trackingSearchFeedback").on("click", function() {
                        $("html, body").velocity({
                            scrollTop: $("#manage-productList").offset().top - 30
                        }, 200)
                    });
                    manageDataSearchBackup = manageData.tracking.slice();
                    manageData.tracking = [];
                    D = 0;
                    for (N = za.length; D < N; D++)
                        manageData.tracking.push(manageDataSearchBackup[za[D]]);
                    manageActiveProducts = za;
                    $("#trackSearchBar").after('<i id="trackClearSearch" style="vertical-align: middle; cursor: pointer" class="fa fa-times fa-lg red"></i>&emsp;');
                    $("#trackClearSearch").on("click", function() {
                        g();
                        $("#trackSearchBar").val("");
                        manageUpdate(!0)
                    });
                    manageUpdate(!0)
                }
            }
        });
        $("#exportOp").on("click", function() {
            var za = la._394.replace("0", manageActiveProducts.length);
            showPopup('<i class="fa fa-floppy-o"></i>&ensp;' + la._393, '<span id="messageOp"><div>' + za + '</div><span style="font-size:larger"><br>&emsp;&emsp;<span class="settings-chpw" id="continueOpCSV">\u00bb CSV</span>&emsp;&emsp;<span class="settings-chpw" id="continueOpJSON">\u00bb JSON</span></span></div></span>', !0);
            var J = function(g) {
                var D = {
                    trackedProducts: []
                };
                for (ba in manageActiveProducts) {
                    var N = manageData.tracking[manageActiveProducts[ba]];
                    null != N && (N = {
                        trackingId: N.TID,
                        ASIN: N.ASIN,
                        title: N.TITLE,
                        amazonLocale: getTldByDomain(N.domainId),
                        currency: getCurrencyCodeByDomain(N.domainId),
                        lastUpdate: 6E4 * (N.LASTUPDATE + 60 * offsetHours),
                        startedTracking: N.CDATE,
                        currentPriceAmazon: N.AMAZON_LAST,
                        currentPriceMarketNew: N.MARKET_NEW_LAST,
                        currentPriceMarketUsed: N.MARKET_USED_LAST,
                        desiredPriceAmazon: N.PRICE_AMAZON,
                        desiredPriceMarketNew: N.PRICE_NEW,
                        desiredPriceMarketUsed: N.PRICE_USED,
                        keepaURL: "https://keepa.com/#!product/" + N.domainId + "-" + N.ASIN,
                        amazonURL: "http://www.amazon." + getTldByDomain(N.domainId) + "/dp/" + N.ASIN
                    },
                    D.trackedProducts.push(N))
                }
                if ("json" === g)
                    var ba = "data:application/json;charset=utf-8," + encodeURIComponent(JSON.stringify(D, null, "\t"));
                else {
                    ba = ["Tracking ID,ASIN,Title,Amazon Locale,Currency,Last Update (Unix Time),Tracking Start (Unix Time),Current Amazon Price,Current Market New Price,Current Market Used Price,Desired Price Amazon,Desired Price Market New,Desired Price Market Used,Keepa URL,Amazon URL"];
                    for (var q in D.trackedProducts)
                        N = D.trackedProducts[q],
                        null != N && (N.title = N.title.replace(/,/g, ""),
                        ba.push([N.trackingId, N.ASIN, N.title, N.amazonLocale, N.currency, N.lastUpdate, N.startedTracking, N.currentPriceAmazon, N.currentPriceMarketNew, N.currentPriceMarketUsed, N.desiredPriceAmazon, N.desiredPriceMarketNew, N.desiredPriceMarketUsed, N.keepaURL, N.amazonURL].join()));
                    ba = "data:attachment/csv;charset=utf-8," + encodeURIComponent(ba.join("\r\n"))
                }
                D = document.createElement("a");
                D.href = ba;
                D.target = "_blank";
                D.download = "keepaTrackingData" + (new Date).formatDate("Ymd") + "_" + storage.username.replace(/\s+/, "") + "." + g;
                document.body.appendChild(D);
                D.click();
                document.body.removeChild(D)
            };
            $("#continueOpJSON").on("click", function() {
                J("json")
            });
            $("#continueOpCSV").on("click", function() {
                J("csv")
            })
        });
        $("#viewerOp").on("click", function() {
            var za = {}, J;
            for (J in manageActiveProducts) {
                var g = manageData.tracking[manageActiveProducts[J]];
                null != g && (za[g.domainId] || (za[g.domainId] = []),
                za[g.domainId].push(g.ASIN))
            }
            za.listId = Guid.newGuid();
            window.location.href = "#!viewer/" + encodeURIComponent(JSON.stringify(za))
        });
        $("#deleteOp").on("click", function() {
            for (var za = la._381.replace("0", manageActiveProducts.length), J = "", g, D, N = manageActiveProducts.length, ba = 9 > N ? "100" : 18 < N ? "35" : "70", q = 0; q < N && 96 > q; q++)
                g = manageData.tracking[manageActiveProducts[q]].IMAGES[0],
                D = g.substring(g.length - 4, g.length),
                ".gif" == D || ".jpg" == D || ".png" == D ? g = g.substring(0, g.length - 4) : D = ".jpg",
                J += '<div class="productIcon" style="width: ' + ba + "px; height: " + ba + "px; background:" + (83 < q && 95 < N ? "linear-gradient(to bottom, rgba(255,255,255,0) 17%, rgba(255,255,255,1) 90%)," : "") + "url(" + ("" != g ? imageServer + g + "._SL" + ba + "_" + D : imgCDNUrl + "no-photo-available.png") + ') no-repeat center center"></div>';
            var L = showPopup('<i class="fa fa-trash-o"></i>&ensp;' + la._379, '<span id="messageOp"><div>' + za + '</div><div style="margin: 20px">' + J + '<br><br><span style="font-size:larger"><span class="settings-chpw" id="continueOp">\u00bb ' + la._379 + '</span>&emsp;&emsp;<span class="settings-chpw" style="color: tomato" id="abortOp">&#x2715; ' + la._380 + "</span></span></div></span>", !0);
            $("#continueOp").on("click", function() {
                function A() {
                    if (M < P.length) {
                        deletionPromise = $.Deferred();
                        deletionPromise.done(A).fail(O);
                        var u = [];
                        if (10 < P.length) {
                            for (var v = 0; M < P.length && 50 > v; v++,
                            M++)
                                u.push(P[M]);
                            deleteTrackings(u)
                        } else
                            deleteTrackings([P[M]]),
                            M++;
                        u = Math.round(M / P.length * 100);
                        $("#progressBarPercent").text(u + "%");
                        $("#progressBarProgress").css("width", u + "%")
                    } else
                        deletionPromise = $.Deferred(),
                        stopBulkOperation(),
                        L.close()
                }
                function O() {
                    replaceHtml("messageOp", la._error);
                    $("#shareChartOverlay-close").show();
                    stopBulkOperation();
                    reportBug(null, "manage bulk delete fail")
                }
                $("#shareChartOverlay-close").hide();
                replaceHtml("messageOp", '<div id="progressBar"><div id="progressBarProgress"></div><div id="progressBarPercent"></div></div><br>');
                startBulkOperation();
                var P = [];
                for (M in manageActiveProducts)
                    try {
                        P.push(manageData.tracking[manageActiveProducts[M]].TID)
                    } catch (u) {
                        reportBug(u, "activeCache")
                    }
                var M = 0;
                A()
            })
        });
        $("#defaultList > span").on("click", function() {
            $(this).attr("rel") != storage.manageView && (storage.manageView = 0 == storage.manageView ? 1 : 0,
            settings.send(),
            manageUpdate(!0))
        });
        $("#trackingSearch,#sortList,#filterList,#operationsList,#defaultList").on("mouseenter", function() {
            $(this).prev(".subsubHeadline").children().not("#manageShowall").css("color", "tomato")
        }).on("mouseleave", function() {
            $(this).prev(".subsubHeadline").children().not("#manageShowall").css("color", "#444")
        })
    }
}
var bulkOperationInProgress = !1;
function startBulkOperation() {
    return bulkOperationInProgress ? !1 : bulkOperationInProgress = !0
}
function stopBulkOperation() {
    bulkOperationInProgress = !1;
    manageUpdate(!0)
}
function getIsDrop(a, b) {
    var d = !0;
    if (null == a.tracking.thresholdValues || 0 == a.tracking.thresholdValues.length)
        return d;
    var h = a.tracking.thresholdValues.find(function(m) {
        return m.csvType == b && m.domain == a.domainId
    });
    h && !1 === h.isDrop && (d = !1);
    return d
}
function insertProductFilterListing(a) {
    var b = manageFilter_domain
      , d = manageFilter_rootcat
      , h = manageFilter_merchant
      , m = manageFilter_condition
      , t = manageFilter_wishlist
      , f = manageData.tracking[a]
      , n = !1;
    -1 != f.AMAZON_LAST && (n = getIsDrop(f, CsvType.AMAZON.index) ? 0 >= f.AMAZON_LAST - f.PRICE_AMAZON : 0 <= f.AMAZON_LAST - f.PRICE_AMAZON);
    n || (-1 != f.MARKET_NEW_LAST && (n = getIsDrop(f, CsvType.NEW.index) ? 0 >= f.MARKET_NEW_LAST - f.PRICE_NEW : 0 <= f.MARKET_NEW_LAST - f.PRICE_NEW),
    n || -1 != f.MARKET_USED_LAST && (n = getIsDrop(f, CsvType.USED.index) ? 0 >= f.MARKET_USED_LAST - f.PRICE_USED : 0 <= f.MARKET_USED_LAST - f.PRICE_USED));
    n = n ? 1 : 2;
    var r = !1;
    if (f.trackedDomains)
        for (var p in f.trackedDomains)
            if (p == b) {
                r = !0;
                break
            }
    if (0 != d && f.ROOTCAT != d || 0 != b && f.domainId != b && !r || 0 != m && n != m || 0 != t && f.wishListId != t || 0 != h && (-1 == f.PRICE_AMAZON && 1 == h || -1 == f.PRICE_NEW && 2 == h || -1 == f.PRICE_USED && 3 == h || (0 <= f.PRICE_AMAZON || 0 <= f.PRICE_NEW || 0 <= f.PRICE_USED) && 4 == h))
        return !1;
    void 0 === manageFilterCats[f.domainId + "_" + f.ROOTCAT] && (manageFilterCats[f.domainId + "_" + f.ROOTCAT] = []);
    manageFilterCats[f.domainId + "_" + f.ROOTCAT].push(a);
    "undefined" == typeof manageFilterDomain[f.domainId] && (manageFilterDomain[f.domainId] = []);
    if (f.trackedDomains)
        for (p in f.trackedDomains)
            "undefined" == typeof manageFilterDomain[p] && (manageFilterDomain[p] = []),
            manageFilterDomain[p].push(a);
    void 0 === manageFilterCondition[n] && (manageFilterCondition[n] = []);
    manageFilterCondition[n].push(a);
    void 0 === manageFilterWishlist[f.wishListId] && (manageFilterWishlist[f.wishListId] = []);
    manageFilterWishlist[f.wishListId].push(a);
    b = !0;
    void 0 === manageFilterMerchant.Amazon && (manageFilterMerchant.Amazon = []);
    0 <= f.PRICE_AMAZON && (manageFilterMerchant.Amazon.push(a),
    b = !1);
    void 0 === manageFilterMerchant[la._93] && (manageFilterMerchant[la._93] = []);
    0 <= f.PRICE_NEW && (manageFilterMerchant[la._93].push(a),
    b = !1);
    void 0 === manageFilterMerchant[la._94] && (manageFilterMerchant[la._94] = []);
    0 <= f.PRICE_USED && (manageFilterMerchant[la._94].push(a),
    b = !1);
    b && (void 0 === manageFilterMerchant.None && (manageFilterMerchant.None = []),
    manageFilterMerchant.None.push(a));
    return !0
}
function insertManageProduct(a, b, d) {
    if (!bulkOperationInProgress) {
        var h = manageData.tracking[a];
        null != h && ("undefined" !== typeof h.productType && 2 <= h.productType && 5 >= h.productType ? (deleteTrackings([h.ASIN]),
        d(1 + b)) : "undefined" !== typeof h.productType ? onPriceHistoryLoadManage(h, a, b, d) : ($("#loadingIcon").show(),
        network.request({
            path: "product",
            history: !0,
            type: "ws",
            domainId: h.domainId,
            asin: h.ASIN,
            refreshProduct: !1,
            version: 3,
            maxAge: 15
        }).done(function(m) {
            $("#loadingIcon").hide();
            null == m || null == m.products || 1 != m.products.length ? d(1 + b) : (m = m.products[0],
            h.productType = m.productType,
            2 <= h.productType && 5 >= h.productType ? (deleteTrackings([h.ASIN]),
            d(1 + b)) : (h.AMAZON = m.csv[CsvType.AMAZON.index],
            h.MARKET_NEW = m.csv[CsvType.NEW.index],
            h.MARKET_USED = m.csv[CsvType.USED.index],
            h.SALESRANK = m.csv[CsvType.SALES.index],
            h.csv = m.csv,
            h.buyBoxSellerIdHistory = m.buyBoxSellerIdHistory,
            h.offers = m.offers,
            h.stats = getStatistics(h),
            onPriceHistoryLoadManage(h, a, b, d)))
        }).fail(function() {
            d(1 + b)
        })))
    }
}
function onPriceHistoryLoadManage(a, b, d, h) {
    var m = getCurrencyByDomain(a.domainId)
      , t = getTldByDomain(a.domainId)
      , f = '<a href="' + getAmazonRedirectByDomain(a.domainId, a.ASIN) + '" rel="amazon"><span class="manage-condmet">' + la._88 + '&nbsp;<i class="fa fa-check fa-lg"></i></span></a>'
      , n = la._89;
    if (-1 != a.AMAZON_LAST) {
        Money.raw(a.AMAZON_LAST, {
            sourceDomainId: a.domainId,
            targetDomainId: a.domainId
        });
        var r = getIsDrop(a, CsvType.AMAZON.index) ? 0 > a.diffAmazon || 0 == a.diffAmazon && 0 <= a.PRICE_AMAZON ? f : n : 0 < a.diffAmazon || 0 == a.diffAmazon && 0 <= a.PRICE_AMAZON ? f : n;
        Money.raw(a.diffAmazon, {
            sourceDomainId: a.domainId,
            targetDomainId: a.domainId
        })
    } else
        r = n;
    var p = 0 <= a.PRICE_AMAZON ? a.PRICE_AMAZON : 0;
    if (-1 != a.MARKET_NEW_LAST) {
        Money.raw(a.MARKET_NEW_LAST, {
            sourceDomainId: a.domainId,
            targetDomainId: a.domainId
        });
        var z = getIsDrop(a, CsvType.NEW.index) ? 0 > a.diffNew || 0 == a.diffNew && 0 <= a.PRICE_NEW ? f : n : 0 < a.diffNew || 0 == a.diffNew && 0 <= a.PRICE_NEW ? f : n;
        Money.raw(a.diffNew, {
            sourceDomainId: a.domainId,
            targetDomainId: a.domainId
        })
    } else
        z = n;
    var F = 0 <= a.PRICE_NEW ? a.PRICE_NEW : 0;
    if (-1 != a.MARKET_USED_LAST) {
        Money.raw(a.MARKET_USED_LAST, {
            sourceDomainId: a.domainId,
            targetDomainId: a.domainId
        });
        var I = getIsDrop(a, CsvType.USED.index) ? 0 > a.diffUsed || 0 == a.diffUsed && 0 <= a.PRICE_USED ? f : n : 0 < a.diffUsed || 0 == a.diffUsed && 0 <= a.PRICE_USED ? f : n;
        Money.raw(a.diffUsed, {
            sourceDomainId: a.domainId,
            targetDomainId: a.domainId
        })
    } else
        I = n;
    var E = 0 <= a.PRICE_USED ? a.PRICE_USED : 0;
    var K = n;
    a: for (aa in a.MULTI_CSV)
        for (var H in a.MULTI_CSV[aa]) {
            var V = a.MULTI_CSV[aa][H].current
              , S = a.MULTI_CSV[aa][H].desired;
            V = Money.raw(V, {
                sourceDomainId: aa,
                targetDomainId: a.domainId,
                keepUnit: !0
            });
            if (-1 != V && (K = -1 == V ? 0 : 0 == S ? 0 : V - S,
            K = getIsDrop(a, H) ? 0 > K || 0 == K && 0 != S ? f : n : 0 < K || 0 == K && 0 != S ? f : n)) {
                f = '<a title="' + la._88 + " (" + getTldByDomain(aa) + ')" href="' + getAmazonRedirectByDomain(aa, a.ASIN) + '" rel="amazon"><span class="manage-condmet">' + la._88 + '&nbsp;<img src="' + imgCDNUrl + 'good.png" /></span></a>';
                break a
            }
        }
    f = (r = r != n || z != n || I != n || K != n) ? f : n;
    a.condMet = r;
    a.desiredPrices = [parseFloat(p), parseFloat(F), parseFloat(E)];
    r = "";
    n = keepaTime.now();
    if (globalEbayArray[a.domainId]) {
        r = 'style="color:#888"';
        z = "unverified if sold on eBay";
        if (20160 > n - getLastTime(a.csv[CsvType.EBAY_NEW_SHIPPING.index], CsvType.EBAY_NEW_SHIPPING) || 20160 > n - getLastTime(a.csv[CsvType.EBAY_USED_SHIPPING.index], CsvType.EBAY_USED_SHIPPING))
            r = 'style="color:#000"',
            z = "show on eBay";
        r = '<li class="manage-tabItem tabAmazon" style="margin-left:0 !important;"><a class="ebayLink" target="_blank" href="' + getEbayRedirectByDomain(a.domainId, a.ASIN, !0) + '" rel="ebay" title="' + z + '" ' + r + '><span>e</span><span style="margin-left: -2px;">b</span><span style="margin-left: -2px;">a</span><span style="margin-left: -2px;">y</span></a>'
    }
    t = '<div class="tabBox"><div><ul class="manage-tabHead"><li class="manage-tabItem manage-tabHistory active" rel="history">' + la._97 + '</li><li class="manage-tabItem manage-tabMonitor " rel="monitor">' + la._96 + '</li><li class="manage-tabItem tabTrack"><a href="#!track/' + a.domainId + "-" + a.ASIN + '">&rarr;&emsp;' + la._98 + '</a></li><li class="manage-tabItem tabAmazon"><a href="' + getAmazonRedirectByDomain(a.domainId, a.ASIN) + '" rel="amazon"><span>&rarr;&ensp;</span>' + la._99 + '&emsp;<img class="amznLogo" src="' + imgCDNUrl + "/amazon/small/" + t + '.png"><span style="margin-left: 10px;">' + la._99_2 + "</span></a>" + r + "</li></ul></div></div>";
    n = "" + (droppedSinceLastVisit(a.deltaA, a.domainId, m, 1) + droppedSinceLastVisit(a.deltaN, a.domainId, m, 2) + droppedSinceLastVisit(a.deltaU, a.domainId, m, 3));
    r = prettyDate((manageData.timeStamp - manageData.lastVisit) / 6E4);
    n = "" != n ? la._206 + " (" + r + "):&emsp;" + n : 0 != manageData.lastVisit ? la._207 + " (" + r + ")." : "";
    r = "" + (droppedSinceLastVisit(a.deltaCA, a.domainId, m, 1) + droppedSinceLastVisit(a.deltaCN, a.domainId, m, 2) + droppedSinceLastVisit(a.deltaCU, a.domainId, m, 3));
    z = prettyDate((manageData.timeStamp - a.CDATE) / 6E4);
    r = "" != r ? la._208 + " (" + z + "):&emsp;" + r : la._209 + " (" + z + ").";
    I = z = "";
    null != a.IMAGES && 0 < a.IMAGES.length && null != a.IMAGES[0] && (I = a.IMAGES[0].substring(a.IMAGES[0].length - 4, a.IMAGES[0].length),
    ".gif" == I || ".jpg" == I ? z = a.IMAGES[0].substring(0, a.IMAGES[0].length - 4) : (z = a.IMAGES[0],
    I = ".jpg"));
    z = "" != z ? imageServer + z + "._SL135_" + I : imgCDNUrl + "no-photo-available.png";
    I = parseCurrentProductPrices(a, a.domainId, manageData.timeStamp);
    var aa = a.wishListId;
    H = "";
    null != aa && null != manageData.wishLists[aa] && (H = manageData.wishLists[aa],
    H = '&emsp;<span style="font-size: 12px; color: #999;" id="' + aa + '">' + la._558 + ': <a href="' + getAmazonWishListUrl(H) + '" style="color: rgb(106, 106, 106);">' + H.name + "</a></span>");
    b = '<tr class="manage-tableRow" rel="' + a.TID + '"><td class="manage-tableRemove"><div class="manage-removeDiv"><div class="manage-remove" title="' + la._100 + '"><i class="fa fa-trash-o fa-lg"></i></div></div></td><td class="manage-tableProduct"><table class="manage-tableProductTable"><tr class="manage-tableProductTableFirstRow"><td class="manage-productImage" style="background:url(' + z + ') no-repeat center center"></td><td class="manage-productOverview"><div class="manage-productOverviewUndo" style="display:none">' + la._84 + '</div><div class="manage-productOverviewDiv"><div class="manage-productFlag" style="background:url(' + flags[a.domainId] + ') no-repeat right top"></div><div class="manage-productTitle"><a href="#!product/' + a.domainId + "-" + a.ASIN + '">' + stripHTML(a.TITLE) + "</a>" + H + "<br></div>" + I + t + '<div class="manage-tabContent"><div id="manage-graph-history-' + b + '" class="manage-graph graph"></div><div id="manage-graph-' + b + '" rel="monitor" class="manage-graph inactive">' + generateMonitorTab(m, a.domainId, a.MULTI_CSV, p, a.AMAZON_LAST, F, a.MARKET_NEW_LAST, E, a.MARKET_USED_LAST) + n + "<br>" + r + '</div></div><div><div class="manage-productConditionDiv">' + la._87 + "?&emsp;" + f + "</div>&emsp;&emsp;</div></div></td></tr></table></td></tr>";
    $("#manage-productList").append(b);
    manage_addEvents($("#manage-productList").find(".manage-tableRow").last());
    a.timeStamp = serverTimeStamp;
    b = $('#manage-productList tr[rel="' + a.ASIN + '"] div[id^="manage-graph-history"]');
    p = graph.prepare(a.domainId);
    p.csv = a.csv;
    p.asin = a.ASIN;
    p.graphIndex = 0;
    p.isOnTrackingPage = !0;
    p.stats = a.stats;
    p.buyBoxSellerIdHistory = a.buyBoxSellerIdHistory;
    p.offers = a.offers;
    p.parameter.height = "170px";
    p.parameter.width = float2int(b.parent().width()) - 215 + "px";
    p.$container = b;
    p.$container.show();
    p.parameter.tracking = a.tracking;
    0 != b.length && (graph.create(p),
    b.attr("rel", "history"),
    1 == storage.manageView && $(".manage-tabMonitor").trigger("click"),
    b = !1,
    null != a.tracking.thresholdValues && 0 < a.tracking.thresholdValues.length && (b = a.tracking.thresholdValues.some(function(ea) {
        return !ea.isDrop && 0 <= ea.thresholdValueCSV[ea.thresholdValueCSV.length - 1]
    })),
    b && (isTest && console.info("%cManage: skip product due to price increase tracking \u27fc ", "color:#6666bf;font-weight:bold;", a.ASIN),
    a = $('.manage-tableRow[rel="' + a.ASIN + '"]'),
    a.find(".manage-tabContent").html('<p class="hint__tracking--important">' + la._708 + "</p>"),
    a.find(".switch-manage-trigger").on("click", function() {
        $("#switch-manage").click()
    })),
    h(1 + d))
}
function generateMonitorTab(a, b, d, h, m, t, f, n, r) {
    var p = {
        sourceDomainId: b,
        targetDomainId: b,
        skipSymbol: !0
    }
      , z = -1 == m ? "-" : 0 == h ? "-" : Money.format(m - h, p)
      , F = -1 == f ? "-" : 0 == t ? "-" : Money.format(f - t, p)
      , I = -1 == r ? "-" : 0 == n ? "-" : Money.format(r - n, p);
    m = -1 == m ? 0 : m;
    f = -1 == f ? 0 : f;
    r = -1 == r ? 0 : r;
    return '<table class="manage-monitorTab"><tr class="borderBottom"><td class="borderRight">' + a + "</td><td>" + la._342 + "</td><td>" + la._344 + "</td><td>" + la._343 + '</td></tr><tr><td class="borderRight priceAmazon">Amazon</td><td>' + zeroToDash(Money.format(h, p)) + "</td><td>" + zeroToDash(Money.format(m, p)) + "</td><td>" + greenOrRed(z) + '</td></tr><tr><td class="borderRight priceNew">' + la._93 + "</td><td>" + zeroToDash(Money.format(t, p)) + "</td><td>" + zeroToDash(Money.format(f, p)) + "</td><td>" + greenOrRed(F) + '</td></tr><tr><td class="borderRight priceUsed">' + la._94 + "</td><td>" + zeroToDash(Money.format(n, p)) + "</td><td>" + zeroToDash(Money.format(r, p)) + "</td><td>" + greenOrRed(I) + '</td></tr></table><div class="customCheckbox" style="white-space: nowrap;">' + getInternationalTrackingManage(b, d, h, t, n) + "</div><br>"
}
function getInternationalTrackingManage(a, b, d, h, m) {
    d = "";
    h = [];
    for (m = 1; m < numberOfDomains; m++)
        if (7 != m) {
            var t = "checkbox-label"
              , f = "";
            if (b[m]) {
                t += " checkbox-label-disabled";
                var n = ' checked="checked" disabled="true"';
                for (var r = 0; 3 > r; r++)
                    if (b[m][r]) {
                        var p = CsvType.getName(r);
                        0 == r && (p += "." + getTldByDomain(m));
                        0 < f.length && (f += "<br><br>");
                        var z = la._355 + " " + p + ": " + Money.format(b[m][r].desired, {
                            sourceDomainId: a,
                            targetDomainId: a
                        })
                          , F = b[m][r].desired == b[m][r].desiredInNativeCurrency ? "" : " (" + Money.format(b[m][r].desiredInNativeCurrency, {
                            sourceDomainId: m,
                            targetDomainId: m
                        }) + ")";
                        p = -1 == b[m][r].current ? "" : "<br>" + la._356 + " " + p + ": " + Money.format(b[m][r].currentInMainCurrency, {
                            sourceDomainId: a,
                            targetDomainId: a
                        });
                        var I = b[m][r].current == b[m][r].currentInMainCurrency || -1 == b[m][r].current ? "" : " (" + Money.format(b[m][r].current, {
                            sourceDomainId: m,
                            targetDomainId: m
                        }) + ")";
                        f += z + F + p + I
                    }
            } else
                t += " checkbox-label-disabled",
                n = ' disabled="true"',
                f = la._83;
            r = Date.now();
            h[m] = '<input id="checkbox_' + checkboxNameArray[m] + "_" + r + '" class="checkbox" type="checkbox" name="' + checkboxNameArray[m] + '" value="' + m + '"' + n + '><label title="' + f + '" for="checkbox_' + checkboxNameArray[m] + "_" + r + '" name="label_' + checkboxNameArray[m] + '" domain="' + m + '" class="' + t + '">' + getTldByDomain(m) + "</label>&emsp;"
        }
    return d += la._352 + ":&emsp;" + h[1] + h[6] + h[11] + "&emsp;" + la._353 + ":&emsp;" + h[2] + h[3] + h[4] + h[8] + h[9] + "&emsp;" + la._354 + ":&emsp;" + h[5] + h[10] + la._663 + ":&emsp;" + h[13]
}
;var databaseDeals = null
  , dealsTotalResults = 1E4
  , dealWrapperInstance = function() {
    var a = null;
    return {
        get: function() {
            null == a && (a = dealWrapper());
            return a
        }
    }
}()
  , dealWrapper = function() {
    function a() {
        try {
            ua = ua || cw({
                initDatabase: function(A, O) {
                    importScripts("localforage.min.1.6.0.js");
                    (asyncSupported = localforage.supports(localforage.INDEXEDDB)) ? (pa = localforage.createInstance(A),
                    pa.getItem("test").then(function(P) {
                        asyncSupported = !0;
                        O(!0)
                    }).catch(function(P) {
                        asyncSupported = !1;
                        O(!1)
                    })) : O(!1)
                },
                removeOudatedCacheEntries: function(A, O) {
                    if (asyncSupported) {
                        var P = A.now
                          , M = A.days
                          , u = [];
                        M = Number(M) || 7;
                        pa.iterate(function(v, G, w) {
                            P - v > 1440 * M && u.push(G)
                        }).then(function() {
                            if (0 < u.length) {
                                console.log("Clearing old visited deals items: ", u.length);
                                for (var v in u)
                                    pa.removeItem(u[v])
                            }
                        }).catch(function(v) {
                            console.log(v)
                        })
                    }
                }
            })
        } catch (A) {
            console.error(A)
        }
    }
    function b() {
        localforage.supports(localforage.INDEXEDDB) && (pa = pa || localforage.createInstance(qa),
        pa.getItem("test").then(function(A) {}).catch(function(A) {
            pa = null
        }),
        ua.initDatabase().then(function(A) {}));
        databaseDeals = pa
    }
    function d(A) {
        A.css("background", "#fff url(" + imgCDNUrl + "cancel_8.png) center no-repeat");
        A.attr("title", "clear search parameter")
    }
    function h(A) {
        A && (J.page = 0,
        storage["dealsRequest." + A] = JSON.stringify(J),
        settings.send())
    }
    function m(A, O) {
        if (A = storage["dealsRequest." + A])
            if (A = tryParseJSON(A),
            null != A) {
                A.page = 0;
                A.dateRange || (A.dateRange = 1);
                A.minRating && [10, 20, 30, 40, 50].includes(Number(A.minRating)) || (A.minRating = -1);
                for (var P in A)
                    J[P] = A[P]
            }
        if (!O && lastSubUrl)
            try {
                var M = JSON.parse(decodeURIComponent(lastSubUrl)), u;
                for (u in M)
                    if ("page" != u) {
                        var v = M[u];
                        "minRating" !== u || [10, 20, 30, 40, 50].includes(Number(v)) || (v = -1);
                        "undefined" != J[u] && (J[u] = v);
                        "domainId" == u && null != v && verifyRegExp.domainId.test(v) && (storage.domainId = v,
                        refreshDomain())
                    }
            } catch (G) {}
        if (null != J.excludeCategories && ("number" == typeof J.excludeCategories[0] || 0 == J.includeCategories.length)) {
            O = J.excludeCategories.slice();
            J.excludeCategories = [];
            for (P = 0; P < numberOfDomains; P++)
                J.excludeCategories[P] = [];
            J.excludeCategories[storage.domainId] = O
        }
        if (null != J.includeCategories && ("number" == typeof J.includeCategories[0] || 0 == J.includeCategories.length)) {
            O = J.includeCategories.slice();
            J.includeCategories = [];
            for (P = 0; P < numberOfDomains; P++)
                J.includeCategories[P] = [];
            J.includeCategories[storage.domainId] = O
        }
        O = $jscomp.makeIterator(["isBackInStock", "warehouseCondition"]);
        for (P = O.next(); !P.done; P = O.next())
            P = P.value,
            "undefined" !== typeof J[P] && delete J[P];
        return J
    }
    function t() {
        if (!0 !== N) {
            $(document).off("scroll.endless-deals");
            N = !0;
            var A = showReferencePrice(Number(storage.domain)) ? " with-reference" : ""
              , O = $(".productPage");
            null != O && 0 < O.length && (J.page = O.length);
            var P = $(O[O.length - 1]);
            P.find(".productContainer").length < O.perPage || (150 * J.page >= dealsTotalResults ? P.after('<div id="productPage' + J.page + '" class="productPage' + A + '">Reached last deal for your selection.</div>') : 1E4 <= 150 * J.page ? P.after('<div id="productPage' + J.page + '" class="productPage' + A + '">Reached maximum allowed page. Please use the filters.</div>') : (P.after('<div id="productPage' + J.page + '" class="productPage' + A + '"></div>'),
            $("#loadingIcon").show(),
            p()))
        }
    }
    function f(A) {
        A && 0 != J.page || F();
        A && 0 == J.page && (h("last"),
        $("#filterBar").hide(),
        $("#dealsTitleSearchResults").text(""));
        0 === J.page && n()
    }
    function n() {
        for (var A = 0; 0 < $("#productPage" + A).length; )
            replaceHtml("productPage" + A, ""),
            0 < A && $("#productPage" + A).remove(),
            A++;
        ba = []
    }
    function r(A) {
        0 == storage.domain && (storage.domain = 1);
        A.domainId = storage.domain;
        void 0 == A.excludeCategories[A.domainId] && (A.excludeCategories[A.domainId] = []);
        void 0 == A.includeCategories[A.domainId] && (A.includeCategories[A.domainId] = []);
        var O = A.excludeCategories.slice()
          , P = A.includeCategories.slice();
        A.excludeCategories = A.excludeCategories[A.domainId];
        A.includeCategories = A.includeCategories[A.domainId];
        null == A.salesRankRange[0] && (A.salesRankRange[0] = -1);
        null == A.salesRankRange[1] && (A.salesRankRange[1] = -1);
        if (A.includeCategories instanceof Array) {
            for (var M = [], u = 0; u < A.includeCategories.length; u++) {
                var v = A.includeCategories[u];
                null != v && (v instanceof Array ? reportBug(null, "includeCategories not valid array: " + JSON.stringify(A.includeCategories)) : isNaN(v) || M.push(v))
            }
            A.includeCategories = M
        } else
            reportBug(null, "includeCategories not array: " + JSON.stringify(A.includeCategories)),
            A.includeCategories = [],
            P[A.domainId] = [];
        "number" == typeof A.includeCategories && (A.includeCategories = []);
        "number" == typeof A.excludeCategories && (A.excludeCategories = []);
        v = A.construct;
        A.construct = null;
        M = A.dateRange;
        A.priceTypes[0] === CsvType.LIGHTNING_DEAL.index && (A.dateRange = "0");
        u = network.request({
            path: "service/deals",
            type: "ws",
            version: 3,
            dealRequest: $.extend(!0, {}, JSON.parse(JSON.stringify(A)))
        });
        A.construct = v;
        v = Object.assign({}, A);
        A.excludeCategories = O;
        A.includeCategories = P;
        A.dateRange = M;
        return [u, v]
    }
    function p() {
        N = !0;
        $("#loadingIcon").show();
        f(!0);
        var A = CsvType.getObject(J.priceTypes[0]);
        A.isBeta ? ($("#betaNotice").html(A.isBeta()),
        $("#dealsNotice").removeClass("hidden")) : ($("#dealsNotice").addClass("hidden"),
        $("#betaNotice").html(""));
        J.perPage = 150;
        var O = $jscomp.makeIterator(r(J));
        A = O.next().value;
        O = O.next().value;
        var P = 150 * J.page
          , M = function(u) {
            0 < u.titleSearch.length ? ($("#dealsTitleSearchResults").html('Product title search results for:&emsp;<span style="color: #333333" id="dealsTitleSearchQuery"></span>'),
            $("#dealsTitleSearchQuery").text(u.titleSearch)) : $("#dealsTitleSearchResults").text("")
        };
        J.settings.viewTyp === ra.TABLE ? (M(J),
        replaceHtml("productPage0", '<div id="dealsGrid"></div>'),
        GridDeals.init($.extend(!0, {}, O), "dealsGrid")) : A.done(function(u) {
            $("#loadingIcon").hide();
            u.deals && (u.data = u.deals);
            if (null == u.data)
                showErrorPopup(),
                reportBug(null, "deal error: " + JSON.stringify(J) + "<br>" + JSON.stringify(u));
            else {
                M(J);
                dealsTotalResults = u.totalResults;
                u = u.data;
                for (var v in u.dr)
                    -1 < ba.indexOf(u.dr[v].asin) ? u.dr[v] = null : ba.push(u.dr[v].asin);
                u.products = u.dr;
                for (var G in u.products)
                    if (G = Number(G),
                    v = u.products[G],
                    null != v) {
                        "undefined" == typeof v.imagesCSV && (v.imagesCSV = v.image);
                        try {
                            v.imagesCSV = String.fromCharCode.apply(null, v.imagesCSV)
                        } catch (fa) {}
                        v.domainId = J.domainId;
                        var w = 4 == J.dateRange ? v.dateIntervalIndex : J.dateRange;
                        w || (w = 0);
                        v.delta = v.delta[w];
                        v.deltaPercent = v.deltaPercent[w];
                        v.avg = v.avg[w];
                        v.imagesCSV = null != v.imagesCSV ? v.imagesCSV.split(",") : [""];
                        null == v.deltaLast && (v.deltaLast = Array.apply(null, Array(CsvType.length)).map(Number.prototype.valueOf, 0))
                    }
                try {
                    0 == J.page && K(u.categoryIds, u.categoryNames, u.categoryCount)
                } catch (fa) {
                    console.log(fa)
                }
                if ("undefined" === typeof u.products || 0 == u.products.length)
                    0 === J.page ? replaceHtml("productPage0", '<br><div style="text-align: center; font-weight: bold;">' + la._195 + "</div><br>") : 1 < J.page && (u = '<div class="newPageSeparator"><span class="backToTop">' + la._196 + "</span></div>",
                    G = $("#productPage" + (J.page - 1)),
                    G.append(u),
                    G.children().last().children().click(function() {
                        $("html, body").velocity("scroll", 300);
                        return !1
                    }));
                else {
                    G = "";
                    for (v = 0; v < u.products.length; v++)
                        if (w = u.products[v],
                        null != w) {
                            var B = "";
                            if (sessionStorage[J.domainId + "-" + w.asin])
                                B = "opacity:" + (storage.dealsOpacity || .5) + ";";
                            else if (pa) {
                                var Q = pa.getItem(J.domainId + "-" + w.asin);
                                (function(fa) {
                                    Q.then(function(R) {
                                        R && $("#p" + fa).css("opacity", storage.dealsOpacity || .5)
                                    }).catch(function(R) {})
                                }
                                )(v + P)
                            }
                            G += '<div id="p' + (v + P) + '" class="productContainer" style="min-width: 210px;' + B + '" >' + I(w, P + v) + "</div>"
                        }
                    $("#productPage" + J.page).append(G);
                    0 < J.page && (G = '<div class="newPageSeparator">Page ' + (J.page + 1) + '<span class="backToTop">' + la._196 + "</span></div>",
                    $("#productPage" + J.page).prepend(G).children().first().children().click(function() {
                        $("html, body").velocity("scroll", 300);
                        return !1
                    }));
                    for (v = 0; v < u.products.length; v++)
                        null != u.products[v] && V($("#pB" + (v + P)), u.products[v].asin);
                    N = !1;
                    $(document).endlessScroll({
                        bottomPixels: 1E3,
                        eventName: "endless-deals",
                        callback: function() {
                            0 == $("#productPage0").length ? $(document).off("scroll.endless-deals") : network.waitForNetworkCompletion().always(t)
                        }
                    })
                }
            }
        }).fail(function(u) {
            showErrorPopup();
            storage.removeItem("dealsRequest.last");
            settings.send()
        })
    }
    function z() {
        function A(u, v) {
            return [u.min, v.max == u.max ? 2147483647 : u.max]
        }
        var O = $("#deltaPercentRange")
          , P = $("#deltaRange")
          , M = $("#currentRange");
        J.currentRange = A(M.rangeSlider("values"), M.rangeSlider("bounds"));
        J.deltaPercentRange = A(O.rangeSlider("values"), O.rangeSlider("bounds"));
        J.deltaRange = A(P.rangeSlider("values"), P.rangeSlider("bounds"));
        J.titleSearch = $("#dealSearchBar").val();
        J.page = 0;
        isMobile ? H() : $("#submitDealQuery").trigger("click")
    }
    function F() {
        var A = '<div class="leftPanelBox" style="background-color: rgba(17, 23, 31, 0.5);">\n\t\t\t\t<div class="leftPanelLabel">' + la._660 + '</div>\n\t\t\t\t<div id="dealsViewType">\n\t\t\t\t\t<div data-viewtype="' + ra.TABLE + '"' + (J.settings.viewTyp === ra.TABLE ? ' class="active"' : "") + ">" + la._661 + '&ensp;<i class="fa fa-table"></i></div>\n\t\t\t\t\t<div data-viewtype="' + ra.BOX + '"' + (J.settings.viewTyp === ra.BOX ? ' class="active"' : "") + ">" + la._662 + '&ensp;<i class="fa fa-th-large"></i></div>\n\t\t\t\t</div>\n\t\t\t</div>'
          , O = '<div class="leftPanelBox"><div class="leftPanelLabel">' + la._452 + '</div><div id="dealPriceTypesFilter">';
        for (B in CsvType)
            if ("object" == typeof CsvType[B] && CsvType[B].deal) {
                var P = "";
                for (M in J.priceTypes) {
                    var M = J.priceTypes[M];
                    if (CsvType[B].index == M) {
                        P = ' class="active"';
                        CsvType.SALES.index == M && setTimeout(function() {}, 0);
                        M != CsvType.AMAZON.index && M != CsvType.NEW.index && setTimeout(function() {}, 0);
                        break
                    }
                }
                if ("TRADE_IN" != B || 1 == J.domainId)
                    if ("AMAZON" != B && "USED" != B || 10 != J.domainId) {
                        var u = "";
                        if ("WAREHOUSE" === B) {
                            u = [];
                            u[2] = la._637;
                            u[3] = la._638;
                            u[4] = la._639;
                            u[5] = la._640;
                            var v = "";
                            for (Q in u) {
                                var G = "sub-deal-type-filter-" + CsvType[B].index + "-" + Q
                                  , w = J.warehouseConditions && J.warehouseConditions.includes(Number(Q));
                                v += '<div><input id="' + G + '" type="checkbox"' + (w ? " checked" : "") + ' data-warehousecondition="' + Q + '"><label for="' + G + '">' + u[Q] + "</label></div>"
                            }
                            u = '<div class="sub-deal-type-filter sub-deal-type-filter-' + CsvType[B].index + '">\n\t\t\t\t\t\t\t' + v + "\n\t\t\t\t\t\t</div>"
                        }
                        O += "<div" + P + ' data-type="' + CsvType[B].index + '">' + CsvType.getName(CsvType[B].index) + u + "</div>"
                    }
            }
        O += "</div></div>";
        u = J.isFilterEnabled ? "" : ' class="hidden"';
        var B = J.priceTypes == CsvType.SALES.index ? " hidden" : "";
        M = J.priceTypes[0] == CsvType.SALES.index;
        P = '<div title="' + la._453 + '"><input maxlength="2000" id="dealSearchBar" placeholder="' + la._454 + '"><span id="submitDealSearch"></span></div>';
        var Q = [4 == J.sortType || 0 == J.sortType || -4 == J.sortType, 2 == J.sortType || -2 == J.sortType, 1 == J.sortType, 3 == J.sortType || -3 == J.sortType, 5 == J.sortType || -5 == J.sortType];
        Q[3] = Q[3] || M && Q[4];
        v = 0 <= J.sortType ? 1 : 0;
        if (Q[3] || Q[4])
            v = 0 == v ? 1 : 0;
        v = g[v];
        M = '<div class="leftPanelBox"><div class="leftPanelLabel">' + la._180 + '</div><div id="dealSortType"><div ' + (Q[0] ? 'class="active"' : "") + ' data-sort="percentage">' + la._486 + (Q[0] ? v : "") + "</div><div " + (Q[1] ? 'class="active"' : "") + ' data-sort="drop">' + la._487 + (Q[1] ? v : "") + "</div>" + (M ? "" : "<div " + (Q[4] ? 'class="active"' : "") + ' data-sort="price">' + la._488 + (Q[4] ? v : "") + "</div>") + "<div " + (Q[2] ? 'class="active"' : "") + ' data-sort="newest">' + la._485 + "</div><div " + (Q[3] ? 'class="active"' : "") + ' data-sort="salesRank" title="' + la._457 + '">' + CsvType.getName(CsvType.SALES.index) + (Q[3] ? v : "") + "</div></div></div>";
        Q = J.dateRange;
        v = "";
        J.priceTypes[0] === CsvType.LIGHTNING_DEAL.index && (Q = 0,
        v = ' style="opacity:0.5;"');
        Q = '<div class="leftPanelBox"><div class="leftPanelLabel">' + la._458 + '</div><div id="dealDateRange"><div ' + (0 == Q ? 'class="active"' : "") + ' data-dateRange="0">' + la._136 + "</div><div " + (1 == Q ? 'class="active"' : "") + v + ' data-dateRange="1">' + la._137 + "</div><div " + (2 == Q ? 'class="active"' : "") + v + ' data-dateRange="2">' + la._139 + "</div><div " + (3 == Q ? 'class="active"' : "") + v + ' data-dateRange="3">' + la._140 + "</div><div " + (4 == Q ? 'class="active"' : "") + v + ' data-dateRange="4">' + la._142 + "</div></div></div>";
        u = '<div class="leftPanelBox"><div class="leftPanelLabel"><a title="disable filters" id="panelFilterSelectionDisableCross"><i class="fa fa-caret-down"></i>&ensp;' + la._182 + '</a></div><div id="dealCheckBoxes" ' + u + ">";
        u += '<div><input id="checkboxLowestEver" ' + (J.isLowest ? "checked" : "") + ' type="checkbox"><label for="checkboxLowestEver">' + la._459 + "</label></div>";
        u += '<div class="' + B + '"><input  id="checkboxLowestAll" ' + (J.isLowestOffer ? "checked" : "") + ' type="checkbox"><label title="' + la._460 + '" for="checkboxLowestAll">' + la._461 + "</label></div>";
        u += '<div class="' + B + '"><input  id="checkboxOutOfStock" ' + (J.isOutOfStock ? "checked" : "") + ' type="checkbox"><label for="checkboxOutOfStock">' + la._134 + "</label></div>";
        v = J.priceTypes[0] === CsvType.AMAZON.index;
        u += '<div class="' + B + '">\n\t\t\t\t<input id="checkboxMustHaveAmazonOffer"' + (J.mustHaveAmazonOffer && !v ? " checked" : "") + (v ? " disabled" : "") + ' type="checkbox">\n\t\t\t\t<label for="checkboxMustHaveAmazonOffer">Has Amazon offer</label>\n\t\t\t</div>';
        u += '<div class="' + B + '">\n\t\t\t\t<input id="checkboxMustNotHaveAmazonOffer"' + (J.mustNotHaveAmazonOffer && !v ? " checked" : "") + (v ? " disabled" : "") + ' type="checkbox">\n\t\t\t\t<label for="checkboxMustNotHaveAmazonOffer">No Amazon offer</label>\n\t\t\t</div>';
        u += '<div><input id="checkboxHasReviews" ' + (J.hasReviews ? "checked" : "") + ' type="checkbox"><label for="checkboxHasReviews">' + la._463 + "</label></div>";
        J.priceTypes[0] === CsvType.AMAZON.index && (u += '<div><input id="checkboxIsPrimeExclusive" ' + (J.isPrimeExclusive ? "checked" : "") + ' type="checkbox"><label for="checkboxIsPrimeExclusive">Is Prime exclusive (beta)</label></div>');
        u += '<div><input id="checkboxFilterErotic" ' + (J.filterErotic ? "checked" : "") + ' type="checkbox"><label for="checkboxFilterErotic">' + la._464 + "</label></div>";
        u += "</div></div>";
        v = J.isRangeEnabled && J.priceTypes != CsvType.SALES.index ? "" : ' class="hidden"';
        G = '<div id="deltaPercentRange"></div><div class="filterbar__label filterbar__label--up">' + la._489 + "</div>";
        w = '<div id="deltaRange"></div><div class="filterbar__label filterbar__label--up">' + la._490 + "</div>";
        for (var fa = '<div id="currentRange"></div><div class="filterbar__label filterbar__label--up">' + la._491 + "</div>", R = '<div id="salesRankRange" class="flex">\n\t\t\t\t<span>' + la._492 + '<div id="srRangeMin" contenteditable="true">\n\t\t\t\t\t' + (-1 == J.salesRankRange[0] ? la._142 : NumberUtil.format(J.salesRankRange[0])) + "\n\t\t\t\t</div></span>\n\t\t\t\t<span>" + la._493 + '<div id="srRangeMax" contenteditable="true">\n\t\t\t\t\t' + (-1 == J.salesRankRange[1] ? la._142 : NumberUtil.format(J.salesRankRange[1])) + '\n\t\t\t\t</div></span>\n\t\t\t</div>\n\t\t\t<div class="filterbar__label filterbar__label">' + CsvType.getName(CsvType.SALES.index) + " " + la._456 + "</div>", T = "", oa = 10; 50 >= oa; oa += 10)
            T += '<i class="fa fa-star' + (J.minRating < oa ? "-o" : "") + '" data-rating="' + oa + '"></i> ';
        replaceHtml("leftPanel", "" + P + A + O + Q + ('<div class="leftPanelBox' + B + ' filterbar__box filterbar__box--range">\n\t\t\t\t<div class="leftPanelLabel">\n\t\t\t\t\t<a title="disable range selections" id="panelRangeSelectionDisableCross" class="' + B + '"><i class="fa fa-caret-down"></i>&ensp;' + la._455 + '</a>\n\t\t\t\t</div>\n\t\t\t\t<div style="margin-top: 12px;margin-bottom: -14px;" id="panelRangeSelection" ' + v + ">\n\t\t\t\t\t" + G + "\n\t\t\t\t\t" + w + "\n\t\t\t\t\t" + fa + "\n\t\t\t\t\t" + R + '\n\t\t\t\t\t<div id="minRating" class="filterbar__filter filterbar__filter--star">\n\t\t\t\t' + (T + '\n\t\t\t</div>\n\t\t\t<div class="filterbar__label">' + la._911 + "</div>\n\t\t\t\t</div>\n\t\t\t</div>")) + u + M + ('<div style="color: #8a8a8a;font-size: 12px;text-align: right;margin-bottom: 6px;margin-top: -4px;">&emsp;\ud83d\ude9a = ' + la._465 + '</div><div id="resetSettings" title="' + la._466 + '"><i class="fa fa-undo"></i>&ensp;' + la._467 + '</div><div id="clearVisited"><i class="fa fa-eraser"></i>&ensp;') + (la._468 + "</div>" + (ua && pa ? '<div id="clearVisitedSetting"><i class="fa fa-sliders"></i>&ensp;Set clearing interval</div>' : "")) + ('<br><div id="queryJSON" title="' + la._470 + '"><i class="fa fa-file-code-o"></i>&ensp;' + la._469 + '</div><br><br><div id="reloadDeals" class="url"><i class="fa fa-refresh " style="font-size: 18px;"></i>&ensp;Reload deals</div><br><br><div id="leftPanelMarkAllVisited"><i class="fa fa-check-square-o fa-lg"></i><br><span>' + la._427 + '</span></div><div><div class="leftPanelBottomMenu" id="leftPanelBackToTop"><i class="fa fa-arrow-up fa-lg"></i><br><span>') + (la._196 + "</span></div>"));
        $("#resetSettings").on("click", function() {
            J = za.construct(J.settings.viewTyp);
            isMobile ? H() : $("#submitDealQuery").trigger("click")
        });
        $("#dealsViewType div").on("click", function() {
            var ca = parseInt($(this).data("viewtype"));
            ca !== J.settings.viewTyp && (J.settings.viewTyp = ca === ra.TABLE ? ra.TABLE : ra.BOX,
            J.settings.viewTyp === ra.BOX && GridDeals.destroy(),
            $("#submitDealQuery").trigger("click"))
        });
        $("#clearVisited").on("click", function() {
            sessionStorage.clear();
            $("#submitDealQuery").trigger("click");
            pa && pa.clear()
        });
        $("#reloadDeals").on("click", function() {
            $("#submitDealQuery").trigger("click")
        });
        $("#clearVisitedSetting").on("click", function(ca) {
            showPopup("Visited Deals Settings", '<div><div><div>Set the days after which a visited deal should automatically no longer be marked as visited: </div><span style="margin-right:20px;"><i class="fa fa-calendar" ></i>&ensp;Days:</span><span id="perPage" class="hrefContainer"><span>1</span><span>2</span><span>3</span><span>7</span><span>14</span><span>30</span></span><div><span style="margin-right:20px;"><i class="fa fa-eye-slash" ></i>&ensp;Opacity of visited deals:</span><span id="imageSize" class="hrefContainer"><span>0.1</span><span>0.25</span><span>0.5</span></span></div></div><br>The information which deals you opened or marked as visited is stored in your browser and not in your account.</div>', !0);
            $("#perPage").children().each(function(ha, C) {
                storage.dealsClearDays = storage.dealsClearDays || 7;
                $(C).text() == storage.dealsClearDays && $(C).addClass("bigAndBold")
            });
            $("#imageSize").children().each(function(ha, C) {
                storage.dealsOpacity = storage.dealsOpacity || .5;
                $(C).text() == storage.dealsOpacity && $(C).addClass("bigAndBold")
            });
            $("#perPage").on("click", function(ha) {
                ha = ha.target;
                if ("" == ha.id) {
                    var C = Number($(ha).text());
                    0 < C && 31 > C && ($(ha).siblings().removeClass("bigAndBold"),
                    $(ha).addClass("bigAndBold"),
                    storage.dealsClearDays = C,
                    settings.send())
                }
            });
            $("#imageSize").on("click", function(ha) {
                ha = ha.target;
                if ("" == ha.id) {
                    var C = Number($(ha).text());
                    0 < C && .8 > C && ($(ha).siblings().removeClass("bigAndBold"),
                    $(ha).addClass("bigAndBold"),
                    storage.dealsOpacity = C,
                    settings.send(),
                    $("#submitDealQuery").trigger("click"))
                }
            });
            ca.stopPropagation();
            return !1
        });
        $("#queryJSON").on("click", function() {
            var ca = JSON.parse(JSON.stringify(J));
            delete ca.perPage;
            delete ca.settings;
            ca.excludeCategories = ca.excludeCategories[J.domainId];
            ca.includeCategories = ca.includeCategories[J.domainId];
            ca.page = 0;
            ca.priceTypes[0] === CsvType.LIGHTNING_DEAL.index && (ca.dateRange = "0");
            ca = '<div style="width:500px;"><span>If you have Keepa API access you can use the following JSON to <a href="https://discuss.keepa.com/t/browsing-deals/338">browse deals</a> via our API:</span><div><pre style="height: 300px;overflow: auto;background-color: #fff4e0;">' + JSON.stringify(ca, null, 4) + '</pre><br>Complete API URL:<div style="width=100%; overflow: auto;background-color: #fff4e0;white-space: nowrap;">https://api.keepa.com/deal?key=<span style="color:red">YOUR_API_KEY</span>&selection=' + encodeURIComponent(JSON.stringify(ca)) + "</div></div></div>";
            showPopup("Deals API query for current selection", ca, !0)
        });
        0 < J.titleSearch.length && ($("#dealSearchBar").val(J.titleSearch),
        d($("#submitDealSearch")));
        $("#salesRankRange div").attr("title", la._472);
        $("#salesRankRange div").on("focus", function(ca) {
            $(this).text("")
        });
        $("#salesRankRange div").on("focusout", function(ca) {
            ca = $(this);
            var ha = ca.text()
              , C = ca.attr("id");
            if (0 != ha.length) {
                if ("srRangeMin" == C) {
                    if (C = Number(ha),
                    J.salesRankRange[0] = Number(C),
                    1 != J.salesRankRange[1]) {
                        var U = J.salesRankRange[1];
                        -1 != U && U < C && ($("#srRangeMax").text(NumberUtil.format(C + 1)),
                        J.salesRankRange[1] = Number(C + 1))
                    }
                } else
                    "srRangeMax" == C && (U = Number(ha),
                    J.salesRankRange[1] = Number(U),
                    -1 != J.salesRankRange[0] && (C = J.salesRankRange[0],
                    -1 != C && C > U && ($("#srRangeMin").text(NumberUtil.format(U - 1)),
                    J.salesRankRange[0] = Number(U - 1))));
                ha = ha.split(",").join("");
                ca.text(NumberUtil.format(ha))
            } else
                ca.text("all"),
                J.salesRankRange["srRangeMax" == C ? 1 : 0] = -1;
            H()
        });
        $("#salesRankRange div").on("keydown", function(ca) {
            ca = ca.keyCode;
            var ha = $(this)
              , C = 47 < ca && 58 > ca || 95 < ca && 112 > ca;
            if (32 == ca || 13 == ca || 64 < ca && 91 > ca || 185 < ca && 193 > ca || 218 < ca && 223 > ca)
                return 13 == ca && setTimeout(function() {
                    ha.trigger("focusout")
                }, 0),
                !1;
            if (C)
                return 7 >= $(this).text().length
        });
        $("#dealSearchBar").on("change", function() {
            d($("#submitDealSearch"));
            z()
        });
        $("#submitDealSearch").on("click", function() {
            $("#dealSearchBar").val() == J.titleSearch && ($("#dealSearchBar").val(""),
            J.titleSearch = "",
            d($("#submitDealSearch")),
            z())
        });
        A = $("#dealCheckBoxes");
        $("#deltaPercentRange");
        var Z = $("#deltaRange")
          , ja = $("#currentRange")
          , W = $("#dealPriceTypesFilter")
          , Aa = $("#dealSortType")
          , Ca = $("#dealDateRange")
          , Ba = $("#panelRangeSelectionDisableCross")
          , ta = $("#panelFilterSelectionDisableCross");
        A.click(function(ca) {
            $(ca.target).addClass("active");
            var ha = $(ca.target).attr("id");
            if (ha) {
                switch (ha) {
                case "checkboxLowestEver":
                case "checkboxLowestAll":
                case "checkboxRisers":
                case "checkboxHighestEver":
                    J.isOutOfStock = !1;
                    $("#checkboxOutOfStock").prop("checked", !1);
                    break;
                case "checkboxOutOfStock":
                    J.isLowest = !1,
                    $("#checkboxLowestEver").prop("checked", !1),
                    J.isLowestOffer = !1,
                    $("#checkboxLowestAll").prop("checked", !1)
                }
                switch (ha) {
                case "checkboxRisers":
                case "checkboxHighestEver":
                    J.isLowestOffer = !1,
                    $("#checkboxLowestAll").prop("checked", !1),
                    J.isLowest = !1,
                    $("#checkboxLowestEver").prop("checked", !1)
                }
                switch (ha) {
                case "checkboxMustHaveAmazonOffer":
                    J.mustHaveAmazonOffer = $(ca.target).prop("checked");
                    J.mustHaveAmazonOffer && (J.mustNotHaveAmazonOffer = !1,
                    $("#checkboxMustNotHaveAmazonOffer").prop("checked", !1));
                    break;
                case "checkboxMustNotHaveAmazonOffer":
                    J.mustNotHaveAmazonOffer = $(ca.target).prop("checked");
                    J.mustNotHaveAmazonOffer && (J.mustHaveAmazonOffer = !1,
                    $("#checkboxMustHaveAmazonOffer").prop("checked", !1));
                    break;
                case "checkboxLowestEver":
                    J.isLowest = $(ca.target).prop("checked");
                    break;
                case "checkboxLowestAll":
                    J.isLowestOffer = $(ca.target).prop("checked");
                    break;
                case "checkboxFilterErotic":
                    J.filterErotic = $(ca.target).prop("checked");
                    break;
                case "checkboxHasReviews":
                    J.hasReviews = $(ca.target).prop("checked");
                    break;
                case "checkboxIsPrimeExclusive":
                    J.isPrimeExclusive = $(ca.target).prop("checked");
                    break;
                case "checkboxOutOfStock":
                    J.isOutOfStock = $(ca.target).prop("checked")
                }
                $("#submitDealQuery").trigger("click")
            }
        });
        var Ea = function() {
            J.isRangeEnabled ? (Ba.children().first().removeClass("fa-caret-right").addClass("fa-caret-down"),
            Ba.attr("title", "disable range selections")) : (Ba.children().first().removeClass("fa-caret-down").addClass("fa-caret-right"),
            Ba.attr("title", "enable range selections"))
        }
          , va = function() {
            J.isFilterEnabled ? (ta.children().first().removeClass("fa-caret-right").addClass("fa-caret-down"),
            ta.attr("title", "disable filters")) : (ta.children().first().removeClass("fa-caret-down").addClass("fa-caret-right"),
            ta.attr("title", "enable filters"))
        };
        Ea();
        va();
        Ba.click(function(ca) {
            J.isRangeEnabled = !J.isRangeEnabled;
            Ea();
            z()
        });
        ta.click(function(ca) {
            J.isFilterEnabled = !J.isFilterEnabled;
            va();
            z()
        });
        W.find("> div").on("click", function(ca) {
            ca = $(ca.target);
            var ha = ca.data("type");
            if ("undefined" !== typeof ha)
                J.priceTypes[0] = ha,
                z();
            else if ("undefined" !== typeof ca.data("warehousecondition")) {
                var C = []
                  , U = [];
                W.find("input[data-warehousecondition]").each(function(ia, X) {
                    ia = $(X).data("warehousecondition");
                    C.push(ia);
                    $(X).prop("checked") && U.push(ia)
                });
                J.warehouseConditions = C !== U ? U : C;
                z()
            }
        });
        Ca.click(function(ca) {
            J.priceTypes[0] !== CsvType.LIGHTNING_DEAL.index && (Ca.children().removeClass("active"),
            $(ca.target).addClass("active"),
            ca = $(ca.target).attr("data-dateRange"),
            J.dateRange = ca,
            J.page = 0,
            isMobile ? H() : $("#submitDealQuery").trigger("click"))
        });
        Aa.click(function(ca) {
            Aa.children().removeClass("active");
            $(ca.target).addClass("active");
            var ha = $(ca.target).attr("data-sort");
            null == ha && (ha = $(ca.target).parent().attr("data-sort"));
            ca = 0;
            switch (ha) {
            case "percentage":
                ca = 4;
                if (0 == J.sortType || 4 == J.sortType)
                    ca *= -1;
                break;
            case "newest":
                ca = 1;
                break;
            case "drop":
                ca = 2;
                2 == J.sortType && (ca *= -1);
                break;
            case "salesRank":
                ca = 3;
                3 == J.sortType && (ca *= -1);
                break;
            case "price":
                ca = 5,
                5 == J.sortType && (ca *= -1)
            }
            J.sortType = ca;
            J.page = 0;
            isMobile ? H() : $("#submitDealQuery").trigger("click")
        });
        A = ka();
        $("#deltaPercentRange").rangeSlider({
            bounds: {
                min: 0,
                max: 100
            },
            defaultValues: {
                min: J.deltaPercentRange[0],
                max: J.deltaPercentRange[1]
            },
            range: {
                min: 5
            },
            step: 10,
            formatter: function(ca) {
                return Math.round(ca).toFixed(0) + "%"
            }
        }).on("userValuesChanged", z);
        Z.rangeSlider({
            bounds: {
                min: 0,
                max: 1E4 * A
            },
            defaultValues: {
                min: J.deltaRange[0],
                max: J.deltaRange[1]
            },
            range: {
                min: 50
            },
            step: 50,
            formatter: function(ca) {
                var ha = ca == Z.rangeSlider("bounds").max ? ">" : "";
                return "" + Money.format(ca, {
                    sourceDomainId: storage.domain,
                    noDigits: !0,
                    preValueModifier: ha
                })
            }
        }).on("userValuesChanged", z);
        ja.rangeSlider({
            bounds: {
                min: 0,
                max: 5E4 * A
            },
            defaultValues: {
                min: J.currentRange[0],
                max: J.currentRange[1]
            },
            range: {
                min: 100
            },
            step: 100,
            formatter: function(ca) {
                var ha = ca == ja.rangeSlider("bounds").max ? ">" : "";
                return "" + Money.format(ca, {
                    sourceDomainId: storage.domain,
                    noDigits: !0,
                    preValueModifier: ha
                })
            }
        }).on("userValuesChanged", z);
        $("#minRating i").on("click", function(ca) {
            ca = Number($(this).data("rating"));
            var ha = J.minRating === ca
              , C = ha ? ca - 10 : ca;
            if (ha)
                for (ha = 50; ha >= ca; ha -= 10)
                    $('#minRating i[data-rating="' + ha + '"]').removeClass("fa-star").addClass("fa-star-o");
            else
                for (ha = 10; ha <= ca; ha += 10)
                    $('#minRating i[data-rating="' + ha + '"]').addClass("fa-star").removeClass("fa-star-o");
            J.minRating = 0 < C ? C : -1;
            $("#submitDealQuery").trigger("click")
        });
        var da = $(".leftPanelBottomMenu");
        $("#leftPanelMarkAllVisited").on("click", function() {
            var ca = $("a:not(.href)"), ha;
            for (ha in ca) {
                var C = ca[ha].href;
                C && -1 != C.indexOf("#!product/") && (C = C.split("/"),
                sessionStorage[C[C.length - 1]] = 1,
                $(ca[ha]).parent().css("opacity", "0.4"),
                pa && pa.setItem(C[C.length - 1], keepaTime.now()))
            }
            GridDeals.setIsVisited(!0)
        });
        $("#leftPanelBackToTop").on("click", function() {
            da.hide();
            L = !1;
            $("html, body").velocity("scroll", 300, function() {
                L = !0
            });
            return !1
        });
        var Y = $("#leftPanel")
          , ma = Y.height();
        $(window).on("scroll.backToTop", function(ca) {
            L && ("none" == Y.css("display") ? $(window).off("scroll.backToTop") : $(this).scrollTop() > ma - 200 ? da.show(500) : da.hide(300))
        })
    }
    function I(A, O) {
        var P = A.current[J.priceTypes[0]]
          , M = A.deltaPercent[J.priceTypes[0]];
        M = 100 == M ? 99 : M;
        var u = 0 < storage.dealsThumbSize ? 20 < M ? 32 : 10 < M ? 24 : 16 : 20 < M ? 24 : 16;
        var v = 0 == storage.dealsThumbSize ? 50 : 100
          , G = A.current[CsvType.SALES.index]
          , w = -1 == G ? "" : " " + la._473 + " " + NumberUtil.format(A.current[CsvType.SALES.index])
          , B = GraphService.getWebGraphTypeAllOff();
        B[CsvType.SALES.index] = 1;
        B = GraphService.getUrl(A.asin, storage.domain, v, 10, B, 31, 1);
        G = -1 != G && J.priceTypes[0] != CsvType.SALES.index ? '<span name="minigraphSales" title="1 month ' + CsvType.getName(CsvType.SALES.index) + " history." + w + '" style="flex-grow: 1;text-align: right;right: 13px;height:10px; width:' + v + "px; display: inline-block;background:url(" + B + ') no-repeat right"></span><br>' : "";
        w = GraphService.getWebGraphTypeAllOff();
        w[J.priceTypes[0]] = 1;
        w = GraphService.getUrl(A.asin, storage.domain, v, 10, w, 31, 1);
        w = CsvType.getObject(J.priceTypes[0]).graphAPI ? "background-image:url(" + w + ");" : "";
        v = '<div class="flex" style="height:12px;">\n\t\t\t\t<span title="1 month ' + CsvType.getName(J.priceTypes[0]) + ' price history" name="minigraph" style="margin-bottom:2px;height:10px;width:' + v + "px;display:inline-block;" + w + '"></span>' + G + "\n\t\t\t</div>";
        M = '<div class="productDiscountBox">\n\t\t\t\t' + (0 == M ? "" : '<i class="fa fa-arrow-circle-down fa-18 arrowBlue" style="font-size:' + (u + 3) + 'px !important;"></i>') + '<span class="productSmallPercent-' + u + '">' + (999 < M ? ">999%" : 0 == M ? "&nbsp;" : M + "%") + "</span>\n\t\t\t</div>";
        w = G = "";
        if (J.priceTypes[0] === CsvType.SALES.index) {
            B = 1 > A.avg[J.priceTypes[0]] ? "" : "" + CsvType.format("SALES", A.avg[J.priceTypes[0]]);
            var Q = "" + CsvType.format("SALES", P)
        } else
            B = 1 > A.avg[J.priceTypes[0]] ? "" : "" + Money.format(A.avg[J.priceTypes[0]], {
                sourceDomainId: J.domainId
            }),
            J.priceTypes[0] === CsvType.LIGHTNING_DEAL.index && (B = 0 < A.avg[CsvType.AMAZON.index] ? A.avg[CsvType.AMAZON.index] : A.avg[CsvType.NEW.index],
            B = 1 > B ? "" : "" + Money.format(B, {
                sourceDomainId: J.domainId
            })),
            Q = -1 == P ? la._134 : "" + Money.format(P, {
                sourceDomainId: J.domainId
            }),
            showReferencePrice(J.domainId) && (G = 1 > A.avg[J.priceTypes[0]] ? "" : '<span class="price__reference">' + Money.format(A.avg[J.priceTypes[0]], {
                sourceDomainId: J.domainId,
                targetDomainId: J.domainId
            }) + "</span>&ensp;",
            w = -1 == P ? "" : '<span class="price__reference">' + Money.format(P, {
                sourceDomainId: J.domainId,
                targetDomainId: J.domainId
            }) + "</span>&ensp;");
        P = '<div class="productDealTable">\n\t\t\t\t<span class="productPriceTableTdSmallS">' + (B ? la._385 + ": " : "") + G + B + '</span><br><span class="productPriceTableTdLargeS">' + la._81 + w + Q + "</span>\n\t\t\t</div>";
        G = null == A.categories || 0 == A.categories.length ? '<br><span class="dealsFindRelatedDeals">&ensp;</span>' : '<br><span class="dealsFindRelatedDeals" data-catIds="' + JSON.stringify(A.categories) + '">' + la._420 + "</span>";
        w = -1 != A.flags.indexOf(308 + J.priceTypes[0]) ? '<div title="' + la._474 + '" class="isLowestMarker"></div>' : "";
        B = -1 != A.flags.indexOf(224 + J.priceTypes[0]) ? '<div title="' + la._475 + '" class="isLowestOfferMarker"></div>' : "";
        Q = '<span class="externalAmazon" style="position: absolute;color:#555;cursor: alias;right: 7px;bottom: 7px;" href="' + getAmazonRedirectByDomain(A.domainId, A.asin) + '" title="' + la._99 + ' Amazon" target="_blank"><i class="fa fa-amazon"></i></span>';
        var fa = "";
        J.priceTypes[0] == CsvType.WAREHOUSE.index && 0 < A.warehouseCondition && (fa = '<span title="' + encodeHTML(A.warehouseConditionComment) + '" class="wdc">' + CsvType.getCondition(A.warehouseCondition) + "</span><br>");
        G = '<div class="productDealAgoBox">\n                ' + fa + '\n\t\t\t\t<span class="productDealAgo">' + la._476 + " " + prettyDate(keepaTime.now() - A.creationDate) + "</span>" + G + w + B + "\n\t\t\t\t" + Q + "\n\t\t\t</div>";
        return E(A, O, v + '<div class="flex">' + M + P + "</div>" + G, u, !1)
    }
    function E(A, O, P, M, u) {
        M = imageToHtml(A.imagesCSV, 180, "");
        u = "";
        0 == storage.dealsThumbSize && (u = "margin-left: 6px;");
        5 == A.domainId && (D = 16);
        if (null == A.title)
            return reportBug(null, "deals: title is null! " + A.domainId + " " + A.asin),
            "";
        A.title = stripHTML(A.title).replace(/"/g, "&quot;");
        return '<div class="title" style="max-width: 210px;font-size: 14px">' + (A.title.length <= D ? A.title : A.title.substr(0, D) + "\u2026") + '</div><a href="#!product/' + A.domainId + "-" + A.asin + '"><div class="productBox" id="pB' + O + '" title="' + A.title + '"><div class="productImageDiv"><div class="productImage" >' + M + '</div></div><div class="productSmallDescription" style="' + u + '">' + P + "</div></div></a>"
    }
    function K(A, O, P) {
        if (0 == A.length)
            $("#filterBar").hide();
        else {
            $("#filterBar").show();
            for (var M = {}, u = 0, v = 0; v < O.length; v++)
                M[O[v]] = {
                    id: A[v],
                    count: P[v],
                    name: O[v]
                },
                u += P[v];
            v = [];
            for (var G in M)
                v.push(G);
            v.sort();
            var w = ""
              , B = u
              , Q = J.includeCategories[J.domainId];
            u = 0 == J.excludeCategories[J.domainId].length && 0 == J.includeCategories[J.domainId].length ? '<span style="color: #444; white-space: nowrap; text-shadow: #ccc 1px 1px 2px;">' + la._82 + " (" + u + ")</span>&emsp;" : '<a style="white-space: nowrap" id="showAllDeals">' + la._82 + " (" + u + ")</a>&emsp;";
            u += '<hr style="margin-top: 9px !important;border-color:rgba(10, 40, 82, 0.5) !important">';
            a: for (G in v) {
                G = v[G];
                var fa = !1;
                for (R in Q) {
                    var R = Q[R];
                    R == M[G].id && (u += '<span style="color: #222; white-space: nowrap; text-shadow: #ccc 1px 1px 2px;" style="white-space: nowrap" id="' + M[G].id + '">' + G + (0 < M[G].count ? " (" + M[G].count + ")" : "") + "</span>&emsp;",
                    fa = !0)
                }
                if (!fa) {
                    if (0 < J.excludeCategories[J.domainId].length)
                        for (fa = 0; fa < J.excludeCategories[J.domainId].length; fa++)
                            if (J.excludeCategories[J.domainId][fa] == M[G].id) {
                                w += '<span style="white-space: nowrap;">' + G + " (" + M[G].count + ')<a class="addCat" rel="' + M[G].id + '"><i class="fa fa-plus-circle"></i></a></span> &emsp;';
                                B -= M[G].count;
                                continue a
                            }
                    u += '<span style="white-space: nowrap; margin-left: -6px;"><a rel="' + M[G].id + '">' + G + " (" + M[G].count + ')</a>&ensp;<a class="removeCat" rel="' + M[G].id + '"><i class="fa fa-times"></i></a></span> &emsp;'
                }
            }
            replaceHtml("filterCats", u);
            "" != w ? (w = '<a id="customView" ' + (0 == Q.length ? 'style="color: #222; white-space: nowrap; text-shadow: #ccc 1px 1px 2px;"' : "") + '><span style="color:#0099FF">&uarr;</span>&ensp;' + la._347 + " (" + B + ')&ensp;<span style="color:#0099FF">&uarr;</span></a><hr style="border-color:#38F !important"><span id="excludedCatsHR">' + la._348 + '</span><div style="color: #777;text-align: center; margin-bottom: -2px; font-size:11px"> ' + w + "</div>",
            replaceHtml("removedCats", w)) : replaceHtml("removedCats", "");
            $("#customView").off("click.showAll").on("click.showAll", function() {
                J.includeCategories[J.domainId] = []
            });
            $("#filterBar").off("click.filter").on("click.filter", function(T) {
                try {
                    if (T.target && ("I" == T.target.nodeName && (T.target = T.target.parentNode),
                    "A" == T.target.nodeName)) {
                        var oa = !1;
                        "showAllDeals" == T.target.id ? (J.includeCategories[J.domainId] = [],
                        J.excludeCategories[J.domainId] = [],
                        oa = !0) : "customView" == T.target.id && (J.includeCategories[J.domainId] = [],
                        oa = !0);
                        var Z = Number($(T.target).attr("rel"));
                        "number" == typeof Z && Z === Z && ($(T.target).hasClass("removeCat") ? (J.excludeCategories[J.domainId].push(Z),
                        J.excludeCategories[J.domainId] = J.excludeCategories[J.domainId].filter(onlyUnique)) : $(T.target).hasClass("addCat") ? J.excludeCategories[J.domainId].splice(J.excludeCategories[J.domainId].indexOf(Z), 1) : J.includeCategories[J.domainId] = [Z],
                        oa = !0);
                        oa && (K(A, O, P),
                        J.page = 0,
                        isMobile ? H() : $("#submitDealQuery").trigger("click"))
                    }
                } catch (ja) {
                    console.log(ja)
                }
            })
        }
    }
    function H() {
        N = !0;
        dealsTotalResults = 1E4;
        $("#dealsTitleSearchResults").text("");
        n();
        f(!1);
        $("#submitDealQuery").show();
        $("#submitDealQuery").effect("highlight", {
            color: "#8CDDFF"
        }, 500)
    }
    function V(A, O) {
        setTimeout(function() {
            A.colorTip({
                color: "whiteDeals"
            });
            A.children().last().each(function() {
                $(this).css({
                    width: 250,
                    top: "-18px"
                })
            });
            A.find(".wdc").colorTip({
                color: "yellow"
            })
        }, 100);
        A.find(".dealsFindRelatedDeals").on("click", function() {
            J.includeCategories = tryParseJSON($(this).attr("data-catIds"));
            null == J.includeCategories && (J.includeCategories = []);
            z();
            return !1
        });
        A.find(".externalAmazon").on("click", function() {
            var u = $(this).attr("href");
            window.open(u);
            return !1
        });
        A.one("mousedown", function() {
            $(this).parent().parent().css("opacity", "0.4");
            var u = $(this).parent().attr("href").split("/")[1];
            sessionStorage[u] = 1;
            pa && pa.setItem(u, keepaTime.now())
        });
        var P = A.find(".productImage > img")
          , M = P.attr("src");
        P.mouseenter(function() {
            var u = GraphService.getWebGraphTypeAllOff();
            u[CsvType.AMAZON.index] = 1;
            u[CsvType.NEW.index] = 1;
            u[CsvType.USED.index] = 1;
            u[CsvType.SALES.index] = 1;
            u = GraphService.getUrl(O, storage.domain, 180, 180, u, 365, 1);
            P.attr("src", u);
            P.attr("title", la._477)
        });
        P.mouseleave(function() {
            P.attr("src", M);
            P.attr("title", "")
        })
    }
    function S(A, O) {
        return '<div class="saveSlotBox"><span title="' + la._480 + '" data-slot="' + A + '" class="dealsSaveSlot">' + O + '</span><ul><li data-type="0">' + (la._478 + '</li><li data-type="1">' + la._479 + '</li><li data-type="2">' + la._379 + '</li></ul><span title="') + la._481 + '" class="editSaveSlot"><i class="fa fa-pencil"></i></span></div>'
    }
    function aa(A) {
        A = A || $("#dealsSaveBox").children(".saveSlotBox");
        A.find(".dealsSaveSlot").on("click", function() {
            var O = $(this).attr("data-slot");
            O = m("slot_" + O, !0);
            window.location.hash = "!deals/" + encodeURIComponent(JSON.stringify(O))
        });
        A.find(".editSaveSlot").on("click", function() {
            $(this).prev().toggle("blind", {
                direction: "up"
            }, 300)
        });
        A.find("li").on("click", function() {
            var O = $(this).closest(".saveSlotBox")
              , P = O.find(".dealsSaveSlot")
              , M = P.attr("data-slot")
              , u = $(this).attr("data-type");
            $(this).parent().hide();
            if (void 0 != M)
                switch (Number(u)) {
                case 0:
                    h("slot_" + M);
                    break;
                case 1:
                    var v = P.text();
                    P.attr("contenteditable", "true");
                    P.text("");
                    P.focus();
                    P.on("focusout.rename", function(G) {
                        P.removeAttr("contenteditable");
                        G = P.text().trim();
                        P.text(G);
                        0 == G.length || G.match(/^\s*$/) ? P.text(v) : (storage["dealsRequest.slotName_" + M] = P.text(),
                        settings.send());
                        P.off("keydown.rename");
                        P.off("focusout.rename")
                    });
                    P.on("keydown.rename", function(G) {
                        G = G.keyCode;
                        var w = $(this);
                        return 13 == G || 185 < G && 193 > G || 218 < G && 223 > G ? (13 == G && setTimeout(function() {
                            w.trigger("focusout")
                        }, 0),
                        !1) : 37 == G || 39 == G || 8 == G || 46 == G ? !0 : 20 >= $(this).text().length
                    });
                    break;
                case 2:
                    storage.removeItem("dealsRequest.slot_" + M),
                    storage.removeItem("dealsRequest.slotName_" + M),
                    settings.send(),
                    P.hide("explode", 700, function() {
                        O.remove();
                        $("#dealsSaveSlotAdd").show()
                    })
                }
        })
    }
    function ea() {
        $(".dealsSaveSlot").each(function(A, O) {
            var P = $(O).attr("data-slot");
            A = m("slot_" + P, !0);
            A.perPage = -1;
            A = $jscomp.makeIterator(r(A));
            var M = A.next().value;
            A.next();
            M.done(function(u) {
                $(O).text(storage["dealsRequest.slotName_" + P] + (" (" + u.totalResults + ")"))
            })
        })
    }
    var ra = {
        BOX: 0,
        TABLE: 1
    }
      , pa = null
      , ua = null
      , na = storage.domain
      , qa = {
        driver: localforage.INDEXEDDB,
        name: "keepaDeals",
        version: 1,
        size: 5E5,
        storeName: "visitedDeals",
        description: "Caches visited deals"
    }
      , ka = function() {
        var A = 1;
        switch (storage.domain) {
        case "10":
            A = 100;
            break;
        case "11":
            A = 100;
            break;
        case "12":
        case "7":
            A = 10;
            break;
        case "13":
            A = 2
        }
        return A
    }
      , za = {
        construct: function(A) {
            for (var O = $jscomp.makeIterator(Object.getOwnPropertyNames(this)), P = O.next(); !P.done; P = O.next())
                P = P.value,
                "construct" != P && delete this[P];
            this.page = 0;
            this.domainId = localStorageSupported ? storage.domain : 1;
            this.excludeCategories = [];
            this.includeCategories = [];
            for (O = 0; O < numberOfDomains; O++)
                this.excludeCategories[O] = [],
                setTimeout(function() {
                    for (var M = 0; M < numberOfDomains; M++)
                        storage.removeItem("dealsExcludedCats." + M),
                        storage.removeItem("dealExcludedCats." + M);
                    storage.removeItem("dealExcludedCats");
                    storage.removeItem("dealsExcludedCats")
                }, 1E4),
                this.includeCategories[O] = [];
            O = ka();
            this.priceTypes = [CsvType.AMAZON.index];
            this.deltaRange = [0, 1E4 * O];
            this.deltaPercentRange = [20, 80];
            this.salesRankRange = [-1, -1];
            this.currentRange = [500 * O, 4E4 * O];
            this.minRating = -1;
            this.isOutOfStock = this.isLowestOffer = this.isLowest = !1;
            this.titleSearch = "";
            this.isRangeEnabled = !0;
            this.isFilterEnabled = !1;
            this.filterErotic = !0;
            this.mustNotHaveAmazonOffer = this.mustHaveAmazonOffer = this.isPrimeExclusive = this.hasReviews = !1;
            this.sortType = 4;
            this.dateRange = 1;
            this.warehouseConditions = [2, 3, 4, 5];
            this.settings = {
                viewTyp: A === ra.TABLE ? ra.TABLE : ra.BOX
            };
            return this
        }
    }
      , J = za.construct()
      , g = ['&nbsp;<i class="fa fa-sort-numeric-asc"></i>', '&nbsp;<i class="fa fa-sort-numeric-desc"></i>']
      , D = 28
      , N = !1
      , ba = []
      , q = !0
      , L = !0;
    return {
        init: function() {
            storage.domain != na && (ea(),
            na = storage.domain);
            if (q) {
                try {
                    a()
                } catch (M) {
                    console.error(M)
                }
                try {
                    b(),
                    ua && ua.removeOudatedCacheEntries({
                        now: keepaTime.now(),
                        days: Number(storage.dealsClearDays || 7)
                    })
                } catch (M) {
                    console.error(M)
                }
            }
            q = !1;
            $("#contentAlign").css({
                marginTop: "130px"
            });
            $("#submitDealQuery").off().on("click", function() {
                $(this).hide();
                var M = window.location.hash;
                dealsTotalResults = 1E4;
                N = !1;
                window.location.hash = "!deals/" + encodeURIComponent(JSON.stringify(J));
                M == window.location.hash && p()
            });
            $("#submitDealCategorySearch").off().on("click", function() {
                0 != A.val().length && ($("#dealCategorySearchBar").val(""),
                $("#submitDealCategorySearch").css("background", "#fff url(" + imgCDNUrl + "search.gif) center no-repeat"),
                $("#submitDealCategorySearch").attr("title", ""),
                $("#filterBarContent").show(),
                $("#categorySearchResults").hide(),
                z())
            });
            $("#dealCategorySearchBar").off().on("input", function() {
                d($("#submitDealCategorySearch"));
                P()
            });
            var A = $("#dealCategorySearchBar"), O, P = function() {
                var M = A.val();
                if (!(3 > M.length)) {
                    try {
                        clearTimeout(O)
                    } catch (u) {}
                    O = setTimeout(function() {
                        network.request({
                            path: "service/search",
                            type: "category",
                            domainId: J.domainId,
                            content: M,
                            version: 3
                        }).always(function(u) {
                            if (null == u || null == u.categories)
                                console.error("category search data is null");
                            else {
                                u = u.categories;
                                var v = [];
                                a: for (B in u) {
                                    var G = u[B];
                                    if (null != G.children && 0 != G.children.length)
                                        for (var w in G.children)
                                            if (u[G.children[w]])
                                                continue a;
                                    v.push(G.catId)
                                }
                                var B = "";
                                w = [];
                                for (G = 0; G < v.length; G++) {
                                    for (var Q = u[v[G]], fa = '<span data-catId="' + Q.catId + '">' + Q.name + "</span>", R = Q.name; null != Q && 0 != Q.parent; )
                                        if (Q = u[Q.parent])
                                            fa = '<span data-catId="' + Q.catId + '">' + Q.name + "</span>&ensp;&#10140;&ensp;" + fa,
                                            R = Q.name + R;
                                    -1 == R.indexOf("Custom Stores") && -1 == R.indexOf("Special Feature Stores") && -1 == R.indexOf("Kindle") && w.push([R, fa])
                                }
                                w.sort(function(oa, Z) {
                                    return oa[0] < Z[0] ? -1 : oa[0] > Z[0] ? 1 : 0
                                });
                                for (var T in w)
                                    B += w[T][1] + "<br>";
                                replaceHtml("categorySearchResults", '<div style="color: #000; margin-bottom: 5px; font-size: 12px;">' + (0 == B.length ? "No matching subcategory found." : 'Choose deal subcategory <sup title="Work in progress! Give us feedback in the comment section." style="color:red">beta</sup>') + "</div>" + B);
                                $("#filterBarContent").hide();
                                $("#categorySearchResults").show();
                                $("#categorySearchResults > span").on("click", function(oa) {
                                    oa = Number($(oa.target).attr("data-catId"));
                                    J.includeCategories[J.domainId] = [oa];
                                    z()
                                });
                                J.includeCategories[J.domainId] = v;
                                z()
                            }
                        })
                    }, 1E3)
                }
            };
            m("last", !1);
            p()
        },
        loadRequest: m,
        insertProductParts: E,
        addSaveSlots: function() {
            for (var A = la._482, O = "", P = !1, M = 0; 30 > M; M++)
                null != storage["dealsRequest.slot_" + M] ? O += S(M, storage["dealsRequest.slotName_" + M] || A + M) : P = !0;
            M = "<span>" + la._483 + "&emsp;</span>";
            0 < O.length && (M = "");
            P = P ? '<div id="dealsSaveSlotAdd" title="' + la._484 + '">' + M + '<i class="fa fa-plus-circle fa-lg"></i></div>' : "";
            $("#bodyPanel").prepend('<div id="dealsSaveBox" class="flex">' + O + P + "</div>");
            $("#dealsSaveSlotAdd").on("click", function() {
                for (var u = 0; 30 > u && void 0 != storage["dealsRequest.slot_" + u]; u++)
                    ;
                $("#dealsSaveSlotAdd").children("span").remove();
                if (30 > u) {
                    h("slot_" + u);
                    var v = "" == J.titleSearch ? A + u : J.titleSearch;
                    storage["dealsRequest.slotName_" + u] = v;
                    aa($(this).before(S(u, v)).prev())
                } else
                    $(this).hide()
            });
            aa();
            ea()
        },
        lastRequest: J,
        formatCategories: K
    }
};
var TrackingComponent = function() {
    var a = {}
      , b = null
      , d = 0
      , h = {}
      , m = ""
      , t = !1
      , f = !1
      , n = !1
      , r = !1
      , p = !1
      , z = "track"
      , F = 0
      , I = []
      , E = null
      , K = !1
      , H = null
      , V = !1
      , S = [CsvType.AMAZON.index, CsvType.NEW.index, CsvType.USED.index]
      , aa = [CsvType.LIGHTNING_DEAL.index, CsvType.NEW_FBA.index, CsvType.NEW_FBM_SHIPPING.index, CsvType.WAREHOUSE.index, CsvType.USED_NEW_SHIPPING.index, CsvType.USED_VERY_GOOD_SHIPPING.index, CsvType.USED_GOOD_SHIPPING.index, CsvType.USED_ACCEPTABLE_SHIPPING.index]
      , ea = function() {
        var da = $(".tracking");
        da.length && da.remove();
        F = 0;
        a = {};
        b = null;
        d = 0;
        h = {};
        m = "";
        p = r = n = f = t = !1;
        z = "track";
        V = !1
    }
      , ra = function() {
        P([d]);
        for (var da = [getDomainByTld("com.mx"), getDomainByTld("com.br"), getDomainByTld("com.au")], Y = getCasinLocalesFromStorage(), ma = !0 === Y[0], ca = [], ha = [], C = continents[domainIdToContinent[d]], U = 1; U < numberOfDomains; U++)
            7 != U && (ma && -1 < C.indexOf(U) && U != d && (Y[U] = !0),
            -1 < da.indexOf(U) && !Y[U] ? P([U]) : -1 < C.indexOf(U) && U != d ? ca.push(U) : U != d && ha.push(U));
        ca.concat(ha).forEach(function(ia) {
            ba([ia]).onLoad.done(function(X) {
                "undefined" !== typeof X && "undefined" !== typeof X.products && G([X.products[0]]);
                P([ia])
            })
        })
    }
      , pa = function() {
        var da = '<p class="mdc-typography--body2">' + la._147 + "</p>";
        ua() && (da = (null != E || K ? "" : '<div class="grid-wrapper-tools" style="position:initial;"><span class="tool__trackback"><span class="trigger"><i class="fa fa-angle-double-left"></i> ' + la._919 + "</span></span></div>") + '\n                <p class="mdc-typography--body2">' + la._231 + "<br><b>" + la._163 + '</b></p>\n                <p class="mdc-typography--body2">' + la._232 + ":<br>" + la._233 + m + "100. " + la._234 + m + "97" + la._234_2 + ".</p>");
        var Y = J()
          , ma = Ea()
          , ca = Number(get("s_trackingTtl"));
        ma = material.getSelect("tracking-ttl", "tracking-ttl", ca, ma, "", !0, !0);
        ca = ua() ? '<div class="tracking__list-mode-settings"><hr>\n                <p class="mdc-typography--body2">' + la._913 + "</p>\n                " + (null != E ? material.getCheckbox("tracking-import-purchased", la._814, !1, !1, "tracking-import-purchased") + "<br>" : "") + "\n                " + material.getCheckbox("tracking-overwrite-existing", la._815, !0, !1, "tracking-overwrite-existing") + "<br>\n                " + material.getCheckbox("tracking-import-oos", la._816, !1, !1, "tracking-import-oos") + "<br>\n            </div>" : "";
        var ha = material.getButton("submitTracking", t ? la._681 : la._110, null, "bell-o")
          , C = ua() ? '<div class="tracking__submit-overlay-message">\n                <p class="mdc-typography--body2">' + (null != E ? la._224 : la._914) + "</p>\n            </div>" : "";
        da = '<div class="tracking' + (isMobile ? " tracking--mobile" : "") + '" style="display:none;">\n\t\t\t' + da + '\n\t\t\t<form id="trackingForm">\n\t\t\t    ' + (ua() ? "" : '<span class="tracking__tab-bar-toggle-hint">' + la._350 + '</span>\n\t\t\t\t<div class="tracking__tab-bar-toggle">\n\t\t\t\t\t<i class="fa fa-globe"></i>\n\t\t\t\t</div>') + "\n\t\t\t\t" + Y + "\n\t\t\t\t" + ca + '\n\t\t\t\t<div class="tracking__hint">\n\t\t\t\t\t' + (n ? '<p class="mdc-typography--caption tracking__hint--amazononly" style="display:none;">\n\t\t\t\t\t\t<i class="fa fa-info-circle"></i> ' + la._873 + "<br>\n\t\t\t\t\t</p>" : "") + '\n\t\t\t\t\t<p class="mdc-typography--caption tracking__hint--offerdata" style="display:none;">\n\t\t\t\t\t\t<i class="fa fa-info-circle"></i> ' + la._653 + '<br>\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t\t<div class="tracking__warning">\n\t\t\t\t\t' + (f ? "" : '<p class="mdc-typography--body2 tracking__warning--isdrop">\n\t\t\t\t\t\t<i class="fa fa-exclamation-triangle"></i>\n\t\t\t\t\t\t' + (0 == storage.accountType ? la._705.replace("<br>", " ") + " " + la._706 : f ? "" : la._704.replace("<br>", " ") + " " + la._706) + "\n\t\t\t\t\t</p>") + '\n\t\t\t\t</div>\n\t\t\t\t<div class="tracking__buttons">\n\t\t\t\t\t<span title="' + la._881 + '">' + la._874 + ":</span>&emsp;" + ma + "&emsp;" + ha + '\n\t\t\t\t</div>\n\t\t\t\t<hr>\n\t\t\t\t<div class="tracking__settings-mode">\n\t\t\t\t    <div>' + (ua() ? "" : '<span class="trigger--casin-popup href">&raquo; ' + la._315 + "</span>") + '</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div title="' + la._847 + '">' + la._843 + ":</div>\n\t\t\t\t\t\t" + material.getRadio("tracking-mode-basic", la._844, !0, "tracking-mode", !1, "basic") + "&emsp;\n\t\t\t\t\t\t" + material.getRadio("tracking-mode-advanced", la._845, !1, "tracking-mode", !1, "advanced") + "&emsp;\n\t\t\t\t\t\t" + material.getRadio("tracking-mode-pro", la._846, !1, "tracking-mode", !1, "pro") + '&emsp;\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="tracking__submit-overlay"><div class="cssload-box-loading"></div>' + C + "</div>\n\t\t\t</form>\n\t\t</div>";
        replaceHtml(z, da);
        material.init(".tracking");
        fa(d);
        ua() ? Q() : R();
        ja();
        t ? L() : A();
        T()
    }
      , ua = function() {
        return 1 === F
    }
      , na = function(da, Y, ma) {
        if ("object" !== typeof CsvType[da] || !0 !== CsvType[da].isEnabled || !0 !== CsvType[da].isTrackable)
            return "";
        var ca = CsvType[da]
          , ha = ca.index;
        if ("TRADE_IN" === da && Y !== getDomainByTld("com"))
            return "";
        if (ua())
            var C = "percent";
        else if (ca.currency)
            a: switch (C = getCurrencyCodeByDomain(d).toLowerCase(),
            C) {
            case "brl":
                C = "usd";
                break a;
            case "aud":
            case "cad":
            case "mxn":
                C = "usd"
            }
        else
            C = "hashtag";
        var U = "csvtype-" + Y + "-" + ha + "-threshold";
        C = material.getInputNumberPattern(U, U, CsvType.getName(ha), "", "", "", "off", C);
        d === getDomainByTld("com.br") && (C = material.getInputNumberPattern(U, U, CsvType.getName(ha), "", "", "", "off", "", "", '<i class="mdc-text-field__icon mdc-text-field__icon--custom">' + getCurrencyByDomain(d) + "</i>"));
        U = ka(da, Y);
        var ia = "--csvtype-color:" + ca.color + ";--csvtype-color-bg:" + ca.bg + ";";
        0 === da.indexOf("NEW_") && (ia = "--csvtype-color:" + CsvType.NEW.color + ";--csvtype-color-bg:" + CsvType.NEW.bg + ";");
        0 === da.indexOf("USED_") && (ia = "--csvtype-color:" + CsvType.USED.color + ";--csvtype-color-bg:" + CsvType.USED.bg + ";");
        0 === da.indexOf("REFURBISHED_") && (ia = "--csvtype-color:" + CsvType.REFURBISHED.color + ";--csvtype-color-bg:" + CsvType.REFURBISHED.bg + ";");
        var X = "";
        !0 === ma && (X += " tracking__block--deactivated");
        ca.isOfferData && ha !== CsvType.BUY_BOX_SHIPPING.index && (X += " tracking__block--offer-data");
        ma = "";
        "AMAZON" === da && Y === getDomainByTld("in") && (ma = '<div class="tracking__block-overlay--disable" title="Not available for amazon.in"></div>');
        graphIsRestricted(Y, ca.index) && (ma = '<div class="tracking__block-overlay--disable" title="' + la._895 + '"></div>');
        return '<div class="tracking__block' + X + '" style="' + ia + '" data-type="' + ha + '">\n\t\t\t\t' + C + (Y === d ? ' <span class="trigger trigger--switch-isdrop" title="' + la._850 + '"><span>' + la._95 + '</span> <i class="fa fa-fw fa-retweet"></i></span>' : ' <span class="trigger--switch-isdrop switch-' + ha + '-isdrop"><span>' + la._95 + "</span>") + '\n\t\t\t\t<p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent">\n  \t\t\t\t\t' + CsvType.getDescriptionTracking(ha) + "\n\t\t\t\t</p>\n\t\t\t\t" + U + '\t\n\t\t\t\t<input type="hidden" name="csvtype-' + Y + "-" + ha + '-isdrop" value="1" />\t\n\t\t\t\t' + ma + "\n\t\t\t</div>"
    }
      , qa = function(da, Y) {
        if ("object" !== typeof CsvType[da] || !0 !== CsvType[da].isEnabled || !0 !== CsvType[da].isTrackable)
            return "";
        var ma = CsvType[da].index
          , ca = "";
        switch (da) {
        case "NEW":
            if (CsvType.NEW_FBA.isTrackable || CsvType.NEW_FBM_SHIPPING.isTrackable)
                ca += material.getCheckbox("csvtype-" + Y + "-" + ma + "-shipping", la._836, !1, !1, "csvtype-" + Y + "-" + ma + "-shipping", 1) + "<br>";
            CsvType.NEW_FBA.isTrackable && (ca += "" + material.getCheckbox("csvtype-" + Y + "-" + ma + "-prime", la._837, !1, !1, "csvtype-" + Y + "-" + ma + "-prime", 1));
            break;
        case "USED":
            if (CsvType.USED_NEW_SHIPPING.isTrackable || CsvType.USED_VERY_GOOD_SHIPPING.isTrackable || CsvType.USED_GOOD_SHIPPING.isTrackable || CsvType.USED_ACCEPTABLE_SHIPPING.isTrackable)
                ca += material.getCheckbox("csvtype-" + Y + "-" + ma + "-shipping", la._836, !1, !1, "csvtype-" + Y + "-" + ma + "-shipping", 1) + "<br>";
            CsvType.WAREHOUSE.isTrackable && (ca += "" + material.getCheckbox("csvtype-" + Y + "-" + ma + "-prime", la._838, !1, !1, "csvtype-" + Y + "-" + ma + "-prime", 1));
            break;
        case "REFURBISHED":
            CsvType.REFURBISHED_SHIPPING.isTrackable && (ca += "" + material.getCheckbox("csvtype-" + Y + "-" + ma + "-shipping", la._836, !1, !1, "csvtype-" + Y + "-" + ma + "-shipping", 1));
            break;
        case "LIGHTNING_DEAL":
            ca += material.getCheckbox("csvtype-" + Y + "-" + ma + "-upcoming", la._839, !1, !1, "csvtype-" + Y + "-" + ma + "-upcoming", 1) + "<br>\n\t\t\t\t\t" + material.getCheckbox("csvtype-" + Y + "-" + ma + "-backinstock", la._840, !1, !1, "csvtype-" + Y + "-" + ma + "-backinstock", 1)
        }
        return 0 === ca.length ? "" : '<div class="tracking__block-switches">\n\t\t\t\t' + ca + "\n\t\t\t</div>"
    }
      , ka = function(da, Y) {
        if (ua())
            return "";
        var ma = D(da, Y);
        if (null == ma)
            return "";
        var ca = function(wa) {
            return CsvType[da].currency ? Money.format(wa, C) : CsvType[da].index === CsvType.RATING.index ? parseFloat(wa / 10).toFixed(1) : NumberUtil.format(wa, 0)
        }
          , ha = CsvType[da].currency ? m : "#"
          , C = {
            sourceDomainId: d,
            targetDomainId: d,
            skipSymbol: !0
        };
        Y = CsvType[da].currency ? la._488 : la._853;
        var U = CsvType[da].currency ? la._851 : la._852
          , ia = "";
        ma.decrease.length ? ma.decrease.forEach(function(wa) {
            var xa = ca(wa.value);
            ia += '<tr class="tracking__suggestion-item" data-value="' + xa + '"><td>' + wa.label + "</td><td>" + ha + " " + xa + "</td></tr>"
        }) : ia += '<tr class="tracking__suggestion-item--emtpy"><td colspan="2">' + U + "</td></tr>";
        var X = "";
        ma.increase.length ? ma.increase.forEach(function(wa) {
            var xa = ca(wa.value);
            X += '<tr class="tracking__suggestion-item" data-value="' + xa + '"><td>' + wa.label + "</td><td>" + ha + " " + xa + "</td></tr>"
        }) : X += '<tr class="tracking__suggestion-item--emtpy"><td colspan="2">' + U + "</td></tr>";
        U = '<tr class="tracking__suggestion-item--current"><td>' + la._344 + "</td><td>-</td></tr>";
        null != ma.current && -1 < ma.current && (U = '<tr class="tracking__suggestion-item--current"><td>' + la._344 + "</td><td>" + ha + " " + ca(ma.current) + "</td></tr>");
        ma = Math.max(ma.decrease.length, ma.increase.length);
        var sa = "";
        7 < ma && (sa += " tracking__suggestion--" + (ma - 7) + "more");
        sa += "USED WAREHOUSE COUNT_USED COUNT_REVIEWS REFURBISHED COUNT_REFURBISHED".split(" ").includes(da) ? " tracking__suggestion--right" : " tracking__suggestion--left";
        return '<div class="tracking__suggestion mdc-elevation--z2' + sa + '">\n\t\t\t<div class="tracking__suggestion--decrease">\n\t\t\t\t<table>\n\t\t\t\t\t' + U + "\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>" + la._854 + ' <i class="fa fa-long-arrow-down"></i></th>\n\t\t\t\t\t\t<th>' + Y + "</th>\n\t\t\t\t\t</tr>\n\t\t\t\t\t" + ia + '\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t\t<div class="tracking__suggestion--increase">\n\t\t\t\t<table>\n\t\t\t\t\t' + U + "\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>" + la._855 + ' <i class="fa fa-long-arrow-up"></i></th>\n\t\t\t\t\t\t<th>' + Y + "</th>\n\t\t\t\t\t</tr>\n\t\t\t\t\t" + X + "\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t</div>"
    }
      , za = function(da) {
        var Y = ""
          , ma = "";
        da !== d && (Y = '<div class="tracking__sync-switch">' + material.getCheckbox("syncdata-" + da, "Sync tracking settings from main locale", !1, !1, "syncdata-" + da, 1) + "</div>",
        ma = '<div class="tracking__sync-overlay"></div>');
        return "<hr>\n\t\t\t" + Y + '\n\t\t\t<section>\n\t\t\t\t<div>\n\t\t\t\t\t<div data-mode="basic">\t\t\n\t\t\t\t\t\t' + na("AMAZON", da) + '\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-mode="advanced">\n\t\t\t\t\t\t' + qa("LIGHTNING_DEAL", da) + "\n\t\t\t\t\t\t" + na("LIGHTNING_DEAL", da) + "\n\t\t\t\t\t</div>\n\t\t\t\t\t" + (da === d ? '<div class="tracking__block--meta" data-mode="advanced">\n\t\t\t\t\t\t' + material.getInput(!1, "", "metadata-memo", la._808, !1, "metadata-memo", "", "", !0, "", "") + "<br>\n\t\t\t\t\t\t" + material.getInput(!1, "", "metadata-tags", la._807, !1, "metadata-tags", "", "", !0, "", "") + "\n\t\t\t\t\t</div>" : "") + '\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div data-mode="basic">\n\t\t\t\t\t\t' + na("NEW", da) + '\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-mode="advanced">\n\t\t\t\t\t\t' + qa("NEW", da) + "\n\t\t\t\t\t\t" + na("NEW_FBA", da, !0) + "\n\t\t\t\t\t\t" + na("NEW_FBM_SHIPPING", da, !0) + '\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-mode="pro">\n\t\t\t\t\t\t' + na("COUNT_NEW", da) + '\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div>\t\t\t\n\t\t\t\t\t<div data-mode="basic">\n\t\t\t\t\t\t' + na("USED", da) + '\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-mode="advanced">\n\t\t\t\t\t\t' + qa("USED", da) + "\n\t\t\t\t\t\t" + na("WAREHOUSE", da, !0) + "\n\t\t\t\t\t\t" + na("USED_NEW_SHIPPING", da, !0) + "\n\t\t\t\t\t\t" + na("USED_VERY_GOOD_SHIPPING", da, !0) + "\n\t\t\t\t\t\t" + na("USED_GOOD_SHIPPING", da, !0) + "\n\t\t\t\t\t\t" + na("USED_ACCEPTABLE_SHIPPING", da, !0) + '\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-mode="pro">\n\t\t\t\t\t\t' + na("COUNT_USED", da) + '\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t\t<div data-mode="pro">\n\t\t\t\t<hr>\n\t\t\t\t<p class="mdc-typography--body2">' + la._841 + "</p>\n\t\t\t\t<section>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t" + na("SALES", da) + "\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t" + na("RATING", da) + "\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t" + na("COUNT_REVIEWS", da) + '\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\t\t\t\t<hr>\n\t\t\t\t<p class="mdc-typography--body2">' + la._842 + "</p>\n\t\t\t\t<section>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t" + na("BUY_BOX_SHIPPING", da) + "\n\t\t\t\t\t\t" + na("LISTPRICE", da) + "\n\t\t\t\t\t\t" + na("TRADE_IN", da) + "\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t" + na("COLLECTIBLE", da) + "\n\t\t\t\t\t\t" + na("COUNT_COLLECTIBLE", da) + "\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t" + na("REFURBISHED", da) + "\n\t\t\t\t\t\t" + qa("REFURBISHED", da) + "\n\t\t\t\t\t\t" + na("REFURBISHED_SHIPPING", da, !0) + "\n\t\t\t\t\t\t" + na("COUNT_REFURBISHED", da) + "\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t\t" + ma
    }
      , J = function() {
        var da = {
            id: "tracking__tab-bar",
            mode: "text",
            tabs: [{
                tab: {
                    id: "tracking__tab--" + d,
                    label: '<img src="' + flags[d] + '" /> .' + getTldByDomain(d).replace("com.", "").replace("co.", "")
                },
                panel: {
                    id: "tracking__panel--" + d,
                    content: za(d)
                },
                isActive: !0
            }],
            panelsClass: "tracking__panel"
        };
        if (!ua()) {
            var Y = domainIdToContinent[d];
            continents[Y].forEach(function(ma) {
                ma !== d && da.tabs.push({
                    tab: {
                        id: "tracking__tab--" + ma,
                        label: '<img src="' + flags[ma] + '" /> .' + getTldByDomain(ma).replace("com.", "").replace("co.", "")
                    },
                    panel: {
                        id: "tracking__panel--" + ma,
                        content: ""
                    }
                })
            });
            continents.forEach(function(ma, ca) {
                ca !== Y && ma.forEach(function(ha) {
                    ha !== d && da.tabs.push({
                        tab: {
                            id: "tracking__tab--" + ha,
                            label: '<img src="' + flags[ha] + '" /> .' + getTldByDomain(ha).replace("com.", "").replace("co.", "")
                        },
                        panel: {
                            id: "tracking__panel--" + ha,
                            content: ""
                        }
                    })
                })
            })
        }
        return material.getTabs(da)
    }
      , g = function() {
        var da = $.Deferred()
          , Y = material.getButton("multilocale__submit", la._848, null, "globe")
          , ma = material.getButton("multilocale__cancel", la._380, "ban", null, !1, !0)
          , ca = [13]
          , ha = [la._664, la._665, la._353, la._354, la._663]
          , C = "";
        continents.forEach(function(U, ia) {
            var X = "";
            ca.length && (U = U.filter(function(sa) {
                return !ca.includes(sa) || sa === d
            }));
            0 !== U.length && (U.forEach(function(sa) {
                X += material.getCheckbox("multilocale-" + sa, '<img src="' + flags[sa] + '" /> .' + getTldByDomain(sa).replace("com.", "").replace("co.", ""), !1, !1, "multilocale[]", sa);
                X += '<span class="tracking__multilocale-casin-data tracking__multilocale-casin-data--' + sa + '"><i class="fa fa-spinner fa-pulse"></i></span>'
            }),
            C += X ? '<div>\n\t\t\t\t\t<span class="tracking__multilocale-select-all"><i class="fa fa-fw fa-caret-down"></i> ' + ha[ia] + "</span>\n\t\t\t\t\t" + X + "\n\t\t\t\t</div>" : "")
        });
        Y = '<div class="tracking__popup">\n\t\t\t\t<form id="tracking__form--multilocale">\t\n\t\t\t\t\t<div class="tracking__multilocale-options">\n\t\t\t\t\t\t' + C + "\n\t\t\t\t\t</div>\t\t\t\t\n\t\t\t\t\t<div>" + Y + "&emsp;" + ma + '</div>\n\t\t\t\t\t<p class="mdc-typography--caption">' + la._349 + "</p>\n\t\t\t\t</form>\n\t\t\t</div>";
        material.init("#tracking__form--multilocale");
        setTimeout(function() {
            var U = $("#tracking__form--multilocale")
              , ia = U.find('input[value="' + d + '"]');
            ia.prop("checked", !0);
            ia.prop("disabled", !0);
            $("#tracking__tab-bar").find(".mdc-tab:visible").each(function() {
                var wa = $(this).attr("id").replace("tracking__tab--", "");
                U.find('input[value="' + wa + '"]').prop("checked", !0)
            });
            U.find(".tracking__multilocale-select-all").on("click", function(wa) {
                wa = $(this).closest("div");
                0 < wa.find('input[type="checkbox"]:not(:checked)').length ? wa.find('input[type="checkbox"]').prop("checked", !0) : wa.find('input[type="checkbox"]:not(:disabled)').prop("checked", !1)
            });
            var X = $("#multilocale__submit")
              , sa = $("#multilocale__cancel");
            sa.on("click", function(wa) {
                wa.preventDefault();
                da.resolve()
            });
            X.on("click", function(wa) {
                wa.preventDefault();
                X.prop("disabled", !0);
                sa.prop("disabled", !0);
                var xa = [];
                U.find("input:checked:not(:disabled)").each(function() {
                    xa.push(Number($(this).val()))
                });
                ba(xa, !0).onLoad.done(function(Ia) {
                    "undefined" !== typeof Ia && G(Ia);
                    da.resolve({
                        enableDomainIds: xa
                    })
                }).fail(function() {
                    da.resolve({
                        enableDomainIds: xa
                    })
                })
            })
        }, 0);
        return {
            onSubmit: da.promise(),
            html: Y
        }
    }
      , D = function(da, Y) {
        var ma = Y === a.domainId ? a : h[Y];
        if ("undefined" === typeof ma)
            return {
                decrease: [],
                increase: [],
                current: null
            };
        var ca = ma.csv[CsvType[da].index]
          , ha = ma.stats[CsvType[da].index] ? ma.stats[CsvType[da].index] : null
          , C = []
          , U = [];
        ma = {
            sourceDomainId: ma.domainId,
            targetDomainId: d,
            keepUnit: !0
        };
        var ia = null;
        if (null !== ca) {
            var X = CsvType[da].currency ? Money.format(1, {
                sourceDomainId: d,
                targetDomainId: d,
                skipSymbol: !0
            }) : 1;
            CsvType[da].index === CsvType.RATING.index && (X = parseFloat(X / 10).toFixed(1));
            var sa = [3, 5, 7, 10, 20]
              , wa = Number(get("s_percent"));
            -1 === sa.indexOf(wa) && sa.push(wa);
            var xa = [];
            ia = getLast(ca, CsvType[da]);
            CsvType[da].currency && Y !== d && (ia = Money.raw(ia, ma));
            0 < ia && (ca = ia - 1,
            C.push({
                label: la._856 + " (" + (CsvType[da].currency ? m + " " : "") + "-" + X + ")",
                value: ca
            }),
            xa.push(ca));
            ha && (0 < ha.lowest.val && (ha.lowest.val < ia || -1 === ia) && (ca = Math.floor(ha.lowest.val),
            CsvType[da].currency && Y !== d && (ca = Money.raw(ca, ma)),
            -1 === xa.indexOf(ca) && (C.push({
                label: la._859,
                value: ca
            }),
            xa.push(ca))),
            0 < ha.lowest90.val && (ha.lowest90.val < ia || -1 === ia) && (ca = Math.floor(ha.lowest90.val),
            CsvType[da].currency && Y !== d && (ca = Money.raw(ca, ma)),
            -1 === xa.indexOf(ca) && (C.push({
                label: la._383 + " 3 " + la._878,
                value: ca
            }),
            xa.push(ca))),
            0 < ha.lowest180.val && (ha.lowest180.val < ia || -1 === ia) && (ca = Math.floor(ha.lowest180.val),
            CsvType[da].currency && Y !== d && (ca = Money.raw(ca, ma)),
            -1 === xa.indexOf(ca) && (C.push({
                label: la._383 + " 6 " + la._878,
                value: ca
            }),
            xa.push(ca))),
            0 < ha.lowest365.val && (ha.lowest365.val < ia || -1 === ia) && (ca = Math.floor(ha.lowest365.val),
            CsvType[da].currency && Y !== d && (ca = Money.raw(ca, ma)),
            -1 === xa.indexOf(ca) && (C.push({
                label: la._383 + " 1 " + la._879,
                value: ca
            }),
            xa.push(ca))),
            0 < ha.avg.val && (ha.avg.val < ia || -1 === ia) && (ca = Math.floor(ha.avg.val),
            CsvType[da].currency && Y !== d && (ca = Money.raw(ca, ma)),
            -1 === xa.indexOf(ca) && (C.push({
                label: "90 " + la._857,
                value: ca
            }),
            xa.push(ca))),
            0 < ha.avg180.val && (ha.avg180.val < ia || -1 === ia) && (ca = Math.floor(ha.avg180.val),
            CsvType[da].currency && Y !== d && (ca = Money.raw(ca, ma)),
            -1 === xa.indexOf(ca) && (C.push({
                label: "180 " + la._857,
                value: ca
            }),
            xa.push(ca))));
            0 < ia && sa.forEach(function(Ia) {
                var Fa = Math.floor(ia - ia * Ia / 100);
                -1 === xa.indexOf(Fa) && (C.push({
                    label: "-" + Ia + "%",
                    value: Fa
                }),
                xa.push(Fa))
            });
            C.sort(function(Ia, Fa) {
                return Ia.value > Fa.value ? -1 : Ia.value < Fa.value ? 1 : 0
            });
            xa = [];
            0 < ia && (ca = ia + 1,
            U.push({
                label: "Any (" + (CsvType[da].currency ? m + " " : "") + "+" + X + ")",
                value: ca
            }),
            xa.push(ca));
            ha && (0 < ha.highest.val && (ha.highest.val > ia || -1 === ia) && (X = Math.ceil(ha.highest.val),
            CsvType[da].currency && Y !== d && (X = Money.raw(X, ma)),
            -1 === xa.indexOf(X) && (U.push({
                label: la._858,
                value: X
            }),
            xa.push(X))),
            0 < ha.highest90.val && (ha.highest90.val > ia || -1 === ia) && (X = Math.floor(ha.highest90.val),
            CsvType[da].currency && Y !== d && (X = Money.raw(X, ma)),
            -1 === xa.indexOf(X) && (U.push({
                label: la._384 + " 3 " + la._878,
                value: X
            }),
            xa.push(X))),
            0 < ha.highest180.val && (ha.highest180.val > ia || -1 === ia) && (X = Math.floor(ha.highest180.val),
            CsvType[da].currency && Y !== d && (X = Money.raw(X, ma)),
            -1 === xa.indexOf(X) && (U.push({
                label: la._384 + " 6 " + la._878,
                value: X
            }),
            xa.push(X))),
            0 < ha.highest365.val && (ha.highest365.val > ia || -1 === ia) && (X = Math.floor(ha.highest365.val),
            CsvType[da].currency && Y !== d && (X = Money.raw(X, ma)),
            -1 === xa.indexOf(X) && (U.push({
                label: la._384 + " 1 " + la._879,
                value: X
            }),
            xa.push(X))),
            0 < ha.avg.val && (ha.avg.val > ia || -1 === ia) && (X = Math.ceil(ha.avg.val),
            CsvType[da].currency && Y !== d && (X = Money.raw(X, ma)),
            -1 === xa.indexOf(X) && (U.push({
                label: "90 " + la._857,
                value: X
            }),
            xa.push(X))),
            0 < ha.avg180.val && (ha.avg180.val > ia || -1 === ia) && (ha = Math.ceil(ha.avg180.val),
            CsvType[da].currency && Y !== d && (ha = Money.raw(ha, ma)),
            -1 === xa.indexOf(ha) && (U.push({
                label: "180 " + la._857,
                value: ha
            }),
            xa.push(ha))));
            0 < ia && sa.forEach(function(Ia) {
                var Fa = Math.ceil(ia + ia * Ia / 100);
                -1 === xa.indexOf(Fa) && (U.push({
                    label: "+" + Ia + "%",
                    value: Fa
                }),
                xa.push(Fa))
            });
            U.sort(function(Ia, Fa) {
                return Ia.value > Fa.value ? 1 : Ia.value < Fa.value ? -1 : 0
            });
            CsvType[da].index === CsvType.RATING.index && (U = U.filter(function(Ia) {
                return 50 >= Ia.value
            }))
        }
        return {
            decrease: C,
            increase: U,
            current: ia
        }
    }
      , N = function() {
        var da = !1;
        $("#trackingForm").find(".tracking__block--offer-data .mdc-text-field__input:not(:disabled)").each(function(Y, ma) {
            if ($(ma).val())
                return da = !0,
                !1
        });
        da ? $(".tracking__hint--offerdata").show() : $(".tracking__hint--offerdata").hide()
    }
      , ba = function(da, Y) {
        var ma = $.Deferred()
          , ca = {};
        da.forEach(function(ha) {
            "undefined" === typeof h[ha] && (ca[ha] = [a.asin])
        });
        0 < Object.keys(ca).length ? (da = {
            path: "product",
            offerPages: 0,
            history: !0,
            maxAge: 60,
            type: "casin",
            refreshProduct: !1
        },
        1 !== Object.keys(ca).length || Y ? ma = networkHelper.loadASINs(da, ca, "") : (da.asin = a.asin,
        da.domainId = Object.keys(ca)[0],
        da.version = 3,
        ma = network.request(da))) : ma.resolve();
        return {
            onLoad: ma.promise()
        }
    }
      , q = function(da, Y) {
        da.val(Y);
        Y.toString().length ? da.next("label").addClass("mdc-floating-label--float-above") : da.next("label").removeClass("mdc-floating-label--float-above");
        N()
    }
      , L = function() {
        var da = "basic"
          , Y = b.notifyIf || []
          , ma = b.thresholdValues || []
          , ca = ma.filter(function(C) {
            return 0 <= C.thresholdValueCSV[C.thresholdValueCSV.length - 1] && 0 < C.domain
        }).map(function(C) {
            return C.domain
        }).concat(Y.map(function(C) {
            return C.domain
        })).filter(function(C) {
            return C !== d
        });
        ca = Array.from(new Set(ca));
        var ha = function() {
            ca.forEach(function(Ja) {
                Ba(Ja, !0, !0);
                P([Ja], $("#tracking__tab--" + Ja), !0)
            });
            var C = {
                NEW: [],
                USED: [],
                REFURBISHED: []
            }
              , U = {
                NEW: [],
                USED: []
            }
              , ia = !1
              , X = !1;
            ma.forEach(function(Ja) {
                var Pa = CsvType.getObject(Ja.csvType)
                  , Oa = CsvType.getObjectName(Ja.csvType)
                  , Ha = Ja.thresholdValueCSV[Ja.thresholdValueCSV.length - 1];
                if (!(0 > Ha)) {
                    var ya = $('input[name="csvtype-' + Ja.domain + "-" + Ja.csvType + '-threshold"]');
                    if (1 !== ya.length)
                        isTest && ![CsvType.EBAY_NEW_SHIPPING.index, CsvType.EBAY_USED_SHIPPING.index].includes(Ja.csvType) && console.warn("missing input for threshold", Ja);
                    else {
                        if (Pa.currency) {
                            var Na = d
                              , La = d;
                            d !== Ja.domain && Ja.domain === a.domainId && (Na = a.domainId);
                            Ha = Money.format(Ha, {
                                sourceDomainId: Na,
                                targetDomainId: La,
                                skipSymbol: !0
                            });
                            Ja.csvType === CsvType.AMAZON.index ? ia = !0 : [CsvType.NEW.index, CsvType.NEW_FBA.index, CsvType.NEW_FBM_SHIPPING.index].includes(Ja.csvType) && (X = !0)
                        } else
                            Ha = Ja.csvType === CsvType.RATING.index ? Ja.domain === d ? Ha.toFixed(1) : parseFloat((Ha / 10).toFixed(1)) : NumberUtil.format(Ha, 0);
                        q(ya, Ha);
                        graphIsRestricted(Ja.domain, Ja.csvType) && ya.closest(".tracking__block").find(".tracking__block-overlay--disable").remove();
                        Ja.isDrop || Ja.domain !== d || ya.closest(".tracking__block").find(".trigger--switch-isdrop").trigger("click");
                        Ja.csvType === CsvType.NEW_FBA.index ? U.NEW.push(Ja.domain) : Ja.csvType === CsvType.WAREHOUSE.index ? U.USED.push(Ja.domain) : Pa.isWithShipping && (Pa = Oa.split("_")[0],
                        C[Pa] && C[Pa].push(Ja.domain));
                        "basic" !== da || S.includes(Ja.csvType) || (da = "advanced");
                        S.includes(Ja.csvType) || aa.includes(Ja.csvType) || (da = "pro")
                    }
                }
            });
            n && ia && !X && ($(".tracking__hint--amazononly").show(),
            setTimeout(ta, 1));
            var sa = "false" !== storage.sendUpcomingLightningDealsAlert
              , wa = "false" !== storage.sendStartLightningDealsAlert;
            $('input[name$="-upcoming"]').prop("checked", b.lightningDealsAlerts);
            sa !== b.lightningDealsAlerts && "basic" === da && (da = "advanced");
            Y.forEach(function(Ja) {
                switch (Ja.notifyIfType) {
                case 1:
                    var Pa = $('input[name="csvtype-' + Ja.domain + "-" + Ja.csvType + '-backinstock"]');
                    if (1 !== Pa.length) {
                        isTest && console.warn("missing input for backinstock", Ja);
                        break
                    }
                    Pa.prop("checked", !0).change();
                    wa || (da = "advanced");
                    break;
                default:
                    isTest && console.warn("missing notifyIf implementation for notifyIf", Ja)
                }
            });
            for (var xa in U)
                if (sa = U[xa],
                sa.length) {
                    sa = $jscomp.makeIterator(sa);
                    for (var Ia = sa.next(); !Ia.done; Ia = sa.next())
                        Ia = Ia.value,
                        -1 === C[xa].indexOf(Ia) && (Ia = $('input[name="csvtype-' + Ia + "-" + CsvType[xa].index + '-prime"]'),
                        1 !== Ia.length ? isTest && console.warn("missing input for prime", thv) : Ia.prop("checked", !0).change())
                }
            for (var Fa in C)
                if (xa = C[Fa],
                xa.length)
                    for (xa = $jscomp.makeIterator(xa),
                    Ia = xa.next(); !Ia.done; Ia = xa.next())
                        sa = $('input[name="csvtype-' + Ia.value + "-" + CsvType[Fa].index + '-shipping"]'),
                        1 !== sa.length ? isTest && console.warn("missing input for shipping", thv) : sa.prop("checked", !0).change();
            xa = Fa = "";
            try {
                var Ga = JSON.parse(b.metaData);
                "undefined" !== typeof Ga.memo && (Fa = Ga.memo);
                if ("undefined" !== typeof Ga.tags) {
                    var Da = Ga.tags;
                    "string" === typeof Ga.tags && (Da = [Ga.tags]);
                    0 < Da.length && (Da = Da.join(" "));
                    xa = Da
                }
            } catch (Ja) {}
            q($('input[name="metadata-memo"]'), Fa);
            q($('input[name="metadata-tags"]'), xa);
            (Fa.length || xa.length) && "basic" === da && (da = "advanced");
            $("#tracking-mode-" + da + "-radio").prop("checked", !0).change();
            if (ca.length) {
                var Ma = $("#tracking__panel--" + d).find('input[type="text"], input[name$="-backinstock"]').serializeArray()
                  , Qa = ["metadata-memo", "metadata-tags"];
                d === getDomainByTld("com") && Qa.push("csvtype-" + d + "-" + CsvType.TRADE_IN.index + "-threshold");
                Ma = Ma.map(function(Ja) {
                    return Qa.includes(Ja.name) ? !1 : Ja.value
                }).filter(function(Ja) {
                    return !1 !== Ja
                });
                ca.forEach(function(Ja) {
                    var Pa = $("#tracking__panel--" + Ja).find('input[type="text"], input[name$="-backinstock"]').serializeArray();
                    Pa = Pa.map(function(Oa) {
                        return Oa.value
                    });
                    Pa.length === Ma.length && Ma.every(function(Oa, Ha) {
                        return Oa === Pa[Ha]
                    }) && $('input[name="syncdata-' + Ja + '"]').prop("checked", !0).change()
                })
            }
            $(".tracking").show()
        };
        ba(ca, !0).onLoad.done(function(C) {
            "undefined" !== typeof C && G(C);
            setTimeout(ha, 0)
        }).fail(function() {
            setTimeout(ha, 0)
        })
    }
      , A = function() {
        var da = get("s_trackingMode")
          , Y = Number(get("s_percent"))
          , ma = get("s_merchantTrack")
          , ca = "false" !== storage.sendUpcomingLightningDealsAlert
          , ha = "false" !== storage.sendStartLightningDealsAlert
          , C = -1 != a.AMAZON_LAST ? a.AMAZON_LAST : -1 != a.MARKET_NEW_LAST ? a.MARKET_NEW_LAST : -1 != a.MARKET_USED_LAST ? a.MARKET_USED_LAST : -1
          , U = function(sa) {
            if (ua())
                return NumberUtil.format(Y, 0);
            var wa = {
                sourceDomainId: d,
                targetDomainId: d,
                skipSymbol: !0
            };
            return 0 > sa ? Money.format(1E7, wa) : Money.format(Math.floor(sa - sa * Y / 100), wa)
        }
          , ia = !1
          , X = !1;
        "1" != ma.charAt(CsvType.AMAZON.index) || n || (ia = U(C),
        $('input[name="csvtype-' + d + "-" + CsvType.AMAZON.index + '-threshold"]').val(ia),
        ia = !0);
        "1" != ma.charAt(CsvType.NEW.index) || r || (X = U(-1 != a.MARKET_NEW_LAST ? a.MARKET_NEW_LAST : C),
        $('input[name="csvtype-' + d + "-" + CsvType.NEW.index + '-threshold"]').val(X),
        X = !0);
        "1" != ma.charAt(CsvType.USED.index) || p || (ma = U(-1 != a.MARKET_USED_LAST ? a.MARKET_USED_LAST : C),
        $('input[name="csvtype-' + d + "-" + CsvType.USED.index + '-threshold"]').val(ma));
        n && ia && !X && ($(".tracking__hint--amazononly").show(),
        setTimeout(ta, 1));
        ca && $('input[name="csvtype-' + d + "-" + CsvType.LIGHTNING_DEAL.index + '-upcoming"]').prop("checked", !0).change();
        ha && $('input[name="csvtype-' + d + "-" + CsvType.LIGHTNING_DEAL.index + '-backinstock"]').prop("checked", !0).change();
        $(".tracking").show();
        ["advanced", "pro"].includes(da) && $("#tracking-mode-" + da + "-radio").prop("checked", !0).change()
    }
      , O = function() {
        V = !1;
        var da = $("#submitTracking");
        da.prop("disabled", !1);
        da.html((t ? la._681 : la._110) + ' &ensp;<i class="fa fa-bell-o"></i>');
        $(".tracking__submit-overlay").hide()
    }
      , P = function(da, Y, ma) {
        da.forEach(function(ca) {
            Y = Y || $(".tracking__multilocale-casin-data--" + ca);
            var ha = ca === d ? a : h[ca];
            if ("undefined" === typeof ha)
                ma || Y.html("&nbsp;");
            else {
                var C = ha.stats[CsvType.AMAZON.index]
                  , U = ha.stats[CsvType.NEW.index]
                  , ia = ha.stats[CsvType.USED.index]
                  , X = -1
                  , sa = ha = -1;
                C && (X = C.current.val ? C.current.val : C.current);
                C && (ha = U.current.val ? U.current.val : U.current);
                C && (sa = ia.current.val ? ia.current.val : ia.current);
                0 > X && 0 > ha && 0 > sa ? ma || Y.html("&nbsp;") : (ca = {
                    sourceDomainId: ca,
                    targetDomainId: d
                },
                ma ? (C = 0 < X ? "Amazon: " + Money.format(X, ca) + " " : "",
                C += 0 < ha ? (C ? " - " : "") + CsvType.getName(CsvType.NEW.index) + ": " + Money.format(ha, ca) + " " : "",
                C += 0 < sa ? (C ? " - " : "") + CsvType.getName(CsvType.USED.index) + ": " + Money.format(sa, ca) : "",
                Y.attr("title", C)) : (ha = "\n\t\t\t\t\t" + (0 < X ? '<span title="Amazon">' + Money.format(X, ca) + "</span>" : '<span style="display:none;"></span>') + "\n\t\t\t\t\t" + (0 < ha ? '<span title="' + CsvType.getName(CsvType.NEW.index) + '">' + Money.format(ha, ca) + "</span>" : '<span style="display:none;"></span>') + "\n\t\t\t\t\t" + (0 < sa ? '<span title="' + CsvType.getName(CsvType.USED.index) + '">' + Money.format(sa, ca) + "</span>" : '<span style="display:none;"></span>') + "\n\t\t\t\t",
                Y.html(ha)))
            }
        })
    }
      , M = function(da) {
        var Y = function(Da, Ma) {
            var Qa = CsvType.getObject(Ma);
            Da = Da.replace(/(\d)\.(\d\d)/g, "$1$2");
            Da = Da.replace(/(\d)\.(\d)/g, "$1$2");
            Da = Da.replace(/(\d),(\d)/g, "$1$2");
            Qa.currency ? Da = Da.replace(/^0+/, "") : Ma === CsvType.RATING.index && (Da = Da.replace(/(\d)\.(\d)/g, "$1$2"));
            return Da
        }
          , ma = !1
          , ca = {
            memo: "",
            tags: []
        }
          , ha = {}
          , C = {}
          , U = Array.apply(null, Array(CsvType.length)).map(function(Da) {
            return 0
        })
          , ia = !1
          , X = !0
          , sa = !0
          , wa = $("#trackingForm").serializeArray();
        $.each(wa, function() {
            if (!["tracking-mode", "tracking-ttl"].includes(this.name) && !this.name.includes("syncdata"))
                if ("tracking-import-purchased" === this.name)
                    X = !1;
                else if ("tracking-overwrite-existing" === this.name)
                    ia = !0;
                else if ("tracking-import-oos" === this.name)
                    sa = !1;
                else {
                    var Da = this.value
                      , Ma = !0;
                    if ("metadata-memo" === this.name)
                        ca.memo = Da.slice(0, 100);
                    else if ("metadata-tags" === this.name) {
                        Da = Da.replace(/\s\s+/g, " ");
                        if (Da.length)
                            for (Da = Da.split(" "); 200 < Da.join('","').length; )
                                Da.pop();
                        else
                            Da = [];
                        ca.tags = Array.from(new Set(Da))
                    } else {
                        var Qa = this.name.split("-")
                          , Ja = Number(Qa[1])
                          , Pa = Number(Qa[2])
                          , Oa = Qa[3];
                        Qa = [Ja, Pa].join("-");
                        if (!["prime", "shipping"].includes(Oa))
                            switch (Oa) {
                            case "threshold":
                                Da = Y(Da, Pa);
                                Da.length && (Oa = (b && b.thresholdValues || []).find(function(Ha) {
                                    return Ha.csvType === Pa && Ha.domain === Ja && 0 <= Ha.thresholdValueCSV[Ha.thresholdValueCSV.length - 1]
                                }),
                                !graphIsRestricted(Ja, Pa) || Oa) && (ua() ? (C[Qa] = {
                                    domain: Ja,
                                    csvType: Pa,
                                    notifyIfType: 2
                                },
                                U[Pa] = -1 * Da) : ha[Qa] = {
                                    domain: Ja,
                                    csvType: Pa,
                                    isDrop: Ma,
                                    thresholdValue: Da
                                });
                                break;
                            case "isdrop":
                                Ma = f && "1" !== Da ? !1 : !0;
                                ha[Qa] && (ha[Qa].isDrop = Ma);
                                U[Pa] && !Ma && (U[Pa] *= -1);
                                break;
                            case "upcoming":
                                ma = !0;
                                break;
                            case "backinstock":
                                C[Qa] = {
                                    domain: Ja,
                                    csvType: Pa,
                                    notifyIfType: 1
                                };
                                break;
                            default:
                                isTest && console.warn("missing input handling", this, Oa)
                            }
                    }
                }
        });
        "basic" === $('input[name="tracking-mode"]:checked').val() && (ma = "false" !== storage.sendUpcomingLightningDealsAlert,
        "false" !== storage.sendStartLightningDealsAlert && $("#tracking__tab-bar").find(".mdc-tab:visible").each(function() {
            var Da = $(this).attr("id").replace("tracking__tab--", "");
            C[[Da, CsvType.LIGHTNING_DEAL.index].join("-")] = {
                domain: Da,
                csvType: CsvType.LIGHTNING_DEAL.index,
                notifyIfType: 1
            }
        }));
        delete ha[getDomainByTld("in") + "-" + CsvType.AMAZON.index];
        delete C[getDomainByTld("in") + "-" + CsvType.AMAZON.index];
        userData && userData.useEbay && !0 === globalEbayArray[d] && (ua() ? (C[d + "-" + CsvType.AMAZON.index] ? (wa = C[d + "-" + CsvType.AMAZON.index],
        C[d + "-" + CsvType.EBAY_NEW_SHIPPING.index] = {
            domain: wa.domain,
            csvType: CsvType.EBAY_NEW_SHIPPING.index,
            notifyIfType: 2
        },
        U[CsvType.EBAY_NEW_SHIPPING.index] = U[wa.csvType]) : C[d + "-" + CsvType.NEW.index] && (wa = C[d + "-" + CsvType.NEW.index],
        C[d + "-" + CsvType.EBAY_NEW_SHIPPING.index] = {
            domain: wa.domain,
            csvType: CsvType.EBAY_NEW_SHIPPING.index,
            notifyIfType: 2
        },
        U[CsvType.EBAY_NEW_SHIPPING.index] = U[wa.csvType]),
        C[d + "-" + CsvType.USED.index] && (wa = C[d + "-" + CsvType.USED.index],
        C[d + "-" + CsvType.EBAY_USED_SHIPPING.index] = {
            domain: wa.domain,
            csvType: CsvType.EBAY_USED_SHIPPING.index,
            notifyIfType: 2
        },
        U[CsvType.EBAY_USED_SHIPPING.index] = U[wa.csvType])) : (ha[d + "-" + CsvType.AMAZON.index] ? (wa = ha[d + "-" + CsvType.AMAZON.index],
        ha[d + "-" + CsvType.EBAY_NEW_SHIPPING.index] = {
            domain: wa.domain,
            csvType: CsvType.EBAY_NEW_SHIPPING.index,
            isDrop: wa.isDrop,
            thresholdValue: wa.thresholdValue
        }) : ha[d + "-" + CsvType.NEW.index] && (wa = ha[d + "-" + CsvType.NEW.index],
        ha[d + "-" + CsvType.EBAY_NEW_SHIPPING.index] = {
            domain: wa.domain,
            csvType: CsvType.EBAY_NEW_SHIPPING.index,
            isDrop: wa.isDrop,
            thresholdValue: wa.thresholdValue
        }),
        ha[d + "-" + CsvType.USED.index] && (wa = ha[d + "-" + CsvType.USED.index],
        ha[d + "-" + CsvType.EBAY_USED_SHIPPING.index] = {
            domain: wa.domain,
            csvType: CsvType.EBAY_USED_SHIPPING.index,
            isDrop: wa.isDrop,
            thresholdValue: wa.thresholdValue
        })));
        wa = Ea();
        var xa = va()
          , Ia = Number($('[name="tracking-ttl"]').val());
        "undefined" === typeof wa.find(function(Da) {
            return Da.value == Ia
        }) && (Ia = xa);
        wa = {
            asin: a.asin,
            desiredPrices: [],
            lightningDealsAlerts: ma,
            mainDomainId: d,
            metaData: JSON.stringify(ca),
            notifyIf: [],
            ttl: Ia,
            minChangeBetweenNotifications: null,
            overwriteExistingTrackings: !0,
            removeTrackingWhenDeleted: !1,
            removeTrackingWhenPurchased: !1,
            skipIfNotInStock: !0,
            desiredPricesInMainCurrency: !0,
            expireNotify: !0,
            individualNotificationInterval: -1,
            isOneTimeImport: !0,
            notificationType: []
        };
        ua() && (delete wa.asin,
        wa.desiredPrices = null,
        wa.minChangeBetweenNotifications = U,
        wa.overwriteExistingTrackings = ia,
        wa.skipIfNotInStock = sa,
        null != E ? (wa.removeTrackingWhenDeleted = !0,
        wa.removeTrackingWhenPurchased = X,
        wa.wishListId = E) : I.length && (wa.asinList = I));
        for (var Fa in ha)
            wa.desiredPrices.push(ha[Fa]);
        for (var Ga in C)
            wa.notifyIf.push(C[Ga]);
        isTest && console.info("%ctrackingRequest", "color:#018786;font-weight:bold;", wa);
        ua() && null == E ? (alert("@todo API call for asinLists (no wishlist)"),
        O()) : (Fa = "addTracking",
        ua() && null != E ? Fa = "wishListImport" : ua() && (Fa = "listImport"),
        network.request({
            path: "track",
            type: Fa,
            trackingRequest: wa,
            version: 3
        }).done(function(Da) {
            V = !1;
            if (null == Da.error)
                v(Da);
            else
                switch (Da.error.type) {
                case "userNotKnown":
                    registerAnonymous().done(function() {
                        Aa(da)
                    }).fail(function(Ja) {
                        u(Da, Ja)
                    });
                    break;
                case "productNotKnown":
                    var Ma = function() {
                        showPopup("Tracking Error", '<p class="mdc-typography--body2">\n                                        Product is invalid and can not be tracked.\n                                    </p>', !0)
                    };
                    ua() && K ? (H.close(),
                    setTimeout(function() {
                        Ma()
                    }, 500)) : (Ma(),
                    O());
                    break;
                case "maxTrackingReached":
                    var Qa = function() {
                        showPopup("Tracking Limit Reached", '<p class="mdc-typography--body2">\n                                        ' + la._920.replace("#maxTrackingAllowed#", maxTrackingAllowed) + "<br><br><b>" + la._921 + "</b>\n                                    </p>", !0)
                    };
                    ua() && K ? (H.close(),
                    setTimeout(function() {
                        Qa()
                    }, 500)) : (Qa(),
                    O());
                    break;
                default:
                    u(Da)
                }
        }).fail(function(Da) {
            u(Da)
        }))
    }
      , u = function(da, Y) {
        isTest && console.info("%csendTrackingFailed", "color:#018786;font-weight:bold;", da);
        Y ? reportBug(null, "track failed due to anon register failed.") : ua() && null != E ? reportBug(null, "wishlistimport: " + JSON.stringify(da) + " " + E + " " + I.join()) : reportBug(null, "track failed due to error.type: '" + da.error.type + "'");
        ua() && K ? (replaceHtml(z, '<div class="tracking__warning"><p class="mdc-typography--body2">' + la._error + "</p></div>"),
        $(".tracking__warning p").show()) : (setTimeout(showErrorPopup, 50),
        O())
    }
      , v = function(da) {
        da.hash && ("function" == typeof addon && ta("resync"),
        handleSettingsRequest(da, !0),
        $("#tabTrack").trigger("click"));
        var Y = storage.token ? "r/" + storage.token + "manage" : "#!manage";
        da = "";
        1 == storage.accountType && "function" != typeof addon && (da = '<p class="mdc-typography--body2">\n\t\t\t\t' + la._289 + ':<br>&raquo; <a href="/' + Y + '" class="href">' + rootURL + Y + "</a>\n\t\t\t</p>");
        Y = la._287 + '\n\t\t\t\t\t<a class="href" target="_parent" href="//' + location.hostname + '/#!manage">' + la._20 + "</a>\n\t\t\t\t\t" + la._288;
        ua() && (Y = la._223);
        da = '<div class="tracking' + (isMobile ? " tracking--mobile" : "") + '">\n\t\t\t\t<p class="mdc-typography--body2 tracking__paragraph--success">\n\t\t\t\t\t<i class="fa fa-check-circle-o" ></i>&emsp;' + Y + '\n\t\t\t\t</p>\n\t\t\t\t<div id="notification-channels"></div>\n\t\t\t\t' + da + "\n\t\t\t</div>";
        $("#" + z).html(da);
        SettingsNotification.init()
    }
      , G = function(da) {
        for (var Y in da)
            "object" === typeof da[Y] && null != da[Y] && da[Y].domainId && (null == da[Y].stats && (da[Y].stats = getStatistics(da[Y])),
            h[da[Y].domainId] = da[Y])
    }
      , w = function(da) {
        var Y = $("#tracking__panel--" + da)
          , ma = function(ca, ha, C, U) {
            var ia = ["AMAZON", "NEW", "USED", "REFURBISHED", "LIGHTNING_DEAL"].includes(ca)
              , X = Y.find('input[name="csvtype-' + da + "-" + CsvType[ca].index + '-threshold"]');
            ca = Y.find('input[name="csvtype-' + da + "-" + CsvType[ca].index + '-isdrop"]');
            ha ? (X.prop("disabled", !0),
            X.closest(".mdc-text-field").addClass("mdc-text-field--disabled"),
            ia || X.closest(".tracking__block").addClass("tracking__block--deactivated")) : (X.prop("disabled", !1),
            X.closest(".mdc-text-field").removeClass("mdc-text-field--disabled"),
            ia || X.closest(".tracking__block").removeClass("tracking__block--deactivated"),
            null != C && "" === X.val() && (q(X, C),
            ca.val() !== U && (ha = da === d ? "click" : "pseudoclick",
            ca.closest(".tracking__block").find(".trigger--switch-isdrop").trigger(ha))))
        };
        Y.find('input[type="checkbox"]').on("change", function(ca) {
            var ha = $(this).attr("name");
            ca = $(this).prop("checked");
            switch (ha) {
            case "csvtype-" + da + "-" + CsvType.NEW.index + "-shipping":
                var C = Y.find('input[name="csvtype-' + da + "-" + CsvType.NEW.index + '-prime"]').prop("checked");
                ha = Y.find('input[name="csvtype-' + da + "-" + CsvType.NEW.index + '-threshold"]').val();
                var U = Y.find('input[name="csvtype-' + da + "-" + CsvType.NEW.index + '-isdrop"]').val();
                ca ? (ma("NEW", !0),
                ma("NEW_FBA", !1, ha, U),
                ma("NEW_FBM_SHIPPING", C, ha, U)) : (ma("NEW", C),
                ma("NEW_FBA", !C),
                ma("NEW_FBM_SHIPPING", !0));
                break;
            case "csvtype-" + da + "-" + CsvType.NEW.index + "-prime":
                C = Y.find('input[name="csvtype-' + da + "-" + CsvType.NEW.index + '-shipping"]').prop("checked");
                ha = Y.find('input[name="csvtype-' + da + "-" + CsvType.NEW.index + '-threshold"]').val();
                U = Y.find('input[name="csvtype-' + da + "-" + CsvType.NEW.index + '-isdrop"]').val();
                ca ? (ma("NEW", !0),
                ma("NEW_FBA", !1, ha, U),
                ma("NEW_FBM_SHIPPING", !0)) : (ma("NEW", C),
                ma("NEW_FBA", !C),
                ma("NEW_FBM_SHIPPING", !C));
                break;
            case "csvtype-" + da + "-" + CsvType.USED.index + "-shipping":
                C = Y.find('input[name="csvtype-' + da + "-" + CsvType.USED.index + '-prime"]').prop("checked");
                ha = Y.find('input[name="csvtype-' + da + "-" + CsvType.USED.index + '-threshold"]').val();
                U = Y.find('input[name="csvtype-' + da + "-" + CsvType.USED.index + '-isdrop"]').val();
                ca ? (ma("USED", !0),
                ma("WAREHOUSE", !1, ha, U),
                ma("USED_NEW_SHIPPING", C, ha, U),
                ma("USED_VERY_GOOD_SHIPPING", C, ha, U),
                ma("USED_GOOD_SHIPPING", C, ha, U),
                ma("USED_ACCEPTABLE_SHIPPING", C, ha, U)) : (ma("USED", C),
                ma("WAREHOUSE", !C),
                ma("USED_NEW_SHIPPING", !0),
                ma("USED_VERY_GOOD_SHIPPING", !0),
                ma("USED_GOOD_SHIPPING", !0),
                ma("USED_ACCEPTABLE_SHIPPING", !0));
                break;
            case "csvtype-" + da + "-" + CsvType.USED.index + "-prime":
                C = Y.find('input[name="csvtype-' + da + "-" + CsvType.USED.index + '-shipping"]').prop("checked");
                ha = Y.find('input[name="csvtype-' + da + "-" + CsvType.USED.index + '-threshold"]').val();
                U = Y.find('input[name="csvtype-' + da + "-" + CsvType.USED.index + '-isdrop"]').val();
                ca ? (ma("USED", !0),
                ma("WAREHOUSE", !1, ha, U),
                ma("USED_NEW_SHIPPING", !0, ha, U),
                ma("USED_VERY_GOOD_SHIPPING", !0, ha, U),
                ma("USED_GOOD_SHIPPING", !0, ha, U),
                ma("USED_ACCEPTABLE_SHIPPING", !0, ha, U)) : (ma("USED", C),
                ma("WAREHOUSE", !C),
                ma("USED_NEW_SHIPPING", !C),
                ma("USED_VERY_GOOD_SHIPPING", !C),
                ma("USED_GOOD_SHIPPING", !C),
                ma("USED_ACCEPTABLE_SHIPPING", !C));
                break;
            case "csvtype-" + da + "-" + CsvType.REFURBISHED.index + "-shipping":
                ha = Y.find('input[name="csvtype-' + da + "-" + CsvType.REFURBISHED.index + '-threshold"]').val();
                U = Y.find('input[name="csvtype-' + da + "-" + CsvType.USED.index + '-isdrop"]').val();
                ca ? (ma("REFURBISHED", !0),
                ma("REFURBISHED_SHIPPING", !1, ha, U)) : (ma("REFURBISHED", !1),
                ma("REFURBISHED_SHIPPING", !0));
                break;
            case "csvtype-" + da + "-" + CsvType.LIGHTNING_DEAL.index + "-backinstock":
                (ha = Y.find('input[name="csvtype-' + da + "-" + CsvType.AMAZON.index + '-threshold"]').val()) ? U = Y.find('input[name="csvtype-' + da + "-" + CsvType.AMAZON.index + '-isdrop"]').val() : (ha = Y.find('input[name="csvtype-' + da + "-" + CsvType.NEW.index + '-threshold"]').val(),
                U = Y.find('input[name="csvtype-' + da + "-" + CsvType.NEW.index + '-isdrop"]').val());
                ca ? ma("LIGHTNING_DEAL", !0) : ma("LIGHTNING_DEAL", !1, ha, U);
                break;
            case "syncdata-" + da:
                ca ? (Y.find(".tracking__sync-overlay").show(),
                Ca(da)) : Y.find(".tracking__sync-overlay").hide()
            }
            setTimeout(ta, 1)
        });
        Y.find('input[type="checkbox"]').change()
    }
      , B = function(da) {
        var Y = $("#tracking__panel--" + da)
          , ma = da === d ? "click" : "pseudoclick";
        Y.find(".trigger--switch-isdrop").on(ma, function(ca) {
            ca = $(this).closest(".tracking__block");
            var ha = ca.data("type")
              , C = ca.find('input[name="csvtype-' + da + "-" + ha + '-isdrop"]')
              , U = 1 == C.val();
            C.val(U ? 0 : 1);
            C = la._703;
            f || (C = '<span class="unavailable">' + C + "</span>");
            $(this).find("span").first().html(U ? C : la._95);
            da === d && (U = U ? la._849 : la._850,
            $(this).find(".colorTipContent").html(U),
            $(".switch-" + ha + "-isdrop").trigger("pseudoclick"));
            ca.find(".tracking__suggestion--decrease").toggle();
            ca.find(".tracking__suggestion--increase").toggle();
            f || ($('input[name$="-isdrop"][value="0"]').length ? ($(".tracking__warning--isdrop").show(),
            $("#submitTracking").prop("disabled", !0)) : ($(".tracking__warning--isdrop").hide(),
            $("#submitTracking").prop("disabled", !1)));
            setTimeout(ta, 1)
        })
    }
      , Q = function() {
        K || $("#" + z + " .tool__trackback").click(function() {
            var da = z.replace("-tracking", "");
            $("#grid-tools-" + da.replace("grid-wrapper-", "")).show();
            $("#" + da).show();
            $("#" + da + "-filter").show();
            $("#" + da + "-tracking").hide();
            setTimeout(ta, 1)
        })
    }
      , fa = function(da) {
        Z(da);
        B(da);
        oa(da);
        w(da);
        var Y = $("#tracking__panel--" + da);
        Y.find(".trigger").colorTip({
            color: "yellow"
        });
        Y.find(".tracking__block-overlay--disable").colorTip({
            color: "yellow"
        });
        da === d && ($(".tracking__buttons").find("[title]").colorTip({
            color: "yellow align-left"
        }),
        $(".tracking__settings-mode").find("[title]").colorTip({
            color: "yellow align-left"
        }))
    }
      , R = function() {
        var da = tabSwitcher("tracking__tab-bar");
        $("#tracking__tab-bar").find(".mdc-tab:not(.mdc-tab--active)").hide();
        da.listen("MDCTabBar:change", function(Y) {
            Y = Y.detail;
            Y = $(".tracking .tracking__panel").find(".panel:nth-child(" + (Number(Y.activeTabIndex) + 1) + ")");
            Y = Number(Y.attr("id").replace("tracking__panel--", ""));
            Ca(Y);
            setTimeout(ta, 1)
        });
        $(".tracking__tab-bar-toggle, .tracking__tab-bar-toggle-hint").on("click", function() {
            if (V)
                return !1;
            var Y = g()
              , ma = showPopup(la._351 + ":", Y.html, !0);
            ra();
            setTimeout(ta, 1);
            Y.onSubmit.done(function(ca) {
                ma.promise.resolve(ca)
            });
            ma.promise.done(function(ca) {
                ma.close();
                setTimeout(ta, 1);
                var ha = !1;
                if (ca && ca.enableDomainIds) {
                    for (var C = 1; C < numberOfDomains; C++)
                        if (7 != C && C !== d) {
                            var U = 1 === $("#tracking__tab--" + C + ":visible").length
                              , ia = -1 < ca.enableDomainIds.indexOf(C);
                            ia && !U ? Ba(C, !0) : !ia && U && (Ba(C, !1),
                            ha = !0)
                        }
                    $('input[name="tracking-mode"]:checked').change();
                    ha && (da.activeTabIndex = 0,
                    da.updatePanel(0))
                }
            }).fail(function(ca) {})
        });
        $(".trigger--casin-popup").on("click", function() {
            comparePricesOverlay(a.asin, a.domainId)
        })
    }
      , T = function() {
        setTimeout(function() {
            $("#submitTracking").on("click", function(da) {
                Aa(da)
            })
        }, 0)
    }
      , oa = function(da) {
        var Y = $("#tracking__panel--" + da);
        Y.find('input[name$="threshold"]').on("focus", function(ma) {
            Y.find(".tracking__suggestion").hide();
            ma = $(this).closest(".tracking__block").find(".tracking__suggestion");
            ma.css({
                display: "block"
            });
            ma.find("tr").removeClass("active");
            ma.find('tr[data-value="' + $(this).val() + '"]').addClass("active")
        });
        if (da === d)
            $("#trackingForm").on("click", function(ma) {
                $(".tracking__suggestion").hide()
            });
        Y.find('input[type="text"], .tracking__suggestion').on("click", function(ma) {
            ma.stopPropagation()
        });
        Y.find(".tracking__suggestion-item").on("click", function(ma) {
            ma = $(this).data("value");
            var ca = $(this).closest(".tracking__block").data("type")
              , ha = $('input[name="csvtype-' + da + "-" + ca + '-threshold"]');
            q(ha, ma);
            $(this).closest(".tracking__block").find(".tracking__suggestion").find("tr").removeClass("active");
            $(this).addClass("active");
            n && da === d && [CsvType.AMAZON.index, CsvType.NEW.index].includes(ca) && ($('input[name="csvtype-' + d + "-" + CsvType.AMAZON.index + '-threshold"]').val().length && !$('input[name="csvtype-' + d + "-" + CsvType.NEW.index + '-threshold"]').val().length ? $(".tracking__hint--amazononly").show() : $(".tracking__hint--amazononly").hide(),
            setTimeout(ta, 1))
        })
    }
      , Z = function(da) {
        $("#tracking__panel--" + da).find('input[name$="threshold"]').on("focusout", function() {
            var Y = this.name.split("-");
            Y = Number(Y[2]);
            0 < $(this).val().length && (ua() ? $(this).val(NumberUtil.format(Money.unformat($(this).val()), 0)) : CsvType.getObject(Y).currency ? $(this).val(Money.format(Money.unformat($(this).val()), {
                sourceDomainId: d,
                targetDomainId: d,
                isDivided: !0,
                skipSymbol: !0
            })) : Y === CsvType.RATING.index ? $(this).val(parseFloat(Money.unformat($(this).val())).toFixed(1)) : $(this).val(NumberUtil.format(Money.unformat($(this).val()), 0)));
            n && da === d && [CsvType.AMAZON.index, CsvType.NEW.index].includes(Y) && ($('input[name="csvtype-' + d + "-" + CsvType.AMAZON.index + '-threshold"]').val().length && !$('input[name="csvtype-' + d + "-" + CsvType.NEW.index + '-threshold"]').val().length ? $(".tracking__hint--amazononly").show() : $(".tracking__hint--amazononly").hide(),
            setTimeout(ta, 1));
            N()
        })
    }
      , ja = function() {
        $('input[name="tracking-mode"]').on("change", function(da) {
            da = $('[data-mode="basic"]');
            var Y = $('[data-mode="advanced"]')
              , ma = $('[data-mode="pro"]')
              , ca = $(this).val();
            "advanced" === ca ? (iframe.isIframe ? (da.show(),
            Y.show(),
            ma.hide(),
            setTimeout(ta, 1)) : (da.fadeIn(600),
            Y.fadeIn(600),
            ma.fadeOut(200)),
            Y.each(function() {
                $(this).find("input").prop("disabled", !1)
            }),
            ma.each(function() {
                $(this).find("input").prop("disabled", !0)
            })) : "pro" === ca ? (iframe.isIframe ? (da.show(),
            Y.show(),
            ma.show(),
            setTimeout(ta, 1)) : (da.fadeIn(600),
            Y.fadeIn(600),
            ma.fadeIn(600)),
            Y.each(function() {
                $(this).find("input").prop("disabled", !1)
            }),
            ma.each(function() {
                $(this).find("input").prop("disabled", !1)
            })) : (iframe.isIframe ? (da.show(),
            Y.hide(),
            ma.hide(),
            setTimeout(ta, 1)) : (da.fadeIn(600),
            Y.fadeOut(200),
            ma.fadeOut(200)),
            Y.each(function() {
                $(this).find('input[name$="shipping"], input[name$="prime"]').prop("checked", !1).change();
                $(this).find("input").prop("disabled", !0)
            }),
            ma.each(function() {
                $(this).find("input").prop("disabled", !0)
            }));
            N()
        });
        $('input[name="tracking-mode"]:checked').change()
    }
      , W = function() {
        $("#updateTracking").on("click", function() {
            pa()
        });
        $("#deleteTracking").on("click", function() {
            network.request({
                path: "track",
                asinBatch: [a.asin],
                type: "deleteTracking",
                version: 3
            }).done(function() {
                replaceHtml(z, '<div class="tracking' + (isMobile ? " tracking--mobile" : "") + '">\n\t\t\t\t\t\t\t<p class="mdc-typography--body2">' + la._437 + "</p>\n\t\t\t\t\t\t</div>");
                setTimeout(function() {
                    pa()
                }, 8E3)
            }).fail(showErrorPopup)
        })
    }
      , Aa = function(da) {
        da.preventDefault();
        isTest && console.info("%csubmitTracking", "color:#018786;font-weight:bold;", "... ... ...");
        if (!f && $('input[name$="-isdrop"][value="0"]').length || V)
            return !1;
        V = !0;
        var Y = $("#submitTracking");
        Y.trigger("focus");
        Y.prop("disabled", !0);
        Y.html(la._45 + ' &ensp;<i class="fa fa-spinner fa-spin"></i>');
        ua() || $('input[type="checkbox"][name^="syncdata-"]').change();
        $(".tracking__submit-overlay").show();
        M(da)
    }
      , Ca = function(da) {
        var Y = $("#tracking__panel--" + d)
          , ma = $("#tracking__panel--" + da);
        ma.find('input[name="syncdata-' + da + '"]').prop("checked") && (Y.find('input:not([type="checkbox"])').each(function() {
            var ca = $(this)
              , ha = ca.attr("type")
              , C = ca.attr("name").split("-");
            C[1] = da;
            var U = Number(C[2]);
            C = ma.find('input[name="' + C.join("-") + '"]');
            if (C.length)
                switch (ha) {
                case "hidden":
                    ca = ca.val();
                    ha = C.val();
                    ca !== ha && C.closest(".tracking__block").find(".trigger--switch-isdrop").trigger("pseudoclick");
                    break;
                case "text":
                    C && (ca = ca.val(),
                    ha = (b && b.thresholdValues || []).find(function(ia) {
                        return ia.csvType === U && ia.domain === da && 0 <= ia.thresholdValueCSV[ia.thresholdValueCSV.length - 1]
                    }),
                    graphIsRestricted(da, U) && !ha || q(C, ca));
                    break;
                default:
                    isTest && console.warn("missing sync handling", ha)
                }
        }),
        Y.find('input[type="checkbox"]').each(function() {
            var ca = $(this)
              , ha = ca.attr("name").split("-");
            ha[1] = da;
            (ha = ma.find('input[name="' + ha.join("-") + '"]')) && ha.prop("checked", ca.prop("checked")).change()
        }))
    }
      , Ba = function(da, Y, ma) {
        var ca = "tracking__panel--" + da
          , ha = "tracking__tab--" + da;
        Y ? ($("#" + ha).fadeIn(400),
        replaceHtml(ca, za(da)),
        material.init("#" + ca),
        fa(da),
        Y = $('input[name="csvtype-' + da + "-" + CsvType.LIGHTNING_DEAL.index + '-upcoming"]'),
        Y.prop("disabled", !0),
        Y.closest(".mdc-form-field").css({
            visibility: "hidden"
        }),
        ma || $('input[name="syncdata-' + da + '"]').prop("checked", !0).change(),
        P([da], $("#tracking__tab--" + da), !0)) : ($("#" + ha).fadeOut(),
        replaceHtml(ca, ""))
    }
      , ta = function(da, Y) {
        iframe.isIframe && addon(da, Y)
    }
      , Ea = function() {
        return [{
            label: "2 " + la._876,
            value: 336
        }, {
            label: "1 " + la._877,
            value: 720
        }, {
            label: "3 " + la._878,
            value: 2160
        }, {
            label: "6 " + la._878,
            value: 4320
        }, {
            label: "1 " + la._879,
            value: 8760,
            default: !0
        }, {
            label: "2 " + la._880,
            value: 17520
        }, {
            label: "3 " + la._880,
            value: 26280
        }, {
            label: "10 " + la._880,
            value: 87600
        }]
    }
      , va = function() {
        return Ea().find(function(da) {
            return !0 === da.default
        }).value
    };
    return {
        addonResizeHook: ta,
        getDefaultTtl: va,
        getTtlOptions: Ea,
        init: function(da) {
            ea();
            a = da.products[0];
            null == a.stats && (a.stats = getStatistics(a));
            d = a.domainId;
            t = "undefined" !== typeof a && null != a.trackingInfos && a.trackingInfos.isTrackedByUser;
            f = 0 !== storage.accountType && hasDataAccessSubscription;
            2 === a.csv[CsvType.AMAZON.index].length && -1 == a.csv[CsvType.AMAZON.index][1] && (n = !0);
            2 === a.csv[CsvType.NEW.index].length && -1 == a.csv[CsvType.NEW.index][1] && (r = !0);
            2 === a.csv[CsvType.USED.index].length && -1 == a.csv[CsvType.USED.index][1] && (p = !0);
            t && (b = a.trackingInfos.userTracking,
            da = !1,
            b.thresholdValues && b.thresholdValues.length && (da = b.thresholdValues.some(function(Y) {
                return !0 !== Y.isDrop
            })),
            f = f || da,
            d = b.mainDomainId);
            m = getCurrencyByDomain(d);
            t ? (da = '<div class="tracking' + (isMobile ? " tracking--mobile" : "") + '">\n\t\t\t\t\t<p class="mdc-typography--body2">' + la._436 + '</p>\n\t\t\t\t\t<div class="tracking__buttons">\n\t\t\t\t\t\t' + material.getButton("updateTracking", la._434, null, "pencil") + "&emsp;\n\t\t\t\t\t\t" + material.getButton("deleteTracking", la._435, null, "trash-o", !1, !0) + "\n\t\t\t\t\t</div>\n\t\t\t\t</div>",
            replaceHtml(z, da),
            W()) : pa()
        },
        initList: function(da) {
            ea();
            F = 1;
            I = [];
            E = null;
            K = !1;
            H = null;
            d = Number(da.domainId);
            I = da.asinList || [];
            E = da.wishlistId || null;
            K = da.showAsPopup || !1;
            z = da.containerId;
            m = getCurrencyByDomain(d);
            f = 0 !== storage.accountType && hasDataAccessSubscription;
            K && (H = showPopup(la._916.replace("#selectedAsinCount#", "<b>" + I.length + "</b>"), '<div id="tracklist"></div>', !0));
            pa()
        },
        setCasinData: G
    }
}();
var Seller = function() {
    var a = function(b) {
        try {
            var d = graph.prepare(b.domainId);
            d.asin = b.sellerId;
            d.graphIndex = 4;
            d.updateCSV = [];
            d.series = graph.getMerchantSeriesTemplates();
            var h = [];
            h[MerchantType.RATING.index] = b.csv[MerchantType.RATING.index];
            h[MerchantType.RATING_COUNT.index] = b.csv[MerchantType.RATING_COUNT.index];
            h[MerchantType.LISTINGS_COUNT.index] = b.totalStorefrontAsinsCSV;
            var m = $("#sellerGraph");
            d.csv = h;
            d.type = "merchant";
            d.objectType = MerchantType;
            d.$container = m;
            d.$container.show();
            d.parameter.offsetLeft = -30;
            d.parameter.width = float2int(m.parent().width()) - 170 + "px";
            d.parameter.height = "250px";
            graph.create(d)
        } catch (t) {
            console.log(t)
        }
    };
    return {
        init: function(b, d) {
            network.request({
                path: "pro/seller",
                domainId: b,
                seller: d,
                page: 0,
                perPage: 0,
                storefront: 1440,
                history: !0,
                version: 3
            }).done(function(h) {
                $("#loadingIcon").hide();
                if (h.merchants && h.merchants[d]) {
                    var m = h.merchants[d]
                      , t = h.listSize
                      , f = getLast(m.totalStorefrontAsinsCSV, MerchantType.LISTINGS_COUNT)
                      , n = getLastTime(m.totalStorefrontAsinsCSV, MerchantType.LISTINGS_COUNT);
                    h = "";
                    -1 < f && (h = '<br><span style="color:#AA5D5D">Verified Listings: </span>' + NumberUtil.format(f) + '<span style="color:#a2a2a2"> (as of ' + (new Date(keepaTime.minutesToEpoch(n))).formatDate("M j, Y") + ")</span>");
                    n = 0;
                    -1 < f && (n = GridConfig.getRowCountOptions("asin"),
                    n = Math.max.apply(Math, $jscomp.arrayFromIterable(n.values)),
                    n = Math.min(t, n));
                    t = getLast(m.csv[0], MerchantType.RATING) + "%";
                    f = getLast(m.csv[1], MerchantType.RATING_COUNT);
                    -1 == f && (t = " - ",
                    f = "0 (just launched)");
                    m.stats = {
                        RATING: statsCSV(m.csv[0], CsvType.COUNT_REVIEWS.index),
                        RATING_COUNT: statsCSV(m.csv[1], CsvType.COUNT_REVIEWS.index)
                    };
                    var r = 0 < m.ratingsLast30Days ? '&emsp;<span style="color: #a2a2a2">last 30 days: ' + NumberUtil.format(m.ratingsLast30Days) + "</span>" : ""
                      , p = m.stats && m.stats.RATING && m.stats.RATING.avg && -1 != m.stats.RATING.avg ? '&emsp;<span style="color: #a2a2a2">' + m.stats.RATING.avg.days + " day avg: " + m.stats.RATING.avg.val.toFixed(1) + "%</span>" : "";
                    h = '\n\t\t\t\t<span id="' + d + '">\n\t\t\t\t\t<a href="https://www.amazon.' + getTldByDomain(b) + "/gp/aag/details/?seller=" + d + '" title="' + la._646 + ' Amazon">\n\t\t\t\t\t\t' + la._646 + ' Amazon <i style="margin-left:7px" class="fa fa-external-link" ></i>\n\t\t\t\t\t</a>\n\t\t\t\t</span>\n\t\t\t\t<br>\n\t\t\t\t<span>\n\t\t\t\t\t<br><span style="color:#AA5D5D">' + la._440 + ": </span>" + t + p + '\n\t\t\t\t\t<br><span style="color:#AA5D5D">' + la._533 + ": </span>" + NumberUtil.format(f) + r + "\n\t\t\t\t\t" + h + '\n\t\t\t\t\t<br><span style="color:#AA5D5D">Browseable listings via Keepa: </span> ' + NumberUtil.format(n) + '\n\t\t\t\t\t<br><span style="color:#AA5D5D">Found FBA listings: </span> ' + (m.hasFBA ? la._254 : la._255) + '\n\t\t\t\t\t<br><span style="color:#AA5D5D">Tracked by Keepa since: </span> ' + (new Date(keepaTime.minutesToEpoch(m.trackedSince))).formatDate("M j, Y") + '\n\t\t\t\t</span>\n\t\t\t\t<br><br><br><div id="sellerGraph" class="graph"></div>\n\t\t\t';
                    m.sellerCategoryStatistics && m.sellerCategoryStatistics.length && (h += '<br><br><br><div>\n\t\t\t\t\t\t<p style="color:#AA5D5D">Seller Category Listing Statistics</p>\n\t\t\t\t\t\t<p style="width:800px;">Overview of the type of products <span style="font-weight:500;">' + m.sellerName + '</span> is primarily selling, how often Amazon is on those listings and what the avg. sales rank of this seller\'s products is.</p><br>\n\t\t\t\t\t\t<div id="grid-container-seller-category-statistic" class="on-white"></div>\n\t\t\t\t\t</div>');
                    m.sellerBrandStatistics && m.sellerBrandStatistics.length && (h += '<br><br><br><div>\n\t\t\t\t\t\t<p style="color:#AA5D5D">Seller Brand Listing Statistics</p>\n\t\t\t\t\t\t<p style="width:800px;">Overview of the products by brand <span style="font-weight:500;">' + m.sellerName + '</span> is primarily selling, how often Amazon is on those listings and what the avg. sales rank of this seller\'s products is.</p><br>\n\t\t\t\t\t\t<div id="grid-container-seller-brand-statistic" class="on-white"></div>\n\t\t\t\t\t</div>');
                    h = material.getTabs({
                        tabs: [{
                            tab: {
                                icon: "bar-chart",
                                label: "Seller Metrics"
                            },
                            panel: {
                                id: "sellerMetrics",
                                content: h
                            },
                            isActive: !0
                        }, 0 < n ? {
                            tab: {
                                icon: "table",
                                label: "Storefront"
                            },
                            panel: {
                                id: "sellerStorefront"
                            }
                        } : null],
                        panelsClass: "dataContent"
                    });
                    replaceHtml("sellerPage", h);
                    tabSwitcher().listen("MDCTabBar:change", function(z) {
                        1 == z.detail.activeTabIndex && (z = $("#sellerStorefront"),
                        z.html() && 50 < z.html().length || (replaceHtml("sellerStorefront", '<div id="grid-container-storefront" class="on-white"></div>'),
                        GridStorefront.init(m, "grid-container-storefront")))
                    });
                    $("#sellerName").text(m.sellerName);
                    a(m);
                    m.sellerCategoryStatistics && m.sellerCategoryStatistics.length && GridSellerCategoryStatistic.init(m, "grid-container-seller-category-statistic");
                    m.sellerBrandStatistics && m.sellerBrandStatistics.length && GridSellerBrandStatistic.init(m, "grid-container-seller-brand-statistic")
                } else
                    h = '<div class="text_long">Seller <code>' + d + "</code> on Amazon." + getTldByDomain(b) + " not found. Either the seller does not exist or Keepa has never encountered an offer by this seller.</div>",
                    replaceHtml("sellerPage", h)
            }).fail(function(h) {
                $("#loadingIcon").hide();
                429 == h.status ? (showPopup("Quota exceeded", quotaExceeded, !0),
                addDataUpdateHandler()) : showErrorPopup("Seller initialization failed: " + (h.status ? h.status : h))
            })
        }
    }
}();
var compareCache = ""
  , comparePricesOverlayActive = !1
  , dataProduct = ""
  , graphShareURL = ""
  , prevTitle = ""
  , refreshedOnce = !1
  , shareChartOverlayActive = !1;
function parseCurrentProductPrices(a, b, d) {
    var h = la._93 + ":"
      , m = la._94 + ":"
      , t = void 0 != a.PRICE_AMAZON;
    b && void 0 != b || (b = a.domainId);
    var f = function(S) {
        return !t || 0 > S ? "" : ' <span style="opacity:0.8" title="' + la._342 + '">(' + Money.format(S, {
            sourceDomainId: b,
            targetDomainId: b,
            skipSymbol: !0
        }) + ")</span>"
    }
      , n = function(S) {
        return !t || 0 > S ? "" : ' <span style="opacity:0.8" title="' + la._342 + '">(' + Money.format(S, {
            sourceDomainId: b,
            skipSymbol: !0
        }) + ")</span>"
    }
      , r = "null" != a.AMAZON_LAST && -1 != a.AMAZON_LAST ? Money.format(a.AMAZON_LAST, {
        sourceDomainId: b,
        targetDomainId: b
    }) : ""
      , p = "null" != a.MARKET_NEW_LAST && -1 != a.MARKET_NEW_LAST ? Money.format(a.MARKET_NEW_LAST, {
        sourceDomainId: b,
        targetDomainId: b
    }) : ""
      , z = "null" != a.MARKET_USED_LAST && -1 != a.MARKET_USED_LAST ? Money.format(a.MARKET_USED_LAST, {
        sourceDomainId: b,
        targetDomainId: b
    }) : ""
      , F = ""
      , I = ""
      , E = "";
    d = "<span>";
    var K = "</span>";
    showReferencePrice(b) && (F = "null" != a.AMAZON_LAST && -1 != a.AMAZON_LAST ? "<span>" + Money.format(a.AMAZON_LAST, {
        sourceDomainId: b
    }) + n(a.PRICE_AMAZON) + "</span>" : "",
    I = "null" != a.MARKET_NEW_LAST && -1 != a.MARKET_NEW_LAST ? "<span>" + Money.format(a.MARKET_NEW_LAST, {
        sourceDomainId: b
    }) + n(a.PRICE_NEW) + "</span>" : "",
    E = "null" != a.MARKET_USED_LAST && -1 != a.MARKET_USED_LAST ? "<span>" + Money.format(a.MARKET_USED_LAST, {
        sourceDomainId: b
    }) + n(a.PRICE_USED) + "</span>" : "",
    d = '<span class="price__reference" style="text-align:right;"><span>',
    K = "</span></span>");
    n = "";
    "" != r ? (n += '<span class="productTableDescriptionPriceDescr">Amazon: </span><span class="productTableDescriptionPrice priceAmazon">' + F + d + r + f(a.PRICE_AMAZON) + K + "</span>",
    "" != p && (n += '<span class="productTableDescriptionPriceDescr">&emsp;' + h + '</span><span class="productTableDescriptionPriceAlt priceNew">' + I + d + p + f(a.PRICE_NEW) + K + "</span>"),
    "" != z && (n += '<span class="productTableDescriptionPriceDescr">&emsp;' + m + '</span><span class="productTableDescriptionPriceAlt priceUsed">' + E + d + z + f(a.PRICE_USED) + K + "</span>")) : "" != p ? (n += '<span class="productTableDescriptionPriceDescr">' + h + '</span><span class="productTableDescriptionPrice priceNew">' + I + d + p + f(a.PRICE_NEW) + K + "</span>",
    "" != z && (n += '<span class="productTableDescriptionPriceDescr">&emsp;' + m + '</span><span class="productTableDescriptionPriceAlt priceUsed">' + E + d + z + f(a.PRICE_USED) + K + "</span>")) : n = "" != z ? n + ('<span class="productTableDescriptionPriceDescr">' + m + '</span><span class="productTableDescriptionPrice priceUsed">' + E + d + z + f(a.PRICE_USED) + K + "</span>") : n + (!0 === a.newPriceIsMAP ? '<span style="font-size: 12px; color: #999;"> (' + la._907 + ' <i class="fa fa-info" title="' + la._908 + '"></i>)</span>' : "");
    try {
        var H = getValueAtTime(a.csv[CsvType.LIGHTNING_DEAL.index], keepaTime.now(), CsvType.LIGHTNING_DEAL);
        if (0 < H) {
            var V = Money.format(H, {
                sourceDomainId: a.domainId,
                targetDomainId: a.domainId
            });
            h = "";
            showReferencePrice(b) && (h = Money.format(H, {
                sourceDomainId: a.domainId
            }));
            n += '&emsp;<span class="productTableDescriptionPriceDescr">' + CsvType.getName(CsvType.LIGHTNING_DEAL.index) + ':</span><span class="productTableDescriptionPrice" style="color:' + CsvType.LIGHTNING_DEAL.color + '">' + h + d + V + K + "</span>"
        }
    } catch (S) {
        console.error(S)
    }
    V = getLastWithShipping(a.csv[CsvType.EBAY_NEW_SHIPPING.index], CsvType.EBAY_NEW_SHIPPING);
    H = getLastWithShipping(a.csv[CsvType.EBAY_USED_SHIPPING.index], CsvType.EBAY_USED_SHIPPING);
    if (isAWS || storage.email && 0 < storage.email.indexOf("@amazon."))
        H = V = -1;
    m = keepaTime.now();
    h = !1;
    if (0 >= a.lastEbayUpdate || 0 < a.lastEbayUpdate && 20160 < m - a.lastEbayUpdate)
        h = !0;
    !h && 0 < V[0] && (m = Money.format(V[0] + V[1], {
        sourceDomainId: b,
        targetDomainId: b
    }),
    f = 0 == V[1] ? "free shipping" : Money.format(V[0], {
        sourceDomainId: b,
        targetDomainId: b
    }) + (0 < V[1] ? " + " + Money.format(V[1], {
        sourceDomainId: b,
        targetDomainId: b,
        skipSymbol: !0
    }) + " shipping" : ""),
    p = r = "",
    showReferencePrice(b) && (p = 0 == V[1] ? "free shipping\n" : Money.format(V[0], {
        sourceDomainId: b
    }) + (0 < V[1] ? " + " + Money.format(V[1], {
        sourceDomainId: b,
        skipSymbol: !0
    }) + " shipping" : "") + "\n",
    r = "<span>" + Money.format(V[0] + V[1], {
        sourceDomainId: b
    }) + "</span>"),
    n += '&emsp;<span class="productTableDescriptionPriceDescr">' + CsvType.getName(CsvType.EBAY_NEW_SHIPPING.index).replace(" \ud83d\ude9a", "") + ':</span><span class="productTableDescriptionPrice priceEbayNew" title="' + p + f + '" style="color:' + CsvType.EBAY_NEW_SHIPPING.color + '">' + r + d + m + K + "</span>");
    !h && 0 < H[0] && (V = Money.format(H[0] + H[1], {
        sourceDomainId: b,
        targetDomainId: b
    }),
    h = 0 == H[1] ? "free shipping" : Money.format(H[0], {
        sourceDomainId: b,
        targetDomainId: b
    }) + (0 < H[1] ? " + " + Money.format(H[1], {
        sourceDomainId: b,
        targetDomainId: b,
        skipSymbol: !0
    }) + " shipping" : ""),
    f = m = "",
    showReferencePrice(b) && (f = 0 == H[1] ? "free shipping\n" : Money.format(H[0], {
        sourceDomainId: b
    }) + (0 < H[1] ? " + " + Money.format(H[1], {
        sourceDomainId: b,
        skipSymbol: !0
    }) + " shipping" : "") + "\n",
    m = "<span>" + Money.format(H[0] + H[1], {
        sourceDomainId: b
    }) + "</span>"),
    n += '&emsp;<span class="productTableDescriptionPriceDescr">' + CsvType.getName(CsvType.EBAY_USED_SHIPPING.index).replace(" \ud83d\ude9a", "") + ':</span><span class="productTableDescriptionPrice priceEbayUsed" title="' + f + h + '" style="color:' + CsvType.EBAY_USED_SHIPPING.color + '">' + m + d + V + K + "</span>");
    t && (a = Date.now() / 6E4 - (a.LASTUPDATE + 60 * offsetHours),
    n += '<span style="font-size: 12px; color: #999;">&emsp;&emsp;(' + la._123 + prettyDate(a) + ")</span>");
    return n
}
function closeProductOverlay() {
    var a = $("#productOverlay").find("#graph");
    graph.remove(a.data("domainId"), a.data("asin"), a.data("index"));
    graph.remove(a.data("domainId"), a.data("asin"), 1);
    $("#overlayShadow").hide();
    a = function() {
        $("#productOverlay").css({
            transform: "translateY(0px)"
        });
        replaceHtml("detailProductPage", "");
        $("#detailProductPage").remove()
    }
    ;
    isMobile ? (a(),
    $("#productOverlay").hide()) : $("#productOverlay").velocity("transition.slideUpOut", 250, a);
    overlayClosed = !0;
    document.title = prevTitle;
    window.location.href = preOverlayUrl;
    setupQuotaWidget()
}
function productUpdate() {
    refreshedOnce = !1;
    0 == $("#detailProductPage").length ? generateProduct() : loadProduct(0)
}
function addLightningDealBox(a) {
    var b = CsvType.LIGHTNING_DEAL.index;
    b = a.csv ? a.csv[b] : null;
    if (null != b) {
        var d = b.length;
        if (3 < d && -1 == b[d - 1] && -1 == b[d - 3]) {
            var h = 0;
            try {
                for (; -1 == b[d - 5]; )
                    d -= 2;
                h = b[d - 2];
                for (var m = d; h < keepaTime.now() && m + 2 <= b.length; )
                    m += 2,
                    h = b[m - 2]
            } catch (n) {
                console.error(n, b, d)
            }
            if (!(keepaTime.now() > h)) {
                var t = (new Date(keepaTime.minutesToEpoch(h))).formatDate("M j, G:i")
                  , f = "";
                5 < d && 0 < b[d - 5] && (h = Date.now() / 6E4 - (b[d - 6] + offsetMinutes),
                a = Money.format(b[d - 5], {
                    sourceDomainId: a.domainId,
                    targetDomainId: a.domainId
                }),
                f = '<br><span style="color:#303030;font-size:12px;">' + la._649 + " (" + prettyDate(h) + ") " + la._650 + " " + a + "</span>");
                setTimeout(function() {
                    var n = '<div style="color:tomato;font-size:19px;width:100%;text-align:center;margin-top:20px">\n\t\t\t\t\t<span><i class="fa fa-bolt"></i>&emsp;' + la._560 + '! <span style="color: #6b4a4a;">' + la._648 + " " + t + '</span>&emsp;<i class="fa fa-bolt" ></i></span>\n\t\t\t\t\t' + f + "\n\t\t\t\t</div>";
                    $("#subGraphHover").before(n);
                    addon()
                }, 0)
            }
        }
    }
}
function getProductFromList(a, b) {
    var d = null;
    if (null != b)
        for (var h = 0; h < b.length; h++) {
            var m = b[h];
            if (m.asin === a) {
                d = m;
                break
            }
        }
    return d
}
function loadProduct(a) {
    var b = lastSubUrl.split("-");
    if (2 !== b.length)
        replaceHtml("productTableDescription", "Error:<br>" + la._216);
    else {
        var d = b[0]
          , h = b[1];
        b = h.match(verifyRegExp.asin);
        if (!b || 10 > b[1].length)
            replaceHtml("productTableDescription", "Error:<br>" + la._216);
        else {
            h = b[1];
            d = Number(d);
            comparePricesOverlayActive = !1;
            compareCache = "";
            shareChartOverlayActive = !1;
            $("#productTableImageBox").hide();
            var m = function(t) {
                if (0 !== $("#productTableDescription").length)
                    if (t.products) {
                        for (var f, n = !1, r = 0; r < t.products.length; r++)
                            f = t.products[r],
                            null != f && (f.ASIN = h,
                            f.MANUFACTURER = f.manufacturer,
                            f.TITLE = f.title,
                            f.LASTUPDATE = f.lastUpdate,
                            f.TYPE = f.productType,
                            5 == f.productType || 3 == f.productType || 4 == f.productType ? 1 == t.products.length && (n = !0) : (f.IMAGES = null == f.imagesCSV ? [""] : f.imagesCSV.split(","),
                            null != f.csv && (f.AMAZON = f.csv[CsvType.AMAZON.index],
                            f.MARKET_NEW = f.csv[CsvType.NEW.index],
                            f.MARKET_USED = f.csv[CsvType.USED.index],
                            f.SALESRANK = f.csv[CsvType.SALES.index],
                            f.AMAZON_LAST = f.AMAZON[f.AMAZON.length - 1],
                            f.MARKET_NEW_LAST = f.MARKET_NEW[f.MARKET_NEW.length - 1],
                            f.MARKET_USED_LAST = f.MARKET_USED[f.MARKET_USED.length - 1])));
                        if (1 < t.products.length) {
                            f = getProductFromList(h, t.products);
                            if (null == f) {
                                replaceHtml("productTableDescription", la._121);
                                return
                            }
                            if (5 == f.productType) {
                                if (null == f.variationCSV || "" == f.variationCSV) {
                                    replaceHtml("productTableDescription", la._121);
                                    return
                                }
                                n = "<div>Please select a specific variation of this product:</div><br>";
                                if ("undefined" != typeof t.products) {
                                    replaceHtml("productTableDescription", n + '<div id="variationGrid" class="on-white" data-wrapper="detailProductPage"></div>');
                                    $("#productTableDescription").css("overflowY", "auto");
                                    GridVariation.init(t.products, "variationGrid", !1);
                                    return
                                }
                                if (null == f.variationCSV) {
                                    replaceHtml("productTableDescription", la._121);
                                    return
                                }
                                f.variationCSV = f.variationCSV.split(",");
                                for (var p in f.variationCSV)
                                    n += '<br><a href="#!product/' + d + "-" + f.variationCSV[p] + '">Variation ' + p + "</a>";
                                replaceHtml("productTableDescription", n);
                                $("#productTableDescription").css("overflowY", "auto");
                                return
                            }
                            3 == f.productType ? (replaceHtml("productTableDescription", la._341),
                            n = !0) : 4 == f.productType && (replaceHtml("productTableDescription", la._341),
                            n = !0)
                        }
                        $("#productTableImageBox").show();
                        f = t.products[0];
                        f.timeStamp = Date.now();
                        if (2 == f.TYPE)
                            replaceHtml("productTableDescription", la._395);
                        else if (null == f.ASIN)
                            replaceHtml("productTableDescription", '<i class="fa fa-exclamation-circle tomato fa-lg"></i>&emsp;' + la._341);
                        else {
                            var z = keepaTime.now()
                              , F = [];
                            f.stats = getStatistics(f);
                            var I = !0;
                            try {
                                if (null == f.csv || null == f.csv[0] || 2 == f.csv[0].length && -1 == f.csv[0][1] && 2 == f.csv[1].length && -1 == f.csv[1][1] && 2 == f.csv[2].length && -1 == f.csv[2][1] && null == f.csv[CsvType.COLLECTIBLE.index] && null == f.csv[CsvType.REFURBISHED.index] && 2 == f.csv[3].length && -1 == f.csv[3][1])
                                    $("#graph").html('<span style="color:tomato; margin-left: 20px;"><i class="fa fa-exclamation-triangle"></i>&emsp;Product never was in stock since we started tracking it.</span>').show(),
                                    I = !1
                            } catch (K) {
                                console.error(K)
                            }
                            if (n)
                                I ? (replaceHtml("productTableDescription", '<div style="color:tomato;font-size: 16px;"><i class="fa fa-exclamation-triangle"></i>&emsp;' + la._341 + '</div><br>Below is our <strong>outdated</strong> historical data for this product:<br><br><div id="priceHistory" class="active"><div class="graph unselectable" id="graph"></div></div>'),
                                p = $("#graph"),
                                n = graph.prepare(d),
                                n.csv = f.csv,
                                n.salesRanks = f.salesRanks,
                                n.syncedGraphs = F,
                                F.push(n),
                                n.salesRankCategoryTrees = f.salesRankCategoryTrees,
                                n.salesRankReference = f.salesRankReference,
                                n.salesRankCategories = f.salesRankCategories,
                                n.asin = f.ASIN,
                                n.graphIndex = 0,
                                n.stats = f.stats,
                                n.buyBoxSellerIdHistory = f.buyBoxSellerIdHistory,
                                n.offers = f.offers,
                                n.$container = p,
                                n.$container.show(),
                                n.parameter.width = float2int(p.parent().width()) - 200 + "px",
                                n.parameter.interval = (z - f.trackingSince) / 60,
                                n.parameter.forceInterval = !0,
                                graph.create(n),
                                addSubGraphMenu(f, d, F),
                                $("#casinLine").hide()) : replaceHtml("productTableDescription", la._341);
                            else {
                                graphShareURL = GraphService.getShareUrl(f.asin, d);
                                n = p = "";
                                if (null == f.IMAGES || 0 == f.IMAGES.length || null == f.IMAGES[0] || "" == f.IMAGES[0])
                                    p += '<img src="' + imgCDNUrl + 'no-img.gif"/>';
                                else {
                                    r = f.IMAGES[0].substring(f.IMAGES[0].length - 4, f.IMAGES[0].length);
                                    ".gif" == r || ".jpg" == r || ".png" == r ? filename = f.IMAGES[0].substring(0, f.IMAGES[0].length - 4) : (filename = f.IMAGES[0],
                                    r = ".jpg");
                                    p += '<div id="mainImageDiv">';
                                    for (var E = 0; E < f.IMAGES.length && 7 > E; E++)
                                        r = f.IMAGES[E].substring(f.IMAGES[E].length - 4, f.IMAGES[E].length),
                                        ".gif" == r || ".jpg" == r || ".png" == r ? filename = f.IMAGES[E].substring(0, f.IMAGES[E].length - 4) : (filename = f.IMAGES[E],
                                        r = ".jpg"),
                                        n += '<div id="' + E + '" class="productThumb" style="background:url(' + imageServer + filename + "._SL75_" + r + ') center center no-repeat"></div>',
                                        p += '<img id="i' + E + '" src="' + imageServer + filename + "._SX500_SY500_" + r + '" style="display:none;"/>';
                                    p += "</div>";
                                    replaceHtml("productTableImageBoxThumbs", n)
                                }
                                replaceHtml("productTableImageBoxMain", p);
                                network.request({
                                    path: "tracking/community",
                                    version: 3,
                                    type: "product",
                                    asin: h,
                                    maxAge: 0
                                }).always(function(K) {
                                    t.trackings = K.comTrackings;
                                    f.trackingInfos = getTrackingInfos(d, t.trackings, f);
                                    addLightningDealBox(f);
                                    K = f.csv[CsvType.RATING.index];
                                    var H = f.csv[CsvType.COUNT_REVIEWS.index]
                                      , V = f.csv[CsvType.EXTRA_INFO_UPDATES.index];
                                    V = null == V ? 0 : V[V.length - 2];
                                    var S = "";
                                    if (null != K && null != H && 10080 > keepaTime.now() - V) {
                                        K = -1 < K[K.length - 1] ? K[K.length - 1] : 0;
                                        H = -1 < H[H.length - 1] ? H[H.length - 1] : 0;
                                        V = (K / 10).toFixed(1);
                                        S = "";
                                        var aa = f.stats[CsvType.RATING.index];
                                        aa && aa.avg && 0 < aa.avg.val && aa.avg.val != K && (S = aa.avg.val > K ? "down" : "up",
                                        S = '&ensp;<i title="rating is ' + (aa.avg.val < K ? "improving" : "in decline") + '" class="fa fa-arrow-circle-' + S + '" ></i>');
                                        S = '&emsp;<span style="white-space: nowrap;" class="small">' + (getStarsFromRating(K) + '&ensp;<span style="color:#cea000">' + V + S + "</span>&ensp;(") + (H + " reviews)</span>")
                                    }
                                    K = '<div id="productInfoBox">' + ('<div class="productTableDescriptionTitle">' + stripHTML(f.TITLE) + S + "</div>");
                                    prevTitle = document.title;
                                    H = document.createElement("div");
                                    H.innerHTML = stripHTML(f.TITLE);
                                    document.title = docTitlePrefix + H.innerHTML;
                                    K = K + ('<div class="productTableDescriptionBrand">' + ("null" != f.MANUFACTURER && null != f.MANUFACTURER ? la._122 + f.MANUFACTURER : "") + "</div>") + parseCurrentProductPrices(f, d);
                                    getCurrencyByDomain(d);
                                    H = Date.now() / 6E4 - (f.LASTUPDATE + 60 * offsetHours);
                                    V = "";
                                    "undefined" != typeof f.lastPriceChange && (V = Date.now() / 6E4 - (f.lastPriceChange + 60 * offsetHours),
                                    V = ",&ensp;" + la._532 + ": " + prettyDate(V));
                                    S = 60 < H ? '&ensp;<i id="refreshProduct" title="' + la._217 + '" class="fa fa-refresh fa-rotate-90" style="cursor: pointer;"></i>&nbsp;' : "";
                                    K += '<span style="font-size: 12px; color: #999;">&emsp;&emsp;(' + la._123 + prettyDate(H) + S + V + ")</span>";
                                    H = '<img class="amznLogo" src="' + imgCDNUrl + "/amazon/small/" + getTldByDomain(d) + '.png">';
                                    V = "";
                                    if (globalEbayArray[f.domainId]) {
                                        V = "#888";
                                        S = "unverified if sold on ebay";
                                        if (20160 > z - getLastTime(f.csv[CsvType.EBAY_NEW_SHIPPING.index], CsvType.EBAY_NEW_SHIPPING) || 20160 > z - getLastTime(f.csv[CsvType.EBAY_USED_SHIPPING.index], CsvType.EBAY_USED_SHIPPING))
                                            V = "#000",
                                            S = "";
                                        V = '&emsp;<a href="' + getEbayRedirectByDomain(f.domainId, f.asin, !0) + '" rel="ebay" title="' + S + '" style="display: inline-block;font-size: 23px;line-height: 20px;transform: scale(1.2,1);color:' + V + '"><span>e</span><span style="margin-left: -2px;">b</span><span style="margin-left: -2px;">a</span><span style="margin-left: -2px;">y</span></a>'
                                    }
                                    S = 7 != storage.domain ? '<li class="tabItem" class="hidden" id="tabMore" rel="more">Data</li>' : "";
                                    aa = null != f.variationCSV && 12 < f.variationCSV.length || null != f.variations && 1 < f.variations.length ? '<li class="tabItem" class="hidden" id="tabVariation" rel="more">' + la._747 + "</li>" : "";
                                    var ea = "Guild Product" !== f.productGroup ? '<li class="tabSubItem" data-box="#MoreTab2">Offers</li>' : ""
                                      , ra = null;
                                    if (f.categories && 0 < f.categories.length)
                                        try {
                                            var pa = JSON.parse(JSON.stringify(dealWrapperInstance.get().loadRequest("last")));
                                            null == pa.includeCategories && (pa.includeCategories = []);
                                            pa.includeCategories[f.domainId] = f.categories;
                                            pa.dateRange = 4;
                                            ra = "https://keepa.com/#!deals/" + encodeURIComponent(JSON.stringify(pa))
                                        } catch (qa) {
                                            reportBug(qa)
                                        }
                                    pa = null != ra ? '<li class="tabItem tabDeals"><a href="' + ra + '">&rarr;&ensp;' + la._420 + "</a></li>" : "";
                                    K += '</div><div class="tabBox"><div><ul id="tabHead" class="flex"><li class="tabItem active" id="tabGraph" rel="graph">' + la._124 + '</li><li class="tabItem" id="tabTrack" rel="track">' + la._125 + "</li>" + S + aa + '<li class="tabItem" id="tabAmazon"><a href="' + getAmazonRedirectByDomain(d, f.ASIN) + '" rel="amazon"><span style="margin-left:20px"></span>' + H + '<span class="margin-left: 10px;">' + la._99_2 + "</span></a>" + V + "</li>" + pa + '</ul></div><div id="tabContent"><div id="priceHistory" class="active"><div class="graph unselectable" id="graph"></div></div><div class="productTrack" id="track"></div><div class="productInfos" id="infos"></div><div class="productLoadingTab" id="loadingTab"></div><div id="more" class="hidden" style="margin-right: 10px;position: relative;min-height:60px;"><div><ul id="tabHeadSub"><li class="tabSubItem active" data-box="#MoreTab1">Product Details</li>' + ea + '<li class="tabSubItem" data-box="#MoreTab3">Buy Box Statistics</li></ul></div><div id="loadingIconAdv" style="position: absolute !important;left: 185px;top: 80px;"><div id="loadingProgress"></div></div>' + (0 == storage.accountType ? '<div style="margin:15px 0;color:#b30093;font-weight:500;font-style:italic;">' + la._925 + "</div><br>" : "") + '<div style="margin-top: 20px;"><div class="active" id="MoreTab1"></div><div class="hidden" id="MoreTab2"></div><div class="hidden" id="MoreTab3"></div></div></div><div id="variation"></div></div></div>';
                                    replaceHtml("productTableDescription", K);
                                    $(".priceEbayNew, .priceEbayUsed").colorTip({
                                        color: "twitter"
                                    });
                                    var ua = $("#tabContent")
                                      , na = $("#tabHead");
                                    if (!refreshedOnce)
                                        $("#refreshProduct").one("click", function() {
                                            refreshedOnce = !0;
                                            $("#refreshProduct").addClass("fa-spin");
                                            loadProduct(1)
                                        });
                                    setTimeout(function() {
                                        storage.previewCasin && function() {
                                            callCasin(function(qa) {
                                                comparePricesLine(f.ASIN, d, qa)
                                            }, f.ASIN, d, !0)
                                        }()
                                    }, 1);
                                    $("#tabGraph").click(function() {
                                        $(this).hasClass("active") || (ua.children(".active").hide().removeClass("active"),
                                        $("#priceHistory").addClass("active"),
                                        $("#priceHistory").fadeIn(),
                                        na.children().removeClass("active"),
                                        $("#tabGraph").addClass("active"),
                                        $("#subGraphButtons").show())
                                    });
                                    $("#tabTrack").click(function() {
                                        $(this).hasClass("active") || (0 === $("#track .tracking").length && (TrackingComponent.init(t),
                                        $("#grid-tools-variation").show(),
                                        $("#grid-wrapper-variation").show(),
                                        $("#grid-wrapper-variation-filter").show()),
                                        $("#priceHistory").hide(),
                                        ua.children(".active").hide().removeClass("active"),
                                        $("#track").addClass("active").fadeIn(),
                                        na.children().removeClass("active"),
                                        $("#tabTrack").addClass("active"))
                                    });
                                    $("#tabMore").click(function() {
                                        $(this).hasClass("active") || (ua.css("height", ""),
                                        $("#subGraphButtons").hide(0),
                                        $("#refreshProductBox").hide(0),
                                        ua.children(".active").hide(0).removeClass("active"),
                                        $("#more").addClass("active").fadeIn().width($("#tabContent").width()),
                                        na.children().removeClass("active"),
                                        $("#tabMore").addClass("active"),
                                        iframe.loadDataOffers("MoreTab1", f))
                                    });
                                    $("#tabHeadSub").on("click", function(qa) {
                                        qa = $(qa.target);
                                        qa.hasClass("active") || (qa.siblings(".active").removeClass("active"),
                                        qa.addClass("active"),
                                        qa = $(qa.data("box")),
                                        qa.siblings(".active").removeClass("active").addClass("hidden"),
                                        qa.removeClass("hidden").addClass("active"),
                                        iframe.loadDataOffers(qa.attr("id"), f),
                                        addon("resize", 50 + float2int($("#initPage").height())))
                                    });
                                    $("#tabVariation").on("click", function(qa) {
                                        $(this).hasClass("active") || (ua.css("height", ""),
                                        ua.children(".active").hide(0).removeClass("active"),
                                        $("#variation").addClass("active").fadeIn().width($("#tabContent").width()),
                                        na.children().removeClass("active"),
                                        $("#tabVariation").addClass("active"),
                                        iframe.loadVariationMatrix(f))
                                    });
                                    f.stats || (f.stats = getStatistics(f));
                                    dataProduct = f;
                                    I && (pa = $("#graph"),
                                    K = graph.prepare(d),
                                    K.csv = f.csv,
                                    K.p = f,
                                    K.salesRanks = f.salesRanks,
                                    K.salesRankCategoryTrees = f.salesRankCategoryTrees,
                                    K.isParentSalesRank = f.isParentSalesRank,
                                    K.salesRankReference = f.salesRankReference,
                                    K.salesRankCategories = f.salesRankCategories,
                                    K.asin = f.ASIN,
                                    K.graphIndex = 0,
                                    K.syncedGraphs = F,
                                    F.push(K),
                                    K.stats = f.stats,
                                    K.buyBoxSellerIdHistory = f.buyBoxSellerIdHistory,
                                    K.offers = f.offers,
                                    K.$container = pa,
                                    K.$container.show(),
                                    null != f.trackingInfos && f.trackingInfos.isTrackedByUser && (K.parameter.tracking = f.trackingInfos.userTracking),
                                    K.parameter.width = float2int(pa.parent().width()) - 200 + "px",
                                    graph.create(K),
                                    addSubGraphMenu(f, d, F));
                                    addThumbEvents();
                                    TrackingComponent.init(t);
                                    triggerTrack && ($("#tabTrack").trigger("click"),
                                    triggerTrack = !1);
                                    setupQuotaWidget(!0)
                                })
                            }
                        }
                    } else
                        replaceHtml("productTableDescription", la._341)
            };
            network.request({
                path: "product",
                version: 3,
                history: !0,
                type: "ws",
                domainId: d,
                asin: h,
                maxAge: 3,
                refreshProduct: 1 == a
            }).done(function(t) {
                var f = keepaTime.now()
                  , n = getProductFromList(h, t.products)
                  , r = null !== n ? n.csv[CsvType.SALES.index] : null
                  , p = null === r || 2 === r.length && -1 === r[1];
                null !== n && null !== n.parentAsin && null == n.variationCSV ? (isTest && console.log("loading parentAsin: " + n.parentAsin + " " + d),
                network.request({
                    path: "product",
                    version: 3,
                    history: !0,
                    type: "ws",
                    domainId: d,
                    asin: n.parentAsin,
                    maxAge: 3,
                    onlyParent: !0,
                    refreshProduct: 1 == a
                }).done(function(z) {
                    z = getProductFromList(n.parentAsin, z.products);
                    try {
                        null != z.variationCSV && (null == n.variationCSV || n.variationCSV.length < z.variationCSV.length) && (n.variationCSV = z.variationCSV);
                        var F = null != z.csv && null != z.csv[CsvType.SALES.index] ? z.csv[CsvType.SALES.index].length : 0;
                        if (p)
                            n.csv[CsvType.SALES.index] = z.csv[CsvType.SALES.index],
                            n.isParentSalesRank = 2 < F;
                        else if (2 < F) {
                            var I = getWeightedMean(z.csv[CsvType.SALES.index], f, 30, CsvType.SALES)
                              , E = getWeightedMean(n.csv[CsvType.SALES.index], f, 30, CsvType.SALES)
                              , K = Math.min(I, E) / Math.max(I, E);
                            .88 < K && (console.log("merged parent and child sales rank history", K),
                            n.csv[CsvType.SALES.index] = mergeCSV(n.csv[CsvType.SALES.index], z.csv[CsvType.SALES.index], CsvType.SALES),
                            n.isParentSalesRank = !0)
                        }
                    } catch (H) {} finally {
                        m(t)
                    }
                }).fail(function(z) {
                    m(t)
                })) : m(t)
            }).fail(function(t) {
                replaceHtml("productTableDescription", "server not responding: <br>" + la._error)
            })
        }
    }
}
function showMoreDataGraph(a, b, d) {
    var h = graph.getGraphObject(b, a.ASIN, 0, !1);
    if ("undefined" == typeof h || null == h)
        console.error("maingraph undefined");
    else {
        if (300 != h.$container.height()) {
            var m = Math.min(h.$container.height(), 300)
              , t = float2int(h.$container.find(".legend > table").height());
            m = Math.max(m, t);
            float2int(h.$container.height()) != m && h.$container.height(m);
            h.plot.resize();
            graph.redraw(h, !0, !0)
        }
        m = $("#moreDataGraph");
        0 < m.children().length ? (addon("resize", float2int($("#initPage").height() + m.height())),
        m.css("pointerEvents", "auto"),
        m.show("fade", function() {
            graph.syncGraphAlignment(h)
        })) : (b = graph.prepare(b),
        b.csv = a.csv,
        b.asin = a.ASIN,
        b.syncedGraphs = d,
        d.push(b),
        b.axes.x[0].show = !0,
        b.axes.x[0].tickFormatter = function() {
            return ""
        }
        ,
        b.graphIndex = 1,
        b.stats = a.stats,
        b.$container = m,
        b.preProcessedCSV = !0,
        b.$container.show(),
        b.parameter.width = h.parameter.width,
        b.parameter.height = "150px",
        null != a.trackingInfos && a.trackingInfos.isTrackedByUser && (b.parameter.tracking = a.trackingInfos.userTracking),
        graph.create(b),
        setTimeout(addon, 1))
    }
}
function hideSalesRankGraph(a, b) {
    var d = graph.getGraphObject(a, b, 2, !1);
    "undefined" != typeof d && (d && d.$container.css("pointerEvents", "none"),
    d.$container.hide("fade", function() {
        var h = graph.getGraphObject(a, b, 0, !1);
        h && (h.$container.height(h.parameter.height),
        h.plot.resize(),
        graph.redraw(h, !0, !1),
        addon())
    }))
}
function showSalesRankGraph(a, b, d) {
    if (!keepaApp) {
        try {
            if ("undefined" == typeof a.salesRanks || null == a.salesRanks || 2 == a.csv[CsvType.SALES.index].length && -2 == a.csv[CsvType.SALES.index][1])
                return;
            var h = graph.getGraphObject(b, a.ASIN, 0, !1);
            if ("undefined" == typeof h || null == h) {
                console.error("maingraph undefined");
                return
            }
            var m = graph.prepare(b);
            m.syncedGraphs = d;
            m.asin = a.ASIN;
            m.axes.x[0].show = !0;
            m.axes.x[0].tickFormatter = function() {
                return ""
            }
            ;
            "undefined" == typeof a.salesRankCategoryTrees && (a.salesRankCategoryTrees = {});
            "undefined" == typeof a.salesRankCategories && (a.salesRankCategories = {});
            for (var t = -2; 0 > t; t++)
                if (a.salesRankReference == t && "undefined" == typeof a.salesRankCategoryTrees[t]) {
                    var f = "" + t;
                    a.salesRankCategoryTrees[f] = [{
                        catId: t,
                        name: "Root Category"
                    }];
                    a.salesRankCategories[f] = {
                        domainId: a.domainId,
                        catId: f,
                        name: -2 == t ? "Launchpad" : "Root Category",
                        children: [],
                        parent: -1,
                        highestRank: 0,
                        productCount: 0,
                        contextFreeName: -2 == t ? "Launchpad" : "Root Category"
                    }
                }
            t = {};
            f = {};
            var n = {};
            for (z in a.salesRankCategoryTrees)
                f["#" + z] = a.salesRankCategoryTrees[z];
            for (var r in a.salesRankCategories)
                n["#" + r] = a.salesRankCategories[r];
            if (null != a.salesRanks)
                for (var p in a.salesRanks)
                    t["#" + p] = a.salesRanks[p];
            if (0 === Object.keys(a.salesRankCategoryTrees).length && a.salesRankCategoryTrees.constructor === Object)
                return;
            var z = [];
            for (var F in t)
                z[F] = t[F];
            z["#" + a.salesRankReference] = a.csv[CsvType.SALES.index];
            F = [];
            var I = getCategorySalesRanks(f, n, z);
            if (0 == I.length)
                return;
            r = 0;
            t = [];
            t["#" + a.salesRankReference] = a.csv[CsvType.SALES.index];
            if (null != a.salesRanks)
                for (var E = $jscomp.makeIterator(I), K = E.next(); !K.done; K = E.next()) {
                    var H = K.value;
                    "undefined" != typeof a.salesRanks[H.cr.catId] && (t["#" + H.cr.catId] = a.salesRanks[H.cr.catId],
                    F.push({
                        data: a.salesRanks[H.cr.catId],
                        catId: H.cr.catId
                    }),
                    r++)
                }
            m.allRanksOrdered = F;
            m.csv = t;
            var V = m.axes.y[m.axes.y.length - 1].index;
            V = 2;
            I = !0;
            var S = [m.axes.y[0]], aa;
            for (aa in z)
                S.push({
                    index: V++,
                    tickDecimals: 0,
                    min: 0,
                    alignTicksWithAxis: 0,
                    position: "right",
                    tickFormatter: function(na, qa) {
                        return "#" + NumberUtil.format(na)
                    },
                    transform: "0" === storage.salesRankInverse ? null : function(na) {
                        return -na
                    }
                    ,
                    inverseTransform: "0" === storage.salesRankInverse ? null : function(na) {
                        return -na
                    }
                    ,
                    tickColor: "rgba(0, 255, 0, 0.13)",
                    show: I,
                    defaultShow: I
                }),
                I = !1;
            if (300 != h.$container.height()) {
                var ea = Math.min(h.$container.height(), 300)
                  , ra = float2int(h.$container.find(".legend > table").height());
                ea = Math.max(ea, ra);
                float2int(h.$container.height()) != ea && h.$container.height(ea);
                h.plot.resize();
                graph.redraw(h, !0, !0)
            }
            var pa = $("#salesRankGraph");
            if (0 < pa.children().length) {
                addon("resize", float2int($("#initPage").height() + pa.height()));
                pa.css("pointerEvents", "auto");
                pa.show("fade", function() {
                    graph.syncGraphAlignment(h)
                });
                return
            }
            d.push(m);
            if (null != a.salesRankReferenceHistory) {
                d = [];
                for (V = 0; V < a.salesRankReferenceHistory.length; V += 2) {
                    var ua = a.salesRankReferenceHistory[V + 1];
                    n["#" + ua] ? a.salesRankReferenceHistory[V + 1] = n["#" + ua].name : d.push(ua)
                }
                0 < d.length && network.request({
                    path: "pro/category",
                    domainId: b,
                    categoryIds: d,
                    version: 3
                }).done(function(na) {
                    for (var qa = 0; qa < a.salesRankReferenceHistory.length; qa += 2) {
                        var ka = a.salesRankReferenceHistory[qa + 1];
                        na.categories[ka] && (a.salesRankReferenceHistory[qa + 1] = na.categories[ka].name)
                    }
                })
            }
            m.axes.y = S;
            m.graphIndex = 2;
            m.$container = pa;
            m.salesRanks = t;
            m.salesRankCategoryTrees = f;
            m.salesRankReference = "#" + a.salesRankReference;
            m.salesRankCategories = n;
            m.salesRankReferenceHistory = a.salesRankReferenceHistory;
            m.preProcessedCSV = !0;
            m.parameter.width = h.parameter.width;
            m.parameter.height = "125px";
            m.$container.show();
            graph.create(m)
        } catch (na) {
            reportBug(na, a.asin + " " + a.domainId),
            console.log(na)
        }
        setTimeout(addon, 1)
    }
}
function addSubGraphMenu(a, b, d) {
    if (!keepaApp) {
        var h = null == a.trackingInfos ? "" : '<span class="shareChart" id="trackingInfos"><span class="statsDate">' + a.trackingInfos.users + '</span>&nbsp;<i class="fa fa-users fa-18"></i>&ensp;' + la._421 + "</span>"
          , m = storage.previewCasin ? "" : '<span class="shareChart " id="compareChart"><i class="fa fa-globe fa-18"></i>&ensp;' + la._315 + "</span>"
          , t = storage.previewCasin ? '<i id="compareChart" title="' + la._315 + '" class="fa fa-globe fa-18" style="font-size: 37px !important;margin-right: 20px;opacity: 0.4;"></i><div id="loadingIconCasin" style="text-align:center;clear: both;"></div>' : ""
          , f = '<div class="legendTip"></div><div style="font-size: 10px;margin-left:30px;color:#7d7d7d;margin-bottom:-5px;position:relative;width: 600px;">' + (isMobile ? "" : la._509) + "&emsp;\ud83d\ude9a = " + la._465 + "<br>" + la._510 + "</div>"
          , n = "1" == storage.moreData ? '<i class="fa fa-minus-square-o fa-18"></i>&ensp;' + la._430 : '<i class="fa fa-clone fa-18"></i>&ensp;' + la._429;
        $("#graph").after('<div id="salesRankGraph" class="graph" style="display:none;margin-top: 10px;"></div><div id="moreDataGraph" class="graph" style="display:none;margin-top: 10px;"></div>' + f + '<div id="subGraphHover" style="position: relative;"><div class="flex subGraphHoverAlignment"><div></div><div id="statisticsContent" class="hidden"></div><div></div></div>' + (null == a.trackingInfos ? "" : '<div class="flex subGraphHoverAlignment"><div></div><div id="trackingInfosContent" class="hidden"></div><div></div></div>') + '</div><div id="casinLine" class="flex">' + t + '<div id="subGraphButtons">' + h + '<span class="shareChart" id="statistics"><i class="fa fa-bar-chart fa-18"></i>&ensp;' + la._382 + "</span>" + m + '<span class="shareChart" id="shareChart"><i class="fa fa-share fa-18"></i>&ensp;' + la._313 + '</span><span class="shareChart" id="moreData">' + n + "</span></div></div>");
        var r = $(".toggleSalesRankGraph");
        $("#salesRankGraph").hover(function() {
            r.css({
                background: "#e9f6ea",
                borderRadius: "16px",
                boxShadow: "0px 0px 7px 2px #e9f6ea"
            })
        }, function() {
            r.css({
                background: "#fff",
                boxShadow: "0px 0px 7px 2px #fff"
            })
        });
        try {
            "1" === storage.showSalesRankGraph && showSalesRankGraph(a, b, d)
        } catch (H) {
            isTest ? console.log(H) : reportBug(H)
        }
        "1" == storage.moreData && showMoreDataGraph(a, b, d);
        $("#compareChart").on("click", function() {
            comparePricesOverlay(a.ASIN, b)
        });
        null != a.trackingInfos && (t = function(H, V, S) {
            var aa = "";
            h[V][S] && -1 != h[V][S] ? (5 == H ? h[V][S].val && (aa = "#" + NumberUtil.format(h[V][S].val)) : aa = '<span style="white-space: nowrap">' + Money.format(h[V][S].val, {
                sourceDomainId: b,
                targetDomainId: b
            }) + "</span>",
            aa = "avg" == S ? aa + ('<br><span class="statsDate">' + la._422.replace("X", h[V].avg.count) + "</span>") : "current" == S ? aa + ('<br><span class="statsDate">' + prettyDate(keepaTime.now() - h[V][S].date) + "</span>") : aa + ('<br><span class="statsDate">' + (new Date(keepaTime.minutesToEpoch(h[V][S].date))).formatDate("M j, Y") + "</span>")) : aa = "current" == S ? '<span style="font-size:11px;">' + la._83 + "</span>" : '<span style="font-size:11px;">-</span>';
            return '<td class="statsRow' + H + '">' + aa + "</td>"
        }
        ,
        h = a.trackingInfos,
        m = h.isTrackedByUser ? '<tr><td class="statsRow1">' + la._423 + "</td>" + t(2, "amazon", "current") + t(3, "mnew", "current") + t(4, "mused", "current") + "</tr><tr>" : "",
        t = 1 < h.users || !h.isTrackedByUser ? '<td class="statsRow1">' + la._342 + " " + la._385 + "</td>" + t(2, "amazon", "avg") + t(3, "mnew", "avg") + t(4, "mused", "avg") + "</tr>" : "",
        replaceHtml("trackingInfosContent", '<table id="trackingInfoTable"><tr><th></th><th rel="2">Amazon</th><th rel="3">' + la._148 + '</th><th rel="4">' + la._149 + "</th></tr>" + m + "<tr>" + t + '</table><div style="padding:10px;">' + (1 < h.users ? h.users + " " + la._424 : h.isTrackedByUser ? la._426 : "1 " + la._425) + "</div>"));
        try {
            m = function(H, V) {
                try {
                    if (void 0 === p[V] || 0 > p[V].lowest && -2 !== p[V].current)
                        I.find(".statsRow" + H).hide(0),
                        I.find("th[rel=" + H + "]").hide(0)
                } catch (S) {
                    console.error(p, H, V, S)
                }
            }
            ;
            t = function(H, V, S) {
                var aa = "";
                try {
                    if (void 0 === p[V])
                        return "";
                    p[V][S] && -1 != p[V][S] && -1 != p[V][S].val && -2 !== p[V][S] ? "avgDrops" == S ? aa = p[V][S] + '<br><span class="statsDate">' + la._397 + "</span>" : (5 == H ? p[V][S].val && (aa = "#" + NumberUtil.format(p[V][S].val)) : aa = Money.format(p[V][S].val, {
                        sourceDomainId: b,
                        targetDomainId: b
                    }),
                    aa = "avg" == S ? aa + ('<br><span class="statsDate">' + la._386.replace("X", p[V].avg.days) + "</span>") : "avg180" == S ? aa + ('<br><span class="statsDate">' + la._386.replace("X", "180") + "</span>") : "current" == S ? aa + ('<br><span class="statsDate">' + prettyDate(keepaTime.now() - p[V][S].date) + "</span>") : aa + ('<br><span class="statsDate">' + (new Date(keepaTime.minutesToEpoch(p[V][S].date))).formatDate("M j, Y") + "</span>")) : aa = -2 === p[V].current ? '<span style="color: #666;"><i class="fa fa-lock"></i></span>' : "current" == S ? '<span style="font-size:11px;">' + la._134 + "</span>" : '<span style="font-size:11px;">-</span>'
                } catch (ea) {
                    return console.log(ea),
                    ""
                }
                return '<td class="statsRow' + H + '">\n\t\t\t\t\t' + aa + "\n\t\t\t\t</td>"
            }
            ;
            var p = a.stats
              , z = 4296 < keepaTime.now() - a.trackingSince ? '<tr><td class="statsRow1"></td>\n\t\t\t' + t(2, "amazon", "avg180") + "\n\t\t\t" + t(3, "mnew", "avg180") + "\n\t\t\t" + t(4, "mused", "avg180") + "\n\t\t\t" + t(5, "salesrank", "avg180") + "\n\t\t\t</tr>" : ""
              , F = -2 === p.salesrank.current ? '<span style="color:#666;display:inline-block;font-size:11px;padding:5px 15px;"><i class="fa fa-lock"></i> = ' + la._909 + "</span>" : "";
            replaceHtml("statisticsContent", '<table id="statsTable">\n\t\t\t\t<tr>\n\t\t\t\t\t<th></th>\n\t\t\t\t\t<th rel="2">Amazon</th>\n\t\t\t\t\t<th rel="3">' + la._148 + '</th>\n\t\t\t\t\t<th rel="4">' + la._149 + '</th>\n\t\t\t\t\t<th rel="5">' + la._391 + '</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="color: rgb(60, 179, 113);" class="statsRow1">' + la._383 + "<br></td>\n\t\t\t\t\t" + t(2, "amazon", "lowest") + "\n\t\t\t\t\t" + t(3, "mnew", "lowest") + "\n\t\t\t\t\t" + t(4, "mused", "lowest") + "\n\t\t\t\t\t" + t(5, "salesrank", "lowest") + '\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td class="statsRow1">' + la._344 + "</td>\n\t\t\t\t\t" + t(2, "amazon", "current") + "\n\t\t\t\t\t" + t(3, "mnew", "current") + "\n\t\t\t\t\t" + t(4, "mused", "current") + "\n\t\t\t\t\t" + t(5, "salesrank", "current") + '\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="color: tomato" class="statsRow1">' + la._384 + "</td>\n\t\t\t\t\t" + t(2, "amazon", "highest") + "\n\t\t\t\t\t" + t(3, "mnew", "highest") + "\n\t\t\t\t\t" + t(4, "mused", "highest") + "\n\t\t\t\t\t" + t(5, "salesrank", "highest") + '\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td class="statsRow1">' + la._385 + "</td>\n\t\t\t\t\t" + t(2, "amazon", "avg") + "\n\t\t\t\t\t" + t(3, "mnew", "avg") + "\n\t\t\t\t\t" + t(4, "mused", "avg") + "\n\t\t\t\t\t" + t(5, "salesrank", "avg") + "\n\t\t\t\t</tr>\n\t\t\t\t" + z + '\n\t\t\t\t<tr>\n\t\t\t\t\t<td class="statsRow1">' + la._396 + '<br><span style="font-size:11px;">90 ' + la._857 + "</span></td>\n\t\t\t\t\t" + t(2, "amazon", "avgDrops") + "\n\t\t\t\t\t" + t(3, "mnew", "avgDrops") + "\n\t\t\t\t\t" + t(4, "mused", "avgDrops") + "\n\t\t\t\t\t" + t(5, "salesrank", "avgDrops") + "\n\t\t\t\t</tr>\n\t\t\t</table>" + F);
            var I = $("#statsTable");
            m(2, "amazon");
            m(3, "mnew");
            m(4, "mused");
            m(5, "salesrank")
        } catch (H) {}
        $("#shareChart").on("click", function() {
            shareChart()
        });
        $("#moreData").on("click", function() {
            if ("1" == storage.moreData) {
                storage.moreData = "0";
                settings.send();
                $(this).html('<i class="fa fa-clone fa-18"></i>&ensp;' + la._429);
                var H = graph.getGraphObject(b, a.asin, 1, !1);
                H && H.$container.css("pointerEvents", "none");
                $("#moreDataGraph").hide("fade", function() {
                    var V = graph.getGraphObject(b, a.asin, 0, !1);
                    V && (V.$container.height(V.parameter.height),
                    V.plot.resize(),
                    graph.redraw(V, !0, !1),
                    addon())
                })
            } else
                $(this).html('<i class="fa fa-minus-square-o fa-18"></i>&ensp;' + la._430),
                storage.moreData = "1",
                settings.send(),
                showMoreDataGraph(a, b, d)
        });
        var E = $("#statisticsContent")
          , K = $("#trackingInfosContent");
        $("#statistics").hover(function() {
            E.show(0)
        }, function() {
            E.hide(0)
        });
        $("#trackingInfos").hover(function() {
            K.show(0)
        }, function() {
            K.hide(0)
        })
    }
}
function getTrackingInfos(a, b, d) {
    function h(p, z) {
        z = z[z.length - 1];
        for (var F = {
            date: 0,
            val: 0
        }, I = {
            date: 0,
            val: 99999999999
        }, E = {
            val: -1,
            count: 0
        }, K = {
            date: 0,
            val: -1
        }, H = 0, V = b.length; H < V; H++) {
            var S = b[H];
            S && 0 < S.createDate && (m = !0,
            t = S);
            if (null != S && null != S.thresholdValues)
                for (var aa in S.thresholdValues) {
                    var ea = S.thresholdValues[aa]
                      , ra = ea.csvType == p;
                    p != CsvType.USED.index || ea.csvType != CsvType.WAREHOUSE.index && ea.csvType != CsvType.USED_ACCEPTABLE_SHIPPING.index && ea.csvType != CsvType.USED_GOOD_SHIPPING.index && ea.csvType != CsvType.USED_NEW_SHIPPING.index && ea.csvType != CsvType.USED_VERY_GOOD_SHIPPING.index || (ra = !0);
                    p != CsvType.NEW.index || ea.csvType != CsvType.NEW_FBA.index && ea.csvType != CsvType.BUY_BOX_SHIPPING.index && ea.csvType != CsvType.NEW_FBM_SHIPPING.index || (ra = !0);
                    if (ra && ea.domain == a && null != ea.thresholdValueCSV && 0 < ea.thresholdValueCSV.length) {
                        var pa = ea.thresholdValueCSV[ea.thresholdValueCSV.length - 2];
                        ra = ea.thresholdValueCSV[ea.thresholdValueCSV.length - 1];
                        if (0 < S.createDate) {
                            K.val = ra;
                            K.date = pa;
                            var ua = 6E4 * (offsetMinutes + pa);
                            d.CDATE = d.CDATE ? Math.min(d.CDATE, ua) : ua
                        }
                        if (ea.isDrop) {
                            I.val >= ra && (I.val = ra,
                            I.date = pa);
                            F.val <= ra && (F.val = ra,
                            F.date = pa);
                            0 > E.val && E.val++;
                            if (4 < E.count && (ea = E.val / E.count,
                            -1 != z && .7 < Math.min(z, ea) / Math.max(z, ea) && (ea = z),
                            .7 > Math.min(ra, ea) / Math.max(ra, ea)))
                                continue;
                            E.count++;
                            E.val += ra
                        }
                    }
                }
        }
        -1 != E.val && (E.val = 0 != E.count ? E.val / E.count : -1);
        return {
            highest: 0 == F.val ? -1 : F,
            current: 1 > K.val ? -1 : K,
            avg: 1 > E.val ? -1 : E,
            lowest: 99999999999 == I.val ? -1 : I,
            pctToAvg: 1 > E.val ? -1 : E.val
        }
    }
    if (void 0 == b || null == b || 0 == b.length)
        return null;
    var m = !1
      , t = null
      , f = h(CsvType.AMAZON.index, d.AMAZON)
      , n = h(CsvType.NEW.index, d.MARKET_NEW)
      , r = h(CsvType.USED.index, d.MARKET_USED);
    m && (d.desiredPrices = [f.current.val, n.current.val, r.current.val]);
    return {
        amazon: f,
        mnew: n,
        mused: r,
        users: b.length,
        isTrackedByUser: m,
        userTracking: t
    }
}
function statsCSV(a, b) {
    if (null != a) {
        var d = CsvType.getObject(b)
          , h = d.isWithShipping
          , m = h ? 3 : 2
          , t = h ? 2 : 1
          , f = keepaTime.now()
          , n = f - a[0]
          , r = f - 129600
          , p = f - 259200
          , z = f - 525600
          , F = {
            date: 0,
            val: 0
        }
          , I = {
            date: 0,
            val: getValueAtTime(a, r, d)
        }
          , E = {
            date: 0,
            val: getValueAtTime(a, p, d)
        }
          , K = {
            date: 0,
            val: getValueAtTime(a, z, d)
        }
          , H = {
            date: 0,
            val: 99999999999
        }
          , V = {
            date: 0,
            val: I.val
        }
          , S = {
            date: 0,
            val: E.val
        }
          , aa = {
            date: 0,
            val: K.val
        }
          , ea = {
            date: 0,
            val: 0
        }
          , ra = 90
          , pa = -1
          , ua = 0;
        129600 > n && (ra = Math.floor(n / 1440));
        for (var na = 1440 * ra, qa = -1, ka = 1, za = a.length; ka < za; ka += m) {
            var J = a[ka];
            if ("" != J && -1 != J) {
                J = Number(J);
                if (h) {
                    var g = Number(a[ka - 2]);
                    J += 0 > g ? 0 : g
                }
                g = Number(a[ka - 1]);
                F.val <= J && (F.val = J,
                F.date = g);
                I.val <= J && -1 < I.val && g > r && (I.val = J,
                I.date = g);
                E.val <= J && -1 < E.val && g > p && (E.val = J,
                E.date = g);
                K.val <= J && -1 < K.val && g > z && (K.val = J,
                K.date = g);
                H.val >= J && (H.val = J,
                H.date = g);
                V.val >= J && g > r && (V.val = J,
                V.date = g);
                S.val >= J && g > p && (S.val = J,
                S.date = g);
                aa.val >= J && g > z && (aa.val = J,
                aa.date = g);
                if (!(1440 > n))
                    if (f - Number(a[ka - 1]) < na) {
                        if (1 != ka) {
                            J < qa && (b == CsvType.SALES.index ? (g = qa / J,
                            (1E4 > qa || 5E4 > qa && 1.03 < g || 1.05 < g) && ua++) : ua++);
                            qa = J;
                            if (0 > pa)
                                if (0 > Number(a[ka - m]))
                                    pa = 0;
                                else {
                                    pa = (na - (f - Number(a[ka - 1]))) / 1440;
                                    g = Number(a[ka - m]);
                                    if (h) {
                                        var D = Number(a[ka - 2]);
                                        g += 0 > D ? 0 : D
                                    }
                                    pa *= Number(g)
                                }
                            ka + t == za ? 0 > a[ka - m] || (pa += (f - a[za - m]) / 24 * J) : pa += J * (Number(a[ka + t]) - Number(a[ka - 1]) / 1440)
                        }
                    } else
                        qa = J,
                        ka == za - t && -1 != a[ka] && (pa = Number(a[ka]))
            }
        }
        0 < ua && (ua = Math.round(ua / ra * 3000.5) / 100,
        ua = 5 > ua ? ua.toFixed(1) : ua.toFixed(0));
        b = Number(a[a.length - t]);
        h && -1 < b && (h = Number(a[a.length - 1]),
        b += 0 > h ? 0 : h);
        ea.val = b;
        ea.date = a[a.length - m];
        m = getWeightedMean(a, keepaTime.now(), 180, d);
        a = getWeightedMean(a, keepaTime.now(), 90, d);
        return {
            avg: 1 > a ? -1 : {
                days: 90,
                val: a
            },
            avg180: 1 > m ? -1 : {
                days: 180,
                val: m
            },
            avgDrops: ua,
            current: 1 > ea.val ? -2 == ea.val ? -2 : -1 : ea,
            highest: 0 == F.val ? -1 : F,
            highest90: 0 >= I.val ? -1 : I,
            highest180: 0 >= E.val ? -1 : E,
            highest365: 0 >= K.val ? -1 : K,
            hoursSinceFirstRecord: n / 60,
            lowest: 99999999999 == H.val || 1 > H.val ? -1 : H,
            lowest90: 99999999999 == V.val || 1 > V.val ? -1 : V,
            lowest180: 99999999999 == S.val || 1 > S.val ? -1 : S,
            lowest365: 99999999999 == aa.val || 1 > aa.val ? -1 : aa,
            pctToAvg: 1 > a ? -1 : a
        }
    }
}
function getStatistics(a) {
    var b = {}, d;
    for (d in a.csv)
        b[d] = statsCSV(a.csv[d], d);
    b.amazon = b[CsvType.AMAZON.index];
    b.mnew = b[CsvType.NEW.index];
    b.mused = b[CsvType.USED.index];
    b.salesrank = b[CsvType.SALES.index];
    return b
}
function addThumbEvents() {
    $(".productThumb").hover(function() {
        for (var a = 0; 8 > a; a++)
            $("#i" + a).hide();
        $("#i" + $(this).attr("id")).show();
        a = $("#productTableDescription");
        var b = $("#productTableImageBoxMain");
        b.width(float2int(a.width()) + 48);
        b.height(float2int(a.height()) + 20);
        b.show();
        return !1
    }, function() {
        $("#i" + $(this).attr("id")).hide();
        $("#productTableImageBoxMain").hide();
        return !1
    })
}
function shareChart() {
    if (!shareChartOverlayActive) {
        shareChartOverlayActive = !0;
        $("#tabGraph").trigger("click");
        var a = '<div id="overlayShadowTop2" class="hidden"></div><div id="shareChartOverlay" class="hidden"><div class="text_long shadow" style="text-align:justify; color: #444; width: 500px !important;"> <div id="shareChartOverlay-close"><i class="fa fa-times-circle fa-2x"></i></div><div><i class="fa fa-share fa-lg fa-2x"></i><div style="font-size: 18px; margin: 0 0 20px;display: inline-block; color: #111">&emsp;' + la._313 + '</div></div><img style="height:200px;margin-bottom: 10px;" src="' + graphShareURL + '"</img><hr style="border-color:#38F !important">' + la._297 + '<br><input class="selectable" id="shareChartInput" type="text" rel="site" autocomplete="off" class="site" role="textbox" readonly="readonly" style="display: inline-block; "></div></div>';
        $("#shareChart").before(a);
        $("#shareChartInput").val(graphShareURL);
        $("#shareChartInput").click(function() {
            $(this).select()
        });
        var b = $("#shareChartOverlay");
        b.velocity("transition.shrinkIn", 150);
        $("#overlayShadowTop2").show();
        a = function() {
            shareChartOverlayActive = !1;
            $("#overlayShadowTop2").hide();
            b.velocity("transition.shrinkOut", 150, function() {
                b.remove()
            });
            addon()
        }
        ;
        $("#overlayShadowTop2").click(a);
        $("#shareChartOverlay-close").click(a);
        try {
            iframe.getIframeHeight() < 80 + $("#shareChartOverlay").height() && addon("resize", 80 + float2int($("#shareChartOverlay").height()))
        } catch (d) {}
    }
}
function comparePricesLine(a, b, d) {
    function h(S) {
        m = t[S];
        var aa = '<img src="' + flags[S] + '">';
        null != m && m.hasReviews && (E += '<a target="_blank" title="open reviews on Amazon.' + getTldByDomain(S) + '" href="http://www.amazon.' + getTldByDomain(S) + "/product-reviews/" + a + '">' + aa + "</a>",
        K = !0);
        if (!(null == m || 0 > m.AMAZON_LAST && 0 > m.MARKET_NEW_LAST && 0 > m.MARKET_USED_LAST && 0 > m.BUY_BOX_LAST)) {
            var ea = 0 < currencyDomainId ? currencyDomainId : b;
            n = 0 > m.AMAZON_LAST ? "" : Money.format(m.values[0], {
                sourceDomainId: ea,
                targetDomainId: ea,
                skipSymbol: !0
            });
            r = 0 > m.MARKET_NEW_LAST ? "" : Money.format(m.values[1], {
                sourceDomainId: ea,
                targetDomainId: ea,
                skipSymbol: !0
            });
            p = 0 > m.MARKET_USED_LAST ? "" : Money.format(m.values[2], {
                sourceDomainId: ea,
                targetDomainId: ea,
                skipSymbol: !0
            });
            z = 0 > m.BUY_BOX_LAST ? "" : Money.format(m.values[3], {
                sourceDomainId: ea,
                targetDomainId: ea,
                skipSymbol: !0
            });
            F = !0;
            var ra = 'data-domain="' + S + '"'
              , pa = "function" == typeof loadProductIFrame ? "http://www.amazon." + getTldByDomain(S) + "/dp/" + a : getAmazonRedirectByDomain(S, a)
              , ua = ' style="' + (0 == n.length ? "display:none;" : "color:" + CsvType.AMAZON.color + ";" + (S == d.lowestAmazonDomain ? "box-shadow: 0 3px 4px -3px #000;font-weight: bold;" : "")) + '"'
              , na = ' style="' + (0 == r.length ? "display:none;" : "color:" + CsvType.NEW.color + ";" + (S == d.lowestNewDomain ? "box-shadow: 0 3px 4px -3px #000;font-weight: bold;" : "")) + '"'
              , qa = ' style="' + (0 == p.length ? "display:none;" : "color:" + CsvType.USED.color + ";" + (S == d.lowestUsedDomain ? "box-shadow: 0 3px 4px -3px #000;font-weight: bold;" : "")) + '"';
            S = ' style="' + (0 == z.length ? "display:none;" : "color:" + CsvType.BUY_BOX_SHIPPING.color + ";" + (S == d.lowestBBDomain ? "box-shadow: 0 3px 4px -3px #000;font-weight: bold;" : "")) + '"';
            var ka = m.csv[CsvType.LIGHTNING_DEAL.index]
              , za = getValueAtTime(ka, keepaTime.now(), CsvType.LIGHTNING_DEAL);
            ea = Money.format(za, {
                sourceDomainId: ea,
                targetDomainId: ea,
                skipSymbol: !0
            });
            ea = getLastTime(ka, CsvType.LIGHTNING_DEAL) < keepaTime.now() ? '<span style="display:none;"></span>' : '<span style="color:red;" title="' + CsvType.getName(CsvType.LIGHTNING_DEAL.index) + '"> <i class="fa fa-bolt" ></i> \n\t\t\t' + (0 > za ? '<i class="fa fa-clock-o" ></i>' : "" + ea) + ' <i class="fa fa-bolt" ></i>  \n\t\t\t</span>';
            I += "<span " + ra + '><a target="_blank" href="' + pa + '">' + aa + ea + ("<span" + S + ' title="' + CsvType.getName(CsvType.BUY_BOX_SHIPPING.index) + '">' + z + "</span><span") + (ua + ' title="' + CsvType.getName(CsvType.AMAZON.index) + '">' + n + "</span><span") + (na + ' title="' + CsvType.getName(CsvType.NEW.index) + '">' + r + "</span><span") + (qa + ' title="' + CsvType.getName(CsvType.USED.index) + '">' + p + "</span></a></span>")
        }
    }
    for (var m, t = {}, f = 0; f < d.length; f++)
        m = d[f],
        null != m && (2 == m.productType || 3 == m.productType || 4 == m.productType || 5 == m.productType ? d[f] = null : (t[m.domainId] = m,
        m.AMAZON = m.csv[CsvType.AMAZON.index],
        m.MARKET_NEW = m.csv[CsvType.NEW.index],
        m.MARKET_USED = m.csv[CsvType.USED.index],
        m.SALESRANK = m.csv[CsvType.SALES.index],
        m.AMAZON_LAST = m.AMAZON[m.AMAZON.length - 1],
        m.MARKET_NEW_LAST = m.MARKET_NEW[m.MARKET_NEW.length - 1],
        m.MARKET_USED_LAST = m.MARKET_USED[m.MARKET_USED.length - 1],
        m.BUY_BOX_LAST = getLast(m.csv[CsvType.BUY_BOX_SHIPPING.index], CsvType.BUY_BOX_SHIPPING),
        m.hasReviews = m.csv[CsvType.COUNT_REVIEWS.index] && 0 < m.csv[CsvType.COUNT_REVIEWS.index][m.csv[CsvType.COUNT_REVIEWS.index].length - 1]));
    calcComparePrices(d, b);
    var n, r, p, z, F = !1, I = "", E = f = "", K = !1, H = 0 < currencyDomainId ? getCurrencyByDomain(currencyDomainId) : getCurrencyByDomain(b);
    var V = '<span class="casinLineContinent"><div><span class="casinLineLabel">' + la._352 + " " + H + "</span>";
    h(1);
    h(6);
    h(11);
    F ? (K && (E = '<span class="casinReview"><span>Reviews:&ensp;</span>' + E + "</span>",
    V += E),
    I = V + "</div><div>" + I + "</div></span>") : I = "";
    E = "";
    f += I;
    I = "";
    K = F = !1;
    V = '<span class="casinLineContinent"><div><span class="casinLineLabel">' + la._353 + " " + H + "</span>";
    h(2);
    h(3);
    h(4);
    h(8);
    h(9);
    F ? (K && (E = '<span class="casinReview"><span>Reviews:&ensp;</span>' + E + "</span>",
    V += E),
    I = V + "</div><div>" + I + "</div></span>") : I = "";
    E = "";
    f += I;
    I = "";
    K = F = !1;
    V = '<span class="casinLineContinent"><div><span class="casinLineLabel">' + la._354 + " " + H + "</span>";
    h(5);
    h(10);
    F || K ? (K && (E = '<span class="casinReview"><span>Reviews:&ensp;</span>' + E + "</span>",
    V += E),
    I = V + "</div><div>" + I + "</div></span>") : I = "";
    E = "";
    f += I;
    I = "";
    K = F = !1;
    V = '<span class="casinLineContinent"><div><span class="casinLineLabel">' + la._663 + " " + H + "</span>";
    h(13);
    F ? (K && (E = '<span class="casinReview"><span>Reviews:&ensp;</span>' + E + "</span>",
    V += E),
    I = V + "</div><div>" + I + "</div></span>") : I = "";
    E = "";
    f += I;
    I = "";
    K = F = !1;
    V = "";
    $("#compareChart").after(f);
    $(".casinReview > a").colorTip({
        color: "yellow"
    });
    addon();
    setTimeout(addon, 450)
}
function comparePricesOverlay(a, b) {
    if (!comparePricesOverlayActive) {
        comparePricesOverlayActive = !0;
        0 < $("#grid-container-casin").length && $("#overlayShadowTop3").trigger("click");
        var d = getCasinLocalesFromStorage(), h = '<span id="casinLocales" style="opacity:' + (!0 === d[0] ? "0.3" : "1") + '">', m = LocaleType.getByRegionOrder(!0), t;
        for (t in m) {
            var f = m[t];
            2 < (f + "").length ? (0 < t && (h += "</span> "),
            h += "<span><span>" + f + "</span>") : h += '<input type="checkbox" data-domain="' + f + '" id="casinLocaleRadio' + f + '"' + (!0 === d[f] ? ' checked="checked"' : "") + ">" + getTldByDomain(f) + "&ensp;"
        }
        d = '<div id="overlayShadowTop3" class="hidden"></div>\n\t\t\t<div id="comparePricesOverlay" class="customCheckbox" style="display:none;width:90%;">\n\t\t\t\t<div class="text_long shadow" style="text-align:justify;color:#444;width:98%;position:relative;">\n\t\t\t\t\t<div id="comparePricesOverlay-close"><i class="fa fa-times-circle fa-2x"></i></div>\n\t\t\t\t\t<div><i class="fa fa-globe fa-lg fa-2x"></i>\n\t\t\t\t\t\t<div style="font-size:18px; margin:0 10px 20px;display:inline-block;color:#111;">' + la._317 + '</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="flex flexWrap">\n\t\t\t\t\t\t<div id="grid-container-casin" class="on-white"></div>\n\t\t\t\t\t\t<div style="flex-grow:2;margin-left:20px;min-width:400px;"><div class="graph" id="compareGraphHolder"></div></div>\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<hr style="border-color:#38F !important;">\n\t\t\t\t\t<div style="min-width:600px;">' + la._318 + '</div>\n\t\t\t\t\t<br><div class="casin-settings">Reduce load time by limiting the locales to retrieve:&emsp;\n\t\t\t<span><input type="checkbox" id="casinLimitedRadio"' + ((!0 === d[0] ? ' checked="checked"' : "") + ">Only same region</span>\n\t\t\t" + (h + '</span></span>\n\t\t</div>\n\t\t\t\t\t<br>\n\t\t\t\t\t<div style="text-align: center;"><input type="checkbox" id="previewCasinRadio"\'')) + (storage.previewCasin ? ' checked="checked"' : "") + '"> ' + la._511 + "</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t";
        $("#tabContentIFrame").append(d);
        $("#tabContent").append(d);
        $("#comparePricesInput").click(function() {
            $(this).select()
        });
        $("#previewCasinRadio").click(function() {
            $(this).is(":checked") ? storage.previewCasin = 1 : storage.removeItem("previewCasin");
            settings.send()
        });
        $("#casinLimitedRadio").click(function() {
            var r = getCasinLocalesFromStorage();
            $(this).is(":checked") ? (r[0] = !0,
            $("#casinLocales").css("opacity", "0.3")) : (r[0] = !1,
            $("#casinLocales").css("opacity", "1").effect("highlight"));
            storage.casinLocales = JSON.stringify(r);
            settings.send()
        });
        for (d = 1; d < numberOfDomains; d++)
            7 != d && $("#casinLocaleRadio" + d).click(function() {
                var r = $(this).data("domain")
                  , p = getCasinLocalesFromStorage();
                $(this).is(":checked") ? p[Number(r)] = !0 : p[Number(r)] = !1;
                storage.casinLocales = JSON.stringify(p);
                settings.send()
            });
        var n = $("#comparePricesOverlay");
        n.velocity("transition.shrinkIn", 150, function() {
            $("#overlayShadowTop3").show();
            var r = function() {
                comparePricesOverlayActive = !1;
                $("#overlayShadowTop3").hide();
                n.velocity("transition.shrinkOut", 150, function() {
                    n.remove()
                });
                addon();
                graph.remove(b, a, 3)
            };
            $("#overlayShadowTop3").click(r);
            $("#comparePricesOverlay-close").click(r);
            var p = function(z) {
                for (var F = [], I = 0; I < z.length; I++) {
                    var E = z[I];
                    if (null != E) {
                        E.converted || (E.converted = []);
                        for (var K in CsvType)
                            if ("object" == typeof CsvType[K] && CsvType[K].isEnabled) {
                                var H = CsvType[K].index;
                                null == E.csv || null == E.csv[H] || 0 == E.csv[H].length || 2 == E.csv[H].length && 0 > E.csv[H][1] && -2 != E.csv[H][1] || (F[H] = !0,
                                !E.converted[K] && CsvType[K].currency && exchangeCurrencyCSV(E.csv[H], CsvType[K], E.domainId, b),
                                E.converted[K] = !0)
                            }
                    }
                }
                I = null;
                E = "";
                for (var V in CsvType)
                    "object" == typeof CsvType[V] && F[CsvType[V].index] && (null == I && (I = CsvType[V]),
                    E += '<span rel="' + V + '">' + CsvType.getName(CsvType[V].index) + "</span> ");
                F = '<div class="flex flexWrap" id="casTypes">' + E + "</div>";
                var S = $("#compareGraphHolder");
                S.before(F);
                $("#casTypes").children().first().addClass("active");
                $("#casTypes").on("click", function(ra) {
                    if ("SPAN" == ra.target.nodeName) {
                        ra = $(ra.target);
                        var pa = CsvType[ra.attr("rel")];
                        ra.parent().children().removeClass("active");
                        ra.addClass("active");
                        ea(z, pa)
                    }
                });
                var aa = null
                  , ea = function(ra, pa) {
                    try {
                        var ua = null;
                        null != aa && (ua = aa.parameter);
                        graph.remove(b, a, 3);
                        aa = graph.prepare(b);
                        null != ua && (aa.parameter = ua,
                        aa.parameter.forceInterval = !0);
                        aa.asin = a;
                        aa.graphIndex = 3;
                        aa.updateCSV = [];
                        aa.series = graph.getLocaleSeriesTemplates(CsvType.getObjectName(pa.index));
                        ua = [];
                        for (var na = [], qa = 0; qa < ra.length; qa++) {
                            var ka = ra[qa];
                            if (null != ka) {
                                var za = getStatistics(ka);
                                "undefined" != typeof za[pa.index] && 2 != ka.productType && 3 != ka.productType && 4 != ka.productType && 5 != ka.productType && (na[ka.domainId] = za[pa.index],
                                ua[ka.domainId] = ka.csv[pa.index],
                                aa.updateCSV[ka.domainId] = ka.csv[CsvType.EXTRA_INFO_UPDATES.index],
                                aa.series[LocaleType.getName(ka.domainId)].isDisabled = !1,
                                graphIsRestricted(ka.domainId, pa.index) && (aa.series[LocaleType.getName(ka.domainId)].series.label += '&ensp;<i class="fa fa-lock"></i>&ensp;'))
                            }
                        }
                        aa.stats = na;
                        aa.csv = ua;
                        aa.csvType = pa.index;
                        aa.type = "locales";
                        aa.objectType = LocaleType;
                        aa.$container = S;
                        aa.$container.show();
                        aa.preResizeHook = function() {
                            $("#casTypes").hide()
                        }
                        ;
                        aa.resizeHook = function() {
                            $("#casTypes").css("width", aa.parameter.width);
                            $("#casTypes").show()
                        }
                        ;
                        aa.parameter.offsetLeft = -30;
                        aa.preResizeHook();
                        aa.parameter.width = float2int(S.parent().width()) - 170 + "px";
                        aa.resizeHook();
                        aa.parameter.height = "250px";
                        graph.create(aa)
                    } catch (J) {
                        console.log(J)
                    }
                };
                ea(z, I)
            };
            callCasin(function(z) {
                for (var F, I = 0; I < z.length; I++)
                    F = z[I],
                    null != F && (2 == F.productType || 3 == F.productType || 4 == F.productType || 5 == F.productType ? z[I] = null : (F.AMAZON = F.csv[CsvType.AMAZON.index],
                    F.MARKET_NEW = F.csv[CsvType.NEW.index],
                    F.MARKET_USED = F.csv[CsvType.USED.index],
                    F.SALESRANK = F.csv[CsvType.SALES.index],
                    F.BUY_BOX_LAST = getLast(F.csv[CsvType.BUY_BOX_SHIPPING.index], CsvType.BUY_BOX_SHIPPING),
                    F.AMAZON_LAST = F.AMAZON[F.AMAZON.length - 1],
                    F.MARKET_NEW_LAST = F.MARKET_NEW[F.MARKET_NEW.length - 1],
                    F.MARKET_USED_LAST = F.MARKET_USED[F.MARKET_USED.length - 1]));
                calcComparePrices(z, b);
                setTimeout(function() {
                    p(z);
                    GridCasin.init(z, b, "grid-container-casin").always(function() {
                        addon("resize", float2int($(document).height()))
                    })
                }, 0)
            }, a, b, !1)
        })
    }
}
function callCasin(a, b, d, h) {
    var m = $("#loadingIconCasin");
    h && m.show();
    var t = getCasinLocalesFromStorage()
      , f = {};
    d = continents[domainIdToContinent[d]];
    for (var n = 1; n < numberOfDomains; n++)
        if (7 != n) {
            if (!0 === t[0]) {
                for (var r = !1, p = 0; p < d.length && !r; p++)
                    d[p] == n && (r = !0);
                if (!r)
                    continue
            } else if (t && !t[n])
                continue;
            f[n] = [b]
        }
    0 === Object.keys(f).length ? h && m.hide() : networkHelper.loadASINs({
        path: "product",
        offerPages: 0,
        history: !0,
        maxAge: 60,
        type: "casin",
        refreshProduct: !1
    }, f, "").done(function(z) {
        h && m.hide();
        a && a(z);
        "object" === typeof TrackingComponent && "function" === typeof TrackingComponent.setCasinData && TrackingComponent.setCasinData(z)
    })
}
function calcComparePrices(a, b, d) {
    a.lowestAmazon = 99999999999;
    a.lowestNew = 99999999999;
    a.lowestUsed = 99999999999;
    a.lowestBB = 99999999999;
    for (var h = 0; h < a.length; ++h) {
        var m = a[h];
        if (null != m) {
            m.values = [m.AMAZON_LAST, m.MARKET_NEW_LAST, m.MARKET_USED_LAST, m.BUY_BOX_LAST];
            for (var t = 0; 4 > t; t++)
                0 > m.values[t] || (m.values[t] = Money.raw(m.values[t], {
                    sourceDomainId: m.domainId,
                    targetDomainId: 0 < d ? d : 0 < currencyDomainId ? currencyDomainId : b,
                    keepUnit: !0
                }));
            m = a[h];
            -1 != m.values[0] && m.values[0] < a.lowestAmazon && (a.lowestAmazon = m.values[0],
            a.lowestAmazonDomain = m.domainId);
            -1 != m.values[1] && m.values[1] < a.lowestNew && (a.lowestNew = m.values[1],
            a.lowestNewDomain = m.domainId);
            -1 != m.values[2] && m.values[2] < a.lowestUsed && (a.lowestUsed = m.values[2],
            a.lowestUsedDomain = m.domainId);
            -1 != m.values[3] && m.values[3] < a.lowestBB && (a.lowestBB = m.values[3],
            a.lowestBBDomain = m.domainId)
        }
    }
}
;var priceDataAPI = function() {
    var a, b, d, h, m, t, f, n, r, p, z, F, I, E, K, H = !1, V = 0, S = "", aa = 0, ea = {}, ra = {
        AL: "Alabama",
        AK: "Alaska",
        AS: "American Samoa",
        AZ: "Arizona",
        AR: "Arkansas",
        CA: "California",
        CO: "Colorado",
        CT: "Connecticut",
        DE: "Delaware",
        DC: "District Of Columbia",
        FM: "Federated States Of Micronesia",
        FL: "Florida",
        GA: "Georgia",
        GU: "Guam",
        HI: "Hawaii",
        ID: "Idaho",
        IL: "Illinois",
        IN: "Indiana",
        IA: "Iowa",
        KS: "Kansas",
        KY: "Kentucky",
        LA: "Louisiana",
        ME: "Maine",
        MH: "Marshall Islands",
        MD: "Maryland",
        MA: "Massachusetts",
        MI: "Michigan",
        MN: "Minnesota",
        MS: "Mississippi",
        MO: "Missouri",
        MT: "Montana",
        NE: "Nebraska",
        NV: "Nevada",
        NH: "New Hampshire",
        NJ: "New Jersey",
        NM: "New Mexico",
        NY: "New York",
        NC: "North Carolina",
        ND: "North Dakota",
        MP: "Northern Mariana Islands",
        OH: "Ohio",
        OK: "Oklahoma",
        OR: "Oregon",
        PW: "Palau",
        PA: "Pennsylvania",
        PR: "Puerto Rico",
        RI: "Rhode Island",
        SC: "South Carolina",
        SD: "South Dakota",
        TN: "Tennessee",
        TX: "Texas",
        UT: "Utah",
        VT: "Vermont",
        VI: "Virgin Islands",
        VA: "Virginia",
        WA: "Washington",
        WV: "West Virginia",
        WI: "Wisconsin",
        WY: "Wyoming"
    }, pa = [], ua = function(Z) {
        var ja = $.Deferred();
        0 == Object.keys(pa).length ? $.getScript("https://js.stripe.com/v3/").done(function() {
            L = Stripe(Z);
            pa[Z] = L;
            ja.resolve(L)
        }).fail(function() {
            ja.reject()
        }) : (null == pa[Z] && (pa[Z] = Stripe(Z)),
        L = pa[Z],
        ja.resolve(L));
        return ja
    }, na = function() {
        var Z = null
          , ja = null
          , W = function() {
            $("#formContent").hide();
            $("#popupTitle").hide();
            $("#loadingIconPopup").show()
        }
          , Aa = function() {
            $("#formContent").show();
            $("#popupTitle").show();
            $("#loadingIconPopup").hide()
        }
          , Ca = !1
          , Ba = "service/stripe"
          , ta = "api"
          , Ea = function(va) {
            setTimeout(function() {
                null != va.billingContact && $("#frmNameS").val(va.billingContact);
                null != va.billingZipCode && $("#frmZipS").val(va.billingZipCode)
            }, 1);
            return '<div id="cardForm" class="stripeForm"><form><div class="group">    <label>      <span>Cardholder Name</span>      <input class="field" name="cardholder-name" id="frmNameS" placeholder="Cardholder full name and/or Company" required autocomplete="billing name" />    </label>  </div>  <div class="group">    <label>      <span>Card</span>      <div id="card-element" class="field"></div>    </label><div id="card-errors" role="alert"></div>  </div>  <button class="button" type="submit">Submit</button>  <div class="outcome">    <div class="error" role="alert"></div>    <div class="success">      Success!    </div>  </div></form></div>'
        };
        return {
            getAuthenticatedSource: function(va, da, Y, ma, ca, ha) {
                function C(X) {
                    Aa();
                    var sa = document.querySelector("#cardForm .success")
                      , wa = document.querySelector("#cardForm .error");
                    sa.classList.remove("visible");
                    wa.classList.remove("visible");
                    X.token ? (sa.querySelector("#cardForm .token").textContent = X.token.id,
                    sa.classList.add("visible")) : X.error && (X = X.error.message,
                    "Your postal code is incomplete." === X && (X = "Your postal code next to your credit card details is incomplete. If you do not see the field, re-enter your credit card information manually."),
                    wa.textContent = X,
                    wa.classList.add("visible"));
                    $("#checkoutForm").show()
                }
                Ca = "pk_live_d8cHyZoVVZdRXDvnxSmuoQTM" != va;
                Ba = "service/stripe";
                ta = Ca ? "data" : "api";
                ja = $.Deferred();
                var U = ca
                  , ia = function() {
                    L.createSource(U, {
                        usage: "reusable",
                        owner: {
                            name: ma ? ma.billingContact : ha,
                            email: storage.email,
                            address: {
                                city: ma ? ma.billingCity : "",
                                country: ma ? ma.billingCountry : "",
                                line1: ma ? ma.billingStreet : "",
                                postal_code: ma ? ma.billingZipCode : "",
                                state: ma ? ma.billingState : ""
                            }
                        }
                    }).then(function(X) {
                        console.info("payment 0...", X.error);
                        if (X.error)
                            C(X);
                        else {
                            var sa = X.source;
                            network.request({
                                path: Ba,
                                dashboard: ta,
                                type: "createSource",
                                token: sa.id,
                                billingContact: ha,
                                version: 3
                            }).done(function(wa) {
                                console.info("payment 6...");
                                if (400 == wa.code) {
                                    Aa();
                                    wa = wa.errorMsg;
                                    var xa = '<p class="mdc-typography--body2">Please verify your card information and try again.</p>';
                                    "Your card was declined. Reason: do not honor." === wa && (xa = '<p class="mdc-typography--body2">\n\t\t\t\t\t\t\t\t\t\t\t\t\tAccording to our payment provider Stripe your card has been declined with the "do not honor" reason by your bank.<br>\n\t\t\t\t\t\t\t\t\t\t\t\t\tSince our company is based in Germany your bank might be blocking the payment as it is an international one.<br> \n\t\t\t\t\t\t\t\t\t\t\t\t\tPlease contact your card issuer for more information and ask them to allow the payment to proceed with the next attempt.\n\t\t\t\t\t\t\t\t\t\t\t\t</p>');
                                    showPopPopup("Payment Error", '<section class="block--mdc-typography">\n\t\t\t\t\t\t\t\t\t\t\t\t<p class="mdc-typography--body2">Payment issue: ' + wa + "</p>\n\t\t\t\t\t\t\t\t\t\t\t\t" + xa + '\n\t\t\t\t\t\t\t\t\t\t\t\t<p class="mdc-typography--body2"> \n\t\t\t\t\t\t\t\t\t\t\t\t\tYou can also contact <a class="href" href="mailto:info@keepa.com">info@keepa.com</a> for help \n\t\t\t\t\t\t\t\t\t\t\t\t\tor check out our <a class="href" href="https://discuss.keepa.com/t/faq-payments-premium-access/7819">FAQ - Payments premium access</a>.\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</section>', !0);
                                    $("#checkoutForm").show()
                                } else
                                    ja.resolve(sa)
                            }).fail(function(wa) {
                                console.info("payment 6e...");
                                ja.reject(la._error)
                            })
                        }
                    })
                };
                null != U ? ia() : (Z = showPopup("Enter Credit Card Information", '<div id="loadingIconPopup"></div><div style="width:600px" ><div id="formContent"></div></div>', !0),
                Z.promise.fail(function() {
                    ja.reject("Process aborted. Please try again.")
                }),
                ja.always(Z.close),
                $("#popupTitle").parent().css({
                    background: "#ececed"
                }),
                W(),
                ua(va).done(function() {
                    Aa();
                    $("#formContent").html(Ea(ma));
                    U = L.elements().create("card", {
                        style: {
                            base: {
                                iconColor: "#666EE8",
                                color: "#000",
                                lineHeight: "40px",
                                fontWeight: 300,
                                fontFamily: '"Helvetica Neue", Helvetica, sans-serif',
                                fontSize: "15px",
                                "::placeholder": {
                                    color: "#acb4bd"
                                }
                            }
                        },
                        hidePostalCode: !0
                    });
                    U.mount("#card-element");
                    U.on("change", function(X) {
                        C(X)
                    });
                    $("#cardForm form").on("submit", function(X) {
                        X.preventDefault();
                        ha = $("#formContent").find("#frmNameS").val();
                        $("#formContent").find("#frmZipS").val();
                        W();
                        ia();
                        return !1
                    })
                }));
                return ja
            },
            loadStripe: ua
        }
    }(), qa = function() {
        var Z = "", ja = 0, W;
        for (W in a.PayedService) {
            var Aa = a.PayedService[W];
            if ("API" == Aa.type)
                0 == ja && (a.PayedServiceTypes.API.pricePerRequest = a.PayedServiceVariants[Aa.variant].price / a.PayedServiceVariants[Aa.variant].variant),
                ja++,
                Z += B(W, a.PayedServiceVariants[Aa.variant], a.PayedServiceTypes.API);
            else if ("KEYWORDS" == Aa.type || "NEW_ASIN_FEED" == Aa.type)
                ja++,
                Z += Q(W, a.PayedServiceVariants[Aa.variant], a.PayedServiceTypes[Aa.type])
        }
        if (W = !!b && 0 < b.length || !!d && 0 < d.length) {
            storage.hasAPI || (storage.hasAPI = 1,
            settings.send());
            var Ca = "ends";
            for (Aa = 0; Aa < d.length; Aa++) {
                var Ba = d[Aa];
                if (0 == Ba.paymentCancelledDate && !Ba.cancel_at_period_end) {
                    Ca = "will be renewed";
                    break
                }
            }
            Ca = null == m || 0 == m[1] ? "" : " and " + Ca + " on " + (new Date(m[1])).formatDate("M j, Y %a%t G:i");
            Aa = Date.now();
            Ba = !1;
            if (null != b)
                for (var ta = 0; ta < b.length; ta++) {
                    var Ea = b[ta];
                    if (!(-1 === Ea.payedService.indexOf("API") || 0 === Ea.paymentReceivedDate || 0 < Ea.paymentCancelledDate || Ea.subscriptionStart > Aa)) {
                        if (Ea.subscriptionStart + Ea.subscriptionDuration < Aa) {
                            if (Ea.cancel_at_period_end)
                                continue;
                            if (Ea.subscriptionStart + Ea.subscriptionDuration + 3456E5 < Aa)
                                continue
                        }
                        Ba = !0
                    }
                }
            Aa = null != h && h.hasActiveSubscription && !Ba;
            Ca = '<div>\n\t\t\t\t\tYour active subscription level generates <span class="black">' + (null == m ? 0 : m[0]) + "</span>\n\t\t\t\t\t" + a.PayedServiceTypes.API.variantDescription + Ca + (Aa ? ' (<a href="#!settings/1">Data subscription</a>)' : "") + ".<br>\n\t\t\t\t\tYou can increase your token rate by " + (Aa ? '<a class="trigger-tab" data-tab="3">adding an API subscription</a>' : "upgrading your subscription") + ".\n\t\t\t\t</div>\n\t\t\t";
            if (64 == t.length) {
                Ca += '<br><div>Private API access key:&emsp;<div style="display:inline-block;" class="darkgrey">' + t + '</div><i id="tokenDelete" title="invalidate the current key and generate new one" class="fa fa-refresh tomato "></i></div>';
                Ca += '<div>Currently available tokens:&emsp;<span class="darkgrey">' + f + "</span>";
                Ca += '&emsp;&emsp;&emsp;Current token flow reduction:&emsp;<span class="darkgrey">' + Math.round(n) + "&ensp;(" + n.toFixed(4) + ")</span></div>";
                Ca += '<br><div style="display: flex;align-items: center;">Notification webhook endpoint:&emsp;<input maxlength="2000" style="width: 300px;display: inline-block;margin-top: -1px;" id="webhookInput" class="inputDefault" ' + (userData.apiWebhook ? 'value="' + userData.apiWebhook + '"' : "") + ' placeholder="http://..."><span id="saveWebHook" class="href" style="margin-left:16px" title="Save"><i class="fa fa-floppy-o" style="font-size: 15px;"></i></span><span id="testWebHook" class="href" style="margin-left:12px" title="Send test notification"><i class="fa fa-exchange fa-lg" style="font-size: 15px;"></i></span></div>';
                if (null != d && 0 < d.length) {
                    Aa = '<br><br><div>Active subscriptions:</div>\n\t\t\t\t\t\t<div id="activeSubscriptions" style="width:600px;" class="borderTopGreen">';
                    for (Ba = 0; Ba < d.length; Ba++)
                        if (ta = d[Ba],
                        Ea = a.PayedService[ta.payedService],
                        null == Ea && "API_Access_1" == ta.payedService && (Ea = {
                            API_Access_1: {
                                type: "API",
                                variant: "API_1"
                            }
                        }),
                        0 == ta.paymentCancelledDate && null != Ea) {
                            H = !0;
                            Ea = "";
                            if (ta.cancel_at_period_end)
                                Ea = "<span>This subscription is cancelled and will not incur any new charges.</span>";
                            else if (null != r && 0 < r.length)
                                for (var va = 0; va < r.length; va++) {
                                    var da = r[va];
                                    if (da.subscription.id == ta.subscriptionId) {
                                        Ea = Money.format(da.amountDue, {
                                            sourceDomainId: 3,
                                            targetDomainId: 3,
                                            forceEuropeanStyle: !0
                                        });
                                        va = "";
                                        showReferencePrice(3) && (va = ' <span class="price__reference">(~ ' + Money.format(da.amountDue, {
                                            sourceDomainId: 3
                                        }) + ")</span>");
                                        Ea = '<div>\n\t\t\t\t\t\t\t\t\t\t\t<span style="color:black">Upcoming invoice:&ensp;</span>\n\t\t\t\t\t\t\t\t\t\t\t<span>' + Ea + va + " on " + (new Date(1E3 * Number(da.nextPaymentAttempt))).formatDate("M j, Y %a%t G:i") + ".</span>\n\t\t\t\t\t\t\t\t\t\t</div>";
                                        break
                                    }
                                }
                            da = Money.format(ta.net, {
                                sourceDomainId: 3,
                                targetDomainId: 3,
                                forceEuropeanStyle: !0,
                                noDigits: !0
                            });
                            va = 0 == ta.includedTax ? "" : Money.format(ta.includedTax, {
                                sourceDomainId: 3,
                                targetDomainId: 3,
                                forceEuropeanStyle: !0
                            });
                            va = 0 == ta.includedTax ? "" : " (+ " + va + " VAT)";
                            var Y = "";
                            showReferencePrice(3) && (Y = 0 == ta.includedTax ? "" : " (+ ~" + Money.format(ta.includedTax, {
                                sourceDomainId: 3
                            }) + " VAT)",
                            Y = '<br><span class="price__reference">(~ ' + Money.format(ta.net, {
                                sourceDomainId: 3
                            }) + " / month" + Y + ")</span>");
                            Aa += '<div style="align-items:center;justify-content:space-between;" class="subscriptionBox borderLeft flex">\n\t\t\t\t\t\t\t\t<div style="padding-right:10px;">\n\t\t\t\t\t\t\t\t\t<span style="color:black;font-size:14px;">' + ta.productName + "</span>\n\t\t\t\t\t\t\t\t\t<br>" + da + " / month" + va + "&ensp;-&ensp;subscribed since: " + (new Date(ta.createDate)).formatDate("M j, Y") + Y + "\n\t\t\t\t\t\t\t\t\t<br>" + Ea + '\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div id="' + ta.subscriptionId + '">\n\t\t\t\t\t\t\t';
                            Ea = !1;
                            if (null != p)
                                for (da = 0; da < p.length; da++)
                                    if (p[da].subscription.id == ta.subscriptionId) {
                                        Ea = !0;
                                        break
                                    }
                            0 < ta.paymentReceivedDate & !Ea ? (Ea = (new Date(ta.subscriptionStart + ta.subscriptionDuration)).formatDate("M j"),
                            da = '<i class="editSubscription fa fa-pencil fa-lg darkgrey" title="edit subscription"></i>&emsp;',
                            "undefined" == typeof a.PayedService[ta.payedService] && (da = ""),
                            Aa += ta.cancel_at_period_end ? '<i data-end="' + Ea + '" class="canceledSubscription fa fa-calendar-times-o red" title="subscription is cancelled and will terminate on ' + Ea + '"></i>' : da + '<i data-end="' + Ea + '" class="cancelSubscription fa fa-trash fa-lg red " title="cancel subscription"></i>',
                            ta.cancel_at_period_end && (Aa += '&emsp;<i class="fa fa-fw fa-repeat href resumeSub"  title="resume subscription" rel="' + ta.subscriptionId + '"></i>')) : Aa = 18E4 < Date.now() - ta.createDate ? Aa + '<div id="retryPayment" style="cursor:pointer;font-weight:bold;"><span style="color:tomato;">Payment failed.<br><span>Try again now <i class="fa fa-repeat" style="margin-left:7px;"></i></span></span></div>' : Aa + '<span class="black">Payment Pending</span>';
                            Aa += "</div></div>"
                        }
                    Ba = null != h && !h.hasOnlyAPISubscription;
                    ta = "";
                    null != h && h.hasActiveSubscription && h.hasAPISubscription && (ta = '<p class="mdc-typography--body2" style=""><br><span style="color:#3cb371;font-weight:bold;">\n\t\t\t\t\t\t\tYou have automatically been granted access to our <a class=\'href\' href=\'#!data\'>Data</a> features via your currently active API subscription.</span>\n\t\t\t\t\t\t\t' + (Ba ? '<span style="font-size: smaller;"> Unless you are making use of the extra 5 tokens/min and daily quota you can cancel your separate Data Access subscription.</span>' : "") + '\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p class="mdc-typography--body2" style="font-weight: bold;"><br>\n\t\t\t\t\t\t\t<a href="#!settings/1" class="href"><i class="fa fa-long-arrow-right"></i> View your Data Access subscription&ensp;<i class="fa fa-external-link"></i></a>\n\t\t\t\t\t\t</p>');
                    H && (Ca += Aa + ta + "</div>")
                }
                Ca = Ca + "<br>" + createCreditCard(F || z)
            }
            Aa = I && 0 > I ? '<div><span style="color:#000">Your current account balance:&emsp;<i class="fa fa-fw fa-money"></i> \n' + Money.format(-1 * I, {
                sourceDomainId: 3,
                targetDomainId: 3,
                noDigits: !1,
                forceEuropeanStyle: !0
            }) + "</span>&ensp;(will be applied to future invoices)</div>" : "";
            Ca += Aa;
            Aa = '<br><hr style="border-color:mediumSeaGreen !important"><div>Receipts:</div><br><table class="paymentTable"><tr><th>Date</th><th>Total</th><th>Price Plan</th><th>Start Date</th><th>End Date</th><th>Payment Method</th><th>Type</th><th>Invoice</th><th>Status</th></tr>';
            if (null != b)
                for (Ba = b.length - 1; 0 <= Ba; Ba--) {
                    ta = b[Ba];
                    Ea = 0 == ta.subscriptionStart ? "-" : (new Date(ta.subscriptionStart)).formatDate("M j");
                    da = 0 == ta.subscriptionStart ? "-" : (new Date(ta.subscriptionStart + ta.subscriptionDuration)).formatDate("M j");
                    va = Money.format(ta.totalBill, {
                        sourceDomainId: 3,
                        targetDomainId: 3,
                        forceEuropeanStyle: !0
                    });
                    Y = "";
                    showReferencePrice(3) && (Y = ' <span class="price__reference">(~ ' + Money.format(ta.totalBill, {
                        sourceDomainId: 3
                    }) + ")</span>");
                    var ma = ta.totalBill - ta.creditApplied;
                    Aa += "<tr>\n\t\t\t\t\t\t\t<td>" + (new Date(ta.createDate)).formatDate("M j, Y") + "</td> \n\t\t\t\t\t\t\t<td>" + va + Y + "</td> \n\t\t\t\t\t\t\t<td>" + ((1 < ta.quantity ? ta.quantity + "x " : "") + ta.payedService) + "</td>\n\t\t\t\t\t\t\t<td>" + Ea + "</td>\n\t\t\t\t\t\t\t<td>" + da + "</td>\n\t\t\t\t\t\t\t<td>" + (0 > ma ? "Credit" : 0 == ta.totalBill ? "-" : ta.paymentProvider) + "</td>\n\t\t\t\t\t\t\t<td>" + (ta.isUpgrade ? "Upgrade" : "Regular") + "</td>\n\t\t\t\t\t\t\t<td>" + (0 > ma || 0 == ma && 0 == ta.creditApplied ? " - " : '<a download class="darkgrey" href="' + ajaxURL + "api/service/?user=" + storage.token + "&type=getInvoicePDF&billId=" + ta.billId + '"><i class="fa fa-file-pdf-o"></i> Download</a>') + "</td>\n\t\t\t\t\t\t\t<td>" + (0 > ma ? '<span style="color: #999;font-style: italic;">-</span>' : 0 == ta.totalBill ? '<span style="color: #999;font-style: italic;">free</span>' : 0 == ma ? '<span style="color: #999;font-style: italic;">paid with credit</span>' : 0 < ta.paymentReceivedDate && 0 < ta.paymentCancelledDate ? '<span style="color:#2196F3">Refunded (' + (new Date(ta.paymentCancelledDate)).formatDate("M j") + ")</span>" : 0 != ta.paymentReceivedDate ? '<span class="green">Payment Received</span>' : 0 != ta.paymentCancelledDate ? '<span class="red">Cancelled (' + (new Date(ta.paymentCancelledDate)).formatDate("M j") + ")</span>" : 'Pending - <a class="black cancelOrder" rel="' + ta.billId + '">Cancel order</a>') + "</td>\n\t\t\t\t\t\t</tr>"
                }
            Ca += Aa + "</table>"
        }
        R = 1;
        if (!isTest) {
            var ca = function(C, U) {
                U = U.replace("/", "_");
                if (C) {
                    for (var ia = C.topic_list.topics.length, X = {}, sa = 0; sa < ia; sa++)
                        X[C.topic_list.topics[sa].title] = C.topic_list.topics[sa];
                    C = "";
                    ia = Object.keys(X).sort();
                    for (sa = 0; sa < ia.length; sa++) {
                        var wa = X[ia[sa]];
                        52 != wa.id && 111 != wa.id && 112 != wa.id && (C += '<div><a href="' + (discourseBaseUrl + "/t/" + wa.slug + "/" + wa.id) + '"><span>' + wa.title + "</span></a></div>")
                    }
                    replaceHtml(U, C)
                }
            };
            discourseApi.category("api/none", function(C) {
                ca(C, "api/none")
            });
            discourseApi.category("api/apirequests", function(C) {
                ca(C, "api/apirequests")
            });
            discourseApi.category("api/apiobjects", function(C) {
                ca(C, "api/apiobjects")
            })
        }
        W = material.getTabs({
            tabs: [W ? {
                tab: {
                    icon: "address-card",
                    label: "Your Access"
                },
                panel: {
                    id: "paymentStatus",
                    content: Ca
                },
                isActive: W
            } : null, {
                tab: {
                    icon: "star-o",
                    label: "API Features"
                },
                panel: {
                    id: "apiFeatures",
                    content: '<div>Get access to our price history data of Amazon products with our API (application programming interface). It offers:</div><br><ul style="list-style: none;line-height:19px;text-indent:-1.8em;padding-left: 1.8em;"><li>&#x271C;&emsp;Over <a href="#!features">1700 million tracked products</a></li><li>&#x271C;&emsp;Live pricing and availability</li><li>&#x271C;&emsp;Price history data for almost all offer types: Amazon, Marketplace New and Used, Warehouse Deals, FBA, FBM, Collectibles and Refurbished, eBay - and many more.</li><li>&#x271C;&emsp;Sales Rank, Offers count, Rating and Review count history. </li><li>&#x271C;&emsp;Complete access to all marketplace offers</li><li>&#x271C;&emsp;Customizable price history graph images</li><li>&#x271C;&emsp;Extensive Buy Box information including price and seller history</li><li>&#x271C;&emsp;Category details, searches and browsing</li><li>&#x271C;&emsp;Product Finder: Search our entire database for products matching any criteria</li><li>&#x271C;&emsp;Best sellers lists containing up to 500k ASINs.</li><li>&#x271C;&emsp;Third party sellers metrics, including rating and rating count history, top seller lists, and storefront access with up to 100k ASINs.</li><li>&#x271C;&emsp;Find millions of deals that match your criteria with complete access to our Deals with search, filter and sorting capability. </li><li>&#x271C;&emsp;Easy use: Request data in JSON format via RESTful API, TLS encrypted.</li><li>&#x271C;&emsp;Ready to use <a target="_blank" href="https://packagist.org/packages/keepa/php_api">PHP</a>  and <a target="_blank" href="https://github.com/keepacom/api_backend">Java framework</a> for fast integration</li><li>&#x271C;&emsp;English and German support via <a href="#!discuss/c/api/apisupport">forum</a> and <a target="_blank" href="mailto:info@keepa.com?subject=Keepa API">email</a></li></ul><div style="margin-top:25px;text-align: center;"><a target="_blank" href="mailto:info@keepa.com?subject=Questions about Keepa API" title="info@keepa.com">Have Questions? Contact us.</a>&emsp;<a rel="terms">Terms and Conditions</a></div>'
                },
                isActive: !W
            }, {
                tab: {
                    icon: "book",
                    label: "Documentation"
                },
                panel: {
                    id: "documentations",
                    content: '<div><div id="discussAPI"><div class="black">General Information</div><div id="api_none"></div><br><div class="black">Available Requests</div><div id="api_apirequests"></div><br><div class="black">Response JSON Objects</div><div id="api_apiobjects"></div></div></div>'
                }
            }, {
                tab: {
                    icon: "shopping-cart",
                    label: "Pricing Plans"
                },
                panel: {
                    id: "pricingPlans",
                    content: '<span>All plans are prepaid for 1 month with a subscription model. A subscription can be cancelled at any time. Multiple plans can be active on the same account and an upgrade is possible at any time, a downgrade once per month. The plans differentiate by the number of tokens generated per minute. For example: With a single token you can retrieve the complete data set for one product. Unused tokens expire after one hour. You can find more information on how our plans work <a href="https://keepa.com/#!discuss/t/how-our-api-plans-work/">in our documentation</a>.</span><br>' + (null != m && 5 < m[0] ? '<br><div style="color: #fff;background: #ec553a;padding: 10px;border-radius: 10px;font-size: 15px;">The new subscription <strong>will be added to your existing subscription level.</strong> If you want to upgrade an existing subscription instead you can do so at "Your Access" via the pencil icon next to an existing subscription.</div>' : "") + '<br><div id="apiOffers"></div><div style="margin-top:25px;text-align: center;"><a target="_blank" href="mailto:info@keepa.com?subject=Questions about Keepa API" title="info@keepa.com">Have Questions? Contact us.</a>&emsp;<a rel="terms">Terms and Conditions</a></div><div style="font-size:smaller;text-align: center;margin-top: 15px;">Our API is only available to users that have registered a Keepa account.<br></div>'
                }
            }],
            panelsClass: "appsContent"
        }) + '<div id="pricingPlansUpdate" class="appsContent"></div>';
        insertPage('<span class="paper" style="min-width: 900px;"><div id="GCBTab1">' + W + '</div><div  class="appsContent" style="padding: 20px;display: none"><div id="backButton">&larr; Back</div><div id="GCBTab2"></div><div id="GCBTab3"></div><div id="GCBTab4"></div></div></span><div class="unselectable" style="line-height:50px;">&nbsp;</div>');
        var ha = tabSwitcher();
        /[0-9]/.test(lastSubUrl) && (0 < lastSubUrl && 3 >= lastSubUrl ? (W = 0 == storage.accountType || "undefined" === typeof storage.hasAPI ? lastSubUrl - 1 : lastSubUrl,
        ha.activeTabIndex = W,
        ha.updatePanel(W)) : document.location.hash = "#!api");
        $(".trigger-tab").on("click", function() {
            var C = Number($(this).data("tab"));
            ha.activeTabIndex = C;
            ha.updatePanel(C)
        });
        fa();
        $("#apiOffers").html(Z);
        $(".editSubscription, .editCard, #saveWebHook, #testWebHook, .resumeSub").colorTip({
            color: "darkgrey"
        });
        $("#tokenDelete, .cancelSubscription, .canceledSubscription").colorTip({
            color: "red"
        });
        $(".editSubscription").on("click", function() {
            var C = $(this).parent().attr("id");
            if (null == C)
                reportBug(null, "not found subscriptionId");
            else {
                for (var U = null, ia = 0; ia < d.length; ia++) {
                    var X = d[ia];
                    if (X.subscriptionId == C) {
                        U = X;
                        break
                    }
                }
                if (null == U)
                    reportBug(null, "not found subscription");
                else {
                    ia = !1;
                    "API" == a.PayedService[U.payedService].type && (ia = !0);
                    var sa = showPopup("Edit subscription", "You can update your invoice address for this subscription " + (ia ? "or change the subscribed plan. An updated plan will be effective immediately and the subscription fee will be prorated." : "") + '<br><br><span class="button" id="editBilling"><i class="fa fa-book" ></i>&ensp;Update invoice address&ensp;</span>&emsp;' + (ia ? '<span class="button" id="editSub"><i class="fa fa-plus-circle" ></i>&ensp;Upgrade / Downgrade subscription&ensp;</span>' : ""), !0);
                    $("#editBilling").on("click", function() {
                        var wa = function() {
                            $("#priceApiForm").show();
                            $("#sendUpdatedBilling").show();
                            $("#loadingIconPopup").hide()
                        };
                        replaceHtml("popupMessage", M(U) + '<span class="button" id="sendUpdatedBilling">&ensp;Save&ensp;</span>');
                        $("#sendUpdatedBilling").on("click", function() {
                            var xa = {};
                            if (P(xa)) {
                                $("#priceApiForm").hide();
                                $("#sendUpdatedBilling").hide();
                                $("#loadingIconPopup").show();
                                var Ia = {
                                    billingContact: xa["billing-name"],
                                    billingStreet: xa["billing-address"],
                                    billingCity: xa["billing-city"],
                                    billingZipCode: xa["billing-zip"],
                                    billingState: xa["billing-state"],
                                    billingCountry: xa["billing-country"],
                                    billingVatId: xa["billing-vatId"].replace(/[-,;_:#. ]/g, ""),
                                    billingBusiness: xa["billing-business"]
                                };
                                xa = $("#priceApiForm").find("#frmCountryS").find(":selected");
                                var Fa = $("#vatIdErrors");
                                xa = {
                                    paymentIntentRequest: Ia,
                                    countryCode: $(xa).data("code"),
                                    isEu: "1" === $(xa).attr("rel")
                                };
                                isTest && console.info("%csend validateData:", "color:orange", xa);
                                priceDataAPI.validateVatIdPromise(xa).done(function(Ga) {
                                    isTest && console.info("%cvalidationPromiseResult:", "color:orange", Ga);
                                    null == Ga || !0 !== Ga.success ? (wa(),
                                    priceDataAPI.handleValidateVatIdError(Ga, $("#vatIdErrors"))) : !0 === Ga.valid && 0 === Ga.invalidFields.length ? (Fa.html(""),
                                    Fa.hide(),
                                    isTest && (!0 === Ga.validationNeeded ? console.info("%cVatId:", "color:green", "everything is valid - proceed ...") : console.info("%cVatId:", "color:green", "no validation needed - proceed ...")),
                                    network.request({
                                        path: "service/stripe",
                                        type: "editAddressSubscription",
                                        content: JSON.stringify(Ia),
                                        subscriptionId: C,
                                        dashboard: "api",
                                        version: 3
                                    }).done(function(Da) {
                                        sa.close();
                                        J()
                                    }).fail(function() {
                                        sa.close();
                                        setTimeout(function() {
                                            showErrorPopup()
                                        }, 500)
                                    })) : (wa(),
                                    Fa.html(Ga.msg),
                                    Fa.show())
                                }).fail(function(Ga) {
                                    priceDataAPI.handleValidateVatIdError(Ga, Fa);
                                    wa()
                                })
                            }
                        })
                    });
                    $("#editSub").on("click", function() {
                        if (storage.email && -1 != storage.email.indexOf("@") && settings.isEmailVerified) {
                            var wa = "";
                            $(".panels.appsContent").hide();
                            $(".dynamic-toolbar").hide();
                            setTimeout(function() {
                                $("#pricingPlansUpdate").attr("style", "").fadeIn(250).attr("rel", "active")
                            }, 100);
                            sa.close();
                            var xa = 24192E5 > Date.now() - K, Ia = !1, Fa = Number(a.PayedServiceVariants[a.PayedService[U.payedService].variant].variant), Ga;
                            for (Ga in a.PayedService) {
                                var Da = a.PayedService[Ga];
                                if ("API" == Da.type) {
                                    var Ma = Number(a.PayedServiceVariants[Da.variant].variant);
                                    0 != ja || a.PayedServiceTypes.API.pricePerRequest || (a.PayedServiceTypes.API.pricePerRequest = a.PayedServiceVariants[Da.variant].price / Ma);
                                    ja++;
                                    if (Ma == Fa && Ia)
                                        wa += '<br><div style="text-align: center;width: 775px;">\u2191&emsp;Downgrade&emsp;\u2191<br>\u2193&emsp;Upgrade&emsp;\u2193</div><br>';
                                    else {
                                        var Qa = Ma <= Fa;
                                        xa && Qa || (Qa && (Ia = !0),
                                        Ma != Fa && (wa += B(Ga, a.PayedServiceVariants[Da.variant], a.PayedServiceTypes.API)))
                                    }
                                }
                            }
                            Ia = "";
                            xa && (Ia = "<br><div>You can only downgrade once per month. You can not downgrade again.</div>");
                            replaceHtml("pricingPlansUpdate", "<div>Choose the new plan:</div><br>" + wa + Ia);
                            ka();
                            $(".gcContainer").on("click", function() {
                                var Ja = $(this).attr("rel");
                                if (Ja) {
                                    var Pa = a.PayedService[Ja];
                                    replaceHtml("pricingPlansUpdate", '<div id="loadingIconPopup"></div>');
                                    $("#loadingIconPopup").show();
                                    network.request({
                                        path: "service/stripe",
                                        type: "upcomingInvoice",
                                        subscriptionId: C,
                                        subscriptionPlan: Ja,
                                        dashboard: "api",
                                        version: 3
                                    }).done(function(Oa) {
                                        var Ha = Oa.invoices;
                                        if (null == Ha || 0 == Ha[0].length || null == Ha[0])
                                            showErrorPopup();
                                        else {
                                            Ha = Ha[0];
                                            for (var ya = Oa = 0, Na = "", La = "", Sa = 0; Sa < Ha.lines.data.length; Sa++) {
                                                var Ka = Ha.lines.data[Sa];
                                                Ka.subscription == C && (0 > Ka.amount ? (Na = Ka.description,
                                                Oa = -1 * Ka.amount) : (La = Ka.description,
                                                ya = Ka.amount))
                                            }
                                            Ha = B(Ja, a.PayedServiceVariants[Pa.variant], a.PayedServiceTypes.API);
                                            var Ra = -Oa + ya;
                                            Sa = Money.format(a.PayedServiceVariants[Pa.variant].price, {
                                                sourceDomainId: 3,
                                                targetDomainId: 3,
                                                noDigits: !0,
                                                forceEuropeanStyle: !0
                                            });
                                            Ka = Money.format(Oa, {
                                                sourceDomainId: 3,
                                                targetDomainId: 3,
                                                forceEuropeanStyle: !0
                                            });
                                            var Ua = Money.format(ya, {
                                                sourceDomainId: 3,
                                                targetDomainId: 3,
                                                forceEuropeanStyle: !0
                                            });
                                            Ra = Money.format(Ra, {
                                                sourceDomainId: 3,
                                                targetDomainId: 3,
                                                forceEuropeanStyle: !0
                                            });
                                            replaceHtml("pricingPlansUpdate", "<div>Your new plan:</div><br>" + Ha + ('<div><span style="margin-left: 30px;">You are about to change your current subscription.</span><span><ul style="line-height: 20px; color: #000; margin: 20px 20px 20px 50px;text-indent: -1.4em;"><li>&bull;&emsp;The new plan will replace your old one immediately after we have received payment.</li><li>&bull;&emsp;You can upgrade your plan as often as you want, but a downgrade is only possible once per month.</li><li>&bull;&emsp;Refund: ' + Ka + " - " + Na + "</li><li>&bull;&emsp;Prorated charge: " + Ua + " - " + La + "</li>" + (Oa > ya ? "<li>&bull;&emsp;You will receive a credit in your account of: " + Ra + ". This credit will be applied to future billing cycles.</li>" : "<li>&bull;&emsp;Immediate amount due: " + Ra + "</li>") + "<li>&bull;&emsp;New monthly subscription cost: " + Sa + '</li></ul></span></div><div style="padding: 10px 0px 0 80px;"  class="flex"><span id="gcPay" style="width: 300px; display: inline-block;"><span style="font-size: 20px;">Yes,</span><br><span style="padding-left: 20px; display: inline-block;">I want to <span id="purchaseText">update my subscription</span>.') + ((Oa > ya ? "" : " Your credit card will be charged immediately with " + Ra + ".") + ' I have read, understood and accept the <a style="cursor: alias !important;" rel="terms">Terms and Conditions</a>.</span></span><span id="gcAbort" style="width: 300px; display: inline-block; margin-left: 30px;"><span style="font-size: 20px;">Abort,</span><br><span style="padding-left: 20px; display: inline-block;">I need to change something.</span></span></div>'));
                                            $("#pricingPlansUpdate").find(".gcContainer").css("cursor", "default");
                                            $("#pricingPlansUpdate #gcAbort").off("click").on("click", function() {
                                                J()
                                            });
                                            var Va = !1;
                                            $("#pricingPlansUpdate #gcPay").off("click").on("click", function() {
                                                null != C && 9 < C.length ? Va || (Va = !0,
                                                U.payedService = Ja,
                                                function(Wa) {
                                                    replaceHtml("pricingPlansUpdate", '<div id="loadingIcon"></div>');
                                                    $("#loadingIcon").show();
                                                    network.request({
                                                        path: "service/stripe",
                                                        type: "subscription",
                                                        content: JSON.stringify(U),
                                                        subscriptionId: C,
                                                        dashboard: "api",
                                                        version: 3
                                                    }).done(function(Ta) {
                                                        console.info("payment 9g...");
                                                        var Za = function(Ya) {
                                                            var $a = material.getButton("closePopup", "Attempt payment again", "credit-card", null, !1, !1)
                                                              , ab = '<section><span class"tomato">Your credit card could not be charged. ' + (null != Ya.errorMsg ? Ya.errorMsg : "") + "</span></section>";
                                                            300 <= Ya.code && (ab = 405 == Ya.code ? '<div><span class"tomato">The coupon code you have entered is not valid.</span></div>' : '<div><span class"tomato">' + (Ya.errorMsg ? Ya.errorMsg : "") + " Your order was aborted and your credit card could not be charged. Please repeat the process with a valid credit card. We accept Visa, MasterCard and American Express.</span></div>");
                                                            replaceHtml("pricingPlansUpdate", ab + "<br><div>" + $a + "</div>");
                                                            $("#closePopup").on("click", function(bb) {
                                                                bb.preventDefault();
                                                                null != Ya.url ? (window.open(Ya.url),
                                                                priceDataAPI.init()) : oa()
                                                            })
                                                        }
                                                          , Xa = function() {
                                                            replaceHtml("pricingPlansUpdate", '<div>Thank you for your purchase!<br><br>Once we have processed the payment your API access will be updated. <strong>This will take a couple minutes!</strong></div><br><br><span class="button" id="openDash">Open your dashboard</span>');
                                                            $("#openDash").off("click").on("click", function(Ya) {
                                                                priceDataAPI.init()
                                                            })
                                                        };
                                                        if (300 <= Ta.code || null != Ta.errorMsg)
                                                            Za(Ta);
                                                        else {
                                                            if (null == Ta.paymentIntent)
                                                                Xa();
                                                            else
                                                                switch (Ta.paymentIntent.status) {
                                                                case "succeeded":
                                                                    Xa();
                                                                    break;
                                                                case "requires_payment_method":
                                                                    Za(Ta);
                                                                    break;
                                                                case "requires_action":
                                                                    console.info("payment 10...", Ta),
                                                                    priceDataAPI.loadStripe("pk_live_d8cHyZoVVZdRXDvnxSmuoQTM").done(function(Ya) {
                                                                        console.info("payment 11...");
                                                                        Ya.handleCardPayment(Ta.paymentIntent.clientSecret).then(function($a) {
                                                                            console.info("payment 12...", $a);
                                                                            $a.error ? (Ta.errorMsg = $a.error.message,
                                                                            Za(Ta)) : Xa()
                                                                        })
                                                                    }).fail(function() {
                                                                        showErrorPopup()
                                                                    })
                                                                }
                                                            Va = !1
                                                        }
                                                    }).fail(function() {
                                                        showErrorPopup();
                                                        Va = !1
                                                    })
                                                }(null),
                                                Va = !1) : showErrorPopup()
                                            })
                                        }
                                    }).fail(function() {
                                        sa.close();
                                        setTimeout(function() {
                                            showErrorPopup()
                                        }, 500)
                                    })
                                }
                            })
                        } else
                            replaceHtml("popupMessage", "<div>" + la._428 + "</div>")
                    })
                }
            }
        });
        $("#testWebHook").on("click", function() {
            network.request({
                path: "service/stripe",
                type: "testWebhook",
                webhookUrl: $("#webhookInput").val(),
                dashboard: "api",
                version: 3
            }).done(function(C) {
                -1 == C.code ? showPopup("Webhook test", "You did not specify a valid URL. Please check your input.", !0) : showPopup("Webhook test", "The server response status code to our test payload was:&emsp;<strong>" + C.code + "</strong><br><br>Note: Only the status code 200 will be interpreted as a success.", !0)
            }).fail(showErrorPopup)
        });
        $("#saveWebHook").on("click", function() {
            network.request({
                path: "service/stripe",
                type: "updateWebhook",
                webhookUrl: $("#webhookInput").val(),
                dashboard: "api",
                version: 3
            }).done(function(C) {
                -1 == C.code ? showPopup("Webhook test", "You did not specify a valid URL. Please check your input.", !0) : showPopup("Webhook URL updated!", "Your webhook URL was successfully updated.", !0)
            }).fail(showErrorPopup)
        });
        $(".resumeSub").on("click", function(C) {
            var U = $(this).attr("rel");
            C = material.getButton("resumeSubscription", "Resume Subscription", "repeat", null, !1, !1);
            var ia = showPopup("Resume subscription", "<div>This will remove your cancellation and continue automatic renewals of your subscription.</div><br><br>" + C, !0);
            $("#resumeSubscription").on("click", function() {
                ia.close();
                network.request({
                    path: "service/stripe",
                    type: "resumeSubscription",
                    subscriptionId: U,
                    dashboard: "api",
                    version: 3
                }).done(function() {
                    J()
                }).fail(N)
            })
        });
        $(".cancelSubscription").on("click", function() {
            var C = $(this)
              , U = C.parent().attr("id");
            if (null != U) {
                var ia = showPopup("Cancel subscription", "If you cancel your subscription it will end on " + C.data("end") + ' (you will not be refunded any pro-rated amount) and will not be renewed. Do you want to continue?<br><br><span class="button" id="cancelSub">&ensp;Yes, cancel subscription&ensp;</span>', !0);
                $("#cancelSub").on("click", function() {
                    ia.close();
                    network.request({
                        path: "service/stripe",
                        type: "cancelSubscription",
                        subscriptionId: U,
                        dashboard: "api",
                        version: 3
                    }).done(function(X) {
                        J()
                    }).fail(function() {
                        setTimeout(function() {
                            showErrorPopup()
                        }, 500)
                    })
                })
            }
        });
        $("#editCC, #addCC").on("click", D);
        $("#removeCC").on("click", function() {
            var C = showPopup("Delete Credit Card", 'This will delete your attached credit card. Your subscription will terminate unless you provide a new payment method before the end of your billing cycle. Do you want to continue?<br><br><span class="button" id="deleteTokenConfirm">&ensp;Yes&ensp;</span>', !0);
            $("#deleteTokenConfirm").on("click", function() {
                C.close();
                network.request({
                    path: "service/stripe",
                    type: "deleteSource",
                    dashboard: "api",
                    version: 3
                }).done(function(U) {
                    setTimeout(function() {
                        showPopup("Payment method removed!", "Your payment method was successfully deleted.", !0);
                        J()
                    }, 300)
                }).fail(function(U) {
                    setTimeout(function() {
                        showPopup("Removal issue", U, !0)
                    }, 300)
                })
            })
        });
        $("#tokenDelete").on("click", function() {
            var C = $(this)
              , U = showPopup("Generate new API access key", 'Your current key will be invalidated and all future requests with it will be denied. Do you want to continue?<br><br><span class="button" id="deleteTokenConfirm">&ensp;Yes&ensp;</span>', !0);
            $("#deleteTokenConfirm").on("click", function() {
                U.close();
                network.request({
                    path: "service/stripe",
                    type: "deleteKey",
                    dashboard: "api",
                    version: 3
                }).done(function(ia) {
                    ia.key ? (t = ia.key,
                    C.prev().text(t)) : setTimeout(function() {
                        showErrorPopup()
                    }, 500)
                }).fail(function() {
                    setTimeout(function() {
                        showErrorPopup()
                    }, 500)
                })
            })
        });
        $(".cancelOrder").on("click", function() {
            var C = $(this);
            network.ajax(ajaxURL + "api/service/?user=" + storage.token + "&type=cancelOrder&billId=" + C.attr("rel")).done(J).fail(N)
        });
        $("#retryPayment").on("click", function() {
            za($(this).parent().attr("id"))
        });
        ka();
        $(".gcContainer").on("click", function() {
            var C = $(this).attr("rel");
            C && O(C)
        })
    }, ka = function() {
        $(".gcContainer").hover(function() {
            $(this).children(".gcValue").css({
                backgroundColor: "#666"
            });
            $(this).find(".gcPrice").css({
                color: "#fff"
            });
            $(this).children(".triangle").css({
                borderColor: "#9FC5B0 transparent #9FC5B0 #666"
            })
        }, function() {
            $(this).children(".gcValue").css({
                backgroundColor: "#444"
            });
            $(this).find(".gcPrice").css({
                color: "#000"
            });
            $(this).children(".triangle").css({
                borderColor: "#9FC5B0 transparent #9FC5B0 #444"
            })
        })
    }, za = function(Z) {
        $("#paymentStatus").html('<div id="loadingIcon"></div>');
        $("#loadingIcon").show();
        var ja = function(W) {
            J();
            setTimeout(function() {
                showErrorPopup()
            }, 500)
        };
        network.request({
            path: "service/stripe",
            type: "getHostedInvoice",
            subscriptionId: Z,
            dashboard: "api",
            version: 3
        }).done(function(W) {
            W.url && 0 < W.url.length ? window.location.href = W.url : ja(W)
        }).fail(function(W) {
            ja(W)
        })
    }, J = function() {
        network.request({
            path: "service/stripe",
            type: "countries",
            dashboard: "api",
            version: 3
        }).done(function(Z) {
            ea = Z.countries;
            network.request({
                path: "service/stripe",
                type: "offers",
                dashboard: "api",
                version: 3
            }).done(function(ja) {
                ja.offers ? (E = ja.user,
                a = ja.offers,
                ja.payments ? (b = ja.payments.payments,
                K = ja.payments.lastDowngrade,
                d = ja.payments.subscriptions,
                h = ja.subscriptionStatus) : b = K = d = h = null,
                null == d && (d = []),
                m = ja.paymentStatus,
                t = ja.key,
                f = ja.tokens,
                n = ja.tokenFlowReduction,
                r = ja.invoices,
                p = ja.pendingInvoices,
                z = ja.card,
                F = ja.source,
                I = ja.balance,
                qa()) : showErrorPopup()
            }).fail(function() {
                showErrorPopup()
            })
        }).fail(function() {
            showErrorPopup()
        })
    }, g = !1, D = function() {
        if (!g) {
            g = !0;
            var Z = d[d.length - 1];
            na.getAuthenticatedSource("pk_live_d8cHyZoVVZdRXDvnxSmuoQTM", r && 0 < r.length ? r[0].amountDue : Z.totalBill, !0, Z).done(function(ja) {
                setTimeout(function() {
                    showPopup("Payment method updated!", "Your payment method for future payments was successfully updated.", !0);
                    J()
                }, 300)
            }).fail(function(ja) {
                setTimeout(function() {
                    showPopup("Payment issue", ja, !0)
                }, 300)
            }).always(function() {
                g = !1
            })
        }
    }, N = function() {
        showErrorPopup()
    }, ba = function() {
        if (null == b)
            return null;
        for (var Z = 0; Z < b.length; Z++) {
            var ja = b[Z];
            if (0 == ja.paymentCancelledDate && 0 == ja.paymentReceivedDate)
                return ja
        }
        return null
    }, q = 0, L, A = !1, O = function(Z) {
        na.loadStripe("pk_live_d8cHyZoVVZdRXDvnxSmuoQTM");
        var ja = $.Deferred();
        T(ja.promise());
        network.request({
            path: "user/settings",
            type: "getSettings",
            version: 3
        }).done(function(W) {
            if (2 != storage.accountType && settings.isEmailVerified)
                ja.resolve("Before you can continue you have to sign in.");
            else {
                var Aa = W.ear;
                q = W.timeStamp;
                E = W.user;
                if (!E.emailAddress || -1 == E.emailAddress.indexOf("@") || null != Aa && "VERIFIED" != EmailStatus[Aa.status])
                    ja.resolve(la._428);
                else {
                    var Ca = a.PayedService[Z];
                    if (null != ba()) {
                        ja.resolve("<div>You are not allowed not make a purchase while you have an unpaid order pending. Please issue the payment for your order first (if you have not already). You can also cancel the order.</div>");
                        return
                    }
                    Aa = "API" == Ca.type ? B(Z, a.PayedServiceVariants[Ca.variant], a.PayedServiceTypes.API) : Q(Z, a.PayedServiceVariants[Ca.variant], a.PayedServiceTypes[Ca.type]);
                    var Ba = a.PayedServiceVariants[Ca.variant].variant + " " + a.PayedServiceTypes.API.variantDescription
                      , ta = Money.format(a.PayedServiceVariants[Ca.variant].price, {
                        sourceDomainId: 3,
                        targetDomainId: 3,
                        noDigits: !0,
                        forceEuropeanStyle: !0
                    }).replace(/\.|,/g, "")
                      , Ea = '<div><span style="margin-left: 30px;">You are about to purchase access to our API for ' + a.PayedServiceTypes.API.subscriptionDurationDescription + " with " + Ba + " for " + ta + '.</span><span><ul style="line-height: 20px; color: #000; margin: 20px 20px 20px 50px;text-indent: -1.4em;"><li>&bull;&emsp;The API access will be activated on your Keepa account immediately after we have received the payment.</li><li>&bull;&emsp;Our price plans are subscription based. The plan will <span style="text-decoration: underline;">automatically renew</span> unless cancelled and all payments are non-refundable.</li><li>&bull;&emsp;Cancellation of the subscription is possible at any time and will end the subscription at the end of the monthly term.</li><li>&bull;&emsp;You can upgrade your API access any time by subscribing to additional plans or upgrading existing subscriptions.</li><li>&bull;&emsp;We accept credit cards through our payment provider Stripe. Contact us if you require other methods of payment.</li></ul></span></div>'
                      , va = '<span style="margin-left: 30px;">The plan will be applied to your current active Keepa account <div style="margin: 10px 0 10px 80px;"><span style="font-family: Verdana, Arial, sans-serif" id="accountEmail"><span style="color:#000">' + storage.username + '</span> with the email <span style="color:#000">' + storage.email + "</span></span></div></span>"
                      , da = null;
                    try {
                        null != d && 0 < d.length ? da = d[d.length - 1] : null != b && 0 < b.length && (da = b[b.length - 1])
                    } catch (ha) {
                        console.log(ha)
                    }
                    if ("undefined" != typeof b && null != b)
                        for (var Y = 0; Y < b.length; Y++) {
                            var ma = b[Y];
                            if (null != ma && "Paypal" == ma.paymentProvider && !(55296E5 < Date.now() - ma.createDate)) {
                                A = !0;
                                break
                            }
                        }
                    da = M(da);
                    ja.resolve(Aa + Ea + va + da + '<div  class="flex" style="padding: 10px 0px 0 80px;"><span id="gcProceed" style="width: 300px; display: inline-block;"><span style="font-size: 20px;">Proceed</span><br><span style="padding-left: 20px; display: inline-block;">You will be able to review your information.</span></span><span id="gcAbort" style="width: 300px; display: inline-block; margin-left: 30px;"><span style="font-size: 20px;">Return</span><br><span style="padding-left: 20px; display: inline-block;">I want to use a different price plan or change the account.</span></span></div>');
                    $("#GCBTab2").find(".gcContainer").css("cursor", "default");
                    $("#gcAbort").off("click").on("click", function() {
                        oa()
                    });
                    var ca = function() {
                        $("#priceApiForm").show();
                        $("#loadingIconPopup").hide()
                    };
                    $("#gcProceed").off("click").on("click", function() {
                        var ha = {};
                        if (P(ha)) {
                            $("#priceApiForm").hide();
                            $("#loadingIconPopup").show();
                            var C = $("#priceApiForm").find("#frmCountryS").find(":selected")
                              , U = $("#vatIdErrors")
                              , ia = {
                                paymentIntentRequest: {
                                    billingBusiness: ha["billing-business"],
                                    billingCity: ha["billing-city"],
                                    billingContact: ha["billing-name"],
                                    billingState: ha["billing-state"],
                                    billingStreet: ha["billing-address"],
                                    billingVatId: ha["billing-vatId"].replace(/[-,;_:#. ]/g, ""),
                                    billingZipCode: ha["billing-zip"]
                                },
                                countryCode: $(C).data("code"),
                                isEu: "1" === $(C).attr("rel")
                            };
                            isTest && console.info("%csend validateData:", "color:orange", ia);
                            priceDataAPI.validateVatIdPromise(ia).done(function(X) {
                                ca();
                                isTest && console.info("%cvalidationPromiseResult:", "color:orange", X);
                                if (null == X || !0 !== X.success)
                                    priceDataAPI.handleValidateVatIdError(X, $("#vatIdErrors"));
                                else if (!0 === X.valid && 0 === X.invalidFields.length) {
                                    U.html("");
                                    U.hide();
                                    isTest && (!0 === X.validationNeeded ? console.info("%cVatId:", "color:green", "everything is valid - proceed ...") : console.info("%cVatId:", "color:green", "no validation needed - proceed ..."));
                                    var sa = ea[ia.countryCode];
                                    G(Z, Ca, Ba, ta, ha, ha["billing-business"] && X.valid && X.validationNeeded ? sa.b2bRate : sa.b2cRate)
                                } else
                                    U.html(X.msg),
                                    U.show()
                            }).fail(function(X) {
                                priceDataAPI.handleValidateVatIdError(X, U);
                                ca()
                            })
                        }
                    })
                }
                handleSettingsRequest(W, !0)
            }
        }).fail(function(W) {
            401 == W.status ? (settings.reset(!1, !1),
            ja.resolve("Before you can continue you have to sign in.")) : ja.resolve(la._error)
        })
    }, P = function(Z) {
        var ja = !0;
        $("#priceApiForm").find("input, select").each(function(Aa, Ca) {
            "radio" !== $(Ca).attr("type") && (Aa = new RegExp(Ca.pattern),
            !$(Ca).attr("required") || null != $(Ca).val() && "" != $(Ca).val() && "None" != $(Ca).val() && Aa.test($(Ca).val()) ? (Z[$(Ca).attr("name")] = $(Ca).val(),
            $(Ca).css("border", ""),
            Aa = "billing-country" != $(Ca).attr("name") && "billing-state" != $(Ca).attr("name") ? "" : "0px") : ($(Ca).css("border", "2px solid tomato"),
            Aa = "billing-country" == $(Ca).attr("name") || "billing-state" == $(Ca).attr("name") ? "" : "1px",
            ja = !1),
            $(Ca).css("padding", Aa))
        });
        var W = $("#priceApiForm").find("#frmCountryS").find(":selected");
        "US" !== $(W).data("code") && (Z["billing-state"] = "");
        Z["billing-business"] = "business-radio" == $("#b2bRadio").find(":checked")[0].id;
        !0 !== Z["billing-business"] && (Z["billing-vatId"] = "");
        "1" !== $(W).attr("rel") && (Z["billing-vatId"] = "");
        return ja
    }, M = function(Z) {
        setTimeout(function() {
            var Aa = $("#b2bRadio")
              , Ca = $("#frmCountryS")
              , Ba = function() {
                var ta = "business-radio" == Aa.find(":checked")[0].id
                  , Ea = ta && "1" == $(Ca.find(":selected")).attr("rel")
                  , va = $("#frmVATS");
                Ea ? va.parent().show(500) : va.parent().hide(500);
                $("#frmNameS").prev("label").text(ta ? "Company" : "Full name");
                $("#vatIdErrors").hide();
                ta = "US" == $(Ca.find(":selected")).data("code");
                Ea = $("#frmStateS");
                ta ? (Ea.prop("disabled", !1),
                Ea.prop("required", !0),
                Ea.css({
                    opacity: 1
                })) : (Ea.val(""),
                Ea.prop("disabled", !0),
                Ea.prop("required", !1),
                Ea.css({
                    opacity: .3
                }))
            };
            [Aa, Ca].map(function(ta) {
                return ta.on("change", Ba)
            });
            Ba();
            null != Z && (null != Z.billingContact && 0 < Z.billingContact.length && $("#frmNameS").val(Z.billingContact),
            null != Z.billingStreet && 0 < Z.billingStreet.length && $("#frmAddressS").val(Z.billingStreet),
            null != Z.billingCity && 0 < Z.billingCity.length && $("#frmCityS").val(Z.billingCity),
            null != Z.billingState && 0 < Z.billingState.length && $("#frmStateS").val(Z.billingState),
            null != Z.billingZipCode && 0 < Z.billingZipCode.length && $("#frmZipS").val(Z.billingZipCode),
            null != Z.billingCountry && 0 < Z.billingCountry.length && $("#frmCountryS").val(Z.billingCountry).trigger("change"),
            null != Z.billingVatId && 0 < Z.billingVatId.length && $("#frmVATS").val(Z.billingVatId),
            !0 === Z.billingBusiness && ($("#business-radio").prop("checked", !0),
            Ba()))
        }, 1);
        var ja = material.getRadio("individual", "Individual", !0, "billing-country")
          , W = material.getRadio("business", "Business", !1, "billing-country");
        return '<div id="priceApiForm" class="flex keepa">\n\t\t\t\tInvoice Address<br>\n\t\t\t\t<form>\n\t\t\t\t\t<section id="b2bRadio">' + ja + W + '</section>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<label for="frmNameS">Full name</label>\n\t\t\t\t\t\t<input name="billing-name" id="frmNameS" placeholder="Full name and/or Company" required pattern=".*\\S{3,}.*" autocomplete="billing name">\n\t\t\t\t\t</span>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<label for="frmAddressS">Address</label>\n\t\t\t\t\t\t<input name="billing-address" required id="frmAddressS" placeholder="123 Any Street" pattern=".*\\S{2,}.*" autocomplete="billing street-address">\n\t\t\t\t\t</span>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<label for="frmCityS">City</label>\n\t\t\t\t\t\t<input name="billing-city" required id="frmCityS" placeholder="New York" pattern=".*\\S{2,}.*" autocomplete="billing locality">\n\t\t\t\t\t</span>\n\t\t\t\t\t<section style="height:50px;"> </section>\n\t\t\t\t\t<span>\t\t\t\t\t\t\n\t\t\t\t\t\t' + v() + '\n\t\t\t\t\t</span>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<label for="frmZipS">Zip</label>\n\t\t\t\t\t\t<input name="billing-zip" required id="frmZipS" placeholder="10011" pattern=".*\\S{2,}.*" autocomplete="billing postal-code">\n\t\t\t\t\t</span>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t' + u() + '\n\t\t\t\t\t</span>\t\t\t\t\n\t\t\t\t</form>\n\t\t\t\t<span style="display:none; padding: 0 11px;">\n\t\t\t\t\t<label for="frmVATS">VAT identification number</label>\n\t\t\t\t\t<input style="width: 420px;" name="billing-vatId" id="frmVATS" placeholder="Required for business customers in EU (eg: EU999999999)"></span>\n\t\t\t\t</span>\n\t\t\t\t<div id="vatIdErrors" style="display:none;padding:20px 10px;"></div>\n\t\t\t</div>\n\t\t\t<div style="width:400px;height:300px;" id="loadingIconPopup"></div>'
    }, u = function() {
        for (var Z = "", ja = [], W = [], Aa = "US GB DE FR JP CA CN IT ES IN MX BR AU".split(" "), Ca = $jscomp.makeIterator(Aa), Ba = Ca.next(); !Ba.done; Ba = Ca.next())
            W.push(ea[Ba.value]);
        for (var ta in ea)
            ja.push([ea[ta].name, ea[ta]]);
        ja.sort(function(da, Y) {
            return da[0].localeCompare(Y[0])
        });
        for (var Ea in ja)
            W.push(ja[Ea][1]);
        for (var va in W)
            ja = W[va],
            Z += '<option rel="' + (ja.isEU ? 1 : 0) + '" data-code="' + ja.id + '" value="' + ja.name + '">' + ja.name + "</option>",
            Number(va) == Aa.length - 1 && (Z += "<option disabled>----------------</option>");
        return '<label for="frmCountryS">Country</label>\n\t\t\t<select name="billing-country" required id="frmCountryS" autocomplete="billing country" style="width: 204px;padding: 1px;">\n\t\t\t\t<option value="None"></option>\n\t\t\t\t' + Z + "\n\t\t\t</select>"
    }, v = function() {
        var Z = [];
        for (ja in ra)
            Z.push(ja);
        var ja = "";
        for (var W in Z) {
            var Aa = Z[W];
            ja += '<option value="' + Aa + '">' + Aa + "</option>"
        }
        return '<label for="frmStateS">State</label>\n\t\t\t<select name="billing-state" required id="frmStateS" autocomplete="billing region" style="width: 204px;padding: 1px;">\n\t\t\t\t<option value=""></option>\n\t\t\t\t' + ja + "\n\t\t\t</select>"
    }, G = function(Z, ja, W, Aa, Ca, Ba) {
        var ta = $.Deferred();
        T(ta.promise());
        var Ea = ""
          , va = "";
        0 < Ba && (Ea = " + " + Ba + "% VAT",
        va = '<div class="vatIdNotice">\n\t\t\t\t\t<i class="fa fa-info-circle"></i>&emsp;' + Ba + "% VAT will be added (Reverse Charge not applicable).\n\t\t\t\t</div>");
        var da = '<div id="paymentMethods" class="flex">Your payment method<div id="paymentProviderRadio"><input checked type="radio" name="paymentProvider" value="CreditCard">Credit Card</input><br><br>If you can not pay via Credit Card we also accept payment through Paypal. Recurring payments are not supported via Paypal, so if you choose this payment option you will have to manually purchase a new API plan each month. <b>Your access is not subscription based if payed through Paypal.</b><br><input type="radio" name="paymentProvider" value="Paypal">Paypal</input></div></div>'
          , Y = "";
        null != m && 80352E5 < m[2] - q && (Y = " (We only allow price plan extension for a maximum of 3 months in advance)");
        Y = null != m && 0 != m[0] ? '<div id="planOptions" class="flex">If paid through Paypal: Do you want to upgrade your existing plan or extend your access?<div id="planOptionsRadio"><input type="radio" name="planOptions" value="true">Upgrade</input>&emsp;<input type="radio" name="planOptions" value="false"><span>Extend' + Y + '</span></input></div><span style="padding: 10px 0 0 10px;width: 700px;font-size: 12px;">If you choose "Extend" your new plan will start when your current ones end (' + (new Date(m[2])).formatDate("M j, Y") + ').<br>If you choose "Upgrade" your new plan will be active simultanousely as your current one (the allowed requests per minute will be added) and the plan duration and price will be adjusted to match the remaining term of your currently active plan (ends at ' + (new Date(m[1])).formatDate("M j, Y") + ").</span></div>" : "";
        A || (Y = da = "");
        va = '<div id="billingReview" class="flex keepa">Please review your ' + $("#priceApiForm").html() + "</div>" + va;
        ta.resolve(va + da + Y + ('<div style="padding: 10px 0px 0 80px;"  class="flex"><span id="gcPay" style="width: 300px; display: inline-block;"><span style="font-size: 20px;">Yes,</span><br><span style="padding-left: 20px; display: inline-block;">I want to <span id="purchaseText">purchase</span> ' + a.PayedServiceTypes.API.description + " with " + W + ' for <span id="finalPrice">' + Aa + Ea + '</span> and I have read, understood and accept the <a style="cursor: alias !important;" rel="terms">Terms and Conditions</a>.</span></span><span id="gcChangeAccount" style="width: 300px; display: inline-block; margin-left: 30px;"><span style="font-size: 20px;">Abort,</span><br><span style="padding-left: 20px; display: inline-block;">I need to change something.</span></span></div>'));
        $("#planOptions").hide();
        !0 === Ca["billing-business"] && $("#billingReview #business-radio").attr("checked", !0);
        $("#billingReview").find("input, select").each(function(ca, ha) {
            if ("radio" === $(ha).attr("type"))
                $(ha).attr("disabled", !0);
            else {
                null != $(ha).val() && 0 != $(ha).val().length || $(ha).attr("placeholder", "");
                $(ha).val(Ca[$(ha).attr("name")]);
                $(ha).attr("readonly", "");
                if ("billing-country" == $(ha).attr("name") || "billing-state" == $(ha).attr("name"))
                    ca = $(ha).val() ? $(ha).val() : "",
                    $(ha).parent().append('<input readonly value="' + ca + '">'),
                    $(ha).remove();
                "billing-vatId" == $(ha).attr("name") && $(ha).val($(ha).val().replace(/[-,;_:#. ]/g, ""))
            }
        });
        $("#billingReview #vatIdErrors").remove();
        aa = a.PayedServiceTypes.API.subscriptionDuration;
        $("#planOptionsRadio").off("click").on("click", function(ca) {
            ca = $(ca.target).attr("value");
            var ha = a.PayedServiceVariants[ja.variant].price
              , C = a.PayedServiceTypes.API.subscriptionDuration;
            switch (ca) {
            case "true":
                aa = m[1] - q;
                V = aa / C * ha;
                S = Money.format(V, {
                    sourceDomainId: 3,
                    targetDomainId: 3,
                    forceEuropeanStyle: !0
                });
                $("#finalPrice").text(S);
                $("#finalPrice").css("fontSize", "16px");
                $("#finalPrice").effect("highlight", 5E3);
                $("#purchaseText").text("upgrade my current");
                $("#paymentProviderRadio").children('input[value="BankTransfer"]').attr("disabled", "").attr("title", "Bank Transfer is not an option when upgrading you current plan.").prop("checked", !1);
                break;
            case "false":
                $("#paymentProviderRadio").children('input[value="BankTransfer"]').removeAttr("disabled").removeAttr("title"),
                aa = a.PayedServiceTypes.API.subscriptionDuration,
                S = Aa,
                $("#finalPrice").text(Aa),
                $("#purchaseText").text("extend my"),
                $("#finalPrice").css("fontSize", "")
            }
        });
        $("#paymentProviderRadio").off("click").on("click", function(ca) {
            "Paypal" == $("#paymentProviderRadio input[name=paymentProvider]:checked").val() ? $("#planOptions").show("slideDown") : $("#planOptions").hide("slideUp")
        });
        null != m && 80352E5 < m[2] - q && ($("#planOptionsRadio").children('[value="true"]').trigger("click"),
        $("#planOptionsRadio").children('[value="false"]').attr("disabled", "true"));
        var ma = !1;
        $("#gcPay").off("click").on("click", function(ca) {
            if ("terms" == $(ca.target).attr("rel"))
                return w(),
                ca.stopImmediatePropagation(),
                !1;
            if (!ma) {
                ma = !0;
                ca = $("#paymentProviderRadio input[name=paymentProvider]:checked").val();
                var ha = $("#planOptionsRadio input[name=planOptions]:checked").val();
                A || (ca = "CreditCard");
                var C = "CreditCard" == ca
                  , U = !0;
                "undefined" == typeof ca ? ($("#paymentProviderRadio").css("color", "tomato"),
                $("#paymentProviderRadio").effect("highlight", 600),
                U = !1) : $("#paymentProviderRadio").css("color", "");
                C || null == m || 0 == m[0] || "undefined" != typeof ha ? $("#planOptionsRadio").css("color", "") : ($("#planOptionsRadio").css("color", "tomato"),
                $("#planOptionsRadio").effect("highlight", 600),
                U = !1);
                if (U) {
                    var ia = {
                        payedService: Z,
                        paymentProvider: ca,
                        billingContact: Ca["billing-name"],
                        billingStreet: Ca["billing-address"],
                        billingCity: Ca["billing-city"],
                        billingZipCode: Ca["billing-zip"],
                        billingState: Ca["billing-state"],
                        billingCountry: Ca["billing-country"],
                        billingBusiness: Ca["billing-business"],
                        billingVatId: Ca["billing-vatId"].replace(/[-,;_:#. ]/g, "")
                    };
                    if (C) {
                        var X = function() {
                            var wa = $("#billingReview").parent();
                            wa.html('<div id="loadingIcon"></div>');
                            $("#loadingIcon").show();
                            $("#backButton").hide();
                            network.request({
                                path: "service/stripe",
                                type: "subscription",
                                content: JSON.stringify(ia),
                                dashboard: "api",
                                version: 3
                            }).done(function(xa) {
                                console.info("payment 9a...");
                                var Ia = function(Ga) {
                                    var Da = material.getButton("closePopup", "Attempt payment again", "credit-card", null, !1, !1)
                                      , Ma = '<section><span class"tomato">Your credit card could not be charged. ' + (null != Ga.errorMsg ? Ga.errorMsg : "") + "</span></section>";
                                    300 <= Ga.code && (Ma = 405 == Ga.code ? '<div><span class"tomato">The coupon code you have entered is not valid.</span></div>' : '<div><span class"tomato">' + (Ga.errorMsg ? Ga.errorMsg : "") + " Your order was aborted and your credit card could not be charged. Please repeat the process with a valid credit card. We accept Visa, MasterCard and American Express.</span></div>");
                                    wa.html(Ma + "<br><div>" + Da + "</div>");
                                    $("#closePopup").on("click", function(Qa) {
                                        Qa.preventDefault();
                                        null != Ga.url ? (window.open(Ga.url),
                                        priceDataAPI.init()) : oa()
                                    })
                                }
                                  , Fa = function() {
                                    wa.html('<div>Thank you for your purchase!<br><br>Once we have processed the payment your API access will be activated.</div><br><br><span class="button" id="openDash">Open your dashboard</span>');
                                    $("#openDash").off("click").on("click", function(Ga) {
                                        priceDataAPI.init()
                                    })
                                };
                                if (300 <= xa.code || null != xa.errorMsg)
                                    Ia(xa);
                                else if (null == xa.paymentIntent)
                                    Fa();
                                else
                                    switch (xa.paymentIntent.status) {
                                    case "succeeded":
                                        Fa();
                                        break;
                                    case "requires_payment_method":
                                        Ia(xa);
                                        break;
                                    case "requires_action":
                                        console.info("payment 10..."),
                                        priceDataAPI.loadStripe("pk_live_d8cHyZoVVZdRXDvnxSmuoQTM").done(function(Ga) {
                                            console.info("payment 11...");
                                            Ga.handleCardPayment(xa.paymentIntent.clientSecret).then(function(Da) {
                                                console.info("payment 12...");
                                                Da.error ? (xa.errorMsg = Da.error.message,
                                                Ia(xa)) : Fa()
                                            })
                                        }).fail(function() {
                                            showErrorPopup()
                                        })
                                    }
                            }).fail(function(xa) {
                                wa.html(la._error)
                            })
                        };
                        na.getAuthenticatedSource("pk_live_d8cHyZoVVZdRXDvnxSmuoQTM", a.PayedServiceVariants[ja.variant].price * (1 + Ba / 100), !1, ia).done(function(wa) {
                            X()
                        }).fail(function(wa) {
                            setTimeout(function() {
                                showPopup("Payment issue", wa, !0)
                            }, 300)
                        }).always(function() {
                            ma = !1
                        })
                    } else {
                        ia.isUpgrade = "true" == ha;
                        ia.subscriptionDuration = aa;
                        var sa = $("#billingReview").parent();
                        sa.html('<div id="loadingIcon"></div>');
                        $("#loadingIcon").show();
                        $("#backButton").hide();
                        network.ajax({
                            url: "api/service/?user=" + storage.token + "&type=paymentIntend",
                            dataType: "json",
                            type: "POST",
                            data: JSON.stringify(ia)
                        }, !0).done(function(wa) {
                            if (0 != parseInt(wa))
                                if (wa.unpaid)
                                    sa.html('<div><span class"tomato">Your order was aborted.</span><br>You are not allowed not make a purchase while you have an unpaid order pending. Please issue the payment for your order first (if you have not already). You can also cancel the order.</div>');
                                else if (wa.paymentUrl)
                                    document.location = wa.paymentUrl;
                                else {
                                    $("#backButton").hide();
                                    var xa = wa.bankAccount;
                                    wa = '<div>Thank you for your purchase!<br><br>You can <a href="' + ajaxURL + "api/service/?user=" + storage.token + "&type=getInvoicePDF&billId=" + wa.payment.billId + '" download id="downloadInvoice">download your invoice here&ensp;<i class="fa fa-file-pdf-o"></i></a><br>Once we have received the payment your API access will be activated (we will send you an email).</div><br><br><div id="paymentMethods">Please issue the payment to the following German bank account<div id="paymentProviderRadio"><div>Reference:&emsp;' + wa.payment.billId + "</div><div>Remmittee:&emsp;" + xa.remittee + "</div><div>Transfer Amount:&emsp;" + Money.format(wa.payment.totalBill, {
                                        sourceDomainId: 3,
                                        targetDomainId: 3,
                                        forceEuropeanStyle: !0
                                    }) + "</div><div>IBAN:&emsp;" + xa.iban + "</div><div>BIC:&emsp;" + xa.bic + "</div><div>Bank:&emsp;" + xa.bank + "</div></div></div>";
                                    sa.html(wa)
                                }
                            else
                                sa.html(la._error)
                        }).fail(function(wa) {
                            sa.html(la._error)
                        })
                    }
                } else
                    ma = !1
            }
        });
        $("#gcChangeAccount").off("click").on("click", function() {
            oa()
        })
    }, w = function() {
        var Z = $.Deferred();
        network.ajax(CDNUrl + "termsAPI.txt?" + (new Date).getDate()).done(function(ja) {
            Z.resolve('<div id="printTerms" style="cursor: pointer; z-index: 1; position: absolute; right: -169px; top: 74px;"><i class="fa fa-print"></i> Print Terms</div><div id="termsAPI" style="padding-right: 20px; text-align:justify; width: 1000px;">' + ja + "</div>");
            T(Z.promise());
            $("#printTerms").on("click", function() {
                var W = window.open("", "Terms and Conditions", "height=800,width=1000");
                W.document.write("<html><head><title>Terms and Conditions for Keepa.com's API</title>");
                W.document.write("</head><body >");
                W.document.write($("#termsAPI").html());
                W.document.write("</body></html>");
                W.document.close();
                W.focus();
                W.print();
                W.close()
            })
        }).fail(function() {
            Z.resolve("<div>" + la._error + "</div>");
            T(Z.promise());
            reportBug(null, "pTerms")
        })
    }, B = function(Z, ja, W, Aa) {
        var Ca = 100 * (1 - ja.price / (W.pricePerRequest * ja.variant));
        Aa = NumberUtil.format(Ca);
        Aa = 0 == Aa ? "" : "save " + Aa + "%";
        0 >= Ca && (Aa = "");
        Ca = Money.format(ja.price, {
            sourceDomainId: 3,
            targetDomainId: 3,
            noDigits: !0,
            forceEuropeanStyle: !0
        }).replace(/\.|,/g, "");
        var Ba = "";
        showReferencePrice(3) && (Ba = '<br><span class="gcPrice reference">&ensp;<span class="price__reference--light">(~ ' + Money.format(ja.price, {
            sourceDomainId: 3
        }) + ' / <span title="' + W.subscriptionDurationDescription + '">month</span>)</span></span>');
        return '<span class="gcContainer" rel="' + Z + '">\n\t\t\t<span class="gcLabel" style="margin-left: 3px;">Keepa API Plan</span>\n\t\t\t<span class="gcValue">' + ja.variant + '<div style="line-height: 13px;font-size: 11px;bottom: 6px;position: relative; text-align: center;">' + W.variantDescription + '<br><span style="color: #C3C3C3;">&#8793; ' + NumberUtil.format(44640 * Number(ja.variant)) + ' per month</span></div></span><span class="triangle"></span><span class="gcLabel" >' + Aa + '</span>\n\t\t\t<span class="gcRebate">\n\t\t\t\t<span class="gcPrice">&ensp;' + Ca + ' / <span title="' + W.subscriptionDurationDescription + '">month</span></span>\n\t\t\t\t' + Ba + "\n\t\t\t</span>\n\t\t\t</span>"
    }, Q = function(Z, ja, W) {
        return '<span class="gcContainer" rel="' + Z + '"><span class="gcLabel" style="margin-left: 3px;">Keepa API Plan</span><span class="gcValue">' + W.description + '<div style="line-height: 13px;font-size: 11px;bottom: 6px;position: relative; text-align: center;">' + W.variantDescription + '<br><span style="color: #C3C3C3;">&nbsp;</span></div></span><span class="triangle"></span><span class="gcLabel" ></span><span class="gcRebate"><span class="gcPrice">&ensp;' + Money.format(ja.price, {
            sourceDomainId: 3,
            targetDomainId: 3,
            noDigits: !0,
            forceEuropeanStyle: !0
        }) + ' / <span title="' + W.subscriptionDurationDescription + '">month</span></span></span></span>'
    }, fa = function() {
        $(".appsContent").off("click").on("click", function(Z) {
            switch ($(Z.target).attr("rel")) {
            case "terms":
                return w(),
                Z.stopImmediatePropagation(),
                !1
            }
            return !0
        });
        $("#backButton").off("click").on("click", function() {
            oa()
        })
    }, R = 1, T = function(Z) {
        var ja = R + 1;
        replaceHtml("GCBTab" + ja, "");
        $("#loadingIcon").show();
        $("#GCBTab" + (ja - 1)).hide();
        R++;
        Z.progress(function(W) {
            replaceHtml("GCBTab" + ja, W);
            $("#GCBTab" + ja).parent().fadeIn();
            $("#GCBTab" + ja).fadeIn()
        });
        Z.done(function(W) {
            $("#loadingIcon").hide();
            replaceHtml("GCBTab" + ja, W);
            $("#GCBTab" + ja).parent().fadeIn();
            $("#GCBTab" + ja).fadeIn();
            fa();
            $("#tabContentIFrame").height()
        }).fail(function() {
            $("#loadingIcon").hide();
            if (!(1 >= R)) {
                var W = $("#GCBTab" + (R - 1));
                2 == R && $("#GCBTab2").parent().hide();
                $("#GCBTab" + R).hide();
                W.fadeIn();
                R--;
                $("#tabContentIFrame").height()
            }
        })
    }, oa = function() {
        if (!(1 >= R)) {
            var Z = $("#GCBTab" + (R - 1));
            2 == R && $("#GCBTab2").parent().hide();
            $("#GCBTab" + R).hide();
            Z.fadeIn();
            R--;
            $("#tabContentIFrame").height()
        }
    };
    return {
        statesUS: ra,
        init: J,
        cardPayment: na,
        loadStripe: ua,
        validateVatIdPromise: function(Z) {
            var ja = $.Deferred()
              , W = {
                invalidFields: [],
                msg: "",
                success: !0,
                valid: !0,
                validationNeeded: !1
            };
            if (!0 !== Z.paymentIntentRequest.billingBusiness || 0 === Z.paymentIntentRequest.billingVatId.length || !0 !== Z.isEu)
                return ja.resolve(W),
                ja;
            W.validationNeeded = !0;
            var Aa = Z.countryCode;
            "GR" == Aa && (Aa = "EL");
            if (0 !== Z.paymentIntentRequest.billingVatId.indexOf(Aa))
                return W.valid = !1,
                W.msg = "The given VAT ID does not match the selected country.\n\t\t\t\t\t<br>Please check the provided data or remove the VAT ID to proceed.",
                ja.resolve(W),
                ja;
            if (0 === Z.paymentIntentRequest.billingVatId.indexOf("DE"))
                return ja.resolve(W),
                ja;
            network.request({
                path: "service/stripe",
                type: "vatId",
                content: JSON.stringify(Z.paymentIntentRequest),
                dashboard: "api",
                version: 3
            }).done(function(Ca) {
                isTest && console.info("%cVatIdResult:", "color:orange", Ca);
                if (null == Ca.vatVerification)
                    ja.reject(W);
                else {
                    var Ba = function(ta) {
                        "B" === ta.Erg_Name && W.invalidFields.push("Company name");
                        "B" === ta.Erg_Str && W.invalidFields.push("Address");
                        "B" === ta.Erg_Ort && W.invalidFields.push("City");
                        "B" === ta.Erg_PLZ && W.invalidFields.push("Postal code")
                    };
                    switch (Ca.vatVerification.ErrorCode) {
                    case 200:
                        isTest && console.info("%cVatId:", "color:green", "valid - check address fields...");
                        Ba(Ca.vatVerification);
                        break;
                    case 201:
                    case 202:
                    case 203:
                    case 204:
                        isTest && console.info("%cVatId:", "color:red", "invalid");
                        Ba(Ca.vatVerification);
                        W.valid = !1;
                        break;
                    case 209:
                    case 210:
                    case 211:
                    case 212:
                        W.valid = !1;
                        break;
                    default:
                        W.success = !1,
                        W.valid = !1
                    }
                    W.success && (W.invalidFields.length || !0 !== W.valid) && (Ba = "Validation of the given VAT ID and billing address failed due to the following reasons:<br>\n\t\t\t\t\t\t<ul>",
                    W.valid || (Ba += "<li>The provided VAT ID has an invalid format.</li>"),
                    W.invalidFields.length && (Ba += "<li>The following address fields do not match the ones registered with the given VAT ID:<br>\n\t\t\t\t\t\t\t<span>" + W.invalidFields.join(", ") + "</span><br>",
                    null != Ca.vatSuggestion && (Ca.vatSuggestion.company_name || Ca.vatVerification.company_address) && (Ba = Ba + "Did you mean?<br>" + (Ca.vatSuggestion.company_name + "<br>"),
                    Ba += Ca.vatSuggestion.company_address.replace(/(?:\r\n|\r|\n)/g, "<br>") + "<br>"),
                    Ba += "</li>"),
                    W.msg = Ba + "</ul><br>Please check the provided data or remove the VAT ID to proceed.");
                    ja.resolve(W)
                }
            }).fail(function(Ca) {
                ja.reject(Ca)
            });
            return ja
        },
        handleValidateVatIdError: function(Z, ja) {
            reportBug(null, "vat id validation failed: " + JSON.stringify(Z));
            ja.html('There was a problem validating your <strong>VAT ID</strong>. Please try again later \n\t\t\t\t\t\tor remove the VAT ID from your billing data.<br>If the error persists, please contact \n\t\t\t\t\t\t<a href="mailto:info@keepa.com" class="href">info@keepa.com</a>.');
            ja.show()
        }
    }
}();
var SettingsNotification = function() {
    var a = isTest ? "holzerindustries_bot" : "keepa_bot"
      , b = {}
      , d = 20
      , h = function() {
        var ea = $("#idEmail")
          , ra = $("#saveEmail");
        ea.on("input", function() {
            ra.show();
            ra.next(".channel-error").remove()
        });
        ea.on("focusout", function() {
            var pa = ea.val()
              , ua = pa.trim();
            pa === storage.email || "" === ua && "undefined" === typeof storage.email ? ra.hide() : "" === ua ? ra.show() : (ra.next(".channel-error").remove(),
            verifyRegExp.email.test(ua) ? ra.show() : ra.hide().after('<span class="channel-error">' + la._49 + "</span>"))
        });
        ra.click(function(pa) {
            m(pa)
        })
    }
      , m = function(ea) {
        $(ea.currentTarget);
        var ra = $("#idEmail");
        ea = ra.val();
        var pa = ea.trim()
          , ua = "undefined" !== typeof storage.email;
        if (ea !== storage.email && ("" !== pa || ua))
            if ("" === pa) {
                ea = material.getButton("emailKeep", "Keep it, but deactivate price alerts via email", "toggle-off", null, !1, !1);
                var na = material.getButton("emailRemove", "Remove email", "trash-o", null, !1, !0)
                  , qa = showPopup("Remove email address", '<div style="width:600px;">Are you sure you want to remove your email address from your account? You will no longer be able to sign in using your email address. (Unless your username is your email as well.)</div><br><br>' + ea + "&emsp;" + na, !0);
                $("#emailKeep").on("click", function() {
                    qa.close();
                    $("#saveEmail").hide();
                    ra.val(storage.email);
                    b.defaultNotificationType[V("email")] && $("#channel-email").find(".channel-toggle").click()
                });
                $("#emailRemove").on("click", function() {
                    qa.close();
                    storage.removeItem("email");
                    t(ua, pa)
                });
                qa.promise.fail(function() {
                    ra.val(storage.email)
                })
            } else
                storage.email = pa,
                t(ua, pa)
    }
      , t = function(ea, ra) {
        var pa = {};
        "" === ra && (pa.removeEmail = !0);
        settings.send(pa).done(function() {
            $("#saveEmail").hide();
            $("#idEmail").val(ra);
            var ua = b.defaultNotificationType[V("email")];
            (!ea && !ua || "" === ra && ua) && $("#channel-email").find(".channel-toggle").click()
        }).fail(showErrorPopup)
    }
      , f = function() {
        var ea = $("#idTelegramBot");
        network.request({
            path: "user/settings",
            type: "getBotStatus",
            version: 3
        }).done(function(ra) {
            ra.error || (ra = z(ra.botProfiles, "tg"),
            !1 === ra ? p() : (ea.val(ra),
            ea.after('<i id="telegramBotDelete" class="fa fa-times tomato fa-lg"></i>&emsp;'),
            ea.addClass("default"),
            $("#telegramBotDelete").on("click", function(pa) {
                r(pa)
            })))
        })
    }
      , n = function() {
        var ea = $("#idTelegramBot");
        ea.val() || network.request({
            path: "user/settings",
            type: "getBotStatus",
            version: 3
        }).done(function(ra) {
            ra = z(ra.botProfiles, "tg");
            !1 !== ra && (ea.val(ra),
            ea.after('<i id="telegramBotDelete" class="fa fa-times tomato fa-lg"></i>&emsp;'),
            ea.off("click"),
            ea.addClass("default"),
            $("#channel-telegramBot").find(".fa-toggle-off").click(),
            $("#telegramBotDelete").on("click", function(pa) {
                r(pa)
            }))
        }).fail().always(function() {
            d--;
            0 <= d && setTimeout(function() {
                n()
            }, 1E3)
        })
    }
      , r = function(ea) {
        var ra = $(ea.currentTarget)
          , pa = ra.closest(".channel-wrapper");
        network.request({
            path: "user/session",
            type: "botLogout",
            version: 3,
            content: "tg"
        }).done(function() {
            $("#idTelegramBot").val("");
            ra.remove();
            pa.find(".fa-toggle-on").click();
            p()
        }).fail(function(ua) {
            showErrorPopup(ua)
        })
    }
      , p = function() {
        var ea = $("#idTelegramBot");
        ea.removeClass("default");
        ea.on("click", function() {
            var ra = window.open("about:blank", "_blank");
            network.request({
                path: "user/settings",
                type: "getBotStatus",
                version: 3
            }).done(function(pa) {
                pa.hash && (ra.location.href = "https://telegram.me/" + a + "?start=lnktref" + pa.hash,
                n())
            }).fail(function() {
                ra.close();
                showErrorPopup()
            })
        })
    }
      , z = function(ea, ra) {
        var pa = !1;
        ea && ea.groupedUserProfiles[ra] && (ea = ea.groupedUserProfiles[ra][0],
        "undefined" !== typeof ea && (pa = (ea.first_name ? ea.first_name + " " : "") + (ea.last_name ? ea.last_name : "")));
        return pa
    }
      , F = function() {
        var ea = $("#channel-browser")
          , ra = !1;
        serviceWorker.checkSubscription().done(function(pa) {
            ra = !0
        }).fail(function(pa) {
            ra = pa ? !1 : null
        }).always(function() {
            if (null != ra) {
                var pa = la._569 + (ra ? " " + la._570 : "");
                replaceHtmlEl(ea.find(".hint")[0], pa);
                pa = ea.find(".channel-toggle");
                ra && pa.hasClass("fa-toggle-off") && pa.addClass("fa-toggle-on").removeClass("fa-toggle-off");
                var ua = !1;
                $("#testMessage").on("click", function() {
                    ua || (serviceWorker.showNotification(),
                    ua = !0,
                    setTimeout(function() {
                        ua = !1
                    }, 5E3))
                });
                pa.on("click", function(na) {
                    var qa = na.currentTarget;
                    qa = $(replaceHtmlEl(qa.closest("div"), '<i class="fa fa-refresh fa-rotate-90 fa-spin fa-fw fw-lg"></i>&emsp;'));
                    if (ra) {
                        var ka = !0;
                        serviceWorker.unsubscribePush().fail(function() {
                            ka = !1
                        }).always(function() {
                            qa = $(replaceHtmlEl(qa.closest("div")[0], ka ? '<i class="channel-toggle fa fa-toggle-off fa-fw fa-lg"></i>&emsp;' : '<i class="channel-toggle fa fa-toggle-on fa-fw fa-lg"></i>&emsp;'));
                            F()
                        })
                    } else {
                        var za = !0;
                        serviceWorker.subscribePush().fail(function() {
                            za = !1
                        }).always(function() {
                            qa = $(replaceHtmlEl(qa.closest("div")[0], za ? '<i class="channel-toggle fa fa-toggle-on fa-fw fa-lg"></i>&emsp;' : '<i class="channel-toggle fa fa-toggle-off fa-fw fa-lg"></i>&emsp;'));
                            F()
                        })
                    }
                })
            }
        })
    }
      , I = function() {
        $("#channel-rss").find("input").on("click", function(ea) {
            ea = $(ea.currentTarget);
            ea.focus();
            ea.select()
        })
    }
      , E = function() {
        if (triggerUnsubscribe) {
            triggerUnsubscribe = !1;
            var ea = $("#idEmail")
              , ra = $("#saveEmail");
            0 != ea.val().length && (ea.val(""),
            ra.click(),
            window.location.hash = "!settings",
            setTimeout(function() {
                $("#notification-channels p").first().before('<p><span style="color: orangered;font-weight: bold;">You are now unsubscribed from our price alerts via email!</span></p>')
            }, 500))
        }
    }
      , K = function() {
        $(".channel-toggle:not(.settings)").on("click", function(ea) {
            H(ea)
        })
    }
      , H = function(ea) {
        var ra = $(ea.currentTarget)
          , pa = ra.closest(".channel-wrapper");
        if (!pa.is("#channel-browser")) {
            ea = pa.attr("id").replace(/channel-/, "");
            var ua = V(ea)
              , na = b.defaultNotificationType[ua]
              , qa = $("#idEmail");
            "email" !== ea || na || "" !== qa.val() ? ("email" === ea && na && (pa = $("#channel-settingsLightningDeals").find(".channel-toggle.fa-toggle-on"),
            pa.length && ($(pa).click(),
            $("#channel-settingsLightningDeals").effect("highlight", 1E3))),
            pa = $("#idTelegramBot"),
            "telegramBot" !== ea || na || "" !== pa.val() ? (ra = $(replaceHtmlEl(ra.closest("div")[0], '<i class="fa fa-refresh fa-rotate-90 fa-spin fa-fw fw-lg"></i>&emsp;')),
            b.defaultNotificationType[ua] = !b.defaultNotificationType[ua],
            storage.defaultNotificationType = JSON.stringify(b.defaultNotificationType),
            settings.send().done(function() {}).fail(showErrorPopup).always(function() {
                ra = $(replaceHtmlEl(ra.closest("div")[0], na ? '<i class="channel-toggle fa fa-toggle-off fa-fw fa-lg"></i>&emsp;' : '<i class="channel-toggle fa fa-toggle-on fa-fw fa-lg"></i>&emsp;'));
                ra.on("click", function(ka) {
                    H(ka)
                })
            })) : pa.click()) : (ea = $("#saveEmail"),
            0 === pa.find(".channel-error").length && ea.after('<span class="channel-error">' + la._90 + "</span>"),
            qa.focus(),
            ea.hide())
        }
    }
      , V = function(ea) {
        return {
            email: 0,
            twitter: 1,
            browser: 3,
            desktop: 3,
            facebookBot: 4,
            telegramBot: 7,
            mobileApp: 6
        }[ea]
    }
      , S = function() {
        $(".channel-toggle.settings").on("click", function(ra) {
            aa(ra)
        });
        var ea = $("#idRearm");
        ea.on("change", function(ra) {
            (ra = ea.val()) ? (ra = Number(ra),
            !ra || 1 > ra || 365 < ra ? (showPopup("Error", la._283 + 1 + la._284 + 365 + ".", !0),
            ra = "undefined" != storage.defaultNotificationInterval ? storage.defaultNotificationInterval : "",
            ea.val(0 < ra ? Number(ra) / 1440 : "")) : (set("defaultNotificationInterval", 1440 * Number(ra)),
            settings.send().done(function() {}).fail(showErrorPopup).always(function() {
                $("#channel-settingsRearmTimer").find(".channel-toggle").removeClass("fa-toggle-off").addClass("fa-toggle-on")
            }))) : (set("defaultNotificationInterval", 0),
            settings.send().done(function() {}).fail(showErrorPopup).always(function() {
                $("#channel-settingsRearmTimer").find(".channel-toggle").removeClass("fa-toggle-on").addClass("fa-toggle-off")
            }))
        })
    }
      , aa = function(ea) {
        var ra = $(ea.currentTarget);
        ea = ra.closest(".channel-wrapper").attr("id").replace(/channel-/, "");
        ra = $(replaceHtmlEl(ra.closest("div")[0], '<i class="fa fa-refresh fa-rotate-90 fa-spin fa-fw fw-lg"></i>&emsp;'));
        switch (ea) {
        case "settingsLightningDeals":
            var pa = "true" === storage.sendUpcomingLightningDealsAlert;
            set("sendUpcomingLightningDealsAlert", !pa);
            break;
        case "settingsLightningDealsStartAlerts":
            pa = "true" === storage.sendStartLightningDealsAlert;
            set("sendStartLightningDealsAlert", !pa);
            break;
        case "settingsRearmTimer":
            ea = (pa = "undefined" != storage.defaultNotificationInterval && 0 < storage.defaultNotificationInterval) ? 0 : 2;
            pa ? $("#idRearm").val("") : $("#idRearm").val(ea);
            set("defaultNotificationInterval", Number(1440 * ea).toFixed(0));
            break;
        default:
            isTest && console.info("%cSettings:", "color:blue;", "missing settings handling > ", ea)
        }
        settings.send().done(function() {}).fail(showErrorPopup).always(function() {
            var ua = (pa ? '<i class="channel-toggle fa fa-toggle-off fa-fw fa-lg"></i>&emsp;' : '<i class="channel-toggle fa fa-toggle-on fa-fw fa-lg"></i>&emsp;').replace("channel-toggle", "channel-toggle settings");
            ra = $(replaceHtmlEl(ra.closest("div")[0], ua));
            ra.on("click", function(na) {
                aa(na)
            })
        })
    };
    return {
        init: function() {
            network.request({
                path: "user/settings",
                type: "getSettings",
                version: 3
            }).done(function(ea) {
                b = ea.user;
                ea = serviceWorker.checkSupport();
                var ra = "https://vimeo.com/keepatutorials/meet-keepa-on-telegram-messenger";
                3 == storage.language && (ra = "https://vimeo.com/keepatutorials/triff-keepa-auf-dem-telegram-messenger");
                var pa = browserInfo()
                  , ua = getAppLinksAndBadges();
                pa = {
                    email: [{
                        name: la._5,
                        hint: la._562,
                        icon: "fa-envelope-o",
                        action: '<input type="text" name="email" id="idEmail" rel="ids" value="' + (storage.email || "") + '" placeholder="' + la._69 + '" /><div><i id="saveEmail" class="fa fa-floppy-o tomato fa-lg"></i>&emsp;</div>',
                        active: b.defaultNotificationType[V("email")]
                    }],
                    telegramBot: [{
                        name: "Telegram Messenger",
                        hint: la._584 + '<br><a href="' + ra + '" target="_blank"><i class="fa fa-vimeo" ></i>' + la._651 + "</a>",
                        icon: "fa-telegram",
                        action: '<input name="idTelegramBot" id="idTelegramBot" rel="ids" value="" placeholder="' + la._585 + '" readonly="readonly" type="text">&emsp;',
                        active: b.defaultNotificationType[V("telegramBot")]
                    }],
                    browser: [{
                        name: la._568,
                        hint: la._569,
                        icon: "fa-bullhorn",
                        action: "<span>" + pa.name + " " + pa.version + "</span>",
                        active: !1
                    }],
                    mobileApp: [{
                        name: la._35,
                        hint: "&rarr; " + la._929 + " &larr;",
                        icon: "fa-mobile",
                        action: '<p class="app-store-icons">\n                            <a class="app-store--android" href="' + ua.linkGooglePlay + '"\n                                target="_blank">' + ua.badgeGooglePlay + '</a>\n                            <a class="app-store--ios" href="' + ua.linkAppStore + '" \n                                target="_blank">' + ua.badgeAppStore + "</a>\n                        </p>",
                        active: !1
                    }],
                    rss: [{
                        name: la._576,
                        hint: la._577,
                        icon: "fa-rss",
                        action: '<input type="text" value="' + ajaxURL + "user/rss/?feed=" + b.rssHash + '" readonly="readonly" />',
                        active: !0
                    }]
                };
                ea || delete pa.browser;
                var na = {};
                ra = "";
                for (var qa in pa)
                    pa.hasOwnProperty(qa) && (ua = pa[qa][0],
                    na = {
                        channelIdentifier: qa,
                        channelIcon: ua.icon,
                        channelName: ua.name,
                        channelHint: ua.hint,
                        channelAction: ua.action,
                        channelToggle: ua.active ? "fa-toggle-on" : "fa-toggle-off"
                    },
                    ra += '<div id="channel-channelIdentifier" class="channel-wrapper">\n\t\t<div><i class="fa channelIcon fa-fw fa-30"></i></div>\n\t\t<div>channelName</div>\n\t\t<div><i class="channel-toggle fa channelToggle fa-fw fa-lg"></i>&emsp;</div>\n\t\t<div class="action">channelAction\n\t\t<p class="hint">channelHint</p>\n\t\t</div>\n\t\t</div>'.replace(new RegExp(Object.keys(na).join("|"),"gi"), function(J) {
                        return na[J]
                    }));
                qa = {};
                pa = storage.sendUpcomingLightningDealsAlert;
                "undefined" != typeof pa && (qa.settingsLightningDeals = {
                    name: la._402,
                    hint: la._714,
                    icon: "",
                    action: la._431,
                    active: "true" === pa
                });
                pa = storage.sendStartLightningDealsAlert;
                "undefined" != typeof pa && (qa.settingsLightningDealsStartAlerts = {
                    name: "",
                    hint: la._715,
                    icon: "",
                    action: '<span style="line-height:16px;margin:8px 0 6px;">' + la._713 + "</span>",
                    active: "true" === pa
                });
                pa = storage.defaultNotificationInterval;
                "undefined" != typeof pa && (pa = Number(pa) / 1440,
                qa.settingsRearmTimer = {
                    name: la._432,
                    hint: '<span><a target="_blank" href="https://discuss.keepa.com/t/continuous-tracking-rearm-timer/62?u=keepa"><i class="fa fa-external-link"></i>' + la._755 + "</a></span>",
                    icon: "",
                    action: '<input type="text" name="rearm" id="idRearm" rel="ids" value="' + (0 < pa ? pa : "") + '" placeholder="' + la._433 + '" class="xs" /><span>&ensp;(' + la._143 + ")</span>",
                    active: 0 < pa
                });
                pa = "";
                var ka = '<div id="channel-channelIdentifier" class="channel-wrapper">\n\t\t<div><i class="fa channelIcon fa-fw fa-30"></i></div>\n\t\t<div>channelName</div>\n\t\t<div><i class="channel-toggle fa channelToggle fa-fw fa-lg"></i>&emsp;</div>\n\t\t<div class="action">channelAction\n\t\t<p class="hint">channelHint</p>\n\t\t</div>\n\t\t</div>'.replace("channel-toggle", "channel-toggle settings"), za;
                for (za in qa)
                    ua = qa[za],
                    na = {
                        channelIdentifier: za,
                        channelIcon: "",
                        channelName: ua.name,
                        channelHint: ua.hint,
                        channelAction: ua.action,
                        channelToggle: ua.active ? "fa-toggle-on" : "fa-toggle-off"
                    },
                    pa += ka.replace(new RegExp(Object.keys(na).join("|"),"gi"), function(J) {
                        return na[J]
                    });
                replaceHtml("notification-channels", '<p class="mdc-typography--body2">' + la._586 + '</p>\n\t\t\t\t\t<div id="pseudo-form">\n\t\t\t\t\t\t' + ra + '\n\t\t\t\t\t\t\n\t\t\t\t\t\t<h4 class="mdc-typography--subheading1">' + la._948 + "</h4>\n\t\t\t\t\t\t" + pa + "\n\t\t\t\t\t</div>");
                K();
                h();
                f();
                ea && F();
                I();
                E();
                S();
                $("#loadingIcon").hide();
                addon()
            }).fail(function(ea) {
                401 === ea.status && settings.reset(!1, !1)
            })
        }
    }
}(), SettingsSubscription = function() {
    var a = [], b, d, h, m, t, f, n, r, p, z, F, I = function() {
        a = [];
        p = z = r = n = f = t = m = h = d = b = null
    };
    I();
    var E = function() {
        return network.request({
            path: "service/stripe",
            type: "offers",
            includeData: !0,
            dashboard: "data",
            version: 3
        }).done(function(q) {
            if (q.offers) {
                I();
                b = q.offers;
                r = q.source;
                p = q.balance;
                f = q.invoices;
                n = q.pendingInvoices;
                q.payments && (d = q.payments.payments,
                h = q.payments.subscriptions,
                m = q.subscriptionStatus,
                z = q.payments.lastDowngrade);
                null == h && (h = []);
                t = q.paymentStatus;
                F = null != t && 5 < t[0];
                isTest && console.info("%cgetOffersAndSubscriptionStatus:", "color:green", q);
                q = !1;
                try {
                    if (null != h)
                        for (var L = h.length - 1; 0 <= L; L--) {
                            var A = h[L];
                            "Data_Access_Year" != A.payedService && "Data_Access_Year_19" != A.payedService || 0 < A.paymentReceivedDate || 0 < A.paymentCancelledDate || (q = !0)
                        }
                } catch (v) {
                    reportBug(v)
                }
                L = null != m && null != m.services && (-1 < m.services.indexOf("Data_Access_Year") || -1 < m.services.indexOf("Data_Access_Year_19"));
                A = !L && null != m && null != m.services && (-1 < m.services.indexOf("Data_Access") || -1 < m.services.indexOf("Data_Access_19"));
                for (var O in b.PayedService) {
                    var P = b.PayedService[O]
                      , M = "DATA" == P.type
                      , u = "DATA_YEAR" == P.type;
                    if (!(q && M || !u && !M || M && L || u && A) && (!u || L || A || q)) {
                        M = b.PayedServiceTypes[P.type];
                        P = b.PayedServiceVariants[P.variant];
                        P = {
                            sku: O,
                            name: M.description,
                            description: M.variantDescription,
                            hint: 'This includes the product details, offers table and variation data export, as \n\t\t\t\t\t\t\t\twell as the product list imports and exports, best seller, top seller and seller \n\t\t\t\t\t\t\t\tstorefront lists. Also included is the Product Finder and the Category Tree.<br><br>\n\t\t\t\t\t\t\t\t<a class=\'quota-info\'>Access is subjected to a daily usage quota to prevent \n\t\t\t\t\t\t\t\tabuse.</a> More details can be found <a href="https://discuss.keepa.com/t/data-features-access-free-vs-monthly-subscription/5845" target="_blank">here.</a><br>\n\t\t\t\t\t\t\t\tImportant note: Account sharing is not allowed.<br>\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\tAdditional parts of the subscription:<br>\n\t\t\t\t\t\t\t\t- Access to interactive <b>Sales Rank history</b> graphs<br>\n\t\t\t\t\t\t\t\t- Access to interactive <b>Buy Box price history</b> graphs<br>\n\t\t\t\t\t\t\t\t- Access to interactive <b>eBay price history</b> graphs<br>\n\t\t\t\t\t\t\t\t- Access to interactive <b>Offer Count and Review/Rating history</b> graphs<br>\n\t\t\t\t\t\t\t\t- Basic access to our API with 5 token/min<br>\n\t\t\t\t\t\t\t\t- Price increase tracking<br><br>\n                                &raquo;<a style="cursor:alias !important;font-style:italic;" class="link--terms">Terms and Conditions</a><br>\n\t\t\t\t\t\t\t',
                            bucketSize: P.variant,
                            interval: P.interval,
                            currencyDomainId: 3,
                            price: P.price,
                            active: !0,
                            paymentPending: !1,
                            subscribed: m ? m.hasActiveSubscription && !m.hasOnlyAPISubscription : !1,
                            subscribedTill: m ? m.dataEndDate : 0
                        };
                        P.priceFormatted = Money.format(P.price, {
                            sourceDomainId: P.currencyDomainId,
                            targetDomainId: P.currencyDomainId,
                            noDigits: !0,
                            forceEuropeanStyle: !0
                        });
                        if (null != h)
                            for (u = h.length - 1; 0 <= u; u--)
                                if (M = h[u],
                                M.payedService == O) {
                                    u = 0 == M.subscriptionStart ? "-" : (new Date(M.subscriptionStart)).formatDate("M j, Y");
                                    P.subscriptionStart = M.subscriptionStart;
                                    P.startDate = u;
                                    P.createDate = (new Date(M.createDate)).formatDate("M j, Y");
                                    P.createDateRaw = M.createDate;
                                    P.paymentPending = 0 == M.paymentReceivedDate && 0 == M.paymentCancelledDate;
                                    P.endDate = 0 == M.subscriptionStart ? "-" : (new Date(M.subscriptionStart + M.subscriptionDuration)).formatDate("M j, Y");
                                    P.cancel_at_period_end = M.cancel_at_period_end;
                                    P.paymentCancelledDate = M.paymentCancelledDate;
                                    P.paymentProvider = M.paymentProvider;
                                    P.subscriptionId = M.subscriptionId;
                                    P.quantity = M.quantity;
                                    break
                                }
                        a[O] = P
                    }
                }
            } else
                showErrorPopup()
        }).fail(function() {
            showErrorPopup()
        })
    }
      , K = function() {
        replaceHtml("subscriptions-tab", '<div id="loadingIconPopup"></div>');
        $("#loadingIconPopup").show()
    }
      , H = function(q) {
        if (0 == storage.accountType)
            replaceHtml("settingsBox", '<span class="subsubHeadline2">' + la._52 + "</span><br>" + la._53),
            $("#settingsSelect").hide(),
            $("#settingsBox").show(),
            $("#settingsTabs").css("borderTop", "0px"),
            setTimeout(function() {
                showLoginOverlay()
            }, 1);
        else if (q || "" === $("#subscriptions-tab").html())
            K(),
            E().done(V)
    }
      , V = function() {
        var q = ""
          , L = !1;
        for (G in a) {
            var A = a[G];
            if (!0 !== A.active && !0 !== A.subscribed)
                return;
            var O = "";
            if (null == A.startDate || A.paymentPending || 0 != A.paymentCancelledDate) {
                var P = [];
                for (w in b.PayedServiceVariants)
                    if (w.startsWith("DATA_BASIC")) {
                        var M = b.PayedServiceVariants[w];
                        P.push(Money.format(M.price, {
                            sourceDomainId: A.currencyDomainId,
                            targetDomainId: A.currencyDomainId,
                            noDigits: !0,
                            forceEuropeanStyle: !0
                        }) + " / " + M.interval)
                    }
                O += '<p><i class="fa fa-fw fa-info-circle"></i>' + P.join(" or ") + "</p>"
            } else
                O += '<p><i class="fa fa-fw fa-calendar-o"></i>Subscribed since ' + A.createDate + "</p>";
            if (null != A.endDate && !A.paymentPending && 0 == A.paymentCancelledDate) {
                P = '<i class="fa fa-fw fa-' + (A.cancel_at_period_end ? "ban" : "refresh") + '"></i>';
                M = "";
                if (null != f)
                    for (var u = 0; u < f.length; u++) {
                        var v = f[u];
                        if (v.subscription.id == A.subscriptionId) {
                            M = Money.format(v.amountDue, {
                                sourceDomainId: A.currencyDomainId,
                                targetDomainId: A.currencyDomainId,
                                noDigits: !1,
                                forceEuropeanStyle: !0
                            });
                            break
                        }
                    }
                if (null != n)
                    for (u = 0; u < n.length; u++)
                        if (n[u].subscription.id == A.subscriptionId) {
                            A.paymentPending = !0;
                            break
                        }
                O += "<p>" + (A.cancel_at_period_end ? '<span style="color:#ff6347">' + P + "Will terminate on " + A.endDate + "</span>" : P + "Will renew on " + A.endDate) + "</p>";
                A.cancel_at_period_end && "Complimentary" != A.paymentProvider && (O += '<p><i class="fa fa-fw fa-repeat"></i><span class="href" rel="' + A.subscriptionId + '" id="resumeSub">Resume subscription</span></p>');
                1 < A.quantity && (O += '<p><i class="fa fa-fw fa-info"></i><span style="font-weight:bold;">' + A.quantity + "</span> active Data subscriptions</p>");
                O += "" == M ? "" : '<p><i class="fa fa-fw fa-money"></i>Upcoming charge ' + M + "</p>";
                if (!A.cancel_at_period_end && !A.paymentPending) {
                    if ("Data_Access" == A.sku || "Data_Access_19" == A.sku)
                        O += '<p class="subdetails__yearly" data-sku="' + A.sku + '" title="Save 20% by changing your billing cycle from monthly to yearly">\n                        <i class="fa fa-fw fa-clock-o"></i>Switch to yearly\n                    </p>';
                    O += '<p class="subdetails__upgrade" data-sku="' + A.sku + '" title="Upgrade your data access to increase your daily quota">\n                        <i class="fa fa-fw fa-pencil"></i>' + (1 < A.quantity ? "Upgrade or Downgrade" : "Upgrade") + "\n                    </p>";
                    O += '<p class="subdetails__update-billing" data-sku="' + A.sku + '">\n\t\t\t\t\t\t\t<i class="fa fa-fw fa-book"></i>Update invoice address \n\t\t\t\t\t\t</p>'
                }
                A.cancel_at_period_end || (L = !0)
            }
            A.paymentPending && (O = 18E4 < Date.now() - A.createDateRaw ? '<div id="retryPayment" data-id="' + A.subscriptionId + '"><span style="color:tomato;">Payment failed.<br><span>Try again now <i class="fa fa-repeat"></i></span></span></div>' : '<div><span style="color:orange;">Payment pending<i id="refreshSubscription" class="fa fa-refresh"></i></span></div>');
            P = A.priceFormatted;
            1 < A.quantity && A.subscribed && (P = Money.format(A.price * A.quantity, {
                sourceDomainId: A.currencyDomainId,
                targetDomainId: A.currencyDomainId,
                noDigits: !0,
                forceEuropeanStyle: !0
            }));
            u = M = void 0;
            A.subscribed && A.cancel_at_period_end || A.disabled ? u = A.cancel_at_period_end ? "Subscription is cancelled" : A.paymentPending ? "Payment pending" : "" : M = material.getButton("toggleSubscription-" + A.sku, A.subscribed ? "Cancel" : "Subscribe", A.subscribed ? "ban" : "lock", null, !1, A.subscribed ? !0 : !1);
            v = A.description.replace("Data", '<a href="#!data">Data</a>');
            q += '<div class="sub-wrapper' + (!0 === A.disabled ? " disable" : "") + '">\n                    <div>' + (M ? M : u) + "</div>\n\t\t\t\t\t<div>\n                        " + A.name + " " + (A.subscribed ? "- " + P + " / " + A.interval : "") + "\n\t\t\t\t\t\t" + (1 < A.quantity && A.subscribed ? '<p style="margin-bottom: 4px;">Base price: ' + A.priceFormatted + " / " + A.interval + "</p>" : "") + "\n                        " + O + '       \n                    </div>\n\t\t\t\t\t<div class="description">' + v + '\n\t\t\t\t\t\t<p class="hint">' + A.hint + "</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>"
        }
        var G = ea();
        O = L ? createCreditCard(r) : "<br>";
        var w = F ? '<p class="mdc-typography--body2" style="font-weight: bold;">\n\t\t\t\t<a href="#!api" class="href"><i class="fa fa-long-arrow-right"></i> View your API subscription&ensp;<i class="fa fa-external-link"></i></a>\n\t\t\t</p>' : "";
        P = m && m.hasActiveSubscription && m.hasOnlyAPISubscription ? '<p><span style="color:#3cb371;">\n\t\t\t\tYou have automatically been granted access to our Data features via your currently active API subscription. No need to subscribe.</span><br>\n\t\t\t\tIn case you need to increase your daily quota you can of course subscribe to additional packages.\n\t\t\t</p>' : "";
        q = "<p>Keepa can be used <span>free of charge</span>.<br><br>\n\t\t\tFor our most advanced users we offer subscriptions that provide access to <span>premium features</span>.<br>\n\t\t\t</p>\n\t\t\t" + P + "\n\t\t\t<div>" + q + '</div>\n\t\t\t<div id="subscriptions-form"></div>';
        M = p && 0 > p ? '<div><span style="color:#000">Your current account balance:&emsp;<i class="fa fa-fw fa-money"></i> \n\t\t\t' + Money.format(-1 * p, {
            sourceDomainId: 3,
            targetDomainId: 3,
            noDigits: !1,
            forceEuropeanStyle: !0
        }) + "</span>&ensp;(will be applied to future invoices)</div>" : "";
        u = L && 0 === P.length ? '<br>\n\t\t\t\t&raquo; How do I cancel my subscription?<br>\n\t\t\t\tJust click on the orange "Cancel" button and confirm to unsubscribe. Your subscription then will terminate on the end of your current billing cycle.' : "";
        A = "Data_Access" !== A.sku && "Data_Access_19" !== A.sku || !L || 0 !== P.length ? "" : '<br>\n\t\t\t\t&raquo; How do I switch from a monthly plan to a yearly one?<br>\n\t\t\t\tClick on the blue label "Switch to yearly".';
        replaceHtml("subscriptions-tab", w + q + ('<p style="font-style: italic;">\n\t\t\t\t<i class="fa fa-question-circle"></i> Questions? Have a look at our <a href="https://discuss.keepa.com/t/faq-payments-premium-access/7819" target="_blank">FAQ - Payments premium access</a>  or <a target="_blank" href="mailto:info@keepa.com?subject=Questions about Keepa Data Subscription" title="info@keepa.com">contact us via e-mail.</a>&emsp;\n\t\t\t\t' + (u || A ? "<br>The most commonly asked questions:" : "") + "\n\t\t\t\t" + u + "\n\t\t\t\t" + A + "\n\t\t\t</p>") + O + M + G);
        $(".quota-info").on("click", function() {
            showPopup("Data Access Quota", infoQuotaGeneral, !0)
        });
        $(".link--terms").on("click", function() {
            N()
        });
        $(".editCard").colorTip({
            color: "darkgrey"
        });
        $("#editCC, #addCC").on("click", aa);
        $("#removeCC").on("click", function() {
            var B = showPopup("Delete Credit Card", 'This will delete your attached credit card. Your subscription will terminate unless you provide a new payment method before the end of your billing cycle. Do you want to continue?<br><br><span class="button" id="deleteTokenConfirm">&ensp;Yes&ensp;</span>', !0);
            $("#deleteTokenConfirm").on("click", function() {
                B.close();
                network.request({
                    path: "service/stripe",
                    type: "deleteSource",
                    dashboard: "data",
                    version: 3
                }).done(function(Q) {
                    setTimeout(function() {
                        showPopup("Payment method removed!", "Your payment method was successfully deleted.", !0);
                        H(!0)
                    }, 300)
                }).fail(function(Q) {
                    setTimeout(function() {
                        showPopup("Removal issue", Q, !0)
                    }, 300)
                })
            })
        });
        $("#resumeSub").on("click", function(B) {
            B = $("#resumeSub").attr("rel");
            var Q = null;
            for (fa in a)
                a[fa].subscriptionId == B && (Q = a[fa]);
            var fa = material.getButton("resumeSubscription", "Resume Subscription", "repeat", null, !1, !1);
            var R = showPopup("Resume subscription " + Q.name, "<div>This will remove your cancellation and continue automatic renewals of your subscription, beginning on " + Q.endDate + " - the end of your current billing cycle.</div><br><br>" + fa, !0);
            $("#resumeSubscription").on("click", function() {
                K();
                R.close();
                network.request({
                    path: "service/stripe",
                    type: "resumeSubscription",
                    subscriptionId: Q.subscriptionId,
                    dashboard: "data",
                    version: 3
                }).done(function() {
                    H(!0)
                }).fail(showErrorPopup)
            })
        });
        ra()
    }
      , S = !1
      , aa = function() {
        if (!S) {
            S = !0;
            var q = h[h.length - 1];
            priceDataAPI.cardPayment.getAuthenticatedSource("pk_live_vZtwJ2C0mPQs55shQOZtruWI", f && 0 < f.length ? f[0].amountDue : q.totalBill, !0, q).done(function(L) {
                setTimeout(function() {
                    showPopup("Payment method updated!", "Your payment method for future payments was successfully updated.", !0);
                    H(!0)
                }, 300)
            }).fail(function(L) {
                setTimeout(function() {
                    showPopup("Payment issue", L, !0)
                }, 300)
            }).always(function() {
                S = !1
            })
        }
    }
      , ea = function() {
        if (null != d) {
            for (var q = '<br><hr class="hr -green"><div>Receipts:</div><br><table class="paymentTable"><tr><th>Date</th><th>Total</th><th>Price Plan</th><th>Start Date</th><th>End Date</th><th>Payment Method</th><th>Type</th><th>Invoice</th><th>Status</th></tr>', L = d.length - 1; 0 <= L; L--) {
                var A = d[L]
                  , O = A.totalBill - A.creditApplied
                  , P = 0 == A.subscriptionStart ? "-" : (new Date(A.subscriptionStart)).formatDate("M j, Y")
                  , M = 0 == A.subscriptionStart ? "-" : (new Date(A.subscriptionStart + A.subscriptionDuration)).formatDate("M j, Y")
                  , u = Money.format(O, {
                    sourceDomainId: 3,
                    targetDomainId: 3,
                    forceEuropeanStyle: !0
                })
                  , v = "";
                showReferencePrice(3) && (v = ' <span class="price__reference">(~ ' + Money.format(O, {
                    sourceDomainId: 3
                }) + ")</span>");
                q += "<tr>\n\t\t\t\t\t\t\t<td>" + (new Date(A.createDate)).formatDate("M j, Y") + "</td> \n\t\t\t\t\t\t\t<td>" + u + v + "</td> \n\t\t\t\t\t\t\t<td>" + ((1 < A.quantity ? A.quantity + "x " : "") + A.payedService.replace(/_/g, " ").replace(" 19", "")) + "</td>\n\t\t\t\t\t\t\t<td>" + P + "</td>\n\t\t\t\t\t\t\t<td>" + M + "</td>\n\t\t\t\t\t\t\t<td>" + (0 > O ? "Credit" : 0 == A.totalBill ? "-" : A.paymentProvider) + "</td>\n\t\t\t\t\t\t\t<td>" + (A.isUpgrade ? "Upgrade" : "Regular") + "</td>\n\t\t\t\t\t\t\t<td>" + (0 > O || 0 == O && 0 == A.creditApplied ? " - " : '<a download class="darkgrey" href="' + ajaxURL + "api/service/?user=" + storage.token + "&type=getInvoicePDF&billId=" + A.billId + '"><i class="fa fa-file-pdf-o"></i> Download</a>') + "</td>\n\t\t\t\t\t\t\t<td>" + (0 > O || 0 == O && 0 == A.creditApplied ? '<span style="color: #999;font-style: italic;">free</span>' : 0 == O ? '<span style="color: #999;font-style: italic;">paid with credit</span>' : 0 < A.paymentReceivedDate && 0 < A.paymentCancelledDate ? '<span style="color:#2196F3">Refunded (' + (new Date(A.paymentCancelledDate)).formatDate("M j") + ")</span>" : 0 != A.paymentReceivedDate ? '<span class="green">Payment Received</span>' : 0 != A.paymentCancelledDate ? '<span class="red">Cancelled (' + (new Date(A.paymentCancelledDate)).formatDate("M j") + ")</span>" : "Pending") + "</td>\n\t\t\t\t\t\t</tr>"
            }
            return q + "</table>"
        }
        return ""
    }
      , ra = function() {
        $("#refreshSubscription").on("click", function(q) {
            H(!0)
        });
        $(".sub-wrapper .mdc-button").on("click", function(q) {
            q.preventDefault();
            q = $(q.currentTarget);
            var L = a[q.attr("id").replace("toggleSubscription-", "")];
            if (L.subscribed) {
                q = material.getButton("cancelSubscription", "Cancel Subscription", "ban", null, !1, !0);
                var A = showPopup("Cancel subscription " + L.name, "<div>" + (L.paymentPending ? "If you cancel your subscription it will terminate immediately." : "If you cancel your subscription it will terminate on " + L.endDate + " - the end of your current billing cycle.") + "</div>" + ("Data_Access_Year" == L.sku || "Data_Access" == L.sku ? "<br><div style='font-style: italic;color: #8a2424;'>Note:<br>Our Data subscription fees are 19 \u20ac / month since May 2021 for new subscriptions.<br>Should you ever decide to subscribe again the higher fees will apply.</div>" : "") + "<br><br>" + q, !0);
                $("#cancelSubscription").on("click", function() {
                    K();
                    A.close();
                    var O = {
                        path: "service/stripe",
                        type: "cancelSubscription",
                        subscriptionId: L.subscriptionId,
                        dashboard: "data",
                        version: 3
                    };
                    L.paymentPending && (O.cancelNow = !0);
                    network.request(O).done(function() {
                        H(!0)
                    }).fail(showErrorPopup)
                })
            } else
                network.request({
                    path: "user/settings",
                    type: "getSettings",
                    version: 3
                }).always(function(O) {
                    (O = O.user) && O.emailAddress && -1 != O.emailAddress.indexOf("@") && settings.isEmailVerified ? pa(L) : showPopup(L.name + " - Subscription", la._428, !0)
                })
        });
        $(".subdetails__upgrade").on("click", function() {
            za($(this).data("sku"))
        });
        $(".subdetails__yearly").on("click", function() {
            J($(this).data("sku"))
        });
        $(".subdetails__update-billing").on("click", function() {
            qa($(this).data("sku"))
        });
        $("#retryPayment").on("click", function() {
            na($(this).data("id"))
        })
    }
      , pa = function(q) {
        isTest && console.info("%cinitCheckoutForm sub:", "color:orange", q);
        var L = network.request({
            path: "service/stripe",
            type: "location",
            dashboard: "data",
            version: 3
        });
        network.request({
            path: "service/stripe",
            type: "countries",
            dashboard: "data",
            version: 3
        }).done(function(A) {
            L.done(function(O) {
                var P = "";
                showReferencePrice(q.currencyDomainId) && (P = ", ~ " + Money.format(q.price, {
                    sourceDomainId: q.currencyDomainId
                }));
                P = q.priceFormatted + " (incl. VAT" + P + ")";
                showPopup(q.name + " - Subscription", '<div id="formContent"></div>' + ua(A.countries, O.json ? tryParseJSON(O.json) : null, q, P, function() {}) + '<div style="width=300px" id="loadingIconPopup"></div>', !0).promise.always(function() {
                    H(!0)
                })
            })
        }).fail(function() {
            showErrorPopup()
        })
    }
      , ua = function(q, L, A, O, P) {
        if (0 < $("#checkoutForm").length)
            return null;
        if (2 != storage.accountType)
            return "<div>Before you can continue you have to sign in.</div>";
        if (!storage.email || -1 == storage.email.indexOf("@") || !settings.isEmailVerified)
            return "<div>" + la._428 + "</div>";
        var M = $.Deferred()
          , u = material.getRadio("monthly", "19 \u20ac / Month", !0, "interval")
          , v = material.getRadio("yearly", "189 \u20ac / Year", !1, "interval")
          , G = material.getRadio("individual", "Individual", !0, "bcb")
          , w = material.getRadio("business", "Business", !1, "bcb")
          , B = '<div style="width: 204px;"> ' + material.getInput(!0, ".*\\S{3,}.*", "formName", "Full name", "billing name", "name", "required", !1, !0) + "</div>"
          , Q = '<div style="width: 384px;">' + material.getInput(!0, ".*\\S{2,}.*", "formAddress", "Address", "billing street-address", "ship-address", "billing address is required", !1, !0) + "</div>"
          , fa = "<div>" + material.getInput(!0, ".*\\S{2,}.*", "formCity", "City", "billing address-level2", "ship-city", "City is required", !1, !0) + "</div>"
          , R = "<div>" + material.getInput(!0, ".*\\S{2,}.*", "formPostcode", "Postal code", "billing postal-code", "ship-zip", "billing ZIP / postal code", !1, !0) + "</div>"
          , T = ba(!1)
          , oa = [];
        for (Z in priceDataAPI.statesUS)
            oa.push({
                value: Z,
                label: Z
            });
        oa = '<div style="margin-top:12px;" id="formStateWrapper">' + material.getSelect("formState", "billing-state", "", oa, "State", !1, !0) + "</div>";
        L = material.getCountrySelect(q, L ? L.country : "");
        var Z = material.getCheckbox("terms", 'I have read and accept the <a style="cursor: alias !important;"  id="terms" class="href" >Terms and Conditions</a>.', !1, !0, "terms");
        var ja = material.getInput(!1, verifyRegExp.vatId.source, "formVatId", "VAT ID", "billing vat-id", "vatId", "e.g. DE999999999", !1, !1)
          , W = material.getButton("submitCheckout", "Subscribe now", "lock")
          , Aa = O + " every month"
          , Ca = O.replace("incl.", "excl.") + " every month";
        O = '<form id="checkoutForm" style="width: 600px; display:none">\n\t\t\t\t\t\t' + (m && m.hasActiveSubscription && m.hasOnlyAPISubscription ? '<p><span style="color:#3cb371;font-weight:bold;">\n\t\t\t\tYou have automatically been granted access to our Data features via your currently active API subscription. No need to subscribe.</span><br>\n\t\t\t\tIn case you need to increase your daily quota you can of course subscribe to additional packages.<br><br>\n\t\t\t</p>' : "") + '\n\t\t\t\t\t\t<section id="b2bRadio" >' + G + w + '<span class="sub_hint sub_hint--radio" title="Only required for tax purposes. Both offer the same features."><i class="fa fa-question-circle"></i></span></section>\n\t\t\t\t\t\t<div class="flex" style="justify-content: space-between;">' + B + Q + '</div>\n\t\t\t\t\t\t<div class="flex" style="justify-content: space-between;">' + L + '<div class="flex" style="width: 384px;justify-content: space-between;">' + fa + R + oa + "</div></div>\n\t\t\t\t\t\t" + ja + '\n\t\t\t\t\t\t<div id="vatIdErrors" style="display:none;"></div>\n\t\t\t\t\t\t' + T + '\n\t\t\t\t\t\t<section id="intervalRadio" >' + u + v + '</section>\n\t\t\t\t\t\t<div class="flex" style="justify-content: space-between;">' + Z + W + '</div>\n\t\t\t\t\t\t<aside class="mdc-typography--subtitle2" style="margin-top: 10px;color: brown;"><i class="fa fa-exclamation" ></i>&emsp;\nYou will be charged <span id="subPrice"> ' + (Aa + "</span>.\n</aside> <div>Cancellation of the subscription is possible at any time and will end the subscription at the end of the term. The subscription will automatically renew unless cancelled and all payments are non-refundable.</div>\n\t\t\t\t\t</form>");
        material.init("#checkoutForm");
        setTimeout(function() {
            var Ba = $("#b2bRadio")
              , ta = $("#intervalRadio")
              , Ea = $("#countrySelect")
              , va = 0
              , da = function() {
                var ca = "business-radio" == Ba.find(":checked")[0].id
                  , ha = ca && q[Ea.find(":selected")[0].id].isEU;
                $("#formVatId").parent()[ha ? "slideDown" : "hide"](va);
                $("#formVatId-validation-msg")[ha ? "slideDown" : "hide"](va);
                $("#formName").next("label").text(ca ? "Company" : "Full name");
                ha = "yearly-radio" == ta.find(":checked")[0].id;
                $("#subPrice").text(ha ? ca ? "189 \u20ac (excl. VAT) every year" : "189 \u20ac (incl. VAT) every year" : ca ? Ca : Aa);
                $("#vatIdErrors").hide();
                ca = "US" == $(Ea.find(":selected")).attr("id");
                ha = $("#formStateWrapper");
                var C = ha.find("select");
                ca ? (C.prop("disabled", !1),
                C.prop("required", !0),
                ha.css({
                    visibility: "visible"
                })) : (C.val(""),
                C.prop("disabled", !0),
                C.prop("required", !1),
                ha.css({
                    visibility: "hidden"
                }))
            };
            [Ba, Ea].map(function(ca) {
                return ca.on("change", da)
            });
            ta.on("change", function() {
                var ca = "yearly-radio" == ta.find(":checked")[0].id
                  , ha = "business-radio" == Ba.find(":checked")[0].id;
                $("#subPrice").text(ca ? ha ? "189 \u20ac (excl. VAT) every year" : "189 \u20ac (incl. VAT) every year" : ha ? Ca : Aa);
                ca ? $("#formCoupon").parent().children().hide("slow") : $("#formCoupon").parent().children().show("slow")
            });
            da();
            $("#checkoutForm").fadeIn("slow");
            va = 250;
            $("#checkoutForm").find(".sub_hint").colorTip({
                color: "facebook"
            });
            priceDataAPI.loadStripe("pk_live_vZtwJ2C0mPQs55shQOZtruWI").done(function(ca) {
                var ha = ca.elements().create("card", {
                    style: {
                        base: {
                            iconColor: "#8898AA",
                            color: "#000",
                            lineHeight: "36px",
                            fontWeight: 300,
                            fontSize: "1rem",
                            "::placeholder": {
                                color: "rgba(0, 0, 0, 0.6)"
                            }
                        },
                        invalid: {
                            iconColor: "#e85746",
                            color: "#e85746"
                        }
                    },
                    hidePostalCode: !0
                });
                ha.mount("#card-element");
                $("#checkoutForm").on("submit", function(C) {
                    C.preventDefault();
                    $("#vatIdErrors").hide();
                    Y();
                    var U = $("#checkoutForm");
                    U.find("#formName").val();
                    U.find("#formPostcode").val();
                    C = "yearly-radio" == ta.find(":checked")[0].id;
                    var ia = {
                        payedService: C ? "Data_Access_19" == A.sku ? "Data_Access_Year_19" : "Data_Access_Year" : A.sku,
                        paymentProvider: "CreditCard",
                        coupon: C ? "" : U.find("#formCoupon").val(),
                        billingContact: U.find("#formName").val().trim(),
                        billingStreet: U.find("#formAddress").val().trim(),
                        billingCity: U.find("#formCity").val().trim(),
                        billingZipCode: U.find("#formPostcode").val().trim(),
                        billingState: U.find("#formState").val(),
                        billingCountry: U.find("#countrySelect").find(":selected")[0].getAttribute("data-country"),
                        billingVatId: U.find("#formVatId").val().replace(/[-,;_:#. ]/g, ""),
                        billingBusiness: "business-radio" == Ba.find(":checked")[0].id
                    };
                    !0 !== ia.billingBusiness && (ia.billingVatId = "");
                    C = U.find("#countrySelect").find(":selected")[0].id;
                    !0 !== q[C].isEU && (ia.billingVatId = "");
                    var X = {
                        billingContact: "formName",
                        billingStreet: "formAddress",
                        billingCity: "formCity",
                        billingZipCode: "formPostcode"
                    }
                      , sa = !0;
                    ["billingContact", "billingStreet", "billingCity", "billingZipCode"].forEach(function(Ga) {
                        if (ia[Ga].length < ("billingContact" === Ga ? 3 : 2)) {
                            sa = !1;
                            Ga = "#" + X[Ga];
                            var Da = $(Ga);
                            document.querySelector(Ga).parentNode.MDCTextField.value = "";
                            Da.attr("required", !0)
                        }
                    });
                    var wa = !0;
                    !0 !== U.find("#terms-checkbox").prop("checked") && (wa = !1);
                    if (sa && wa) {
                        var xa = function(Ga) {
                            Y();
                            network.request({
                                path: "service/stripe",
                                type: "subscription",
                                content: JSON.stringify(ia),
                                dashboard: "data",
                                version: 3
                            }).done(function(Da) {
                                busy = !1;
                                console.info("payment 9a data...");
                                var Ma = function(Ja) {
                                    var Pa = material.getButton("closePopup", "Attempt payment again", "credit-card", null, !1, !1)
                                      , Oa = '<section><span class"tomato">Your credit card could not be charged. ' + (null != Ja.errorMsg ? Ja.errorMsg : "") + "</span></section>";
                                    300 <= Ja.code && (Oa = 405 == Ja.code ? '<div><span class"tomato">The coupon code you have entered is not valid.</span></div>' : '<div><span class"tomato">' + (Ja.errorMsg ? Ja.errorMsg : "") + " Your order was aborted and your credit card could not be charged. Please repeat the process with a valid credit card. We accept Visa, MasterCard and American Express.</span></div>");
                                    var Ha = showPopPopup("Error processing payment", Oa + "<br><div>" + Pa + "</div>", !0);
                                    ma();
                                    addon();
                                    var ya = !1;
                                    $("#closePopup").on("click", function(Na) {
                                        Na.preventDefault();
                                        null != Ja.url && (window.open(Ja.url),
                                        ya = !0);
                                        Ha.close();
                                        M.resolve({
                                            updated: ya
                                        })
                                    })
                                }
                                  , Qa = function() {
                                    var Ja = "";
                                    Da.couponMsg && (Ja = '<br><div style="color:darkgreen">' + Da.couponMsg + "</div><br>");
                                    U.html('<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div style="color:#00b753; font-size: 16px;"><i class="fa fa-check-circle-o" ></i>&emsp;Thank you for subscribing!</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br>You have successfully signed up for the Data subscription with the account: <span style="color:#00b753;font-weight:bold;">' + storage.username + "</span><br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\tOnce we have processed the payment your subscription will be activated. This usually takes less than a minute. You might have to reload Keepa.<br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t" + Ja + "<br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t" + infoQuotaGeneral + "\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>");
                                    $("#formContent").html("");
                                    if (Ja = storage.showGraphs) {
                                        Ja = JSON.parse(Ja);
                                        for (var Pa in CsvType)
                                            "object" === typeof CsvType[Pa] && graphIsRestricted(Number(storage.domain), CsvType[Pa].index, !0) && ![CsvType.EBAY_NEW_SHIPPING.index, CsvType.EBAY_USED_SHIPPING.index].includes(Number(CsvType[Pa].index)) && (Ja[CsvType[Pa].index] = 1);
                                        storage.showGraphs = JSON.stringify(Ja);
                                        storage.moreData = 1;
                                        storage.showSalesRankGraph = 1;
                                        settings.send()
                                    }
                                    P(!0)
                                };
                                if (300 <= Da.code || null != Da.errorMsg)
                                    Ma(Da);
                                else if (null == Da.paymentIntent)
                                    Qa(),
                                    ma();
                                else
                                    switch (Da.paymentIntent.status) {
                                    case "succeeded":
                                        Qa();
                                        ma();
                                        break;
                                    case "requires_payment_method":
                                        Ma(Da);
                                        ma();
                                        break;
                                    case "requires_action":
                                        console.info("payment 10..."),
                                        priceDataAPI.loadStripe("pk_live_vZtwJ2C0mPQs55shQOZtruWI").done(function(Ja) {
                                            console.info("payment 11...");
                                            Ja.handleCardPayment(Da.paymentIntent.clientSecret).then(function(Pa) {
                                                ma();
                                                console.info("payment 12...");
                                                Pa.error ? (Da.errorMsg = Pa.error.message,
                                                Ma(Da)) : Qa()
                                            })
                                        }).fail(function() {
                                            ma();
                                            showErrorPopup()
                                        })
                                    }
                            }).fail(function(Da) {
                                $("#formContent").html("");
                                console.info(Da.status);
                                U.html(Da.errorMsg || la._error);
                                ma()
                            })
                        }
                          , Ia = function() {
                            ta.find(":checked");
                            priceDataAPI.cardPayment.getAuthenticatedSource("pk_live_vZtwJ2C0mPQs55shQOZtruWI", Number(A.price), !1, ia, ha, U.find("#formName").val().trim()).done(function(Ga) {
                                xa()
                            }).fail(function(Ga) {}).always(function() {})
                        }
                          , Fa = $("#vatIdErrors");
                        priceDataAPI.validateVatIdPromise({
                            paymentIntentRequest: ia,
                            countryCode: C,
                            isEu: q[C].isEU
                        }).done(function(Ga) {
                            isTest && console.info("%cvalidationPromiseResult:", "color:orange", Ga);
                            null == Ga || !0 !== Ga.success ? (priceDataAPI.handleValidateVatIdError(Ga, $("#vatIdErrors")),
                            ma()) : !0 === Ga.valid && 0 === Ga.invalidFields.length ? (isTest && (!0 === Ga.validationNeeded ? console.info("%cVatId:", "color:green", "everything is valid - proceed with createSource...") : console.info("%cVatId:", "color:green", "no validation needed - proceed with createSource...")),
                            Ia()) : (Fa.html(Ga.msg),
                            Fa.show(),
                            ma())
                        }).fail(function(Ga) {
                            priceDataAPI.handleValidateVatIdError(Ga, Fa);
                            ma()
                        });
                        return !1
                    }
                    ma()
                })
            });
            $("#terms").on("click", function(ca) {
                ca.preventDefault();
                N();
                return !1
            });
            var Y = function() {
                $("#checkoutForm").hide();
                $("#loadingIconPopup").show()
            }
              , ma = function() {
                $("#checkoutForm").show();
                $("#loadingIconPopup").hide()
            }
        }, 0);
        return O
    }
      , na = function(q) {
        K();
        var L = function(A) {
            H(!0);
            setTimeout(function() {
                showErrorPopup()
            }, 500)
        };
        network.request({
            path: "service/stripe",
            type: "getHostedInvoice",
            subscriptionId: q,
            dashboard: "data",
            version: 3
        }).done(function(A) {
            A.url && 0 < A.url.length ? window.location.href = A.url : L(A)
        }).fail(function(A) {
            L(A)
        })
    }
      , qa = function(q) {
        if (q) {
            var L = a[q];
            "undefined" === typeof L ? isTest && console.info("%cSub is undefined!", "color:red; ", q) : network.request({
                path: "service/stripe",
                type: "countries",
                dashboard: "data",
                version: 3
            }).done(function(A) {
                A = ka(L, A.countries);
                var O = showPopup("Update invoice address", A.html + '<div style="width=300px" id="loadingIconPopup"></div>', !0);
                A.onUpdate.done(function(P) {
                    O.promise.resolve(P)
                });
                O.promise.done(function(P) {
                    O.close();
                    !0 === P.updated && H(!0)
                }).fail(function(P) {})
            }).fail(function() {
                showErrorPopup()
            })
        }
    }
      , ka = function(q, L) {
        for (var A = $.Deferred(), O = null, P = 0; P < h.length; P++) {
            var M = h[P];
            if (M.subscriptionId == q.subscriptionId) {
                O = M;
                break
            }
        }
        var u = Object.values(L).find(function(oa) {
            return oa.name === O.billingCountry
        });
        P = material.getButton("updateBillingAddressSubmit", "Update invoice address", "book");
        M = material.getButton("cancelBillingAddress", "Cancel", "ban", null, !1, !0);
        var v = material.getRadio("individual", "Individual", !0 !== O.billingBusiness, "bcb")
          , G = material.getRadio("business", "Business", !0 === O.billingBusiness, "bcb")
          , w = '<div style="width: 204px;"> ' + material.getInput(!0, ".*\\S{3,}.*", "formName", "Full name", "billing name", "name", "required", !1, !0, "", O.billingContact) + "</div>"
          , B = '<div style="width: 384px;">' + material.getInput(!0, ".*\\S{2,}.*", "formAddress", "Address", "billing street-address", "ship-address", "billing address is required", !1, !0, "", O.billingStreet) + "</div>"
          , Q = "<div>" + material.getInput(!0, ".*\\S{2,}.*", "formCity", "City", "billing address-level2", "ship-city", "City is required", !1, !0, "", O.billingCity) + "</div>"
          , fa = "<div>" + material.getInput(!0, ".*\\S{2,}.*", "formPostcode", "Postal code", "billing postal-code", "ship-zip", "billing ZIP / postal code", !1, !0, "", O.billingZipCode) + "</div>"
          , R = [];
        for (T in priceDataAPI.statesUS)
            R.push({
                value: T,
                label: T
            });
        var T = '<div style="margin-top:12px;" id="formStateWrapper">' + material.getSelect("formState", "billing-state", O.billingState ? O.billingState : "", R, "State", !1, !0) + "</div>";
        u = material.getCountrySelect(L, u ? u.id : "");
        R = material.getInput(!1, verifyRegExp.vatId.source, "formVatId", "VAT ID", "billing vat-id", "vatId", "e.g. DE999999999", !1, !1, "", O.billingVatId);
        P = '<div id="updateBillingAddressPopupWrapper" style="width: 600px;">\n\t\t\t\t<section style="margin-bottom: 12px;">Changes to your invoice address will only apply to future invoices.<br>If you have questions please contact us at <a class="href" href="mailto:info@keepa.com">info@keepa.com</a>.</section>\n\t\t\t\t<form id="updateBillingAddressForm" style="width: 600px;">\n\t\t\t\t\t<section id="b2bRadio" >' + v + G + '<span class="sub_hint sub_hint--radio" title="Only required for tax purposes. Both offer the same features."><i class="fa fa-question-circle"></i></span></section>\n\t\t\t\t\t<div class="flex" style="justify-content: space-between;">' + w + B + '</div>\n\t\t\t\t\t<div class="flex" style="justify-content: space-between;">' + u + '<div class="flex" style="width: 384px;justify-content: space-between;">' + Q + fa + T + "</div></div>\n\t\t\t\t\t" + R + '\n\t\t\t\t\t<div id="vatIdErrors" style="display:none;"></div>\n\t\t\t\t\t<div>' + P + "&emsp;" + M + "</div>\n\t\t\t\t</form>\n\t\t\t</div>";
        material.init("#updateBillingAddressForm");
        setTimeout(function() {
            var oa = $("#updateBillingAddressForm")
              , Z = $("#b2bRadio")
              , ja = $("#countrySelect")
              , W = 0
              , Aa = function() {
                var Ba = "business-radio" == Z.find(":checked")[0].id
                  , ta = Ba && L[ja.find(":selected")[0].id].isEU;
                $("#formVatId").parent()[ta ? "slideDown" : "hide"](W);
                $("#formVatId-validation-msg")[ta ? "slideDown" : "hide"](W);
                $("#formName").next("label").text(Ba ? "Company" : "Full name");
                $("#vatIdErrors").hide();
                Ba = "US" == $(ja.find(":selected")).attr("id");
                ta = $("#formStateWrapper");
                var Ea = ta.find("select");
                Ba ? (Ea.prop("disabled", !1),
                Ea.prop("required", !0),
                ta.css({
                    visibility: "visible"
                })) : (Ea.val(""),
                Ea.prop("disabled", !0),
                Ea.prop("required", !1),
                ta.css({
                    visibility: "hidden"
                }))
            };
            [Z, ja].map(function(Ba) {
                return Ba.on("change", Aa)
            });
            Aa();
            oa.fadeIn("slow");
            W = 250;
            oa.find(".sub_hint").colorTip({
                color: "facebook"
            });
            $("#cancelBillingAddress").on("click", function(Ba) {
                Ba.preventDefault();
                A.resolve({
                    updated: !1
                })
            });
            var Ca = function() {
                oa.show();
                $("#loadingIconPopup").hide()
            };
            oa.on("submit", function(Ba) {
                Ba.preventDefault();
                $("#vatIdErrors").hide();
                oa.hide();
                $("#loadingIconPopup").show();
                var ta = {
                    billingContact: oa.find("#formName").val().trim(),
                    billingStreet: oa.find("#formAddress").val().trim(),
                    billingCity: oa.find("#formCity").val().trim(),
                    billingZipCode: oa.find("#formPostcode").val().trim(),
                    billingState: oa.find("#formState").val(),
                    billingCountry: oa.find("#countrySelect").find(":selected")[0].getAttribute("data-country"),
                    billingVatId: oa.find("#formVatId").val().replace(/[-,;_:#. ]/g, ""),
                    billingBusiness: "business-radio" == Z.find(":checked")[0].id
                };
                !0 !== ta.billingBusiness && (ta.billingVatId = "");
                Ba = oa.find("#countrySelect").find(":selected")[0].id;
                !0 !== L[Ba].isEU && (ta.billingVatId = "");
                var Ea = {
                    billingContact: "formName",
                    billingStreet: "formAddress",
                    billingCity: "formCity",
                    billingZipCode: "formPostcode"
                }
                  , va = !0;
                ["billingContact", "billingStreet", "billingCity", "billingZipCode"].forEach(function(Y) {
                    if (ta[Y].length < ("billingContact" === Y ? 3 : 2)) {
                        va = !1;
                        Y = "#" + Ea[Y];
                        var ma = $(Y);
                        document.querySelector(Y).parentNode.MDCTextField.value = "";
                        ma.attr("required", !0)
                    }
                });
                if (va) {
                    var da = $("#vatIdErrors");
                    priceDataAPI.validateVatIdPromise({
                        paymentIntentRequest: ta,
                        countryCode: Ba,
                        isEu: L[Ba].isEU
                    }).done(function(Y) {
                        isTest && console.info("%cvalidationPromiseResult:", "color:orange", Y);
                        null == Y || !0 !== Y.success ? (priceDataAPI.handleValidateVatIdError(Y, $("#vatIdErrors")),
                        Ca()) : !0 === Y.valid && 0 === Y.invalidFields.length ? (isTest && (!0 === Y.validationNeeded ? console.info("%cVatId:", "color:green", "everything is valid - proceed with editAddressSubscription...") : console.info("%cVatId:", "color:green", "no validation needed - proceed with editAddressSubscription...")),
                        network.request({
                            path: "service/stripe",
                            type: "editAddressSubscription",
                            content: JSON.stringify(ta),
                            subscriptionId: q.subscriptionId,
                            dashboard: "data",
                            version: 3
                        }).done(function(ma) {
                            isTest && console.log(ma);
                            ma = material.getButton("closePopup", "Ok, close", "window-close", null, !1, !1);
                            oa.html('<p style="color:#00b753;margin:2em 0;">You invoice address has been successfully updated.</p><br><div>' + ma + "</div>");
                            Ca();
                            $("#closePopup").on("click", function(ca) {
                                ca.preventDefault();
                                A.resolve({
                                    updated: !0
                                })
                            })
                        }).fail(function(ma) {
                            oa.html(la._error);
                            Ca()
                        })) : (da.html(Y.msg),
                        da.show(),
                        Ca())
                    }).fail(function(Y) {
                        priceDataAPI.handleValidateVatIdError(Y, da);
                        Ca()
                    })
                } else
                    Ca()
            })
        }, 0);
        return {
            onUpdate: A.promise(),
            html: P
        }
    }
      , za = function(q) {
        var L = function(O, P) {
            var M = D(O)
              , u = showPopup(1 < O.quantity ? "Upgrade / Downgrade Data Access subscription" : "Upgrade Data Access subscription", M.html + '<div style="width=300px" id="loadingIconPopup"></div>', !0);
            addon();
            M.onUpdate.done(function(v) {
                u.promise.resolve(v)
            });
            u.promise.done(function(v) {
                u.close();
                addon();
                !0 === v.updated && (P ? getBucketInformation() : H(!0))
            }).fail(function(v) {})
        };
        if (q) {
            var A = a[q];
            "undefined" === typeof A ? isTest && console.info("%cSub is undefined!", "color:red; ", q) : L(A)
        } else
            E().done(function() {
                var O, P;
                for (P in a)
                    !0 === a[P].subscribed && (O = a[P]);
                L(O, !0)
            })
    }
      , J = function(q) {
        var L = function(O, P) {
            if ("Data_Access_Year" != O.sku && "Data_Access_Year_19" != O.sku) {
                O = g(O);
                var M = showPopup("Change billing cycle to yearly", O.html + '<div style="width=300px" id="loadingIconPopup"></div>', !0);
                addon();
                O.onUpdate.done(function(u) {
                    M.promise.resolve(u)
                });
                M.promise.done(function(u) {
                    M.close();
                    addon();
                    !0 === u.updated && (P ? getBucketInformation() : H(!0))
                }).fail(function(u) {})
            }
        };
        if (q) {
            var A = a[q];
            "undefined" === typeof A ? isTest && console.info("%cSub is undefined!", "color:red; ", q) : L(A)
        } else
            E().done(function() {
                var O, P;
                for (P in a)
                    !0 === a[P].subscribed && (O = a[P]);
                L(O, !0)
            })
    }
      , g = function(q) {
        var L = $.Deferred()
          , A = q.cancel_at_period_end
          , O = "undefined" === typeof storage.email || "" === storage.email || 0 === storage.email.length
          , P = material.getButton("updateDataSubmit", "Switch to yearly now", null, "refresh")
          , M = material.getButton("cancelUpdate", "Cancel", "ban", null, !1, !0)
          , u = ba(!1);
        A = '<div id="updateDataPopupWrapper" class="updatedata">\n                <form id="checkoutForm">\n                    <section>' + (A ? "As your Data Access subscription is cancelled you cannot edit it. You need to subscribe anew once the current period is over." : "Save 20% on your subscription fees by switching to the yearly billing cycle. Switching now will use your remaining time on your monthly term and apply a prorated credit to the yearly fee.") + "</section>\n                    " + (O ? '<section style="color:#ff4500;">In order to edit your subscription your email address is required. You can add it <a href="https://keepa.com/#!channels/" class="href">here</a>.</section>' : "") + '\n                    <section id="proration" class="hidden"></section>\n                    <section id="card-element-update-wrapper" style="display:none;">' + u + "</section>\n                    <div>" + P + "&emsp;" + M + '</div>\n                    <section class="mdc-typography--caption" style="color:tomato; margin-top: 30px;"><hr class="hr -tomato" /><i class="fa fa-info-circle"></i>\n\t\t\t\t\t\tImportant note: Cancellation is possible at any time. All payments are non-refundable. It is not possible to switch back to a monthly billing cycle during a yearly term.\n\t\t\t\t\t\t<br>If you have questions please contact us at <a class="href" href="mailto:info@keepa.com">info@keepa.com</a>.</section>\n                </form>\n            </div>';
        material.init("#checkoutForm");
        setTimeout(function() {
            var v = $("#updateDataSubmit")
              , G = $("#cancelUpdate");
            v.prop("disabled", !0);
            $("#cancelUpdate").on("click", function(B) {
                console.log("cancel");
                B.preventDefault();
                L.resolve({
                    updated: !1
                })
            });
            v.prop("disabled", !0);
            G.prop("disabled", !0);
            var w = function(B) {
                if (null == B || 0 == B[0].length || null == B[0])
                    showErrorPopup();
                else {
                    B = B[0];
                    for (var Q = 0, fa = 0, R = "", T = "", oa = 0; oa < B.lines.data.length; oa++) {
                        var Z = B.lines.data[oa];
                        Z.subscription == q.subscriptionId && (Z.description = Z.description.replace(". Provides access to all features of the Data section", ""),
                        0 > Z.amount ? (R = Z.description,
                        Q = -1 * Z.amount) : (T = Z.description,
                        fa = Z.amount))
                    }
                    oa = -Q + fa;
                    Q = Money.format(Q, {
                        sourceDomainId: 3,
                        targetDomainId: 3,
                        forceEuropeanStyle: !0
                    });
                    fa = Money.format(fa, {
                        sourceDomainId: 3,
                        targetDomainId: 3,
                        forceEuropeanStyle: !0
                    });
                    Z = Money.format(oa, {
                        sourceDomainId: 3,
                        targetDomainId: 3,
                        forceEuropeanStyle: !0
                    });
                    B = Money.format(B.lines.data[B.lines.data.length - 1].amount, {
                        sourceDomainId: 3,
                        targetDomainId: 3,
                        forceEuropeanStyle: !0
                    });
                    replaceHtml("proration", '\n                        <section>Your new subscription fee:&emsp;<span class="updatedata__price highlight">' + B + "</span> / Year</section>\n                        <ul>" + (0 >= oa ? '<li>You will receive a credit in your account of:&emsp;<span class="highlight">' + Z + "</span></li>\n\t\t\t\t\t\t\t<li>&bull;&emsp;This credit will be applied to future invoices (<strong>no refund possible</strong>).</li>" : '<li>Immediate amount due:&emsp;<span class="highlight">' + Z + '</span>&emsp;<i class="fa fa-question" title="\n\t\t\t\t\t\t\t<p><span>Refund:</span>' + (Q + " - " + R + "</p>\n\t\t\t\t\t\t\t<p><span>Prorated charge:</span>" + fa + " - " + T + '</p>\n\t\t\t\t\t\t"></i></li>')) + "</ul>\n\t\t\t\t\t");
                    $("#proration").show();
                    $("#card-element-update-wrapper").show();
                    addon();
                    $(".fa-question").colorTip({
                        color: "facebook"
                    });
                    v.prop("disabled", !1);
                    G.prop("disabled", !1);
                    priceDataAPI.loadStripe("pk_live_vZtwJ2C0mPQs55shQOZtruWI").done(function(ja) {
                        var W = ja.elements().create("card", {
                            style: {
                                base: {
                                    iconColor: "#8898AA",
                                    color: "#000",
                                    lineHeight: "36px",
                                    fontWeight: 300,
                                    fontSize: "1rem",
                                    "::placeholder": {
                                        color: "rgba(0, 0, 0, 0.6)"
                                    }
                                },
                                invalid: {
                                    iconColor: "#e85746",
                                    color: "#e85746"
                                }
                            },
                            hidePostalCode: !0
                        });
                        W.mount("#card-element");
                        $("#checkoutForm").on("submit", function(Aa) {
                            console.log("submit", "checkoutForm");
                            Aa.preventDefault();
                            $("#checkoutForm").hide();
                            $("#loadingIconPopup").show();
                            var Ca = h.find(function(ta) {
                                return ta.subscriptionId == q.subscriptionId
                            });
                            if ("undefined" === typeof Ca)
                                L.resolve({
                                    updated: !1
                                }),
                                setTimeout(function() {
                                    showErrorPopup()
                                }, 500);
                            else {
                                Ca.payedService = "Data_Access" == Ca.payedService ? "Data_Access_Year" : "Data_Access_Year_19";
                                var Ba = function() {
                                    network.request({
                                        path: "service/stripe",
                                        type: "subscription",
                                        content: JSON.stringify(Ca),
                                        subscriptionId: q.subscriptionId,
                                        dashboard: "data",
                                        version: 3
                                    }).done(function(ta) {
                                        console.info("payment 9a-...");
                                        var Ea = function(da) {
                                            var Y = material.getButton("closePopup", "Attempt payment again", "credit-card", null, !1, !1);
                                            replaceHtml("updateDataPopupWrapper", '<section><span class"tomato">Your credit card could not be charged. ' + (null != da.errorMsg ? da.errorMsg : "") + "</span></section><div>" + Y + "</div>");
                                            addon();
                                            var ma = !1;
                                            $("#closePopup").on("click", function(ca) {
                                                ca.preventDefault();
                                                null != da.url && (window.open(da.url),
                                                ma = !0);
                                                L.resolve({
                                                    updated: ma
                                                })
                                            })
                                        }
                                          , va = function() {
                                            var da = material.getButton("closePopup", "Ok, close", "window-close", null, !1, !1)
                                              , Y = !0
                                              , ma = "";
                                            300 <= ta.code ? (Y = !1,
                                            ma = '<section><span class"tomato">Your order was aborted. Your credit card could not be charged. Please repeat the process with a valid credit card.</span></section>') : ma = "<section>Thank you for switching to the yearly Data subscription!<br><br>Your new billing term is yearly.</section>";
                                            replaceHtml("updateDataPopupWrapper", ma + "<div>" + da + "</div>");
                                            $("#loadingIconPopup").hide();
                                            addon();
                                            $("#closePopup").on("click", function(ca) {
                                                ca.preventDefault();
                                                L.resolve({
                                                    updated: Y
                                                })
                                            })
                                        };
                                        if (300 <= ta.code || null != ta.errorMsg)
                                            Ea(ta);
                                        else if (null == ta.paymentIntent)
                                            va();
                                        else
                                            switch (ta.paymentIntent.status) {
                                            case "succeeded":
                                                va();
                                                break;
                                            case "requires_payment_method":
                                                Ea(ta);
                                                break;
                                            case "requires_action":
                                                console.info("payment 10..."),
                                                priceDataAPI.loadStripe("pk_live_vZtwJ2C0mPQs55shQOZtruWI").done(function(da) {
                                                    console.info("payment 11...");
                                                    da.handleCardPayment(ta.paymentIntent.clientSecret).then(function(Y) {
                                                        console.info("payment 12...");
                                                        Y.error ? (ta.errorMsg = Y.error,
                                                        Ea(ta)) : va()
                                                    })
                                                }).fail(showErrorPopup)
                                            }
                                    }).fail(function() {
                                        L.resolve({
                                            updated: !1
                                        });
                                        setTimeout(function() {
                                            showErrorPopup()
                                        }, 500)
                                    })
                                };
                                (function() {
                                    priceDataAPI.cardPayment.getAuthenticatedSource("pk_live_vZtwJ2C0mPQs55shQOZtruWI", null, !1, Ca, W, Ca.billingContact).done(function(ta) {
                                        Ba()
                                    }).fail(function() {}).always(function() {})
                                }
                                )()
                            }
                        })
                    })
                }
            };
            network.request({
                path: "service/stripe",
                type: "upcomingInvoice",
                subscriptionId: q.subscriptionId,
                subscriptionPlan: "Data_Access_19" == q.sku ? "Data_Access_Year_19" : "Data_Access_Year",
                quantity: q.quantity,
                dashboard: "data",
                version: 3
            }).done(function(B) {
                w(B.invoices)
            }).fail(function() {
                L.resolve({
                    updated: !1
                });
                setTimeout(function() {
                    showErrorPopup()
                }, 500)
            })
        }, 0);
        return {
            onUpdate: L.promise(),
            html: A
        }
    }
      , D = function(q) {
        for (var L = $.Deferred(), A = q.cancel_at_period_end, O = "undefined" === typeof storage.email || "" === storage.email || 0 === storage.email.length, P = 24192E5 > Date.now() - z, M = q.quantity, u = [], v = P ? M : 1; 60 >= v; v++)
            (A || O) && M !== v || u.push({
                value: v,
                label: v
            });
        v = 100 * M;
        var G = Money.format(q.price * M, {
            sourceDomainId: q.currencyDomainId,
            targetDomainId: q.currencyDomainId,
            noDigits: !0,
            forceEuropeanStyle: !0
        });
        u = material.getSelect("dataQuantity", "dataQuantity", M, u, !1, !0);
        var w = material.getButton("updateDataSubmit", 1 < M ? "Upgrade / Downgrade now" : "Upgrade now", null, "refresh")
          , B = material.getButton("cancelUpdate", "Cancel", "ban", null, !1, !0)
          , Q = "You can add additional Data Access subscriptions to increase your daily quota and/or allow additional users to share your account. Each additional person requires another plan.\n\t\t\t<br><br>Currently you have <b>" + M + "</b> subscription" + (1 < M ? "s" : "") + ".";
        1 < M && (Q += P ? "<br><div>You can only downgrade once per month. You can not downgrade again.</div>" : "<br>To downgrade decrease the number of subscriptions.");
        P = ba(!1);
        A = '<div id="updateDataPopupWrapper" class="updatedata">\n                <form id="checkoutForm">\n                    <section>' + (A ? "As your Data Access subscription is cancelled you cannot edit it. You need to subscribe anew once the current period is over." : Q) + "</section>\n                    " + (O ? '<section style="color:#ff4500;">In order to upgrade / downgrade your subscription your email address is required. You can add it <a href="https://keepa.com/#!channels/" class="href">here</a>.</section>' : "") + "\n                    <section>Quantity:&emsp;" + u + '&emsp;<span class="updatedata__quota highlight">= ' + v + '% Quota</span></section>\n                    <section>Your <span class="updatedata__pricehint">current</span> ' + q.interval + 'ly subscription fee:&emsp;<span class="updatedata__price highlight">' + G + "</span> / " + q.interval + '</section>\n                    <section id="proration" class="hidden"></section>\n                    <section id="card-element-update-wrapper" style="display:none;">' + P + "</section>\n                    <div>" + w + "&emsp;" + B + "</div>\n                    " + ("month" === q.interval ? '<section class="mdc-typography--caption" style="color:tomato; margin-top: 30px;"><hr class="hr -tomato" /><i class="fa fa-info-circle"></i>\n\t\t\t\t\t\tImportant note: This does not change your monthly plan to a yearly plan. An upgrade increases your \n\t\t\t\t\t\tdaily quota. To convert to a yearly payment you have to cancel your current subscription first. \n\t\t\t\t\t\tOnce it has ended you can subscribe anew - this time choosing the yearly option. <br>If you have\n\t\t\t\t\t\tquestions please contact us at <a class="href" href="mailto:info@keepa.com">info@keepa.com</a>.</section>' : "") + "\n                </form>\n            </div>";
        material.init("#checkoutForm");
        setTimeout(function() {
            var fa = $("#updateDataSubmit")
              , R = $("#cancelUpdate");
            fa.prop("disabled", !0);
            var T = $("#dataQuantity")
              , oa = G;
            T.on("change", function() {
                var W = Math.max(Math.min(Number($(this).val()), 60), 1)
                  , Aa = 100 * W;
                oa = Money.format(q.price * W, {
                    sourceDomainId: q.currencyDomainId,
                    targetDomainId: q.currencyDomainId,
                    noDigits: !0,
                    forceEuropeanStyle: !0
                });
                $(".updatedata__quota").text("= " + Aa + "% Quota");
                $(".updatedata__price").text(oa);
                $(".updatedata__pricehint").text(W === M ? "current" : "new");
                fa.prop("disabled", W === M || 1 > W);
                replaceHtml("proration", "");
                $("#proration").hide();
                addon();
                $("#card-element-update-wrapper").hide();
                W != M && ja()
            });
            $("#cancelUpdate").on("click", function(W) {
                W.preventDefault();
                L.resolve({
                    updated: !1
                })
            });
            var Z = {}
              , ja = function() {
                var W = Math.max(Math.min(Number(T.val()), 60), 1);
                T.prop("disabled", !0);
                fa.prop("disabled", !0);
                R.prop("disabled", !0);
                var Aa = function(Ca) {
                    if (null == Ca || 0 == Ca[0].length || null == Ca[0])
                        showErrorPopup();
                    else {
                        Ca = Ca[0];
                        for (var Ba = 0, ta = 0, Ea = "", va = "", da = 0; da < Ca.lines.data.length - 1; da++) {
                            var Y = Ca.lines.data[da];
                            Y.subscription == q.subscriptionId && (Y.description = Y.description.replace(". Provides access to all features of the Data section", ""),
                            0 > Y.amount ? (Ea = Y.description,
                            Ba = -1 * Y.amount) : (va = Y.description,
                            ta = Y.amount))
                        }
                        Ca = -Ba + ta;
                        Ba = Money.format(Ba, {
                            sourceDomainId: 3,
                            targetDomainId: 3,
                            forceEuropeanStyle: !0
                        });
                        ta = Money.format(ta, {
                            sourceDomainId: 3,
                            targetDomainId: 3,
                            forceEuropeanStyle: !0
                        });
                        Ca = Money.format(Ca, {
                            sourceDomainId: 3,
                            targetDomainId: 3,
                            forceEuropeanStyle: !0
                        });
                        replaceHtml("proration", "<ul>" + ((M > W ? '<li>You will receive a credit in your account of:&emsp;<span class="highlight">' + Ca + "</span></li>\n\t\t\t\t\t\t\t<li>&bull;&emsp;This credit will be applied to future invoices (<strong>no refund possible</strong>).</li>" : '<li>Immediate amount due:&emsp;<span class="highlight">' + Ca + '</span>&emsp;<i class="fa fa-question" title="\n\t\t\t\t\t\t\t<p><span>Refund:</span>' + (Ba + " - " + Ea + "</p>\n\t\t\t\t\t\t\t<p><span>Prorated charge:</span>" + ta + " - " + va + '</p>\n\t\t\t\t\t\t"></i></li>\n\t\t\t\t\t\t\t<li>&bull;&emsp;The updated Quota limit will take effect immediately after we have received payment.</li>')) + "<li>&bull;&emsp;You can upgrade your Data access as often as you want, but a downgrade is only possible once per month.</li></ul>"));
                        $("#proration").show();
                        M > W ? $("#card-element-update-wrapper").hide() : $("#card-element-update-wrapper").show();
                        addon();
                        $(".fa-question").colorTip({
                            color: "facebook"
                        });
                        T.prop("disabled", !1);
                        fa.prop("disabled", W === M || 1 > W);
                        R.prop("disabled", !1)
                    }
                };
                Z[W] ? Aa(Z[W]) : network.request({
                    path: "service/stripe",
                    type: "upcomingInvoice",
                    subscriptionId: q.subscriptionId,
                    subscriptionPlan: q.sku,
                    quantity: W,
                    dashboard: "data",
                    version: 3
                }).done(function(Ca) {
                    Z[W] = Ca.invoices;
                    Aa(Ca.invoices)
                }).fail(function() {
                    L.resolve({
                        updated: !1
                    });
                    setTimeout(function() {
                        showErrorPopup()
                    }, 500)
                })
            };
            priceDataAPI.loadStripe("pk_live_vZtwJ2C0mPQs55shQOZtruWI").done(function(W) {
                var Aa = W.elements().create("card", {
                    style: {
                        base: {
                            iconColor: "#8898AA",
                            color: "#000",
                            lineHeight: "36px",
                            fontWeight: 300,
                            fontSize: "1rem",
                            "::placeholder": {
                                color: "rgba(0, 0, 0, 0.6)"
                            }
                        },
                        invalid: {
                            iconColor: "#e85746",
                            color: "#e85746"
                        }
                    },
                    hidePostalCode: !0
                });
                Aa.mount("#card-element");
                $("#checkoutForm").on("submit", function(Ca) {
                    Ca.preventDefault();
                    $("#checkoutForm").hide();
                    $("#loadingIconPopup").show();
                    var Ba = h.find(function(va) {
                        return va.subscriptionId == q.subscriptionId
                    });
                    if ("undefined" === typeof Ba)
                        L.resolve({
                            updated: !1
                        }),
                        setTimeout(function() {
                            showErrorPopup()
                        }, 500);
                    else {
                        Ba.quantity = Math.max(Math.min(Number(T.val()), 60), 1);
                        var ta = Ba.quantity > M
                          , Ea = function() {
                            network.request({
                                path: "service/stripe",
                                type: "subscription",
                                content: JSON.stringify(Ba),
                                subscriptionId: q.subscriptionId,
                                dashboard: "data",
                                version: 3
                            }).done(function(va) {
                                console.info("payment 9a-...");
                                var da = function(ma) {
                                    var ca = material.getButton("closePopup", "Attempt payment again", "credit-card", null, !1, !1);
                                    replaceHtml("updateDataPopupWrapper", '<section><span class"tomato">Your credit card could not be charged. ' + (null != ma.errorMsg ? ma.errorMsg : "") + "</span></section><div>" + ca + "</div>");
                                    addon();
                                    var ha = !1;
                                    $("#closePopup").on("click", function(C) {
                                        C.preventDefault();
                                        null != ma.url && (window.open(ma.url),
                                        ha = !0);
                                        L.resolve({
                                            updated: ha
                                        })
                                    })
                                }
                                  , Y = function() {
                                    var ma = material.getButton("closePopup", "Ok, close", "window-close", null, !1, !1)
                                      , ca = !0
                                      , ha = "";
                                    300 <= va.code ? (ca = !1,
                                    ha = '<section><span class"tomato">Your order was aborted. Your credit card could not be charged. Please repeat the process with a valid credit card.</span></section>') : ha = ta ? "<section>Thank you for your purchase!<br><br>Once we have processed the payment your Data access will be updated. <strong>This will take a couple of minutes!</strong></section>" : "<section>Your downgrade has been successfull and takes affect immediately.</section>";
                                    replaceHtml("updateDataPopupWrapper", ha + "<div>" + ma + "</div>");
                                    $("#loadingIconPopup").hide();
                                    addon();
                                    $("#closePopup").on("click", function(C) {
                                        C.preventDefault();
                                        L.resolve({
                                            updated: ca
                                        })
                                    })
                                };
                                if (300 <= va.code || null != va.errorMsg)
                                    da(va);
                                else if (null == va.paymentIntent)
                                    Y();
                                else
                                    switch (va.paymentIntent.status) {
                                    case "succeeded":
                                        Y();
                                        break;
                                    case "requires_payment_method":
                                        da(va);
                                        break;
                                    case "requires_action":
                                        console.info("payment 10..."),
                                        priceDataAPI.loadStripe("pk_live_vZtwJ2C0mPQs55shQOZtruWI").done(function(ma) {
                                            console.info("payment 11...");
                                            ma.handleCardPayment(va.paymentIntent.clientSecret).then(function(ca) {
                                                console.info("payment 12...");
                                                ca.error ? (va.errorMsg = ca.error,
                                                da(va)) : Y()
                                            })
                                        }).fail(showErrorPopup)
                                    }
                            }).fail(function() {
                                L.resolve({
                                    updated: !1
                                });
                                setTimeout(function() {
                                    showErrorPopup()
                                }, 500)
                            })
                        };
                        Ca = function() {
                            priceDataAPI.cardPayment.getAuthenticatedSource("pk_live_vZtwJ2C0mPQs55shQOZtruWI", null, !1, Ba, Aa, Ba.billingContact).done(function(va) {
                                Ea()
                            }).fail(function() {}).always(function() {})
                        }
                        ;
                        ta ? Ca() : Ea()
                    }
                })
            })
        }, 0);
        return {
            onUpdate: L.promise(),
            html: A
        }
    }
      , N = function() {
        network.ajax(CDNUrl + "termsSubscriptions.txt?" + (new Date).getDate()).done(function(q) {
            showPopPopup("Terms and Conditions", '<div id="printTerms" style="cursor: pointer; z-index: 1; position: absolute; right: 20px;"><i class="fa fa-print"></i> Print Terms</div><div id="termsAPI" style="padding-right: 20px; text-align:justify; width: 1000px;">' + q + "</div>", !0);
            $("#printTerms").on("click", function(L) {
                L = window.open("", "Terms and Conditions", "height=800,width=1000");
                L.document.write("<html><head><title>Terms and Conditions for Keepa.com's API</title>");
                L.document.write("</head><body >");
                L.document.write($("#termsAPI").html());
                L.document.write("</body></html>");
                L.document.close();
                L.focus();
                L.print();
                L.close()
            })
        }).fail(showErrorPopup)
    }
      , ba = function(q) {
        return '<div class="flex" style="justify-content: space-between;">\n                <div style="width: 300px;">\n                <label><span>Credit Card</span><div id="card-element" style="border-bottom: 1px solid #e2e2e2 !important;" class="field"></div></label>\n            </div><div class="stripeForm" id="cardForm">\n                <div class="outcome2">\n                    <div class="error" role="alert"></div>\n                    <div class="success">Success!</div>\n                </div>\n            </div>' + (q ? '<div style="margin-top:-8px;">\n                ' + material.getInput(!1, ".{4,}", "formCoupon", "Coupon code", "", "coupon-code", "Leave empty if you have no valid coupon code.", !1, !0, "margin-top: 8px;") + "\n            </div>" : "") + '\n            </div>\n            <div class="mdc-typography--caption" style="margin:8px 0 4px;">\n                <i class="fa fa-info-circle" style="color: #444;"></i>&emsp;We currently only accept the following credit/debit cards: Visa, Mastercard & American Express\n            </div>'
    };
    return {
        init: H,
        initUpdateData: za,
        reset: I
    }
}(), createCreditCard = function(a) {
    var b = "";
    if (null != a)
        switch (a.type || a.object) {
        case "card":
            a = a.typeData ? a.typeData : a.card ? a.card : a;
            var d = a.brand
              , h = "credit-card";
            "Visa" == d ? (d = "",
            h = "cc-visa") : "MasterCard" == d ? (d = "",
            h = "cc-mastercard") : "Diners Club" == d ? (d = "",
            h = "cc-diners-club") : "JCB" == d ? (d = "",
            h = "cc-jcb") : "Discover" == d ? (d = "",
            h = "cc-discover") : "American Express" == d && (d = "",
            h = "cc-amex");
            b += '<br><div><span style="color:black">Payment method:</span>&ensp;<span><i class="legendColorBox fa fa-' + (h + ' fa-22" ></i> ') + d + " ending with " + a.last4 + " (exp: " + a.expMonth + "/" + a.expYear + ')</span>&emsp;<i class="editCard fa fa-pencil fa-lg darkgrey" id="editCC" title="edit credit card"></i>&emsp;<i class="editCard fa fa-trash-o fa-lg darkgrey" id="removeCC" title="remove credit card"></i></div>'
        }
    else
        b += '<br><div><i class="legendColorBox fa fa-exclamation-triangle fa-lg red" ></i>&emsp;<span class="href" id="addCC">No payment method is attached to your account. Click here to add new a payment method.</span></div>';
    return b
}, tabBars, SettingsPage = function() {
    var a = function() {
        var d = tabSwitcher();
        tabBars = d;
        $("#contentAlign").css(contentAlignCss);
        $("#contentAlign").css({
            minWidth: "900px",
            maxWidth: "900px"
        });
        d.listen("MDCTabBar:change", function(m) {
            1 == m.detail.activeTabIndex && SettingsSubscription.init()
        });
        var h = parseInt(lastSubUrl);
        /[0-9]/.test(h) ? (1 == h && SettingsSubscription.init(),
        d.activeTabIndex = h,
        d.updatePanel(h)) : "#!settings" === lastUrl && (d.activeTabIndex = 2,
        d.updatePanel(2));
        0 == storage.accountType ? (replaceHtml("settingsBox", '<span class="subsubHeadline2">' + la._52 + "</span><br>" + la._53),
        $("#settingsSelect").hide(),
        $("#settingsBox").show(),
        $("#settingsTabs").css("borderTop", "0px")) : (SettingsNotification.init(),
        $("#notification-channels").attr("rel", "active"),
        b(),
        isSettings = !0,
        insertSettings(),
        d.listen("MDCTabBar:change", function(m) {
            1 == m.detail.activeTabIndex && SettingsSubscription.init()
        }))
    }
      , b = function() {
        var d = getNewPasswordHtml()
          , h = '<div id="passCheck" ><table class="trackFormTable" style="width: 200px"><tr><td class="trackFormTable-empty">&nbsp;</td><td colspan="2"><label for="pwCheck">' + la._60 + '</label></td></tr><tr><td class="trackFormTable-empty">&nbsp;</td><td class="trackFormTable-id"><input type="password" rel="ids" maxlength="1024" name="pwCheck" id="pwCheck" /><div style="padding: 10px;"></div><input type="submit" id="submitDelete" class="button" value="' + la._61 + '" /></tr></table></div>';
        d = '<section class="block--mdc-typography">\n            <p class="mdc-typography--body2"><a class="href switch-tab-0">&raquo; ' + la._942 + '</a></p>\n            <p class="mdc-typography--body2"><span class="href settings-chpw">&raquo; ' + (isSocialAccount ? "Create account credentials" : la._63) + '</span></p>\n            <form id="addTrackForm" method="post" action="">\n                ' + d + '\n                <br><input type="submit" id="submit" class="button" value="' + la._64 + '" style="display:none"><br>\n            </form>\n        </section>';
        h = hasDataAccessSubscription ? "" : '<form id="deleteForm" method="post" action="" style="display:none;">\n                <div>\n                    <br>' + la._65 + "\n                    " + h + "\n                </div>\n            </form>";
        var m = '<br><hr class="hr -tomato"><div id="settingsDeletion">' + la._66 + "<br>";
        m += hasDataAccessSubscription ? "" + la._940.replace('">info', " " + storage.username + '">info') : '<span id="settingsDeleteUndo" style="display:none">' + la._67 + '</span>\n                <span id="settingsDelete">&raquo; ' + la._68 + "</span>\n            </div>\n            " + h;
        network.request({
            path: "user/settings",
            type: "getSettings",
            version: 3
        }).done(function(p) {
            p = p.user;
            var z = '&ensp;<i title="' + la._518 + '" class="fa fa-times tomato clickable fa-lg"></i>&emsp;&emsp;'
              , F = p.facebookUsername ? '<span rel="facebookLogin"><i class="fa fa-acebook fa-lg"></i>&ensp;' + p.facebookUsername + z + "</span>" : ""
              , I = p.twitterUsername ? '<span rel="twitterLogin"><i class="fa fa-witter fa-lg"></i>&ensp;' + p.twitterUsername + z + "</span>" : ""
              , E = p.googleUsername ? '<span rel="googleLogin"><i class="fa fa-ogle"></i>&ensp;' + p.googleUsername + z + "</span>" : "";
            z = p.amazonUsername ? '<span rel="amazonLogin"><i class="fa fa-amazon"></i>&ensp;' + p.amazonUsername + z + "</span>" : "";
            var K = p.facebookUsername || p.twitterUsername || p.googleUsername || p.amazonUsername;
            z = K ? '<span id="removeLinks"><span>' + la._514 + "&emsp;</span>" + F + I + E + z + "</span>" : "";
            F = '<div class="borderLeft">' + z + "</div><br><br>";
            K || (F = "");
            K = $("#settingsBox");
            I = "";
            null != p.sessions && 0 < p.sessions.length && (I = '<table id="sessionsList"></table>',
            $.getScript("//cdn.keepa.com/bowser.js").done(function() {
                var H = "<tr><th>" + la._956 + "</th><th>" + la._957 + "</th><th>" + la._958 + "</th><th>" + la._959 + "</th><th> </th></tr>";
                p.sessions.sort(function(ua, na) {
                    return ua.lastVisit < na.lastVisit ? 1 : -1
                });
                for (var V = $jscomp.makeIterator(p.sessions), S = V.next(); !S.done; S = V.next()) {
                    S = S.value;
                    var aa = {
                        browser: {
                            name: ""
                        },
                        os: {
                            name: ""
                        },
                        platform: {
                            type: ""
                        }
                    };
                    "" === S.device && (S.device = "KeepaMobile");
                    var ea = "";
                    S.device && (aa = bowser.getParser(S.device).parsedResult,
                    0 === S.device.indexOf("KeepaMobile") ? (ea = S.device.split(" "),
                    1 === ea.length ? (aa.os = {
                        name: "Android / iOS",
                        version: ""
                    },
                    aa.browser = {
                        name: "Keepa Mobile App",
                        version: ""
                    }) : (ea = ea[0].split("/")[1],
                    aa.browser = {
                        name: "Keepa Mobile App",
                        version: ea
                    }),
                    ea = "" + aa.os.name + (aa.os.version ? " " + aa.os.version : "") + (aa.browser.name ? ", " + aa.browser.name + (aa.browser.version ? " (" + aa.browser.version + ")" : "") : "")) : ea = "" + aa.os.name + (aa.os.versionName ? " " + aa.os.versionName : "") + (aa.browser.name ? ", " + aa.browser.name + " (" + aa.browser.version + ")" : ""));
                    var ra = aa.platform.type
                      , pa = "";
                    if ("desktop" == ra)
                        "Windows" == aa.os.name && (ra = "windows"),
                        "Linux" == aa.os.name && (ra = "linux"),
                        "iOS" == aa.os.name && (ra = "apple");
                    else if ("mobile" == ra || "tablet" == ra)
                        pa = "font-size: 23px;";
                    H += '<tr><td><i class="fa fa-' + (ra + ' fa-lg" style="width: 15px;text-align: center;' + pa + '"></i>&emsp;') + ea + '</td><td title="' + S.ip + '">' + (S.country || "") + "</td><td>" + (new Date(keepaTime.minutesToEpoch(S.lastVisit))).formatDate("M j, Y %a%t G:i") + "</td><td>" + (new Date(keepaTime.minutesToEpoch(S.created))).formatDate("M j, Y") + '</td><td class="removeDevice" data-id="' + S.id + '"><i class="fa fa-ban fa-lg"></i> ' + la._960 + "</td></tr>"
                }
                $("#sessionsList").html(H);
                $(".removeDevice").hover(function() {
                    $(this).find(".fa").css({
                        color: "red"
                    })
                }, function() {
                    $(this).find(".fa").css({
                        color: ""
                    })
                });
                $(".removeDevice").on("click", function(ua) {
                    ua.target.attributes["data-id"] && network.request({
                        path: "user/session",
                        type: "deleteSession",
                        token: ua.target.attributes["data-id"].value,
                        version: 3
                    }).done(function(na) {
                        if (null == na.error) {
                            var qa = $(ua.target).parent();
                            qa.hide("slow", function() {
                                qa.remove()
                            })
                        } else
                            showErrorPopup()
                    }).fail(function(na) {
                        showErrorPopup()
                    })
                })
            }));
            K.prepend(F + I);
            $("#removeLinks").on("click", function(H) {
                H = H.target;
                "colorTip" == H.parentElement.className && (H = H.parentElement.parentElement);
                "colorTip" == H.className && (H = H.parentElement);
                "I" == H.nodeName && (H = $(H).parent().attr("rel"),
                void 0 == H || "" == H ? (showErrorPopup(),
                reportBug(null, "ssoremove rel is undefined")) : network.request({
                    path: "user/session",
                    type: "ssoremove",
                    content: H,
                    version: 3
                }).done(function(V) {
                    null == V.error ? a() : "nopw" == V.error.type ? showPopup("No password set", "You can not remove this linked external account, as your Keepa account does not have any other method of authentication. You need to set up account credentials first or add another external account.", !0) : showErrorPopup()
                }).fail(function(V) {
                    showErrorPopup();
                    a()
                }))
            });
            K.find("#openIDoogle").click(function() {
                var H = getSocialLoginURL("googleLogin", "", "0");
                window.open(H, popupName, popupSettings)
            });
            K.find("#openIDacebook").click(function() {
                var H = getSocialLoginURL("facebookLogin", "", "0");
                window.open(H, popupName, popupSettings)
            });
            K.find("#openIDwitter").click(function() {
                var H = getSocialLoginURL("twitterLogin", "", "0");
                window.open(H, popupName, popupSettings)
            });
            K.find("#openIDmazon").click(function() {
                var H = getSocialLoginURL("amazonLogin", "", "0");
                window.open(H, popupName, popupSettings)
            });
            $("#settingsBox .fa-times").colorTip("red")
        }).fail(function(p) {
            401 == p.status && settings.reset(!1, !1)
        });
        replaceHtml("settingsBox", d + m);
        2 != storage.accountType && ($(".settings-chpw").hide(),
        $("#passCheck").hide());
        $(".switch-tab-0").on("click", function() {
            tabBars.activeTabIndex = 0;
            setTimeout(function() {
                tabBars.updatePanel(0)
            }, 100)
        });
        $(".settings-chpw").on("click.pass", function() {
            $(this).html($(this).html().replace(/^./, "") + ":");
            $("#passBox").show("Blind");
            $("#addTrackForm #submit").show("Blind");
            $(this).off("click.pass");
            $(this).removeClass()
        });
        var t = !1;
        $("#addTrackForm").submit(function(p) {
            p.preventDefault();
            if (t)
                return !1;
            p = $("#oldPW").val().trim();
            var z = $("#newPW").val().trim()
              , F = $("#newPW2").val().trim()
              , I = $("#addTrackForm").find("#submit");
            I.val(la._45);
            if (0 != p.length) {
                if (z != F) {
                    p = la._236;
                    $("label[for=newPW]").append('<span class="error">' + p + "</span>");
                    I.val(la._64);
                    return
                }
                t = !0;
                network.request({
                    path: "user/session",
                    type: "changepw",
                    password: z,
                    oldPassword: p,
                    version: 3
                }).always(function(E) {
                    t = !1;
                    if (null == E.error)
                        I.val(la._44),
                        settings.retrieve();
                    else {
                        var K = ""
                          , H = "";
                        switch (E.error.type) {
                        case "newPWWrong":
                            K = "newPW";
                            H = la._74;
                            break;
                        case "oldPWWrong":
                            K = "oldPW";
                            H = isSocialAccount ? la._48 : la._75;
                            break;
                        case "usernametaken":
                            K = "oldPW";
                            H = la._50;
                            break;
                        default:
                            reportBug(null, "user/session/ changepw default " + JSON.stringify(E)),
                            showErrorPopup()
                        }
                        0 != E.status && ($("label[for=" + K + "]").append('<span class="error">' + H + "</span>"),
                        I.val(la._64))
                    }
                })
            } else
                I.val(la._44);
            setTimeout(function() {
                I.val(la._64)
            }, 1E3)
        });
        $("#settingsDelete").on("click.passCheck", function() {
            if (2 != storage.accountType && 0 != storage.accountType) {
                $(this).hide();
                var p = $("#settingsDeleteUndo");
                p.show();
                p.on("click.remove", function() {
                    $(this).off("click.remove");
                    $(this).hide();
                    $(this).html(la._67);
                    $(this).css("color", "#000");
                    $("#settingsDelete").show()
                });
                window.setTimeout(function() {
                    settingsUndo(p)
                }, 1E3)
            } else
                $("#settingsDeletion").hide("Blind"),
                $("#deleteForm").show("Blind"),
                $(this).off("click.passCheck"),
                $(this).removeClass()
        });
        var f = !1
          , n = $("#deleteForm")
          , r = function() {
            if (hasDataAccessSubscription || f)
                return !1;
            f = !0;
            $("span.error").remove();
            network.request({
                path: "user/session",
                type: "delete",
                password: n.find("#pwCheck").val().trim(),
                version: 3
            }).always(function(p) {
                f = !1;
                null == p.error ? ($("#settingsPage").hide("explode", 1E3, function() {
                    window.location.hash = ""
                }),
                logout()) : "pwrong" == p.error.type ? (p = la._76,
                $("label[for=pwCheck]").append('<span class="error">' + p + "</span>")) : (reportBug(null, "user/session deleteAccount " + JSON.stringify(p)),
                showErrorPopup())
            })
        };
        n.submit(function(p) {
            p.preventDefault();
            p = material.getButton("confirmDelete", la._68, null, "trash");
            var z = material.getButton("cancelDelete", la._380, "ban", null, !1, !0)
              , F = showPopup(la._66, '<div style="margin:1em 0 2em 0;width:500px;">\n\t\t\t\t\t' + la._899 + "\n\t\t\t\t\t" + (hasDataAccessSubscription ? '<br><br><span style="color:red;">' + la._898 + "</span>" : "") + '\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div style="margin:1em 0;">\n\t\t\t\t\t' + p + "&emsp;" + z + "\n\t\t\t\t</div>", !0);
            $("#cancelDelete").on("click", function(I) {
                F.close();
                return !1
            });
            $("#confirmDelete").on("click", function(I) {
                F.close();
                r()
            })
        })
    };
    return {
        init: a
    }
}();
var StartPage = function() {
    var a = function(f, n, r, p) {
        var z = getBaseUrl();
        f = f || (new Date).formatDate("M d, Y");
        n = n || la._25;
        return '\n\t\t\t\t<p class="mdc-typography--caption">' + f + '</p>\n\t\t\t\t<h6 class="mdc-typography--headline6">' + n + '</h6>\n\t\t\t\t<p class="mdc-typography--body2">' + (r || "&hellip;") + '</p>\n\t\t\t\t<p class="mdc-typography--body2"><a class="mdc-typography--button href" href="' + (p || z + "#!news") + '">' + la._733 + "</a></p>\n\t\t\t"
    }
      , b = function(f, n, r, p, z, F, I) {
        n = '<div class="teaser__slide-text">\n\t\t\t\t<h2 class="mdc-typography--headline2">' + f + '</h2>\n\t\t\t\t<p class="mdc-typography--body2">' + n + "</p>\n\t\t\t\t" + (r ? '<p class="mdc-typography--body2"><a class="mdc-button mdc-button--raised" href="' + p + '">' + r + "</a></p>" : "") + "\n\t\t\t</div>";
        f = '<div class="teaser__slide-image">\n\t\t\t\t<img srcset="' + imgCDNUrl + "start/" + z + "_1x.jpg 1x, " + imgCDNUrl + "start/" + z + '_2x.jpg 2x" src="' + imgCDNUrl + "start/" + z + '_1x.jpg" alt="' + f + '" />\n\t\t\t</div>';
        return '<div class="teaser__slide' + (I ? " teaser__slide--reverse" : "") + '"' + (F ? ' style="display:none;"' : "") + ">\n\t\t\t\t\t" + (I ? "" + f + n : "" + n + f) + "\t\t\t\t\t\n\t\t\t\t</div>"
    }
      , d = function() {
        $(".teaser__slide-text-icons").find("a").each(function(f, n) {
            return $(n).colorTip({
                color: "black"
            })
        });
        $("#opera").on("click", function(f) {
            showPopup("How to use Keepa in Opera", 'Our extension is not available on the Opera add-ons website. How to get it: <br><br>1. Install the <a target="_blank" href="https://addons.opera.com/en/extensions/details/download-chrome-extension-9/?display=en">Download Chrome Extension</a> add-on<br>2. Install our <a target="_blank" href="https://chrome.google.com/webstore/detail/neebplgakaahbhdphmkckjjcegoiijjo">Chrome extension</a>', !0);
            return !1
        })
    }
      , h = function() {
        var f = $($(".teaser--small").get(2)), n, r = function() {
            window_focus && "#!" == lastHash && network.request({
                path: "service/features",
                type: "website",
                version: 3
            }).done(function(p) {
                if (0 != parseInt(p)) {
                    0 == f.length && clearInterval(n);
                    p = p.data;
                    p = p.productCount;
                    for (var z = [7, 13], F = 0, I = "", E = 1; E < numberOfDomains; E++)
                        -1 < z.indexOf(E) || (F += p[E],
                        I += '<span title="Amazon.' + getTldByDomain(E) + '">\n\t\t\t\t\t\t\t\t<img src="' + flags[E] + '" />&nbsp;&nbsp;' + NumberUtil.format(p[E]) + "&emsp; \n\t\t\t\t\t\t\t</span> ");
                    p = '\n\t\t\t\t\t\t<p class="mdc-typography--body2">' + la._189.replace("<span id='productCount'></span>", NumberUtil.format(F)) + '</p>\n\t\t\t\t\t\t<p class="mdc-typography--caption teaser__domains">' + I + '</p>\n\t\t\t\t\t\t<p class="mdc-typography--body2 teaser__user-count">&nbsp;</p>\n\t\t\t\t\t';
                    f.html(p);
                    n = setTimeout(r, 2E3)
                }
            })
        };
        r()
    }
      , m = function() {
        var f = function(r, p) {
            discourseApi.topic(r, function(z) {
                try {
                    if (z) {
                        var F = (new Date(z.created_at)).formatDate("M d, Y")
                          , I = z.title
                          , E = z.post_stream.posts[0].cooked;
                        z = null;
                        if (12524 == r)
                            z = '<span>Now available on Google Play Store and Apple App Store</span><br><div>&emsp;<a href="https://play.google.com/store/apps/details?id=com.keepa.mobile"><img src="https://cdn.keepa.com/img/app-store/en_badge_web_generic_no_border.png" alt="Get it on Google Play" width="186" height="55"></a> &emsp;&emsp;<a href="https://apps.apple.com/app/keepa-price-tracker/id1518541385"><img src="https://cdn.keepa.com/img/app-store/Download_on_the_App_Store_Badge_US-UK_RGB_blk_092917.svg" alt="Get it on Apple App Store" width="165" height="55"></a></div>';
                        else {
                            E = E.replace(/(<([^>]+)>)/ig, "");
                            E = E.replace(/\r?\n|\r/g, " @@@");
                            var K;
                            null !== (K = /(^.*?[a-z]{2,}[.!?:])\s+\W*/.exec(E)) ? E = K[0].replace(":", ".").replace(/ @@@/g, "<br>") : (E = E.replace(/ @@@/g, " "),
                            E = E.split(" ", 10).join(" ") + "&hellip;");
                            z = E
                        }
                        p.html(a(F, I, z))
                    }
                } catch (H) {
                    isTest && console.log("Could not load news:", H)
                }
            })
        }
          , n = $(".teaser--small");
        window && window.news && "undefined" !== typeof window.news && (f(window.news[0], $(n.get(0))),
        f(window.news[1], $(n.get(1))))
    }
      , t = function() {
        if (!0 !== f) {
            var f = !0;
            isTest && console.time("loading slick scripts");
            $.when(LoaderUtil.css(CDNUrl + "slick-1.8.1.css"), LoaderUtil.js(CDNUrl + "slick-1.8.1.min.js")).then(function() {
                isTest && console.timeEnd("loading slick scripts");
                var n = {
                    adaptiveHeight: isMobile,
                    autoplay: !0,
                    autoplaySpeed: 3E4,
                    dots: !0,
                    nextArrow: '<button class="mdc-fab mdc-fab--mini slick-next" aria-label="' + la._612 + '">\n\t\t\t\t\t\t\t\t<i class="fa fa-angle-right mdc-fab__icon"></i>\n\t\t\t\t\t\t\t</button>',
                    prevArrow: '<button class="mdc-fab mdc-fab--mini slick-prev" aria-label="' + la._614 + '">\n\t\t\t\t\t\t\t\t<i class="fa fa-angle-left mdc-fab__icon"></i>\n\t\t\t\t\t\t\t</button>'
                };
                $(".carousel--extension div").show();
                $(".carousel--extension").slick(n);
                7 != Number(storage.domain) && (n.autoplay = !1,
                $(".carousel--data div").show(),
                $(".carousel--data").slick(n))
            }).fail(showErrorPopup)
        }
    };
    return {
        init: function() {
            PageLayoutGrid.init("start");
            document.title = "Keepa - Amazon Price Tracker";
            var f = getBaseUrl()
              , n = la._719 + "\n\t\t\t\t<br><br>\n\t\t\t\t" + la._290 + '*\n\t\t\t\t<p class="mdc-typography--caption teaser__slide-text-icons">\n\t\t\t\t\t<a href="https://addons.mozilla.org/firefox/addon/keepa/" title="' + la._720 + '" target="_blank"><img src="' + imgCDNUrl + 'firefox_128x128.png" alt="Firefox" /></a>\n\t\t\t\t\t<a href="https://chrome.google.com/webstore/detail/neebplgakaahbhdphmkckjjcegoiijjo" title="' + la._721 + '" target="_blank"><img src="' + imgCDNUrl + 'chrome_128x128.png" alt="Chrome" /></a>\n\t\t\t\t\t<a id="opera" href="#!" title="' + la._722 + '" target="_blank"><img src="' + imgCDNUrl + 'opera_128x128.png" alt="Opera" /></a>\n\t\t\t\t\t<a href="https://microsoftedge.microsoft.com/addons/detail/ejefaeioamebhekmfaclajddbpnnobje" title="' + la._723 + '" target="_blank"><img src="' + imgCDNUrl + 'edgechromium_128x128.png" alt="Edge" /></a>\n\t\t\t\t\t<a href="https://apps.apple.com/us/app/id1533805339" title="Install on Safari 14"><img src="' + imgCDNUrl + 'safari_128x128.png" alt="Safari 14" /></a>&emsp;&emsp;\n\t\t\t\t</p>\t\t\t\n\t\t\t\t<p class="mdc-typography--caption">* ' + la._724 + "</p>\t\n\t\t\t"
              , r = "";
            7 != Number(storage.domain) && (r = '<div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">\n\t\t\t\t<div class="teaser--large carousel carousel--data">\n\t\t\t\t\t' + b(la._734, la._735 + " *", la._717, "https://discuss.keepa.com/t/data-features-access-free-vs-monthly-subscription/5845", "data", !1, !0) + "\n\t\t\t\t\t" + b(la._736, la._737, la._730, f + "#!finder", "finder", !0, !0) + "\n\t\t\t\t\t" + b(la._738, la._739, la._730, f + "#!viewer", "viewer", !0, !0) + "\n\t\t\t\t\t" + b(la._740, la._741, la._730, f + "#!bestseller", "bestseller", !0, !0) + "\n\t\t\t\t\t" + b(la._742, la._743, !1, !1, "increase", !0, !0) + '\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">\n\t\t\t\t<p class="mdc-typography--caption footnote">\n\t\t\t\t\t* ' + la._744 + "<br>\n\t\t\t\t</p>\n\t\t\t</div>");
            f = '\n\t\t\t\t<div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">\n\t\t\t\t\t<div class="teaser--large carousel carousel--extension">\n\t\t\t\t\t\t' + b(la._718, n, !1, !1, "pricehistory", !1) + "\n\t\t\t\t\t\t" + b(la._726, la._725, !1, !1, "track", !0) + "\n\t\t\t\t\t\t" + b(la._731, "" + la._727, !1, !1, "compare", !0) + "\n\t\t\t\t\t\t" + b(la._728, la._729, la._730, f + "#!deals", "deals", !0) + '\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="mdc-layout-grid__cell mdc-elevation--z3 block block--elevated">\n\t\t\t\t\t<div class="teaser--small">\n\t\t\t\t\t\t' + a() + '\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="mdc-layout-grid__cell mdc-elevation--z3 block block--elevated">\n\t\t\t\t\t<div class="teaser--small">\n\t\t\t\t\t\t' + a() + '\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet mdc-elevation--z3 block block--elevated">\n\t\t\t\t\t<div class="teaser--small">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t' + r + "\n\t\t\t";
            PageLayoutGrid.initBodyPanel(f);
            d();
            h();
            m();
            t()
        }
    }
}();
var enableWishlistTrackingComponent = isTest && !1
  , trackingFormFocusTrigger = !1;
function importWish() {
    var a = /https?:\/\/.*?amazon\.(de|com\.mx|com|co\.uk|co\.jp|ca|fr|cn|it|es|in)\/.*?\/([A-Z0-9]{11,13}).*/
      , b = /([A-Z0-9]{11,13})/
      , d = '<a href="http://www.amazon.' + getTldByDomain(storage.domain) + '/registry/wishlist/" target="_blank">' + la._218 + "</a>"
      , h = material.getInput(!0, /([A-Z0-9]{11,13})|(https?:\/\/.*?amazon\.(de|com\.mx|com|co\.uk|co\.jp|ca|fr|cn|it|es|in)\/.*?\/([A-Z0-9]{11,13}).*)/.source, "importWish", "Wish List URL", !1, "", la._226, "", !0, "", "")
      , m = material.getButton("wishlistSubmit", la._225, null, "paper-plane");
    replaceHtml("settingsBox", '<section id="step1">\n\t\t\t' + la._219 + "<br><br>\n\t\t\t" + la._220 + d + la._221 + la._221_2 + ". " + la._222 + '<br>\n\t\t\t<div style="width:100%">' + h + "</div>\n\t\t\t" + m + '\n\t\t</section>\n\t\t<section id="step2">' + (enableWishlistTrackingComponent ? '<div id="step2List"></div><div id="step2Form"></div>' : "") + '</section>\n\t\t<section id="step3" style="display:none;">\n\t\t\t<div style="color:#00b753;font-size:16px;"><i class="fa fa-bell-o"></i>&emsp;' + la._223 + '</div><br>\n\t\t\t<div id="notification-channels"></div>\n\t\t</section>\n\t\t<div id="wishError" style="color:red;padding-top:10px;clear:both;"></div>\n\t\t<div id="loadingIcon" style="text-align:center;"><br><br><br><br>' + la._224 + "<br><br></div>");
    material.init("#settingsBox");
    d = storage.wishlistAddonId;
    var t = storage.domain;
    storage.wishlistAddonImport ? (showPopup("Unsupported Wish List Import", 'Private Wish List import is currently not working. Please go back to Amazon, set your Wish List privacy setting to "Shared" and use the URL to import it on Keepa.', !0),
    storage.removeItem("wishlistAddonImport"),
    storage.removeItem("wishlistDomain")) : (d && (t = storage.wishlistDomain || t,
    storage.removeItem("wishlistAddonId"),
    storage.removeItem("wishlistAddonImport"),
    storage.removeItem("wishlistDomain"),
    $("#importWish").text(d),
    setTimeout(function() {
        $("#wishlistSubmit").trigger("click")
    }, 0)),
    d = document.getElementById("importWish"),
    $(d).blur(function() {
        storage.wishlist = this.innerHTML
    }),
    storage.wishlist && (d.innerHTML = storage.wishlist),
    $("#importWish").keypress(function(f) {
        13 == f.which && $("#wishlistSubmit").trigger("click");
        return 13 != f.which
    }),
    network.request({
        path: "service/wishlist",
        type: "getLists",
        version: 3
    }).done(function(f) {
        var n = f.wishLists;
        f = f.noHistoryProducts || [];
        if (n && 0 != n.length) {
            var r = {};
            for (p in n)
                "null" != p && n[p] && (r[n[p].createDate + "" + 100 * Math.random()] = n[p]);
            var p = "";
            for (var z = Object.keys(r).sort().reverse(), F = 0; F < z.length; F++) {
                for (var I = r[z[F]], E = I ? I.name : "?", K = 0, H = 0, V = 0; V < I.items.length; V++)
                    null != I.items[V] && ("0" == I.items[V][3] ? H++ : K++);
                0 == I.lastUpdate && (I.lastUpdate = I.createDate);
                V = keepaTime.now() - I.lastUpdate;
                var S = 15 < V;
                p += '<div class="mdc-card wishlist-card">\n\t\t\t\t\t\t<div class="mdc-card__media mdc-card__media--16-9">\n\t\t\t\t\t\t\t<div class="mdc-card__media-content">' + getProductIconsCard(I, f) + '</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t\t<div class="wishlist-card__primary">\n\t\t\t\t\t\t\t<h2 class="mdc-typography--subtitle1"><a href="#!manage/0-0-0-0-0-' + I.id + '">' + E + '</a></h2>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="wishlist-card__secondary mdc-typography--body2">\n\t\t\t\t\t\t\t<dt>' + la._539 + ":</dt><dd>" + (new Date(keepaTime.minutesToEpoch(I.createDate))).formatDate("M j, Y") + " (" + prettyDate(keepaTime.now() - I.createDate) + ")</dd>\n\t\t\t\t\t\t\t<dt>" + la._540 + ":</dt><dd>" + (new Date(keepaTime.minutesToEpoch(I.lastUpdate))).formatDate("M j, Y") + " (" + prettyDate(V) + ")</dd>\n\t\t\t\t\t\t\t<dt>" + la._203 + ":</dt><dd>Amazon." + getTldByDomain(I.domain) + '&emsp;<a href="' + getAmazonWishListUrl(I) + '" target="_blank" title="' + la._646 + " Amazon." + getTldByDomain(I.domain) + '"><i class="fa fa-external-link"></i></a></dd>\n\t\t\t\t\t\t\t<dt>' + la._543 + ":</dt><dd>" + H + '&emsp;<span style="color:grey;">(' + K + " " + la._544 + ')</span></dd>\n\t\t\t\t\t\t\t<hr style="border-top: 1px solid #d8d8d8;">\n\t\t\t\t\t\t\t<div class="wishlistcard__settings">\n\t\t\t\t\t\t\t\t' + material.getCheckbox("isOneTimeImport-" + I.id, la._707 + ' <i class="fa fa-spinner fa-spin" style="display:none;"></i>', !I.isOneTimeImport, !1, "isOneTimeImport-" + I.id, 0) + "\n\t\t\t\t\t\t\t\t" + material.getCheckbox("removeTrackingWhenPurchased-" + I.id, la._814 + ' <i class="fa fa-spinner fa-spin" style="display:none;"></i>', !I.removeTrackingWhenPurchased, !1, "removeTrackingWhenPurchased-" + I.id, 0) + "\n\t\t\t\t\t\t\t\t" + material.getCheckbox("overwriteExistingTrackings-" + I.id, la._815 + ' <i class="fa fa-spinner fa-spin" style="display:none;"></i>', I.overwriteExistingTrackings, !1, "overwriteExistingTrackings-" + I.id, 1) + "\n\t\t\t\t\t\t\t\t" + material.getCheckbox("skipIfNotInStock-" + I.id, la._816 + ' <i class="fa fa-spinner fa-spin" style="display:none;"></i>', !I.skipIfNotInStock, !1, "skipIfNotInStock-" + I.id, 0) + '\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div class="mdc-card__actions">\n\t\t\t\t\t\t\t<div class="mdc-card__action-buttons">\n\t\t\t\t\t\t\t\t<button class="mdc-button mdc-card__action mdc-card__action--button refreshWL" rel="' + I.id + '"' + (S ? "" : " disabled") + ' style="color:' + (S ? "forestgreen" : "grey") + ';">' + (S ? '<i class="fa fa-fw fa-refresh"></i> ' + la._537 : "" + la._542) + '</button>\n\t\t\t\t\t\t\t\t<button class="mdc-button mdc-card__action mdc-card__action--button delete" rel="' + I.id + '" style="color:tomato;"><i class="fa fa-fw fa-trash-o"></i> ' + la._545 + "</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>"
            }
            $("#trackedLists").remove();
            z && z.length && $(".paper").after('<div id="trackedLists">\n\t\t\t\t\t<h2 class="mdc-typography--subtitle1">' + la._535 + ':</h2>\n\t\t\t\t\t<div class="box__wishlists">\n\t\t\t\t\t' + p + "\n\t\t\t\t\t</div>\n\t\t\t\t</div>");
            $(".box__wishlists .delete").on("click", function(aa) {
                var ea = $(aa.currentTarget)
                  , ra = ea.attr("rel");
                aa = null;
                for (var pa in n)
                    if ("null" != pa && n[pa] && n[pa].id == ra) {
                        aa = n[pa];
                        break
                    }
                if (null != aa) {
                    var ua = showPopup('<i class="fa fa-trash-o"></i>&ensp;' + la._545, '<span id="messageOp">\n\t\t\t\t\t\t<div>' + la._547.replace("{NAME}", "<b>" + aa.name + "</b>") + '</div>\n\t\t\t\t\t\t<span style="font-size:larger;">\n\t\t\t\t\t\t\t<br><span class="settings-chpw" id="removeTrackings">\u00bb ' + la._548 + '</span>\n\t\t\t\t\t        <br><span class="settings-chpw" id="keepTrackings">\u00bb ' + la._549 + "</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>", !0)
                      , na = function(qa) {
                        ua.close();
                        network.request({
                            path: "service/wishlist",
                            type: "deleteList",
                            content: ra,
                            deleteTrackings: qa,
                            version: 3
                        }).done(function(ka) {
                            if (0 === ka.status) {
                                var za = ea.closest(".wishlist-card");
                                za.hide("explode", 700, function() {
                                    za.remove()
                                })
                            } else
                                showErrorPopup("" + ka.errorMsg)
                        }).fail(function(ka) {
                            showErrorPopup("Status: " + ka.status + " | Error: " + ka.errorMsg)
                        })
                    };
                    $("#removeTrackings").on("click", function(qa, ka) {
                        na(!0)
                    });
                    $("#keepTrackings").on("click", function(qa, ka) {
                        na(!1)
                    })
                }
            });
            $(".box__wishlists .refreshWL").on("click", function(aa) {
                var ea = $(aa.currentTarget).attr("rel");
                aa = null;
                for (var ra in n)
                    if ("null" != ra && n[ra] && n[ra].id == ea) {
                        aa = n[ra];
                        break
                    }
                if (null != aa) {
                    var pa = showPopup('<i class="fa fa-refresh"></i>&ensp;' + la._537, '<span id="messageOp">\n\t\t\t\t\t\t<div>' + la._536.replace("{NAME}", "<b>" + aa.name + "</b>") + '</div>\n\t\t\t\t\t\t<span style="font-size:larger;">\n\t\t\t\t\t\t\t<br><span class="settings-chpw" id="updateWishList">\u00bb ' + la._538 + "</span>\n\t\t\t\t\t\t</span>\t\t\t\t\n\t\t\t\t\t</span>", !0)
                      , ua = function() {
                        pa.update("<div>" + la._45 + "</div>");
                        network.request({
                            path: "track",
                            type: "wishListRefresh",
                            wishListId: ea,
                            version: 3
                        }).done(function(na) {
                            null == na.error ? pa.update("<div>" + la._223 + "</div>") : pa.update("<div>" + la._error + "</div>");
                            importWish()
                        })
                    };
                    $("#updateWishList").on("click", function(na, qa) {
                        ua()
                    })
                }
            });
            $('.wishlistcard__settings input[type="checkbox"]').on("change", function() {
                var aa = this
                  , ea = $(this).parent().parent().find("label").find("i");
                ea.show();
                var ra = $(this).attr("name").split("-")
                  , pa = ra[0];
                ra = ra[1];
                var ua = $(this).val();
                ua = $(this).prop("checked") && 1 == ua || !$(this).prop("checked") && 0 == ua;
                var na = {};
                network.request({
                    path: "track",
                    type: "wishListUpdate",
                    trackingRequest: (na.wishListId = ra,
                    na[pa] = ua,
                    na),
                    version: 3
                }).done(function(qa) {
                    qa.error && ($(aa).prop("checked", !$(aa).prop("checked")),
                    showErrorPopup())
                }).fail(function(qa) {
                    showErrorPopup("Status: " + qa.status + " | Error: " + qa.errorMsg)
                }).always(function() {
                    ea.hide()
                })
            })
        }
    }),
    $("#wishlistSubmit").click(function() {
        var f = $("#importWish").val();
        $("#trackedLists").velocity("slideUp");
        var n, r = "";
        if (n = a.exec(f))
            t = getDomainByTld(n[1]),
            r = n[2];
        else if (n = b.exec(f))
            r = n[1];
        else {
            "" == f ? $("#importWish")[0].reportValidity() : $("#importWish-validation-msg").effect("highlight");
            return
        }
        $("#step1").hide("blind");
        $("#loadingIcon").show();
        network.request({
            path: "service/wishlist",
            type: "getASINs",
            domainId: t,
            content: r,
            version: 3
        }).done(function(p) {
            $("#loadingIcon").hide();
            p = p.queryResult[t];
            0 == p.length ? (5 == storage.language ? replaceHtml("wishError", "<br>" + la._227 + " Amazon." + getTldByDomain(t) + la._228 + r + la._228_2) : replaceHtml("wishError", "<br>" + la._227 + r + " " + la._228 + " Amazon." + getTldByDomain(t)),
            $("#step1").show("blind")) : wishlistStep2(p, r, t)
        }).fail(function(p) {
            replaceHtml("wishError", "<br>" + la._error)
        });
        $(this).text(la._110)
    }))
}
function getProductIcons(a, b) {
    var d = ""
      , h = a.length;
    b = b ? 35 : 9 > h ? "100" : 18 < h ? "35" : "70";
    for (var m = 0; m < h && 63 > m; m++) {
        var t = a[m];
        d += '<div class="productIcon" style="width: ' + b + "px; height: " + b + "px; background:" + (41 < m && 62 < h ? "linear-gradient(to bottom, rgba(255,255,255,0) 17%, rgba(255,255,255,1) 90%)," : "") + "url(" + ("" != t ? imageServerAsin + t + ".01._SL" + b + "_.jpg" : imgCDNUrl + "no-photo-available.png") + ') no-repeat center center"></div>'
    }
    return d
}
function getProductIconsCard(a, b) {
    for (var d = "", h = 0, m = {}, t = $jscomp.makeIterator(a.items), f = t.next(); !f.done; m = {
        $jscomp$loop$prop$item$739: m.$jscomp$loop$prop$item$739
    },
    f = t.next())
        if (m.$jscomp$loop$prop$item$739 = f.value,
        !0 !== a.removeTrackingWhenPurchased || "0" === m.$jscomp$loop$prop$item$739[3])
            if (f = b.find(function(n) {
                return function(r) {
                    return r.asin === n.$jscomp$loop$prop$item$739[0]
                }
            }(m)))
                if (f = imageToUrl(f.imagesCSV, 90),
                !1 === f && (f = imgCDNUrl + "no-photo-available.png"),
                d += '<div class="productIcon" style="width:90px;height:90px;margin:12px 1px;background:url(' + f + ') no-repeat center center"></div>',
                h++,
                8 <= h)
                    break;
    return d
}
function wishlistStep2(a, b, d) {
    if (enableWishlistTrackingComponent)
        replaceHtml("step2List", '<p class="mdc-typography--body2">' + la._229 + la._230 + "</p><br>" + getProductIcons(a, !1) + "<br><br>"),
        TrackingComponent.initList({
            asinList: a,
            domainId: d,
            wishlistId: b,
            containerId: "step2Form"
        });
    else {
        var h = 0 !== storage.accountType && hasDataAccessSubscription
          , m = getProductIcons(a, !1) + "<br><br>" + la._229 + la._230 + "<br><br>" + la._231 + "<br><br>"
          , t = getCurrencyByDomain(d)
          , f = function(K) {
            var H = 0 == storage.accountType ? la._705 : h ? "" : la._704;
            H = h ? "" : '&ensp;<a href="https://keepa.com/#!settings/1" title="' + H + '"><i class="fa fa-lock fa-lg"></i></a>';
            return '<td class="trackFormTable-less trackFormTable-less-more"><div>%</div>\n\t\t\t\t' + material.getRadio("is-drop-1-" + K, la._95, !0, "is-drop-" + K, !1, 1) + "<br>\n\t\t\t\t" + material.getRadio("is-drop-0-" + K, la._703, !1, "is-drop-" + K, !h, 0) + H + "\n\t\t\t</td>"
        }
          , n = 10 == d ? "" : '<td class="trackFormTable-currency"></td>\n\t\t<td class="trackFormTable-price"><input type="text" rel="price" placeholder="' + la._83 + '" name="priceAmazon" id="priceAmazon" maxlength="10"></td>\n\t\t' + f(CsvType.AMAZON.index);
        f = '<table class="trackFormTable">\n\t\t\t<tr>\n\t\t\t\t<td colspan="3"><label for="priceAmazon">Amazon.' + getTldByDomain(d) + ':</label></td>\n\t\t\t\t<td colspan="3"><label for="priceNew">' + la._93 + ':</label></td>\n\t\t\t\t<td colspan="3"><label for="priceUsed">' + la._94 + ":</label></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t" + n + '\n\t\t\t\t\n\t\t\t\t<td class="trackFormTable-currency"></td>\n\t\t\t\t<td class="trackFormTable-price"><input type="text" rel="price" placeholder="' + la._83 + '" name="priceNew" id="priceNew" maxlength="10"></td>\n\t\t\t\t' + f(CsvType.NEW.index) + '\n\t\t\t\t\n\t\t\t\t<td class="trackFormTable-currency"></td>\n\t\t\t\t<td class="trackFormTable-price"><input type="text" rel="price" placeholder="' + la._83 + '" name="priceUsed" id="priceUsed" maxlength="10"></td>\n\t\t\t\t' + f(CsvType.USED.index) + "\t\t\t\t\n\t\t\t</tr>\n\t\t</table>";
        n = material.getCheckbox("importPurchased", la._814, !1, !1, "importPurchased");
        var r = material.getCheckbox("overwriteExisting", la._815, !0, !1, "overwriteExisting")
          , p = material.getCheckbox("oosAlert", la._816, !1, !1, "oosAlert")
          , z = material.getButton("wishlistSubmit2", la._110, null, "bell-o");
        replaceHtml("step2", m + ('<form id="addTrackForm" method="post" action="">\n\t\t\t<p>' + la._163 + "</p>\n\t\t\t<p>" + la._108 + '</p>\n\t\t\t<div style="padding:16px 0;">\n\t\t\t\t' + f + "\n\t\t\t</div>\t\t\t\n\t\t\t<p>" + la._232 + ":<br>" + la._233 + t + "100. " + la._234 + t + "97" + la._234_2 + '.</p>\n\t\t\t<div style="padding-top:16px;">\n\t\t\t\t' + n + "<br>\n\t\t\t\t" + r + "<br>\n\t\t\t\t" + p + '<br>\n\t\t\t</div>\n\t\t\t<div style="padding-top:20px;">\n\t\t\t\t' + z + "\n\t\t\t</div>\n\t\t</form>"));
        var F = function() {
            trackingFormFocusTrigger = !0;
            var K = $(this).attr("id")
              , H = "borderShadowCoral";
            "priceNew" === K ? H = "borderShadowBlue" : "priceUsed" === K && (H = "borderShadowBlack");
            $('input[rel="price"]').removeClass();
            $(this).addClass(H + "Input")
        };
        $("#priceAmazon").focus(F);
        $("#priceNew").focus(F);
        $("#priceUsed").focus(F);
        10 == d ? F.call($("#priceNew")) : F.call($("#priceAmazon"));
        $(".trackFormTable-price").children().focusout(function() {
            if (0 < $(this).val().length) {
                var K = parseInt($(this).val());
                K && (1 > K || 99 < K) && (K = "",
                showPopup("Error", "value must be between 1% and 99%", !0));
                K = K ? K : "";
                $(this).val(K);
                trackingFormFocusTrigger = !1
            }
        });
        $(".trackFormTable-less-more a").colorTip({
            color: "yellow"
        });
        m = $('[name^="is-drop"]');
        m.attr("tabindex", -1);
        m.on("click", function() {
            var K = this.name.slice(-1);
            2 == K ? F.call($("#priceUsed")) : 1 == K ? F.call($("#priceNew")) : F.call($("#priceAmazon"))
        });
        var I = !1
          , E = !1;
        $("#wishlistSubmit2").click(function(K) {
            K.preventDefault();
            if (trackingFormFocusTrigger && !E)
                E = !0,
                setTimeout(function() {
                    $("#wishlistSubmit2").trigger("click")
                }, 100);
            else {
                E = !1;
                if (I)
                    return !1;
                I = !0;
                $("#step2").hide("blind");
                $("#loadingIcon").show();
                $("#wishlistSubmit2").val(la._45);
                $("span.error").remove();
                replaceHtml("wishError", "");
                var H = function(V) {
                    $("#wishlistSubmit2").val(la._110);
                    reportBug(null, "wishlistimport: " + JSON.stringify(V) + " " + b + " " + a.join());
                    showErrorPopup()
                };
                (function() {
                    function V(ua, na) {
                        /.*price.*/i.test(ua) && (na = na.replace(/(\d)\.(\d\d)/g, "$1$2"),
                        na = na.replace(/(\d),(\d)/g, "$1$2"),
                        na = na.replace(/^0+/, ""));
                        return na
                    }
                    var S = {}
                      , aa = $("#addTrackForm").serializeArray();
                    $.each(aa, function() {
                        if (-1 !== this.name.indexOf("price") && this.value) {
                            var ua = this.name.replace("price", "").toUpperCase()
                              , na = CsvType[ua].index
                              , qa = h ? !aa.some(function(ka) {
                                return ka.name === "is-drop-" + na && 0 === parseInt(ka.value)
                            }) : !0;
                            S[ua] = {
                                price: V(this.name, this.value),
                                isDrop: qa
                            }
                        }
                    });
                    var ea = -1 * TrackingComponent.getDefaultTtl();
                    ea = {
                        wishListId: b,
                        mainDomainId: Number(d),
                        ttl: ea,
                        expireNotify: !0,
                        desiredPrices: null,
                        desiredPricesInMainCurrency: !0,
                        isOneTimeImport: !0,
                        removeTrackingWhenDeleted: !0,
                        removeTrackingWhenPurchased: !$("#importPurchased-checkbox")[0].checked,
                        overwriteExistingTrackings: $("#overwriteExisting-checkbox")[0].checked,
                        skipIfNotInStock: !$("#oosAlert-checkbox")[0].checked,
                        notificationType: [],
                        individualNotificationInterval: -1,
                        minChangeBetweenNotifications: [],
                        notifyIf: []
                    };
                    ea.minChangeBetweenNotifications = Array.apply(null, Array(CsvType.length)).map(function(ua) {
                        return 0
                    });
                    ea.notifyIf.push({
                        domain: ea.mainDomainId,
                        csvType: CsvType.LIGHTNING_DEAL.index,
                        notifyIfType: 1
                    });
                    for (var ra in S) {
                        var pa = S[ra];
                        10 == d && "AMAZON" === ra || !pa.price || (ea.notifyIf.push({
                            domain: ea.mainDomainId,
                            csvType: CsvType[ra].index,
                            notifyIfType: 2
                        }),
                        ea.minChangeBetweenNotifications[CsvType[ra].index] = pa.isDrop ? -Number(pa.price) : Number(pa.price))
                    }
                    network.request({
                        path: "track",
                        type: "wishListImport",
                        trackingRequest: ea,
                        version: 3
                    }).done(function(ua) {
                        I = !1;
                        if (null == ua.error)
                            $("#loadingIcon").hide(),
                            ua.hash && handleSettingsRequest(ua, !0),
                            $("#step1").hide(),
                            $("#step3").show("blind"),
                            SettingsNotification.init();
                        else
                            switch (ua.error.type) {
                            case "userNotKnown":
                                registerAnonymous().done(function() {
                                    $("#wishlistSubmit2").trigger("click")
                                }).fail(H);
                                break;
                            case "productNotKnown":
                                showPopup("Tracking Error", "Product is invalid and can not be tracked.", !0);
                                resetTrack();
                                break;
                            case "maxTrackingReached":
                                showPopup("Tracking Limit Reached", la._920.replace("#maxTrackingAllowed#", maxTrackingAllowed) + "<br><br><b>" + la._921 + "</b>", !0);
                                $("#wishlistSubmit2").val(la._110);
                                break;
                            default:
                                H(ua)
                            }
                    }).fail(function() {
                        I = !1;
                        $("#step2").show("blind");
                        $("#loadingIcon").hide();
                        replaceHtml("wishError", "<br>" + la._error);
                        $("#wishlistSubmit2").val(la._110)
                    })
                }
                )()
            }
        });
        $("#addTrackForm").submit(function(K) {
            K.preventDefault()
        });
        $("#step2").show("blind")
    }
}
;var IAP = function() {
    function a(f) {
        t();
        var n = $.Deferred()
          , r = Date.now() + "" + Math.floor(1E5 * Math.random());
        b[r] = n;
        f.value.parameters = {
            env: "prod"
        };
        window.postMessage({
            key: "IAP",
            value: f.value,
            id: r,
            origin: "keepaIAP",
            location: "" + document.location
        }, "*");
        return n.promise()
    }
    var b = {}
      , d = null
      , h = $.Deferred()
      , m = !1
      , t = function() {
        m || (m = !0,
        window.addEventListener("message", function(f) {
            if (f.data && f.data.key && "IAPResponse" == f.data.key) {
                var n = b[f.data.id];
                n && (delete b[f.data.id],
                n.resolve(f.data))
            }
        }, !1))
    };
    return {
        getSkuDetails: function() {
            return a({
                value: {
                    method: "getSkuDetails"
                }
            })
        },
        buy: function(f) {
            return a({
                value: {
                    method: "buy",
                    sku: f
                }
            })
        },
        consumePurchase: function() {
            return a({
                value: {
                    method: "consumePurchase"
                }
            })
        },
        getPurchases: function() {
            return a({
                value: {
                    method: "getPurchases"
                }
            }).done(function(f) {
                if (!f.response || f.response.errorType)
                    clearInterval(interval),
                    h.reject("notInstalled"),
                    console.log(f);
                else if (f = f.response.response,
                f.details) {
                    d = {};
                    f = $jscomp.makeIterator(f.details);
                    for (var n = f.next(); !n.done; n = f.next())
                        (n = n.value) && n.state && (d[n.sku] = n)
                }
            })
        },
        getActive: function() {
            return d
        },
        onReady: function() {
            return h
        }
    }
}();
var filename, activeSubMenu = 0, hoveredSubMenu = -1, $subMenus = $(".subMenu"), leftPanelVisible = !1, newThemeColor = "#444";
function initMenu() {
    $subMenus = $(".subMenu");
    var a = $("#topMenu");
    $("#topMenu").on("click", function(h) {
        var m = h.target.hash || window.location.hash.split("/")[0];
        m = m.replace("%21", "!");
        "#!" != m.substring(0, 2) && (m = "#!" + m.substring(1));
        if (void 0 !== m) {
            a.find("a").attr("style", "");
            $subMenus.hide();
            $subMenus.find("a").attr("style", "");
            if ("showSearchBar" == $(h.target).attr("id") || "showSearchBar" == $(h.target).parent().attr("id"))
                m = "#!search";
            var t = {
                "box-shadow": "rgba(255, 255, 255, 0.568627) 0px -13px 13px -9px inset"
            }
              , f = {
                "margin-top": "80px",
                height: ""
            }
              , n = !1
              , r = m
              , p = !1
              , z = $("#subPanel");
            switch (m) {
            case "":
            case "#!":
            case "#!sso":
            case "#!settings":
            case "#!channels":
                f["margin-top"] = "40px";
                break;
            case "#!comment":
            case "#!community":
            case "#!discuss":
                f["margin-top"] = "40px";
                t.background = "rgba(128, 128, 128, 0.4)";
                break;
            case "#!tmp":
            case "#!track":
            case "#!product":
                return;
            case "#!deals":
                t.background = "rgba(108, 166, 245, 0.4)";
                newThemeColor = "#566D8D";
                f["margin-top"] = "40px";
                r = "#!deals";
                p = !0;
                break;
            case "#!tracking":
                p = !1;
            case "#!import":
            case "#!notification":
            case "#!notificationAPI":
            case "#!manage":
                r = "#!tracking";
                newThemeColor = "#905246";
                t.background = "rgba(255, 99, 71,0.4)";
                f.background = "rgba(0, 0, 0, 0.27) linear-gradient(to bottom, rgba(147, 84, 73, 0.8) 0, rgba(255, 74, 74, 0.6) 100%)";
                break;
            case "#!imageapi":
            case "#!bot":
            case "#!addon":
            case "#!android":
            case "#!api":
            case "#!app":
                r = "#!addon";
                newThemeColor = "#417156";
                t.background = "rgba(60, 179, 113, 0.4)";
                f.background = "rgba(0, 0, 0, 0.27) linear-gradient(to bottom, rgba(70, 118, 91, 0.8) 0, rgba(60, 179, 113, 0.4) 100%)";
                break;
            case "#!bestseller":
            case "#!categorytree":
            case "#!data":
            case "#!finder":
            case "#!seller":
            case "#!topseller":
            case "#!viewer":
                r = "#!data";
                newThemeColor = "#77435f";
                t.background = "rgba(197, 67, 138, 0.4)";
                f.background = "linear-gradient(rgba(118, 70, 106, 0.8) 0px, rgba(179, 60, 109, 0.4) 100%) rgba(0, 0, 0, 0.27)";
                break;
            case "#!faq":
            case "#!disclaimer":
            case "#!news":
            case "#!features":
                r = "#!features";
                newThemeColor = "#8F6129";
                t.background = "rgba(255, 140, 0, 0.4)";
                f.background = "rgba(0, 0, 0, 0.27) linear-gradient(to bottom, rgba(149, 103, 47, 0.8) 0, rgba(255, 140, 0, 0.4) 100%)";
                break;
            case "#!dev":
                r = "#!discuss";
                newThemeColor = "#777777";
                t.background = "rgba(192, 192, 192, 0.4)";
                f.background = "rgba(137, 137, 137, 1) linear-gradient(to bottom, rgba(144, 144, 144, 0.8) 0, rgba(28, 28, 28, 0.4) 100%)";
                break;
            case "#!search":
                if ("50px" != $("#subPanel").css("height"))
                    t.background = "rgba(192, 192, 192, 0.4)",
                    f.height = "50px",
                    f["margin-top"] = "80px",
                    f.background = "rgba(137, 137, 137, 1) linear-gradient(to bottom, rgba(144, 144, 144, 0.8) 0, rgba(28, 28, 28, 0.4) 100%)",
                    n = !0,
                    $("#showSearchBar").css(t);
                else {
                    if ("#!search" != (h.target.hash || window.location.hash.split("/")[0])) {
                        $("#topMenu").trigger("click");
                        return
                    }
                    f.height = "50px";
                    f["margin-top"] = "80px";
                    n = !0
                }
                p = $("#leftPanel").is(":visible");
                break;
            default:
                t.background = "rgba(192, 192, 192, 0.6)"
            }
            updateThemeColor(newThemeColor);
            a.find('a[href="' + r + '"]').css(t);
            $subMenus.first().parent().find('ul[rel="' + r + '"]').show();
            $subMenus.find('a[href="' + m + '"]').css({
                cursor: "default",
                "border-bottom": "1px solid white",
                background: "linear-gradient(rgba(255, 255, 255, 0) 33px, rgba(255, 255, 255, 0.44) 100%)"
            });
            z.css(f);
            n ? ($("#searchBar").fadeIn(),
            setTimeout(function() {
                $("#searchInput").focus()
            }, 10)) : $("#searchBar").hide();
            p ? (leftPanelVisible = !0,
            $("#leftPanel").show()) : leftPanelVisible && ($("#deltaPercentRange").rangeSlider("destroy"),
            $("#deltaRange").rangeSlider("destroy"),
            $("#currentRange").rangeSlider("destroy"),
            $("#leftPanel").hide().empty(),
            leftPanelVisible = !1)
        }
    });
    "onhashchange"in window ? (hashChangeSupport = !0,
    window.onhashchange = updateHashedMenu) : interval = window.setInterval(updateHashedMenu, 100);
    updateHashedMenu();
    var b = 0
      , d = function() {
        var h = $("#topPanel").width();
        h != b && (b = h,
        1080 > b ? $("#logo").velocity({
            width: "52px"
        }, 300) : $("#logo").velocity({
            width: "216px"
        }, 300))
    };
    $(window).on("resize", d);
    d()
}
var hashChangeSupport = !1
  , lastUrl = ""
  , lastHash = ""
  , lastRootUrl = ""
  , lastSubUrl = ""
  , ignoreNext = 0
  , busy = !1
  , clickedObjectReference = null
  , rootPreventLoop = !1
  , overlayClosed = !1
  , triggerTrack = !1
  , triggerUnsubscribe = !1
  , preOverlayUrl = "";
function updateHashedMenu() {
    if ("undefined" == typeof isSnapshotPage && (hashChangeSupport || !busy))
        if (!hashChangeSupport && skipAsyncInterval)
            skipAsyncInterval = !1;
        else {
            try {
                clearTimeout(iframeTimeout)
            } catch (p) {}
            busy = !0;
            var a = window.location.hash;
            a = a.replace("%21", "!");
            var b = a.indexOf("?");
            if (-1 < b && !a.startsWith("#!sso") && !a.startsWith("#!discuss"))
                window.location.hash = a.substr(a, b);
            else if ("#!" != a.substring(0, 2))
                window.location.hash = "#!" + a.substring(1);
            else {
                b = a.split("/");
                var d = b[0];
                "undefined" == typeof isLoggerPage && network.cancel();
                var h = $("#graph");
                0 < h.length ? (graph.remove(h.data("domainId"), h.data("asin"), h.data("index"), !1),
                graph.remove(h.data("domainId"), h.data("asin"), h.data("index"), !0),
                graph.remove(h.data("domainId"), h.data("asin"), 1, !1)) : "#!product" != d && "#!manage" != d && graph.removeAll();
                if ("#!language" == d)
                    window.location.hash = "",
                    storage.language = b[1],
                    verifyRegExp.domainId.test(storage.language) && (storage.domain = storage.language),
                    refreshDomain(storage.domain),
                    settings.refresh(),
                    d = "",
                    location.reload();
                else {
                    if ("#!signup" === d || "#!signupLoginFail" === d)
                        "#!signupLoginFail" === d && showPopPopup("Login Failed", 'No Keepa account is connected with the chosen "login with" option. You can register a new one instead or use a different login option.', !0),
                        window.location.hash = "",
                        2 != storage.accountType && window.setTimeout(function() {
                            showLoginOverlay();
                            $("#registerTab").trigger("click")
                        }, 800),
                        d = "";
                    if ("#!fbMessengerLogin" !== d && "#!tgMessengerLogin" !== d) {
                        "#!logout" === d && (window.location.hash = "",
                        logout(),
                        d = "");
                        if ("#!sso" === d) {
                            if (inIframe())
                                return;
                            sso = getQueryVariable("sso");
                            sig = getQueryVariable("sig");
                            $(".subMenu").hide();
                            if (2 == storage.accountType) {
                                sendToDiscussSSO();
                                return
                            }
                            window.setTimeout(function() {
                                showLoginOverlay();
                                $("#loginTab").trigger("click")
                            }, 800)
                        }
                        "#!search" === d && (h = [],
                        h = b,
                        h.splice(0, 1),
                        b[1] = h.join("/"));
                        if ("#!pricedataapi" == d)
                            d = "",
                            window.location.hash = "#!api";
                        else {
                            if ("#!r" == d) {
                                if (64 <= b[1].length) {
                                    var m = b[1].substring(64);
                                    d = b[1].substr(0, 64);
                                    var t = b[2] && 0 < b[2].length ? "/" + b[2] : "";
                                    if (storage.token != d) {
                                        h = storage.install;
                                        var f = storage.optOut_crawl
                                          , n = storage.overlayPriceGraph
                                          , r = storage.revealStock;
                                        network.clearDatabase();
                                        storage.clear();
                                        h && (storage.install = h);
                                        f && (storage.optOut_crawl = f);
                                        n && (storage.overlayPriceGraph = n);
                                        r && (storage.revealStock = r);
                                        initializeSettings();
                                        settings.setToken(d, !0);
                                        settings.retrieve(!1).always(function() {
                                            window.location.hash = "#!" + m + t
                                        })
                                    }
                                    setTimeout(function() {
                                        window.location.hash = "#!" + m + t
                                    }, 100)
                                }
                                lastSubUrl = d = "";
                                window.location.hash = "#!tmp"
                            }
                            "#!discuss" === d && callSubPage(0);
                            1 < b.length ? (b = b[1],
                            b != lastSubUrl && (lastSubUrl = b,
                            d == lastUrl && callSubPage(0))) : lastSubUrl = "";
                            if ("" == d && "" == lastUrl && !rootPreventLoop)
                                generateStartPage(),
                                rootPreventLoop = !0;
                            else if ("" == d && "" != lastUrl)
                                document.title = "Keepa.com",
                                rootPreventLoop = !1,
                                activeSubMenu = 0,
                                $("#bodyPanel").hide(),
                                $("#contentStartPage").show(),
                                -1 == lastUrl.indexOf("#!product") && (preOverlayUrl = lastHash),
                                lastUrl = d,
                                lastHash = a,
                                $(".menuItem, .subList").attr("style", "");
                            else if (d != lastUrl && ("#!track" == d ? (d = "#!product",
                            triggerTrack = !0) : "#!trackDelete" == d ? setTimeout(function() {
                                var p = deleteTracking();
                                p && p.done(function() {
                                    showPopup("Tracking deleted", la._437, !0)
                                }).fail(showErrorPopup).always(function() {
                                    location.hash = "!notification"
                                })
                            }, 0) : "#!unsubscribe" == d ? (d = "#!channels",
                            triggerUnsubscribe = !0) : "#!verify" == d ? generateVerifyEmail() : "#!pwreset" == d && ($("#loginOverlay-close").trigger("click"),
                            $("#domainName").css("color", "rgb(255, 99, 71)"),
                            $("#contentStartPage").hide(),
                            generatePWreset()),
                            -1 == lastUrl.indexOf("#!product") && -1 == lastUrl.indexOf("#!finder") && -1 == lastUrl.indexOf("#!viewer") && (preOverlayUrl = lastHash),
                            lastHash = a,
                            lastUrl = d,
                            rootPreventLoop = !1,
                            $("#topMenu").trigger("click"),
                            $("#bodyPanel").show(),
                            "#!search" == lastUrl ? 0 < lastSubUrl.length && loadPage(lastUrl) : loadPage(lastUrl),
                            d.match(/#!comment-.*/))) {
                                $('a[href="#!comment"]').trigger("click");
                                return
                            }
                            busy = !1
                        }
                    }
                }
            }
        }
}
var skipAsyncInterval = !1;
function updateSub(a, b, d, h) {
    busy = !0;
    clickedObjectReference = a;
    $("#contentStartPage").is(":visible") ? $("#bodyPanel").show() : skipAsyncInterval = !0;
    $(".menu" + d).trigger("click");
    a.siblings().attr("style", "");
    a.css("color", b);
    checkURL(h);
    busy = !1
}
function checkURL(a) {
    a || (a = window.location.hash);
    var b = a.split("|");
    a = b[0];
    1 < b.length && (b = b[1],
    b != lastSubUrl && (lastSubUrl = b));
    loadPage(a);
    a != lastUrl && (lastUrl = a,
    ignoreNext = 1)
}
function settingsUndo(a) {
    if (a.is(":visible")) {
        var b = a.html()
          , d = /(\d+)/.exec(b)
          , h = Number(d[1]);
        1 == h ? network.request({
            path: "user/session",
            type: "delete",
            version: 3
        }).done(function(m) {
            $("#settingsPage").hide("explode", 1E3, function() {
                replaceHtml("bodyPanel", "");
                window.location.hash = ""
            });
            logout()
        }).fail(showErrorPopup) : (a.html(b.replace(d[1], h - 1)),
        window.setTimeout(function() {
            settingsUndo(a)
        }, 1E3))
    }
}
function getNewPasswordHtml() {
    return '<div id="passBox" style="display:none;" ><table class="trackFormTable"><tr><td class="trackFormTable-empty">&nbsp;</td><td colspan="2"><label for="oldPW">' + (isSocialAccount ? la._4 : la._57) + '</label></td><td colspan="2"><label for="newPW">' + la._58 + '</label></td><td colspan="2"><label for="newPW2">' + la._59 + '</label></td></tr><tr><td class="trackFormTable-empty">&nbsp;</td><td class="trackFormTable-id"><input autocapitalize="off" autocorrect="off" type="' + (isSocialAccount ? "text" : "password") + '" rel="ids" maxlength="1024" name="oldPW" id="oldPW" /></td><td class="trackFormTable-empty">&nbsp;</td><td class="trackFormTable-id"><input type="password" rel="ids" maxlength="1024" name="newPW" id="newPW" /></td><td class="trackFormTable-empty">&nbsp;</td><td class="trackFormTable-id"><input type="password" rel="ids" maxlength="1024" name="newPW2" id="newPW2" /></td><td class="trackFormTable-empty">&nbsp;</td></tr></table></div>'
}
function settingsFailLabels(a) {
    var b = [];
    a.status.length ? b = a.status : b.push(a.status);
    for (var d = 0; d < b.length; d++) {
        switch (b[d]) {
        case 0:
            break;
        case 1:
            errorLabel = "username";
            errorMsg = "amazon locale not valid";
            break;
        case 2:
            errorLabel = "password";
            errorMsg = "language not valid";
            break;
        case 3:
            errorLabel = "idEmail";
            errorMsg = "<br />" + la._49;
            break;
        case 4:
            errorLabel = "idTwitter";
            errorMsg = "<br />" + la._72;
            break;
        default:
            reportBug(null, "settings.send() " + JSON.stringify(a)),
            showErrorPopup()
        }
        0 != b[d] && ($("label[for=" + errorLabel + "]").append('<span class="error">' + errorMsg + "</span>"),
        $("#submit").val(la._64))
    }
}
var isSettings;
function insertSettings() {
    get("s_boxVertical") || resetSettings(0);
    try {
        var a = JSON.parse(get("showGraphs"))
    } catch (G) {
        a = graph.getDefaultShowGraphSetting(),
        reportBug(G, get("showGraphs") + " " + G)
    }
    var b = get("s_range")
      , d = get("graphScale")
      , h = get("extremeFilter")
      , m = get("s_dateFormat")
      , t = get("s_trackingMode")
      , f = Number(get("s_trackingTtl"))
      , n = get("s_merchantTrack")
      , r = get("s_boxHorizontal");
    get("s_position");
    var p = get("s_boxType")
      , z = get("optOut_crawl")
      , F = get("overlayPriceGraph")
      , I = get("revealStock");
    t = "<li>\n\t\t\t<sep>&#x271C;</sep>" + la._843 + '<sep>&emsp;-</sep>\n\t\t\t<span id="s_trackingMode">\n\t\t\t\t<a' + ("basic" === t ? " active" : "") + ' rel="basic">' + la._844 + "</a>\n\t\t\t\t<a" + ("advanced" === t ? " active" : "") + ' rel="advanced">' + la._845 + "</a>\n\t\t\t\t<a" + ("pro" === t ? " active" : "") + ' rel="pro">' + la._846 + "</a>\n\t\t\t</span>\n\t\t</li>";
    var E = "";
    TrackingComponent.getTtlOptions().forEach(function(G) {
        E += "<a" + (f === G.value ? " active" : "") + ' rel="' + G.value + '">' + G.label + "</a>"
    });
    var K = "<li>\n\t\t\t<sep>&#x271C;</sep>" + la._874 + '<sep>&emsp;-</sep>\n\t\t\t<span id="s_trackingTtl">\n\t\t\t\t' + E + "\n\t\t\t</span>\n\t\t</li>"
      , H = storage.sendUpcomingLightningDealsAlert
      , V = "";
    "undefined" != typeof H && (V = "<li><sep>&#x271C;</sep>" + la._431 + '<sep>&emsp;-</sep><span id="s_upcomingLightningDeals"><a multi ' + ("true" == H ? "active" : "") + ' rel="true">' + la._254 + "</a><a multi " + ("false" == H ? "active" : "") + ' rel="false">' + la._255 + "</a></span></li>");
    var S = storage.sendStartLightningDealsAlert;
    H = "";
    "undefined" != typeof S && (H = "<li><sep>&#x271C;</sep>" + la._713 + '<sep>&emsp;-</sep><span id="s_startLightningDeals"><a multi ' + ("true" == S ? "active" : "") + ' rel="true">' + la._254 + "</a><a multi " + ("false" == S ? "active" : "") + ' rel="false">' + la._255 + "</a></span></li>");
    var aa = [1, 2, 3]
      , ea = storage.useSmile;
    S = "";
    "undefined" != typeof ea && -1 < aa.indexOf(Number(storage.domain)) && (S = '<li><sep>&#x271C;</sep>Amazon Smile<sep>&emsp;-</sep><span id="s_useSmile"><a multi ' + ("true" == ea ? "active" : "") + ' rel="true">' + la._254 + "</a><a multi " + ("false" == ea ? "active" : "") + ' rel="false">' + la._255 + "</a></span></li>");
    aa = "<li>\n\t\t<sep>&#x271C;</sep>&emsp;" + la._975 + '<sep>&emsp;-</sep>\n\t\t<span id="stockMaxOrderQty">\n\t\t\t<a ' + ("true" == storage.stockMaxOrderQty ? "active" : "") + ' rel="true">' + la._254 + "</a>\n\t\t\t<a " + ("false" == storage.stockMaxOrderQty ? "active" : "") + ' rel="false">' + la._255 + "</a>\n\t\t</span>\n\t</li>";
    var ra = storage.defaultNotificationInterval;
    ea = "";
    if ("undefined" != typeof ra) {
        ra = Number(ra) / 1440;
        ea = 0 < ra ? "active" : "";
        var pa = 0 == ra ? "active" : "";
        0 == ra && (ra = "-");
        ea = "<li><sep>&#x271C;</sep>" + la._432 + '<sep>&emsp;-</sep><span id="s_rearm"><div contenteditable="true"  class="editBox">' + ra + "</div><a " + ea + ' style="cursor:default"> ' + la._143 + "</a><a multi " + pa + ' rel="true">' + la._433 + '</a></span><span><a title="How does it work?" target="_blank" href="https://discuss.keepa.com/t/continuous-tracking-rearm-timer/62?u=keepa"><i class="fa fa-15 fa-external-link" ></i></a></span></li>'
    }
    ra = 1 == a[0] ? "active" : "";
    pa = 1 == a[1] ? "active" : "";
    a = 1 == a[2] ? "active" : "";
    var ua = "24" == b ? "active" : ""
      , na = "168" == b ? "active" : ""
      , qa = "744" == b ? "active" : ""
      , ka = "2160" == b ? "active" : ""
      , za = "8760" == b ? "active" : "";
    b = "-1" == b ? "active" : "";
    var J = "0" == h ? "active" : "";
    h = "1" == h ? "active" : "";
    var g = "D, M j G:i" == m ? "active" : ""
      , D = "G:i %- d/m/Y" == m ? "active" : ""
      , N = "M j, g a" == m ? "active" : ""
      , ba = "j. M, G %U%h%r" == m ? "active" : ""
      , q = "G%\u6642n%\u6708j%\u65e5" == m ? "active" : ""
      , L = "1" == n.charAt(0) ? "active" : ""
      , A = "1" == n.charAt(1) ? "active" : "";
    n = "1" == n.charAt(2) ? "active" : "";
    var O = "0" == r ? "active" : "";
    r = "1" == r ? "active" : "";
    var P = "0" == p ? "active" : "";
    p = "1" == p ? "active" : "";
    var M = "0" == z ? "active" : "";
    z = "1" == z ? "active" : "";
    var u = "0" == F ? "active" : "";
    F = "1" == F ? "active" : "";
    var v = "0" == I ? "active" : "";
    I = "1" == I ? "active" : "";
    replaceHtml("settingsContent", '<section id="settingsTab">\n\t\t\t<span class="settingLabel">' + la._252 + '</span>\n\t\t\t<ul id="chartList" rel="chart">\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>' + la._253 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="showGraphs">\n\t\t\t\t\t\t<a multi ' + ra + ' rel="0">Amazon</a>\n\t\t\t\t\t\t<a multi ' + pa + ' rel="1">' + la._93 + "</a>\n\t\t\t\t\t\t<a multi " + a + ' rel="2">' + la._94 + "</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._135 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="s_range">\n\t\t\t\t\t\t<a ' + ua + ' rel="24">' + la._136 + "</a>\n\t\t\t\t\t\t<a " + na + ' rel="168">' + la._137 + "</a>\n\t\t\t\t\t\t<a " + qa + ' rel="744">' + la._139 + "</a>\n\t\t\t\t\t\t<a " + ka + ' rel="2160">' + la._140 + "</a>\n\t\t\t\t\t\t<a " + za + ' rel="8760">' + la._141 + "</a>\n\t\t\t\t\t\t<a " + b + ' rel="-1">' + la._142 + "</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._144 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="graphScale">\n\t\t\t\t\t\t<a ' + ("0" == d ? "active" : "") + ' rel="0">' + la._146 + "</a>\n\t\t\t\t\t\t<a " + ("1" == d ? "active" : "") + ' rel="1">' + la._145 + "</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._164 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="extremeFilter">\n\t\t\t\t\t\t<a ' + J + ' rel="0">' + la._254 + "</a>\n\t\t\t\t\t\t<a " + h + ' rel="1">' + la._255 + "</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._257 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="s_dateFormat">\n\t\t\t\t\t\t<a ' + g + ' rel="D, M j G:i">' + (new Date).formatDate("D, M j G:i") + "</a>\n\t\t\t\t\t\t<a " + D + ' rel="G:i %- d/m/Y">' + (new Date).formatDate("G:i %- d/m/Y") + "</a>\n\t\t\t\t\t\t<a " + N + ' rel="M j, g a">' + (new Date).formatDate("M j, g a") + "</a>\n\t\t\t\t\t\t<a " + ba + ' rel="j. M, G %U%h%r">' + (new Date).formatDate("j. M, G %U%h%r") + "</a>\n\t\t\t\t\t\t<a " + q + ' rel="G%\u6642n%\u6708j%\u65e5">' + (new Date).formatDate("G%\u6642n%\u6708j%\u65e5") + '</a>\n\t\t\t\t\t\t<div title="Supported switches are \n a, A, B, c, d, D, F, g, G, h, H, i, I, j, l, L, m,\n M, n, N, O, P, r, s, S, t, U, w, W, y, Y, z, Z\n To escape chars, use %. \n\n For more information, Google: \'PHP date\'" contenteditable="true" class="editBox">' + m + '</div>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<span class="settingLabel">' + la._258 + '</span>\n\t\t\t<ul id="trackList" rel="tracking">\n\t\t\t\t' + t + "\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._259 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="s_percent">\n\t\t\t\t\t\t<div contenteditable="true" class="editBox">' + get("s_percent") + '</div><a style="cursor:default"> %&emsp;(' + la._260 + ")</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._261 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="s_merchantTrack">\n\t\t\t\t\t\t<a multi ' + L + ' rel="0">Amazon</a>\n\t\t\t\t\t\t<a multi ' + A + ' rel="1">' + la._93 + "</a>\n\t\t\t\t\t\t<a multi " + n + ' rel="2">' + la._94 + "</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t" + K + "\n\t\t\t\t" + V + "\n\t\t\t\t" + H + "\n\t\t\t\t" + ea + "\n\t\t\t\t" + S + '\n\t\t\t</ul>\n\t\t\t<span class="settingLabel">' + la._262 + '</span>\n\t\t\t<ul id="addonList" rel="addon">\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>' + la._56 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="s_language">\n\t\t\t\t\t\t<a rel="1"><img id="lang_en" src="' + englishFlag + '" /></a>\n\t\t\t\t\t\t<a rel="3"><img id="lang_de" src="' + flag_3 + '" /></a>\n\t\t\t\t\t\t<a rel="4"><img id="lang_fr" src="' + flag_4 + '" /></a>\n\t\t\t\t\t\t<a rel="5"><img id="lang_jp" src="' + flag_5 + '" /></a>\n\t\t\t\t\t\t<a rel="7"><img id="lang_cn" src="' + flag_7 + '" /></a>\n\t\t\t\t\t\t<a rel="8"><img id="lang_it" src="' + flag_8 + '" /></a>\n\t\t\t\t\t\t<a rel="9"><img id="lang_es" src="' + flag_9 + '" /></a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep><span id="currencySettings"><a rel="currencySettings">' + la._949 + "</a></span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._263 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="s_boxVertical">\n\t\t\t\t\t\t<div id="test" contenteditable="true" class="editBox">' + get("s_boxVertical") + '</div><a style="cursor:default"> px&emsp;(' + la._264 + ")</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._265 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="s_boxHorizontal">\n\t\t\t\t\t\t<a ' + O + ' rel="0">' + la._266 + "</a>\n\t\t\t\t\t\t<a " + r + ' rel="1">' + la._267 + "</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._271 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="s_boxType">\n\t\t\t\t\t\t<a ' + P + ' rel="0">' + la._272 + "</a>\n\t\t\t\t\t\t<a " + p + ' rel="1">' + la._273 + "</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._418 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="overlayPriceGraph">\n\t\t\t\t\t\t<a ' + F + ' rel="1">' + la._254 + "</a>\n\t\t\t\t\t\t<a " + u + ' rel="0">' + la._255 + '</a>\n\t\t\t\t\t\t<a style="color: #6b90fd !important;" rel="-1">Setup</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>' + la._438 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="revealStock">\n\t\t\t\t\t\t<a ' + I + ' rel="1">' + la._254 + "</a>\n\t\t\t\t\t\t<a " + v + ' rel="0">' + la._255 + '</a>\n\t\t\t\t\t\t<a style="color: #962b2b !important;" rel="-1">' + (hasDataAccessSubscription ? "" : "Requires Data subscription.") + " " + la._950 + "</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t" + aa + "\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep>" + la._411 + '<sep>&emsp;-</sep>\n\t\t\t\t\t<span id="optOut_crawl">\n\t\t\t\t\t\t<a ' + M + ' rel="0">' + la._254 + "</a>\n\t\t\t\t\t\t<a " + z + ' rel="1">' + la._255 + '</a>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<sep>&#x271C;</sep><span id="s_reset"><a rel="resetSettings">' + la._278 + "</a></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</section>");
    $(".editBox").on("focusout", function() {
        var G = $(this)
          , w = G.parent().attr("id");
        if ("s_dateFormat" != w) {
            var B = 1
              , Q = 90;
            "s_boxVertical" == w && (B = 170,
            Q = 500);
            "s_rearm" == w && (B = 1,
            Q = 365);
            var fa = Number(G.text());
            if (!fa || fa < B || fa > Q)
                showPopup("Error", la._283 + B + la._284 + Q + ".", !0),
                G.text(get(w))
        }
        "s_rearm" == w ? (storage.defaultNotificationInterval = Number(1440 * fa).toFixed(0),
        insertSettings()) : set(w, G.text());
        G.css("border", "1px solid orange");
        try {
            firefox || window.parent.postMessage("refresh,", "*")
        } catch (R) {}
        $("#reload").effect("highlight", {
            color: "#FFDBB7"
        }, 1E3);
        settings.send()
    });
    $(document).on("keypress", ".editBox", function(G) {
        if (13 == G.which && window.getSelection)
            return window.getSelection().getRangeAt(0).deleteContents(),
            !1
    });
    $("#chartList,#trackList,#addonList").hover(function() {
        $(this).prev().css({
            color: "#000",
            borderBottom: "1px solid orange"
        })
    }, function() {
        $(this).prev().css({
            color: "",
            borderBottom: ""
        })
    });
    $("#chartList > li, #trackList > li, #addonList > li").hover(function() {
        $(this).children("sep").css({
            color: "#777"
        })
    }, function() {
        $(this).children("sep").css({
            color: ""
        })
    });
    $("#settingsTab").find("a").on("click", function() {
        var G = $(this)
          , w = G.parent().attr("id")
          , B = G.attr("rel");
        if ("undefined" == typeof B || "undefined" == B)
            console.log("settings click rel is undefined", G);
        else {
            var Q = function() {
                $("#reload").effect("highlight", {
                    color: "#FFDBB7"
                }, 1E3);
                settings.send();
                try {
                    firefox || window.parent.postMessage("refresh,", "*")
                } catch (Z) {}
            };
            if (-1 != B)
                switch (w) {
                case "optOut_crawl":
                case "revealStock":
                case "s_boxType":
                case "s_boxHorizontal":
                case "overlayPriceGraph":
                    settings.setExtensionSetting(w, B)
                }
            switch (w) {
            case "showGraphs":
                G = JSON.parse(get("showGraphs"));
                G[B] = "0" == G[B] ? 1 : 0;
                set("showGraphs", G);
                break;
            case "s_range":
                set("s_range", B);
                break;
            case "graphScale":
                set("graphScale", B);
                break;
            case "extremeFilter":
                set("extremeFilter", B);
                break;
            case "s_dateFormat":
                set("s_dateFormat", B);
                break;
            case "s_trackingMode":
                set("s_trackingMode", B);
                break;
            case "s_trackingTtl":
                set("s_trackingTtl", B);
                break;
            case "s_merchantTrack":
                G = get("s_merchantTrack");
                G = G.replaceAt(B, "0" == G.charAt(B) ? 1 : 0);
                set("s_merchantTrack", G);
                break;
            case "s_language":
                set("language", B);
                break;
            case "s_boxHorizontal":
                set("s_boxHorizontal", B);
                break;
            case "overlayPriceGraph":
                if (-1 == B) {
                    B = GraphService.getAvailableGraphTypes();
                    var fa = JSON.parse(get("webGraphType"))
                      , R = get("webGraphRange");
                    G = '<p class="mdc-typography--body2">' + la._654 + ':</p>\n\t\t\t\t\t\t<div id="ovSetup">';
                    w = $jscomp.makeIterator(B);
                    for (var T = w.next(); !T.done; T = w.next())
                        T = T.value,
                        G += '<input type="checkbox" id="webGraphType' + T + '" value="' + T + '"><label for="webGraphType' + T + '">' + CsvType.getName(T) + "</label><br>";
                    G += '<br><input type="number" min="1" max="1000" id="webGraphRange" value="' + R + '"><label for="webGraphRange">&ensp;' + la._135 + " (" + la._143 + ')</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p class="mdc-typography--body2"><span class="button" id="saveSetup">&ensp;' + la._64 + "&ensp;</span></p>";
                    var oa = showPopup(la._253, G, !0);
                    B = $jscomp.makeIterator(B);
                    for (T = B.next(); !T.done; T = B.next())
                        G = T.value,
                        1 == fa[G] && $("#webGraphType" + G).prop("checked", !0);
                    $("#saveSetup").on("click", function() {
                        oa.close();
                        $("#ovSetup input[type=checkbox]").each(function(Z, ja) {
                            fa[ja.value] = $(ja).prop("checked") ? 1 : 0
                        });
                        set("webGraphType", fa);
                        R = Number($("#webGraphRange")[0].value);
                        set("webGraphRange", R);
                        settings.setExtensionSetting("webGraphRange", "" + R);
                        settings.setExtensionSetting("webGraphType", JSON.stringify(fa));
                        Q()
                    });
                    return
                }
                set("overlayPriceGraph", B);
                break;
            case "revealStock":
                if (-1 == B) {
                    window.open("https://keepa.com/#!settings/1");
                    return
                }
                set("revealStock", B);
                break;
            case "stockMaxOrderQty":
                B != storage.stockMaxOrderQty && (showPopup("", la._976, !0),
                storage.stockMaxOrderQty = "true" == B);
                break;
            case "s_position":
                set("s_position", B);
                set("s_boxType", 0);
                break;
            case "s_boxType":
                set("s_boxType", B);
                set("s_position", 0);
                break;
            case "s_upcomingLightningDeals":
                storage.sendUpcomingLightningDealsAlert = "true" == B;
                break;
            case "s_startLightningDeals":
                storage.sendStartLightningDealsAlert = "true" == B;
                break;
            case "s_useSmile":
                storage.useSmile = "true" == B;
                break;
            case "s_rearm":
                B = Number(B);
                isNaN(B) && (B = 0);
                storage.defaultNotificationInterval = Number(1440 * B).toFixed(0);
                break;
            case "optOut_crawl":
                set("optOut_crawl", B);
                break;
            case "s_reset":
                resetSettings(1);
                break;
            case "currencySettings":
                CurrencySwitch.init();
                break;
            default:
                return
            }
            insertSettings();
            Q()
        }
    })
}
function resetSettings(a) {
    1 == a && showPopup("", la._286, !0);
    set("showGraphs", graph.getDefaultShowGraphSetting());
    set("s_range", 2160);
    set("graphScale", 0);
    set("extremeFilter", 0);
    set("s_dateFormat", "D, M j G:i");
    set("s_percent", 5);
    set("s_trackingMode", "basic");
    set("s_trackingTtl", TrackingComponent.getDefaultTtl());
    set("s_merchantTrack", "100");
    set("s_boxHorizontal", 0);
    set("s_position", 0);
    set("s_boxType", 0);
    set("optOut_crawl", 0);
    set("revealStock", 1);
    set("stockMaxOrderQty", !1);
    set("webGraphType", JSON.stringify(GraphService.getDefaultWebGraphType()));
    set("webGraphRange", GraphService.getDefaultWebGraphRange().toString())
}
function save(a, b) {
    "object" == typeof b && (b = JSON.stringify(b));
    storage[a] = b;
    try {
        addon(a, b)
    } catch (d) {}
}
function set(a, b) {
    "object" == typeof b && (b = JSON.stringify(b));
    storage[a] = b;
    try {
        addon("storageEntry", {
            key: a,
            value: b
        })
    } catch (d) {}
}
function remove(a) {
    storage.removeItem(a)
}
function get(a) {
    var b = storage[a];
    b && "null" != b || (b = {
        showGraphs: JSON.stringify(graph.getDefaultShowGraphSetting()),
        s_range: "2160",
        graphScale: "0",
        s_dateFormat: "D, M j G:i",
        s_percent: "5",
        s_trackingMode: "basic",
        s_trackingTtl: TrackingComponent.getDefaultTtl().toString(),
        s_merchantTrack: "100",
        s_boxVertical: "200",
        s_boxHorizontal: "0",
        s_position: "0",
        s_boxType: "0",
        optOut_crawl: "0",
        s_alertTimer: "900000",
        extremeFilter: "0",
        revealStock: "1",
        webGraphType: JSON.stringify(GraphService.getDefaultWebGraphType()),
        webGraphRange: GraphService.getDefaultWebGraphRange().toString()
    }[a],
    save(a, b));
    return b
}
;var searching = !1;
function sendSearch(a) {
    if (!searching) {
        searching = !0;
        $("#leftPanel").hide();
        verifyRegExp.domainId.test(a) || (a = /^([1-9]|10|11|12)$/.test(storage.domain) ? storage.domain : la == la_de ? 3 : la == la_ja ? 5 : 1);
        var b = $("#searchInput").val();
        replaceHtml("searchPage", '<div style="margin-top:250px;">' + getLoaderBox(!0) + "</div>");
        replaceHtml("searchPageContinue", "");
        network.request({
            content: b,
            domainId: a,
            path: "service/search",
            type: "productBasic",
            version: 3
        }).always(function(d) {
            searching = !1;
            d = d.searchProducts;
            null == d || 0 == d.length ? (replaceHtml("searchPage", la._237 + '<span id="searchQuery" style="color:slategrey;"></span>' + la._238),
            $("#searchQuery").text(b)) : null != d && 1 == d.length ? ($("#bodyPanel").html(""),
            window.document.location.hash = "#!product/" + d[0].domainId + "-" + d[0].asin) : (GridSearch.init(d, "searchPage"),
            d = '<div class="card m-t-10 p-10"><p class="mdc-typography--caption -center">\n                        <a class="href -data" href="https://www.amazon.' + getTldByDomain(a) + "/gp/search?keywords=" + encodeURIComponent(b) + '">&rarr; ' + la._357 + " &larr;</a>\n                    </p></div>",
            $("#searchPageContinue").html(d));
            $("#subMenu1Search").prev().css("visibility", "hidden")
        })
    }
}
function searchUpdate() {
    0 == $("#searchPage").length && generateSearch();
    var a = window.location.hash.split("/");
    if ("#!search" == a[0] || "#search" == a[0]) {
        a.splice(0, 1);
        var b = a.join("/").split("-");
        if (2 > b.length)
            replaceHtml("productTableDescription", "Error:<br>" + la._216);
        else {
            a = b.splice(0, 1);
            b = decodeURIComponent(b.join("-"));
            $(".headline").text(la._10 + ": " + truncate(b, 70));
            var d = $("#searchInput");
            d.val($("<div/>").text(b).text());
            "" != d.val() && sendSearch(a[0])
        }
    }
}
function initSearch() {
    var a = this
      , b = $("#searchInput");
    b.autocomplete({
        appendTo: "#searchBar",
        source: function(d, h) {
            $.ajax({
                url: "https://completion.amazon." + getSSTldByDomain(storage.domain) + "/search/complete",
                type: "GET",
                cache: !1,
                dataType: "jsonp",
                data: {
                    q: d.term,
                    "search-alias": "aps",
                    mkt: getSSMktByDomain(storage.domain)
                }
            }).always(function(m) {
                try {
                    h($.map(m[1], function(t) {
                        return {
                            label: t,
                            value: t
                        }
                    }))
                } catch (t) {
                    console.log(t)
                }
            })
        },
        minLength: 2,
        select: function(d, h) {
            "" != h.item.value && (b.val(h.item.value),
            window.location.href = "#!search/" + storage.domain + "-" + encodeURIComponent(h.item.value))
        },
        open: function() {
            $(a).removeClass("ui-corner-all").addClass("ui-corner-top")
        },
        close: function() {
            $(a).removeClass("ui-corner-top").addClass("ui-corner-all")
        }
    })
}
function truncate(a, b) {
    var d;
    a = a.split("");
    if (a.length > b) {
        for (d = a.length - 1; -1 < d; --d)
            if (d > b)
                a.length = d;
            else if (" " === a[d]) {
                a.length = d;
                break
            }
        a.push("...")
    }
    return a.join("")
}
;var Guid = Guid || function() {
    var a = function(d, h, m) {
        return d.length >= h ? d : a(m + d, h, m || " ")
    }
      , b = function() {
        var d = (new Date).getTime();
        return "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/x/g, function(h) {
            var m = (d + 16 * Math.random()) % 16 | 0;
            d = Math.floor(d / 16);
            return ("x" === h ? m : m & 7 | 8).toString(16)
        })
    };
    return {
        newGuid: function() {
            var d = "undefined" != typeof window.crypto, h;
            d && (h = "undefined" != typeof window.crypto.getRandomValues);
            if (d && h) {
                d = new window.Uint16Array(16);
                window.crypto.getRandomValues(d);
                var m = "";
                for (h = 0; 16 > h; h++) {
                    var t = d[h].toString(16);
                    t = a(t, 4, "0");
                    m += t
                }
                d = m
            } else
                d = b();
            return d
        }
    }
}()
  , settings = {
    isEmailVerified: !1,
    refresh: function() {
        lastSubUrl = lastRootUrl = lastUrl = "";
        initPage();
        clickedObjectReference = null;
        rootPreventLoop = !1;
        currency = getCurrencyByDomain(storage.domain);
        currencyDomainId = isNaN(Number(storage.currencyDomainId)) ? 0 : Number(storage.currencyDomainId)
    },
    reset: function(a, b) {
        storage.accountType = 0;
        storage.removeItem("username");
        storage.removeItem("email");
        storage.removeItem("facebook");
        storage.removeItem("twitter");
        storage.removeItem("wishlist");
        storage.removeItem(intranet.key);
        for (var d = 0; d < numberOfDomains; d++)
            storage.removeItem("dealsExcludedCats." + d),
            storage.removeItem("dealExcludedCats." + d);
        storage.removeItem("dealExcludedCats");
        for (d = 0; d < storage.length; d++) {
            var h = storage.key(d);
            0 == h.indexOf("keepa.") && storage.removeItem(h)
        }
        a && settings.setToken(Guid.newGuid(), b);
        emailActive = twitterActive = facebookActive = 0;
        clearedLocalStorage = !1;
        settings.applyDataBucket()
    },
    setToken: function(a, b) {
        a && 64 == a.length && (storage.token != a && (storage.token = a,
        storage.removeItem("hashSynced"),
        storage.removeItem("keepa.hash"),
        network.reauthorize()),
        b && settings.setExtensionSetting("token", a))
    },
    setExtensionSetting: function(a, b) {
        "undefined" != typeof b && null != b && "null" != b && "" != b && "undefined" != b && (sendReceive({
            key: "setCookie",
            value: {
                key: a,
                val: b
            }
        }),
        document.cookie = a + "=" + b + ";path=/extension;secure;Max-Age=31536000;")
    },
    setExtensionSettingAll: function() {
        settings.setExtensionSetting("optOut_crawl", storage.optOut_crawl);
        settings.setExtensionSetting("revealStock", storage.revealStock);
        settings.setExtensionSetting("s_boxType", storage.s_boxType);
        settings.setExtensionSetting("s_boxHorizontal", storage.s_boxHorizontal);
        settings.setExtensionSetting("webGraphType", storage.webGraphType);
        settings.setExtensionSetting("webGraphRange", storage.webGraphRange);
        settings.setExtensionSetting("overlayPriceGraph", storage.overlayPriceGraph)
    },
    send: function(a) {
        var b = $.Deferred()
          , d = $("#extension");
        0 < d.length && (d = {
            browser: browserInfo(),
            type: d.attr("type"),
            version: d.attr("version")
        },
        storage.extension = JSON.stringify(d));
        var h = {};
        for (d = 0; d < storage.length; d++) {
            var m = storage.key(d);
            if (m.startsWith("__$"))
                localStorage.removeItem(m);
            else if (!(m == intranet.key || "token" == m || 0 < m.indexOf("viewer") || 0 < m.indexOf("_localstorage_available_")) && "tokenBucketSize" !== m && "tokens" !== m && "bucketUpdated" !== m && "string" === typeof storage[m]) {
                var t = storage[m];
                t && (h[m] = t)
            }
        }
        d = {
            path: "user/settings",
            type: "setSettings",
            version: 3,
            localStorage: JSON.stringify(h),
            domainId: storage.domain,
            language: storage.language
        };
        if (0 == d.localStorage.length || "{}" == d.localStorage)
            try {
                d.localStorage = localStorageIsPolyFill ? storage.toJSON() : JSON.stringify(storage)
            } catch (f) {}
        storage.twitter && (d.twitterId = storage.twitter);
        "undefined" != typeof storage.sendUpcomingLightningDealsAlert && (d.sendUpcomingLightningDealsAlert = storage.sendUpcomingLightningDealsAlert);
        "undefined" != typeof storage.sendStartLightningDealsAlert && (d.sendStartLightningDealsAlert = storage.sendStartLightningDealsAlert);
        isNaN(parseInt(storage.defaultNotificationInterval)) && (storage.defaultNotificationInterval = 2880);
        "undefined" != typeof storage.defaultNotificationInterval && (d.defaultNotificationInterval = storage.defaultNotificationInterval);
        if ("undefined" != typeof storage.defaultNotificationType)
            for (d.defaultNotificationType = JSON.parse(storage.defaultNotificationType),
            m = 0; m < d.defaultNotificationType.length; m++)
                d.defaultNotificationType[m] = d.defaultNotificationType[m] ? 1 : 0;
        "undefined" != typeof storage.useSmile && (d.useSmile = storage.useSmile);
        "undefined" != typeof storage.stockMaxOrderQty && (d.stockMaxOrderQty = "true" == storage.stockMaxOrderQty ? !0 : !1);
        storage.email && (d.email = storage.email);
        storage.facebook && (d.facebookId = storage.facebook);
        "undefined" !== typeof a && !0 === a.removeEmail && "undefined" === typeof d.email && (d.removeEmail = !0,
        isTest && console.info("%csetSettings", "color:orange;font-weight:bold;", d));
        a = getCasinLocalesFromStorage();
        d.casinLocales = a;
        network.request(d).done(function(f) {
            if (0 != parseInt(f)) {
                var n = [];
                f.status.length ? n = f.status : n.push(f.status);
                for (var r = 0; r < n.length; r++)
                    switch (n[r]) {
                    case 0:
                        break;
                    case 1:
                        storage.domain = 1;
                        break;
                    case 2:
                        storage.language = 1;
                        break;
                    case 3:
                        isTest && console.info("%cSettings error", "color:red;font-weight:bold;", "EMAIL FAILED");
                        storage.removeItem("email");
                        break;
                    case 4:
                        storage.removeItem("twitter");
                        break;
                    case 5:
                        reportBug(null, "sendSettings error 5, storage js fail " + JSON.stringify(h));
                        break;
                    case -1:
                    case -2:
                        break;
                    default:
                        reportBug(null, "sendSettings unknown status error " + JSON.stringify(f))
                    }
                refreshDomain(storage.domain);
                b.resolve(f)
            }
        }).fail(function(f) {
            b.reject(f)
        });
        return b
    },
    dataCache: null,
    lastPromise: null,
    retrieve: function(a, b) {
        var d = $.Deferred()
          , h = function() {
            var m = function(n) {
                0 != parseInt(n) ? (localStorageSupported && handleSettingsRequest(n, a),
                d.resolve()) : d.reject()
            }
              , t = function(n) {
                401 == n.status ? (localStorageSupported && settings.reset(!1, !1),
                d.resolve()) : d.reject()
            };
            if (null != settings.dataCache && 500 > Date.now() - settings.dataCache.time) {
                var f = JSON.parse(settings.dataCache.dataString);
                settings.dataCache.success ? m(f) : t(f)
            } else
                network.request({
                    path: "user/settings",
                    type: "getSettings",
                    version: 3
                }).done(function(n) {
                    settings.dataCache = {
                        time: Date.now(),
                        dataString: JSON.stringify(n),
                        success: !0
                    };
                    m(n)
                }).fail(function(n) {
                    settings.dataCache = {
                        time: Date.now(),
                        dataString: JSON.stringify(n),
                        success: !1
                    };
                    t(n)
                })
        };
        b || null == settings.lastPromise ? h() : settings.lastPromise.always(h);
        return settings.lastPromise = d
    },
    applyDataBucket: function(a, b) {
        "undefined" !== typeof a && null !== a ? (storage.tokenBucketSize = a,
        storage.tokens = b) : (storage.tokenBucketSize = 0,
        storage.tokens = 0);
        storage.bucketUpdated = Date.now()
    }
}
  , logosvg = '<svg version="1.1" id="keepa" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 281.1 80.8" enable-background="new 0 0 281.1 80.8" xml:space="preserve"> <g> <g> <path class="svgKeepaShadow" fill="#CDCCCC" d="M116.7,60.4H109c0-0.3-1.3-2.3-4-6.1c-3.1-4.4-5.9-8.1-8.5-11c-3.5-3.9-6-5.9-7.7-5.9h-1.1 c0,5.5,0.1,13.1,0.4,23h-6.6c0.4-7.3,0.5-15.3,0.5-24c0-8.2-0.2-15.5-0.5-21.7h6.6c-0.2,6.2-0.4,12.6-0.4,19h0.8 c1.3,0,4.5-3,9.7-9c5.1-6,7.7-9.3,7.7-10h7.3c0,0.7-2.5,3.6-7.5,8.7c-5,5.1-8.7,8.5-11.2,10.3V34c2.7,1,7.2,5.7,13.5,14 C113.8,55.5,116.7,59.7,116.7,60.4z"/> <path class="svgKeepaShadow" fill="#CDCCCC" d="M151,39.8c0,1,0,2.3-0.1,4.1l-24.2,0.4c0.2,3.4,1.6,6.3,4,8.6c2.4,2.3,5.6,3.5,9.6,3.5 c3.6,0,6.9-0.4,10-1.3l-0.6,5c-2.3,0.9-5.6,1.4-9.9,1.4c-6.1,0-10.7-1.7-13.9-5C122.6,53,121,49,121,44.2c0-5.1,1.5-9.5,4.4-13.2 c2.9-3.7,6.8-5.5,11.8-5.5c4.5,0,8,1.3,10.3,4S151,35.6,151,39.8z M145.1,39.8c0-6.6-2.8-9.9-8.3-9.9c-5.6,0-8.9,3.4-9.9,10.3 L145.1,39.8z"/> <path class="svgKeepaShadow" fill="#CDCCCC" d="M187.9,39.8c0,1,0,2.3-0.1,4.1l-24.2,0.4c0.2,3.4,1.6,6.3,4,8.6c2.4,2.3,5.6,3.5,9.6,3.5 c3.6,0,6.9-0.4,10-1.3l-0.6,5c-2.3,0.9-5.6,1.4-9.9,1.4c-6.1,0-10.7-1.7-13.9-5c-3.2-3.3-4.8-7.4-4.8-12.2c0-5.1,1.5-9.5,4.4-13.2 s6.8-5.5,11.8-5.5c4.5,0,8,1.3,10.3,4S187.9,35.6,187.9,39.8z M182,39.8c0-6.6-2.8-9.9-8.3-9.9c-5.6,0-8.9,3.4-9.9,10.3L182,39.8z "/> <path class="svgKeepaShadow" fill="#CDCCCC" d="M227.9,42.3c0,5.1-1.4,9.5-4.3,13.3c-2.9,3.8-6.9,5.7-12.1,5.7c-4.3,0-7.1-0.8-8.5-2.3h-0.4 c0,6.5,0.1,12.3,0.2,17.4h-6.6c0.5-6.2,0.8-13.9,0.8-23.1c0-11.3-0.6-20-1.8-26.2l6.2-0.9l0.5,3.5h0.4c2.3-2.6,6-4,11-4 c4.5,0,8,1.6,10.6,4.9S227.9,37.8,227.9,42.3z M221.7,43.2c0-3.5-0.9-6.4-2.7-8.9c-1.8-2.5-4.4-3.7-7.7-3.7 c-4.2,0-7.2,1.3-9.1,3.8c0.4,7.9,0.6,14.6,0.6,20.3c1.9,1.6,4.4,2.4,7.4,2.4c3.9,0,6.8-1.4,8.7-4.1 C220.7,50.3,221.7,47,221.7,43.2z"/> <path class="svgKeepaShadow" fill="#CDCCCC" d="M262.4,60.4l-5.5,0.2c-0.3-1.1-0.4-2.2-0.4-3.3h-0.4c-2.9,2.6-6.8,3.9-11.8,3.9c-2.7,0-5-0.8-7-2.4 s-2.9-3.8-2.9-6.8c0-3.6,1.5-6.5,4.6-8.7c3-2.2,8.7-3.3,17-3.5c0.1-0.6,0.1-1.2,0.1-1.9c0-2.9-0.8-4.8-2.3-5.8 c-1.5-1-3.9-1.4-7-1.4c-3.7,0-7.3,0.5-10.9,1.4l0.6-4.9c3.5-1,7.6-1.5,12.1-1.5c4.2,0,7.4,0.9,9.7,2.6s3.4,4.7,3.4,8.8 c0,1.1-0.1,3.1-0.2,6c-0.1,2.9-0.2,4.8-0.2,5.8C261.5,53.3,261.8,57.1,262.4,60.4z M256.2,53.6c-0.1-3.6-0.2-6.8-0.2-9.6 c-4.4,0-7.8,0.3-10.1,1c-3.8,1.2-5.8,3.4-5.8,6.7c0,3.2,2.3,4.8,6.8,4.8C250.8,56.5,253.9,55.5,256.2,53.6z"/> </g> <g> <g> <path class="svgKeepa" fill="#FFFFFF" d="M115.3,59h-7.7c0-0.3-1.3-2.3-4-6.1c-3.1-4.4-5.9-8.1-8.5-11c-3.5-3.9-6-5.9-7.7-5.9h-1.1 c0,5.5,0.1,13.1,0.4,23h-6.6c0.4-7.3,0.5-15.3,0.5-24c0-8.2-0.2-15.5-0.5-21.7h6.6c-0.2,6.2-0.4,12.6-0.4,19h0.8 c1.3,0,4.5-3,9.7-9c5.1-6,7.7-9.3,7.7-10h7.3c0,0.7-2.5,3.6-7.5,8.7c-5,5.1-8.7,8.5-11.2,10.3v0.4c2.7,1,7.2,5.7,13.5,14 C112.4,54.1,115.3,58.3,115.3,59z"/> <path class="svgKeepa" fill="#FFFFFF" d="M149.5,38.4c0,1,0,2.3-0.1,4.1l-24.2,0.4c0.2,3.4,1.6,6.3,4,8.6c2.4,2.3,5.6,3.5,9.6,3.5 c3.6,0,6.9-0.4,10-1.3l-0.6,5c-2.3,0.9-5.6,1.4-9.9,1.4c-6.1,0-10.7-1.7-13.9-5c-3.2-3.3-4.8-7.4-4.8-12.2 c0-5.1,1.5-9.5,4.4-13.2s6.8-5.5,11.8-5.5c4.5,0,8,1.3,10.3,4S149.5,34.2,149.5,38.4z M143.7,38.4c0-6.6-2.8-9.9-8.3-9.9 c-5.6,0-8.9,3.4-9.9,10.3L143.7,38.4z"/> <path class="svgKeepa" fill="#FFFFFF" d="M186.5,38.4c0,1,0,2.3-0.1,4.1l-24.2,0.4c0.2,3.4,1.6,6.3,4,8.6c2.4,2.3,5.6,3.5,9.6,3.5 c3.6,0,6.9-0.4,10-1.3l-0.6,5c-2.3,0.9-5.6,1.4-9.9,1.4c-6.1,0-10.7-1.7-13.9-5c-3.2-3.3-4.8-7.4-4.8-12.2 c0-5.1,1.5-9.5,4.4-13.2s6.8-5.5,11.8-5.5c4.5,0,8,1.3,10.3,4S186.5,34.2,186.5,38.4z M180.6,38.4c0-6.6-2.8-9.9-8.3-9.9 c-5.6,0-8.9,3.4-9.9,10.3L180.6,38.4z"/> <path class="svgKeepa" fill="#FFFFFF" d="M226.5,40.9c0,5.1-1.4,9.5-4.3,13.3c-2.9,3.8-6.9,5.7-12.1,5.7c-4.3,0-7.1-0.8-8.5-2.3h-0.4 c0,6.5,0.1,12.3,0.2,17.4h-6.6c0.5-6.2,0.8-13.9,0.8-23.1c0-11.3-0.6-20-1.8-26.2l6.2-0.9l0.5,3.5h0.4c2.3-2.6,6-4,11-4 c4.5,0,8,1.6,10.6,4.9S226.5,36.4,226.5,40.9z M220.2,41.8c0-3.5-0.9-6.4-2.7-8.9c-1.8-2.5-4.4-3.7-7.7-3.7 c-4.2,0-7.2,1.3-9.1,3.8c0.4,7.9,0.6,14.6,0.6,20.3c1.9,1.6,4.4,2.4,7.4,2.4c3.9,0,6.8-1.4,8.7-4.1 C219.3,48.9,220.2,45.6,220.2,41.8z"/> <path class="svgKeepa" fill="#FFFFFF" d="M261,59l-5.5,0.2c-0.3-1.1-0.4-2.2-0.4-3.3h-0.4c-2.9,2.6-6.8,3.9-11.8,3.9c-2.7,0-5-0.8-7-2.4 s-2.9-3.8-2.9-6.8c0-3.6,1.5-6.5,4.6-8.7c3-2.2,8.7-3.3,17-3.5c0.1-0.6,0.1-1.2,0.1-1.9c0-2.9-0.8-4.8-2.3-5.8 c-1.5-1-3.9-1.4-7-1.4c-3.7,0-7.3,0.5-10.9,1.4l0.6-4.9c3.5-1,7.6-1.5,12.1-1.5c4.2,0,7.4,0.9,9.7,2.6s3.4,4.7,3.4,8.8 c0,1.1-0.1,3.1-0.2,6c-0.1,2.9-0.2,4.8-0.2,5.8C260.1,51.9,260.4,55.7,261,59z M254.8,52.2c-0.1-3.6-0.2-6.8-0.2-9.6 c-4.4,0-7.8,0.3-10.1,1c-3.8,1.2-5.8,3.4-5.8,6.7c0,3.2,2.3,4.8,6.8,4.8C249.4,55.1,252.5,54.1,254.8,52.2z"/> </g> </g> </g> <g> <g> <path class="svgKeepaShadow" fill="#CDCCCC" d="M46.4,45.8h-13v13H21.6v-13h-13V34h13V21h11.8v13h13V45.8z M22.2,34.6v10.6h10.4V34.6H22.2z"/> </g> <g> <g> <path class="svgKeepa" fill="#FFFFFF" d="M45,44.4h-13v13H20.1v-13h-13V32.6h13v-13h11.8v13h13V44.4z M20.8,33.2v10.6h10.4V33.2H20.8z"/> </g> </g> </g> </svg> ';
function getLogoSVG(a) {
    return '<img style="vertical-align: middle; width: ' + a + 'px; !important" src="' + imgCDNUrl + 'logo_circled.svg" alt="">'
}
var clearedLocalStorage = !1
  , isSocialAccount = !1
  , userData = null;
function handleSettingsRequest(a, b) {
    if (null != a)
        if (-2 == a.status)
            settings.reset(!1, !1);
        else if (userData = a.user,
        null == userData && (userData = a.data),
        null != userData) {
            isSocialAccount = !!a.sso;
            localStorageIsPolyFill || settings.setExtensionSetting("token", storage.token);
            if (null != userData.localStorage)
                try {
                    try {
                        userData.localStorage = JSON.parse(userData.localStorage),
                        delete userData.localStorage[intranet.key]
                    } catch (p) {
                        reportBug(p, userData.localStorage),
                        userData.localStorage = null
                    }
                    for (var d = {
                        hashSynced: storage.hashSynced,
                        wishlistAddonId: storage.wishlistAddonId,
                        wishlistDomain: storage.wishlistDomain,
                        token: storage.token,
                        initFailed: storage.initFailed
                    }, h = 0; h < storage.length; h++)
                        if ("token" != h) {
                            var m = storage.key(h);
                            "string" == typeof m && 0 == m.indexOf("11") && (d[m] = storage[m])
                        }
                    clearedLocalStorage || null == d.token || "undefined" == d.token || 64 != d.token.length || (storage.clear(),
                    storage.token = d.token,
                    clearedLocalStorage = !0);
                    for (var t in userData.localStorage) {
                        var f = userData.localStorage[t];
                        "null" != f && null != f && "undefined" != f && (/hashSynced|install|token|keepa\..*|addonVersion.*|wishlist/.test(t) || "undefined" != typeof d[t] || (storage[t] = f))
                    }
                    isNaN(Number(storage.currencyDomainId)) || (currencyDomainId = Number(storage.currencyDomainId));
                    for (var n in d) {
                        var r = d[n];
                        void 0 != r && null != r && (storage[n] = r)
                    }
                } catch (p) {
                    console.log(p),
                    reportBug(p)
                }
            storage.accountType = userData.accountType;
            storage.username = "ANON" != AccountType[userData.accountType] ? userData.userName : la._43;
            verifyRegExp.domainId.test(userData.domainId) ? storage.domain = userData.domainId : verifyRegExp.domainId.test(storage.language) && (storage.domain = storage.language);
            1 > storage.domain && (storage.domain = 1);
            storage.language = userData.language || storage.language;
            storage.sendUpcomingLightningDealsAlert = userData.sendUpcomingLightningDealsAlert;
            storage.sendStartLightningDealsAlert = userData.sendStartLightningDealsAlert;
            storage.defaultNotificationInterval = userData.defaultNotificationInterval;
            storage.defaultNotificationType = JSON.stringify(userData.defaultNotificationType);
            storage.useSmile = userData.useSmile;
            storage.stockMaxOrderQty = userData.stockMaxOrderQty;
            storage.rssHash = userData.rssHash;
            storage.lastVisit = userData.lastVisit;
            d = Date.now();
            null != storage.lastManageVisitUpdate ? 12E5 < d - Number(storage.lastManageVisitUpdate) && (storage.lastManageVisitUpdate = d,
            storage.lastManageVisit = userData.lastManageVisit) : storage.lastManageVisit = userData.lastManageVisit;
            storage.lastManageVisitUpdate = d;
            storage.defaultNotificationInterval = userData.defaultNotificationInterval;
            storage.useSmile = userData.useSmile;
            storage.stockMaxOrderQty = userData.stockMaxOrderQty;
            storage.showSalesRankGraph = "undefined" === typeof storage.showSalesRankGraph ? "undefined" != typeof storage.showGraphs ? storage.showGraphs[7] : 0 : storage.showSalesRankGraph;
            storage.webGraphType && storage.webGraphRange || (storage.webGraphType = JSON.stringify(GraphService.getDefaultWebGraphType()),
            storage.webGraphRange = GraphService.getDefaultWebGraphRange().toString(),
            storage.s_overlay && (d = JSON.parse(storage.s_overlay),
            h = GraphService.getWebGraphTypeAllOff(),
            h[CsvType.AMAZON.index] = d[CsvType.AMAZON.index],
            h[CsvType.NEW.index] = d[CsvType.NEW.index],
            h[CsvType.USED.index] = d[CsvType.USED.index],
            h[CsvType.SALES.index] = d[CsvType.SALES.index],
            h[CsvType.WAREHOUSE.index] = 1,
            h[CsvType.LIGHTNING_DEAL.index] = 1,
            storage.webGraphType = JSON.stringify(h),
            storage.webGraphRange = d[4].toString()));
            storage.removeItem("s_overlay");
            userData.casinLocales && Array.isArray(userData.casinLocales) ? storage.casinLocales = JSON.stringify(userData.casinLocales) : (d = null,
            "string" === typeof storage.casinLocales && (d = tryParseJSON(storage.casinLocales)),
            h = null,
            d && (h = d.map(function(p) {
                return !!p
            }),
            "1" !== storage.casinLimited && (h[0] = !1)),
            Array.isArray(h) && h.length === LocaleType.length || (h = Array(LocaleType.length).fill(!1),
            h[0] = !0),
            storage.casinLocales = JSON.stringify(h));
            storage.casinLimited && storage.removeItem("casinLimited");
            userData.emailAddress ? storage.email = userData.emailAddress : storage.removeItem("email");
            userData.twitterId ? storage.twitter = userData.twitterId : storage.removeItem("twitter");
            userData.facebookId ? storage.facebook = userData.facebookId : storage.removeItem("facebook");
            null != a.ear ? "VERIFIED" != EmailStatus[a.ear.status] ? (setTimeout(function() {
                resend_Verify()
            }, 4E3),
            settings.isEmailVerified = !1) : settings.isEmailVerified = !0 : settings.isEmailVerified = !0;
            settings.applyDataBucket(a.tokenBucketSize, a.tokens);
            settings.setExtensionSettingAll();
            facebookActive = storage.facebook ? 1 : 0;
            twitterActive = storage.twitter ? 1 : 0;
            emailActive = storage.email ? 1 : 0;
            manageSortType = storage.sortDefault;
            refreshDomain(storage.domain);
            b || $("#tabTrack").hasClass("active") ? refreshLoginBar() : settings.refresh()
        }
}
function refreshLoginBar() {
    $("#loginOverlay").hide();
    storage.accountType && 0 != storage.accountType ? (1 != storage.accountType ? updateMenuUserMenu({
        settings: 1,
        login: 0,
        register: 0,
        subscriptions: 1,
        api: storage.hasAPI ? 1 : 0,
        logout: 1
    }) : updateMenuUserMenu({
        settings: 1,
        login: 1,
        register: 1,
        subscriptions: 0,
        api: 0,
        logout: 1
    }),
    $("#panelUsername").text(storage.username),
    updateMenuUserPanel(1)) : ($("#panelUsername").text(la._9),
    updateMenuUserPanel(0));
    $("#submitLogin").val(la._2);
    $("#submitRegister").val(la._42)
}
function updateMenuUserPanel(a) {
    0 === a ? ($("#panelUserMenu").hide(),
    $("#userMenuOverlay").css({
        opacity: 0,
        display: "none"
    }),
    $("#panelUserRegisterLogin").show()) : ($("#panelUserMenu").show(),
    $("#panelUserRegisterLogin").hide())
}
var userMenuEntriesActive = {
    login: 1,
    register: 1,
    settings: 1,
    subscriptions: 1,
    api: 0,
    logout: 0
}
  , userMenuEntries = {
    login: function() {
        return '<div id="UMElogin"><i class="fa fa-sign-in fa-fw fa-lg"></i>&ensp;' + la._2 + "</div>"
    },
    register: function() {
        return '<div id="UMEregister"><i class="fa fa-user-plus fa-fw fa-lg"></i>&ensp;' + la._42 + "</div>"
    },
    settings: function() {
        return '<div id="UMEsettings"><a href="#!channels"><i class="fa fa-fw fa-cog fa-lg"></i>&ensp;' + la._8 + "</a></div>"
    },
    subscriptions: function() {
        return '<div id="UMEsubscriptions"><a href="#!settings/1"><i class="fa fa-fw fa-unlock fa-lg"></i>&ensp;' + la._647 + "</a></div>"
    },
    api: function() {
        return '<div id="UMEapi"><a href="#!api"><i class="fa fa-fw fa-cloud fa-lg"></i>&ensp;API Access</a></div>'
    },
    logout: function() {
        return '<div id="UMElogout"><i class="fa fa-fw fa-power-off fa-lg"></i>&ensp;' + la._392 + "</div>"
    }
};
function showLoginOverlay() {
    $("#loginOverlay").show()
}
function updateMenuUserMenu(a) {
    var b = "", d;
    for (d in a)
        a.hasOwnProperty(d) && userMenuEntriesActive.hasOwnProperty(d) && (userMenuEntriesActive[d] = a[d]);
    for (var h in userMenuEntriesActive)
        userMenuEntriesActive.hasOwnProperty(h) && 1 === userMenuEntriesActive[h] && userMenuEntries.hasOwnProperty(h) && (b += userMenuEntries[h]());
    replaceHtml("userMenuOverlay", b);
    $("#UMElogin").click(function() {
        showLoginOverlay()
    });
    $("#UMElogout").click(function() {
        logout()
    });
    $("#UMEregister").click(function() {
        showLoginOverlay();
        $("#registerTab").trigger("click")
    })
}
var reCaptchaPromise;
function isUserHuman(a) {
    var b = $.Deferred();
    if (isHuman)
        return b.resolve(""),
        b;
    reCaptchaPromise = $.Deferred();
    var d = showPopup("One time anti-bot check", '<div id="recaptcha" class="g-recaptcha"></div><div id="reCaptchaHelp"><div style="display:block" id="loadingIcon"></div><br>Loading reCaptcha ...</div><br>', a);
    var h = window.setTimeout(function() {
        $("#reCaptchaHelp").html("Unable to load reCaptcha from Google. Please verify you can access Google.com unrestricted. We use the reCaptcha service to verify you are human and to block bots from abusing our service.")
    }, 5E3);
    if ("undefined" != typeof grecaptcha)
        try {
            grecaptcha.reset(),
            $("#reCaptchaHelp").remove(),
            grecaptcha.render("recaptcha", reCaptchaParm)
        } catch (m) {
            reportBug(m),
            showErrorPopup(m)
        }
    else
        $.ajax({
            url: "https://www.google.com/recaptcha/api.js?onload=reCaptchaOnload&render=explicit",
            dataType: "script",
            success: function() {
                $("#reCaptchaHelp").remove();
                window.clearTimeout(h)
            }
        });
    reCaptchaPromise.always(function(m) {
        $(".pls-container").remove();
        d.close();
        b.resolve(m);
        addon()
    });
    d.promise.fail(function() {
        b.reject()
    });
    return b
}
var reCaptchaParm = {
    sitekey: "6Lf6pwITAAAAAFzmtyDr1Vv629mD-I6QiibwemP1",
    callback: function(a) {
        reCaptchaPromise.resolve(a)
    },
    theme: "light"
};
function reCaptchaOnload() {
    $("#reCaptchaHelp").remove();
    addon("resize", "1000px");
    grecaptcha.render("recaptcha", reCaptchaParm)
}
function registerAnonymous(a) {
    var b = $.Deferred();
    iframe.isIframe && 0 == $("#loginOverlayBox").length && ($("#content").before(getLoginForm()),
    initLogin());
    $("#loginOverlay").css("position", "fixed");
    showLoginOverlay();
    addon("resize", 350 + float2int($("#loginOverlayBox").height()));
    !0 !== a && $("#registerTab").trigger("click");
    var d = "registerAnon" + Date.now();
    loginCallbacks[d] = function(h) {
        $("#guestContainer").remove();
        delete loginCallbacks[d];
        $("#loginOverlay-close").trigger("click");
        $("#loginOverlay").css("position", "absolute");
        h || a ? b.resolve() : isUserHuman(!0).done(function(m) {
            network.request({
                path: "user/session",
                type: "register",
                captcha: m,
                version: 3
            }).always(function(t) {
                settings.send().done(function() {
                    settings.retrieve(!0).done(function() {
                        refreshLoginBar();
                        sendHelloGraph();
                        b.resolve();
                        loginProgress.notify(!0)
                    }).fail(function() {
                        b.reject(!0);
                        loginProgress.notify(!1)
                    })
                }).fail(function() {
                    loginProgress.notify(!1);
                    b.reject(!0)
                })
            })
        }).fail(function() {
            $("#loginOverlay").css("position", "absolute");
            b.reject(!1)
        })
    }
    ;
    $("#loginForm").before('<div id="guestContainer" style="text-align: right;"><div id="continueGuest" class="button" style="display: inline-block;">' + la._588 + '</div><br><hr style="border-color:rgba(10, 40, 82, 0.5) !important"></div>');
    $("#continueGuest").on("click", function() {
        loginProgress.notify(!1)
    });
    b.fail(function() {
        addon("resize", 50 + float2int($("#initPage").height()))
    });
    return b
}
function wasForceLogout() {}
function logout(a) {
    a && showPopup(la._27, '<div style="max-width:600px"><p class="mdc-typography--body2">' + la._941 + "</p></div>", !0);
    a = storage.token;
    var b = storage.username
      , d = storage.install
      , h = storage.optOut_crawl
      , m = storage.overlayPriceGraph;
    storage.clear();
    network.clearDatabase();
    d && (storage.install = d);
    h && (storage.optOut_crawl = h);
    m && (storage.overlayPriceGraph = m);
    initializeSettings();
    network.request({
        path: "user/session",
        type: "logout",
        token: a,
        version: 3
    }).always(function(t) {
        updateMenuUserPanel(0);
        refreshLoginBar();
        replaceHtml("panelUsername", la._41 + b);
        currency = getCurrencyByDomain(storage.domain);
        try {
            callSubPage(1)
        } catch (f) {
            reportBug(f, JSON.stringify(f))
        }
        "" == storage.username || /anon/.test(storage.username) ? $("#name").val(storage.username) : $("label[for=name]").append(" " + storage.username);
        updateMenuUserPanel(0);
        intranet.postMessage({
            key: "logout"
        });
        sendHelloGraph(!0)
    })
}
var popupSettings = "toolbar=no,statusbar=no,location=no,width=900px,height=600px,resizable=yes"
  , popupName = "Keepa_OpenID_Login";
window.addEventListener("message", function(a) {
    if (a.data && a.origin)
        if (~a.origin.indexOf("https://dyn.keepa.com"))
            handleSocialLoginCallback(a.data);
        else if (~a.origin.indexOf("https://discuss.keepa.com"))
            switch (a.data.key) {
            case "discussLoaded":
                $(".pL").remove();
                $("#discussContainer").slideDown("slow");
                break;
            case "discussNavigation":
                var b = a.data.value;
                a = a.data.title || "Keepa";
                b = "#!discuss" + b.substring(b.indexOf("keepa.com") + 9);
                history.replaceState({
                    path: b
                }, a, b);
                document.title = a
            }
});
var lastSocial = "";
function handleSocialLoginCallback(a) {
    try {
        var b = 0 < location.href.indexOf("#!fbMessengerLogin")
          , d = 0 < location.href.indexOf("#!tgMessengerLogin")
          , h = function() {
            "" == redirect_uri ? (reportBug(null, "redirect_uri is empty after socialLogin loop"),
            showErrorPopup()) : network.request({
                path: "user/session",
                type: "fbApp",
                content: b ? "fb" : "tg",
                version: 3
            }).done(function(m) {
                document.location = redirect_uri + m.hash
            }).fail(showErrorPopup)
        };
        if (~a.status)
            switch ("twitter" == a.provider && "twitterNotify" == lastSocial && (a.provider = lastSocial),
            a.provider) {
            case "alreadyRegistered":
                showPopup("External Account Link failed", "The external account is already linked with a Keepa Account. You need to remove that link first: log out, then use the external account to sign in and go to the settings page. There you can either delete the link or, if not needed anymore, delete the whole account.", !0);
                break;
            case "loginNotExist":
                showPopup("External Account login failed", 'No Keepa account is connected with the chosen "login with" option. You can register a new one instead or use a different login option.', !0);
                break;
            case "google":
            case "amazon":
            case "twitter":
            case "facebook":
                1 == a.status ? showPopup("Error", "Social login failed, as you denied Keepa access / aborted the process.", !0) : (localStorageSupported && settings.setToken(a.token, !0),
                settings.retrieve().always(function() {
                    (b || d) && h();
                    loginProgress.notify(!0)
                }))
            }
        else
            throw Error("status != 0");
    } catch (m) {
        loginProgress.notify(!1),
        showErrorPopup(),
        reportBug(m, "socialCallback: " + JSON.stringify(a))
    }
}
function sendToDiscussSSO() {
    2 == storage.accountType && network.request({
        path: "user/session",
        type: "sso",
        sso: sso,
        sig: sig,
        version: 3
    }).done(function(a) {
        if (a.url)
            location.hash = "#!nothing",
            setTimeout(function() {
                location.hash = "#!discuss/" + a.url
            }, 10);
        else if (a.error) {
            var b = a.error;
            "emailNew" === b.type ? null == storage.email ? showPopup("Missing eMail", la._428, !0) : resend_Verify() : "alreadyUsed" === b.type ? (showPopup("eMail already in use", 'Your email address is already assigned to another account and can not be used again when using the forum. Please sign in using the account you used the first time accessing the forum or change your email address through the <a class="settings-chpw" href="#!settings">settings</a>.<br><br> You can gain access to all your accounts associated with your email address by requesting a <a class="settings-chpw" id="loginMailPopup">account recovery email</a>.', !0),
            replaceHtml("initPage", ""),
            $("#loginMailPopup").on("click", function() {
                setTimeout(function() {
                    network.request({
                        path: "user/session",
                        type: "loginMail",
                        version: 3
                    }).done(function(d) {
                        null == d.error ? showPopup("Account access email sent.", "Please check your email: " + storage.email, !0) : showErrorPopup()
                    }).fail(function() {
                        showPopup("Error", a.status + " " + la._error, !0)
                    })
                }, 400)
            })) : showPopup("Error", a.status + " " + la._error, !0)
        }
    }).fail(showErrorPopup)
}
function addOpenIdEvents(a) {
    var b = $("#loginForm")
      , d = a ? "&redirect_uri=" + a : "";
    b.find("#openIDoogle").click(function() {
        var m = getSocialLoginURL("googleLogin", d, isMobile ? "1" : "0");
        isMobile ? document.location = m : window.open(m, popupName, popupSettings)
    });
    b.find("#openIDacebook").click(function() {
        var m = getSocialLoginURL("facebookLogin", d, isMobile ? "1" : "0");
        isMobile ? document.location = m : window.open(m, popupName, popupSettings)
    });
    b.find("#openIDwitter").click(function() {
        var m = getSocialLoginURL("twitterLogin", d, isMobile ? "1" : "0");
        isMobile ? document.location = m : window.open(m, popupName, popupSettings)
    });
    b.find("#openIDmazon").click(function() {
        var m = getSocialLoginURL("amazonLogin", d, isMobile ? "1" : "0");
        isMobile ? document.location = m : window.open(m, popupName, popupSettings)
    });
    $("#pwreset").click(function() {
        $("#loginTable").hide();
        $("#resetForm").show();
        $("#emailReset").val($("#emailRegister").val())
    });
    $("#PWresetBack").click(function() {
        $("#resetForm").hide();
        $("#emailReset").val("");
        $("#loginTable").show()
    });
    var h = !1;
    $("#resetForm").submit(function(m) {
        m.preventDefault();
        m = $("#emailReset").val().trim();
        if (0 == m.length)
            $("#emailReset").effect("highlight");
        else {
            if (h)
                return !1;
            h = !0;
            $("#submitPWreset").val(la._45);
            network.request({
                path: "user/session",
                type: "emailpw",
                version: 3,
                email: m
            }).done(function() {
                h = !1;
                $("#resetForm").html('<div style="width: 400px; text-align: justify; margin-right: 30px;">' + la._375 + "</div>")
            }).fail(function(t) {
                h = !1;
                replaceHtml("resetForm", '<div style="width: 400px; text-align: justify; margin-right: 30px;">' + la._error + "</div>");
                reportBug(null, "resetForm fail: " + t.status)
            })
        }
    })
}
function getSocialLoginURL(a, b, d) {
    var h = protocol + network.server[network.serverIndex] + ajaxPrefix
      , m = localStorageSupported ? storage.token : Guid.newGuid()
      , t = $("#registerEmailBox").is(":visible") ? "1" : "0";
    return h + "user/social/init/?user=" + m + "&type=" + a + "&noCache=" + Date.now() + b + "&isRegister=" + t + "&isRedirect=" + d
}
var la, languageObjects = {};
function loadLanguage(a) {
    var b = $.Deferred();
    if (languageObjects[a])
        la = languageObjects[a],
        b.resolve();
    else {
        var d = $('script[src$="keepa.js"]').attr("src");
        d = d ? d.split("/").slice(-2, -1)[0] : Date.now();
        var h = /test\.keepa/.test(location.href) ? "https://test.keepa.com/js/languages/" + a + ".json?" + d : /localhost:63342\/web/.test(location.href) ? "http://localhost:63342/web/js/languages/" + a + ".json?" + Date.now() : CDNUrl + "languages/" + a + ".json?" + d;
        var m = 0
          , t = function() {
            network.ajax({
                type: "GET",
                url: h,
                dataType: "json"
            }, !0).done(function(f) {
                la = f;
                languageObjects[a] = f
            }).fail(function(f) {
                3 < m ? (reportBug(null, "could not load language: " + a + " " + h + " " + JSON.stringify(f)),
                b.reject()) : (m++,
                setTimeout(t, 500))
            }).always(function() {
                b.resolve()
            })
        };
        t()
    }
    return b
}
var loginCallbacks = {}
  , loginProgress = $.Deferred();
loginProgress.progress(function(a) {
    for (var b in loginCallbacks)
        loginCallbacks[b](a)
});
var initRun = !1
  , initLogin = function() {
    $("#registerTab").click(function() {
        $(this).hasClass("inactive") && (toggleLoginRegister(!0),
        $(this).removeClass(),
        $("#loginTab").addClass("inactive"),
        $("#registerTabBox").show("fold", 300))
    });
    var a = $(".toggle-password");
    a.click(function() {
        a.toggleClass("fa-eye fa-eye-slash");
        var h = $("#password");
        "password" == h.attr("type") ? h.attr("type", "text") : h.attr("type", "password")
    });
    $("#loginTab").click(function() {
        $(this).hasClass("inactive") && (toggleLoginRegister(!1),
        $(this).removeClass(),
        $("#registerTab").addClass("inactive"))
    });
    $("#loginOverlay-close").click(function(h) {
        $("#loginOverlay").hide();
        $("#loginTable").show();
        $("#resetForm").hide();
        $("#registerForm").find(".error").remove();
        h.preventDefault();
        loginProgress.notify(!1)
    });
    $("#usernameRegister").blur(function() {
        storage.username = $(this).val()
    });
    var b = !1
      , d = function() {
        if (b)
            return !1;
        b = !0;
        $("#submitLogin").val(la._45);
        isUserHuman(!0).done(function(h) {
            var m = $("#emailRegister").val().trim();
            h = {
                path: "user/session",
                type: "register",
                username: $("#username").val().trim(),
                password: $("#password").val().trim(),
                email: m,
                captcha: h,
                version: 3
            };
            0 == m.length && delete h.email;
            var t = function(f, n) {
                $("#loginForm").find(".error").remove();
                $("#submitLogin").val(la._42);
                $("#pwreset").hide();
                $("#loginForm").find("label[for=" + f + "]").append('<span class="error">' + n + "</span>")
            };
            network.request(h).done(function(f) {
                b = !1;
                if (f.error)
                    switch (f.error.type) {
                    case "usernametaken":
                        t("username", la._50);
                        break;
                    case "emailAddressTaken":
                        t("email", la._936);
                        $("#pwreset").show().velocity({
                            opacity: 1
                        }, {
                            duration: 300
                        });
                        break;
                    default:
                        reportBug(null, "user/session register: default " + JSON.stringify(f)),
                        showErrorPopup()
                    }
                else
                    settings.setToken(f.token, !0),
                    $("#submitLogin").val(la._44),
                    settings.retrieve().done(function() {
                        $("#loginOverlay-close").trigger("click");
                        intranet.postMessage({
                            key: "login"
                        })
                    }),
                    null != sso && sendToDiscussSSO(),
                    sendHelloGraph(),
                    loginProgress.notify(!0)
            }).fail(function(f) {
                b = !1;
                if (f.hasOwnProperty("details") && f.hasOwnProperty("error") && "invalidParameter" == f.error)
                    for (var n in f.details) {
                        var r = f.details[n];
                        if ("invalid" != r.message) {
                            var p = ""
                              , z = "";
                            switch (r.type) {
                            case "userName":
                                p = "username";
                                z = la._48.replace("6", "2");
                                break;
                            case "restrictedUserName":
                                p = "username";
                                z = r.message;
                                break;
                            case "userPasswordOld":
                            case "userPassword":
                                p = "password";
                                z = la._48;
                                break;
                            case "userEmail":
                                p = "email";
                                z = la._49;
                                break;
                            case "captcha":
                                p = r.type;
                                z = r.message;
                                break;
                            default:
                                reportBug(null, "user/session register: case unknown " + JSON.stringify(f)),
                                showErrorPopup()
                            }
                            $("#loginForm").find(".error").remove();
                            $("#loginForm").find("label[for=" + p + "]").append('<span class="error">' + z + "</span>")
                        }
                    }
                else
                    reportBug(null, "keepa register " + JSON.stringify(f)),
                    showErrorPopup();
                $("#submitLogin").val(la._42)
            })
        }).fail(function() {
            $("#submitLogin").val(la._42);
            b = !1
        })
    };
    $("#loginForm").submit(function(h) {
        h.preventDefault();
        if ($("#loginTab").hasClass("inactive"))
            d();
        else {
            if (b)
                return !1;
            b = !0;
            $("#submitLogin").val(la._45);
            replaceHtml("loginError", "");
            network.request({
                path: "user/session",
                type: "login",
                username: $("#username").val().trim(),
                password: $("#password").val().trim(),
                version: 3
            }).done(function(m) {
                b = !1;
                null == m.error || "undefined" == typeof m.error ? (settings.setToken(m.token, !0),
                $("#submitLogin").val(la._44),
                settings.retrieve().done(function() {
                    $("#loginOverlay-close").trigger("click");
                    intranet.postMessage({
                        key: "login"
                    })
                }),
                null != sso && sendToDiscussSSO(),
                sendHelloGraph(),
                loginProgress.notify(!0)) : "loginCredentialsWrong" === m.error.type ? ($("#submitLogin").val(la._2),
                replaceHtml("loginError", la._46)) : (showErrorPopup(),
                reportBug(null, "user/session login: " + JSON.stringify(m)))
            }).fail(function(m) {
                b = !1;
                if (m.hasOwnProperty("details") && m.hasOwnProperty("error") && "invalidParameter" == m.error)
                    for (var t in m.details) {
                        var f = m.details[t];
                        if ("invalid" != f.message) {
                            var n = ""
                              , r = "";
                            switch (f.type) {
                            case "userName":
                                n = "username";
                                r = la._48.replace("6", "4");
                                break;
                            case "userPasswordOld":
                            case "userPassword":
                                n = "password";
                                r = la._48;
                                break;
                            default:
                                reportBug(null, "user/session register: case unknown " + JSON.stringify(m)),
                                showErrorPopup()
                            }
                            $("#loginForm").find(".error").remove();
                            $("#loginForm").find("label[for=" + n + "]").append('<span class="error">' + r + "</span>")
                        }
                    }
                else
                    reportBug(null, "user/session login: " + JSON.stringify(m)),
                    showErrorPopup();
                $("#submitLogin").val(la._2)
            })
        }
    });
    addOpenIdEvents()
};
window.initTimestamp = Date.now();
window.settingsLoadedTimestamp = 0;
window.networkInitTimestamp = 0;
var isDomainSwitch = !1
  , sentInitOnce = !0;
function sendInitTimeStat(a) {
    if (sentInitOnce) {
        sentInitOnce = !1;
        try {
            var b = Date.now() - window.initTimestamp
              , d = window.networkInitTimestamp - window.initTimestamp
              , h = window.settingsLoadedTimestamp - window.initTimestamp;
            console.log("network took " + d + "ms, init took " + h + "ms");
            network.ajax({
                url: "app/stats/?type=init" + (iframe.isIframe ? "Iframe" : "Website") + "&took=" + b + "&tookNetwork=" + d + "&tookSettings=" + h + "&domain=" + a,
                type: "GET",
                dataType: "json"
            }, !0)
        } catch (m) {}
    }
}
function initPage() {
    initRun = !0;
    window.settingsLoadedTimestamp = Date.now();
    var a = null;
    if ("undefined" == typeof storage.domain || 7 == storage.domain)
        storage.domain = 1;
    a = 3 == storage.language ? loadLanguage("de") : 4 == storage.language ? loadLanguage("fr") : 5 == storage.language ? loadLanguage("ja") : 7 == storage.language ? loadLanguage("cn") : 8 == storage.language ? loadLanguage("it") : 9 == storage.language ? loadLanguage("es") : loadLanguage("en");
    a.done(function() {
        storage.removeItem("hash");
        storage.removeItem("keepa.hash");
        if (iframe.isIframe)
            iframe.init();
        else {
            sendInitTimeStat(storage.domain);
            var b = !1;
            setTimeout(function() {
                try {
                    inIframe() && (0 < location.href.indexOf("#!sso") || 0 < location.href.indexOf("#!logout") || 0 < window.parent.location.href.indexOf("#!discuss")) && (b = !0,
                    window.parent.location = location.href,
                    $("html").html(""))
                } catch (d) {}
            }, 0);
            setTimeout(function() {
                if (!b) {
                    generateIndex();
                    initMenu();
                    initSearch();
                    replaceHtml("currentLanguage", '<div style="display:flex;justify-content:space-between;">\n\t\t\t\t\t\t\t<span class="languageMenuText">' + la._56 + '</span>\n\t\t\t\t\t\t\t<img class="languageMenuImg" style="margin-top:5px;width:30px;height:20px;" src="' + (1 == storage.language ? englishFlagLarge : flagsLarge[storage.language]) + '"  rel="language"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div style="display:flex;justify-content:space-between;height:30px;margin-top:5px;">\n\t\t\t\t\t\t\t<span class="languageMenuText">' + la._55 + '</span>\n\t\t\t\t\t\t\t<span class="languageMenuImg" style="vertical-align: top;" rel="domain">.' + getTldByDomain(storage.domain) + "</span>\n\t\t\t\t\t\t</div>");
                    var d = null
                      , h = null
                      , m = $("#languageOverlay")
                      , t = $("#userMenuOverlay");
                    $("#userMenuPanel");
                    var f = $("#currentLanguage")
                      , n = $("#panelUser")
                      , r = function() {
                        if ($(this).hasClass("switch__currency"))
                            return CurrencySwitch.init(),
                            !1;
                        if ("undefined" === typeof $(this).attr("rel"))
                            return !1;
                        var p = $("#currentLanguage").find("[rel = " + $(this).attr("rel") + "]");
                        $(this).attr("src");
                        "domain" == $(this).attr("rel") ? ($("#language_domains").find(".active").removeClass("active"),
                        p.text("." + $(this).text().substring(1)),
                        $(this).addClass("active")) : "language" == $(this).attr("rel") && ($("#language_language").find(".active").removeClass("active"),
                        $(this).addClass("active"));
                        p = storage.language;
                        var z = storage.domain;
                        m.find(".active").each(function() {
                            var F = $(this).attr("rel")
                              , I = $(this).attr("setting");
                            I && F && (storage[F] = I)
                        });
                        if (storage.language != p || storage.domain != z)
                            isDomainSwitch = !0,
                            refreshDomain(storage.domain),
                            settings.send(),
                            storage.language != p ? settings.refresh() : ("#!product" == lastUrl && (p = lastSubUrl.indexOf("-"),
                            0 < p && (lastSubUrl = storage.domain + lastSubUrl.substr(p),
                            location.hash = lastUrl + "/" + lastSubUrl)),
                            callSubPage(0));
                        return !1
                    };
                    m.find("span").on("click", r);
                    m.find("img").on("click", r);
                    m.hover(function() {
                        clearTimeout(d);
                        m.fadeIn(150)
                    }, function() {
                        d = setTimeout(function() {
                            m.fadeOut(150)
                        }, 0)
                    });
                    n.hover(function() {
                        "none" == $("#panelUserRegisterLogin").css("display") && (clearTimeout(h),
                        t = $("#userMenuOverlay"),
                        t.css({
                            opacity: 1,
                            display: "inline-block"
                        }))
                    }, function() {
                        "none" == $("#panelUserRegisterLogin").css("display") && (t.css({
                            opacity: 0
                        }),
                        h = setTimeout(function() {
                            t.css({
                                display: "none"
                            })
                        }, 250))
                    });
                    f.on("click", function() {
                        clearTimeout(d);
                        m.fadeIn(150)
                    });
                    f.on("mouseleave", function() {
                        d = setTimeout(function() {
                            m.fadeOut(300)
                        }, 500)
                    });
                    f.on("mouseenter", function() {
                        clearTimeout(d)
                    });
                    $("#language_domains").find("[setting = " + storage.domain + "]").addClass("active");
                    $("#language_language").find("[setting = " + storage.language + "]").addClass("active");
                    initLogin();
                    $("#productOverlay-close").click(function(p) {
                        p.preventDefault();
                        $(document).off("click.overlay");
                        closeProductOverlay()
                    });
                    refreshLoginBar();
                    $("#userMenuPanel").click(function() {
                        $("#panelUserRegisterLogin").is(":visible") ? $("#loginOverlay").show() : $("#userMenuOverlay").css("display", "inline-block")
                    });
                    $("#userMenuPanel").on("mouseenter", function() {
                        $("#panelUserRegisterLogin").is(":visible") || $("#userMenuOverlay").css("display", "inline-block")
                    });
                    $("#loginSettings").click(function() {
                        window.location.hash = "" == window.location.hash ? "#!settings" : "#!settings/" + window.location.hash.replace(/#!settings\|*/, "");
                        return !1
                    });
                    $("#searchBarForm").submit(function(p) {
                        p.preventDefault();
                        "" != $("#searchInput").val() && $("#searchInput").val() != la._159 && (window.location.href = "#!search/" + storage.domain + "-" + encodeURIComponent($("#searchInput").val()))
                    });
                    $("#submitSearch").click(function() {
                        $("#searchBarForm").trigger("submit")
                    });
                    pageLoaded();
                    2 == storage.accountType && settings.isEmailVerified && "#!discuss" != lastUrl && discourseApi.notification(function(p) {
                        if (!p.errors && p.notifications) {
                            for (var z = 0, F = 0; F < p.notifications.length; F++)
                                p.notifications[F].read || z++;
                            var I = p.load_more_notifications.substr(p.load_more_notifications.indexOf("username=") + 9);
                            0 < z && ($("#panelUserMenu").prepend('<span title="Unread Forum Notifications" id="userMenuNotification">' + z + "</span>"),
                            $("#userMenuNotification").on("click", function(E) {
                                document.location = discourseUrl + "/u/" + I.toLowerCase() + "/notifications";
                                $(E.currentTarget).hide("slow", function() {
                                    $(E.currentTarget).remove()
                                })
                            }).colorTip({
                                color: "transparent"
                            }))
                        }
                    })
                }
            }, 1)
        }
    })
}
var redirect_uri = ""
  , isFbLoginPage = !1;
function fbBotLogin(a) {
    isFbLoginPage = !0;
    var b = getDefaultLocation()
      , d = null;
    d = 3 == b ? loadLanguage("de") : 5 == b ? loadLanguage("ja") : 7 == b ? loadLanguage("cn") : 8 == b ? loadLanguage("it") : loadLanguage("en");
    d.done(function() {
        var h = location.hash.split("-");
        if (2 > h.length)
            console.error("invalid split length: ", h),
            showErrorPopup("invalid split length: " + h);
        else if (redirect_uri = decodeURIComponent(h.splice(1).join("-")),
        0 != redirect_uri.indexOf("https://www.facebook.com/") && 0 != redirect_uri.indexOf("https://facebook.com/") && 0 != redirect_uri.indexOf("https://messenger.com/") && 0 != redirect_uri.indexOf("https://keepa.kallisto.rocks/") && 0 != redirect_uri.indexOf("https://bot.keepa.com/"))
            reportBug(null, "untrusted redirect_uri: ", redirect_uri),
            showErrorPopup("untrusted redirect_uri: " + redirect_uri);
        else {
            redirect_uri = -1 < redirect_uri.indexOf("?") ? redirect_uri + "&authorization_code=" : redirect_uri + "?authorization_code=";
            $("#content").html(getLoginForm());
            $("#loginOverlay-close").after('<img src="https://cdn.keepa.com/img/logo_circled.svg" alt="" style="width:135px;margin:0 0 10px 42px;">');
            $("#loginOverlay-close").remove();
            document.querySelector('meta[name="viewport"]').content = "user-scalable=yes, initial-scale=1.0, maximum-scale=2.0, minimum-scale=0.2, width=device-width, height=device-height";
            $("#submitLogin").css("fontSize", "17px");
            $("#loginForm").addClass("is-fbbot-login");
            $("#loginForm label, #orOpenId").css("fontSize", "16px");
            $("#loginOverlay").css({
                background: "inherit",
                display: "flex",
                justifyContent: "center"
            });
            $("html").css({
                background: "#989898"
            });
            $("#loginOverlayBox").css({
                margin: "15px",
                position: "static"
            });
            $("#registerTab").click(function() {
                $(this).hasClass("inactive") && (toggleLoginRegister(!0),
                $(this).removeClass(),
                $("#loginTab").addClass("inactive"))
            });
            $("#loginTab").click(function() {
                $(this).hasClass("inactive") && (toggleLoginRegister(!1),
                $(this).removeClass(),
                $("#registerTab").addClass("inactive"))
            });
            if (localStorageSupported) {
                storage.token = null;
                try {
                    storage.clear(),
                    intranet.postMessage({
                        key: "logout"
                    }),
                    network.clearDatabase(),
                    initializeSettings()
                } catch (f) {}
            }
            addOpenIdEvents(encodeURIComponent(redirect_uri));
            var m = !1
              , t = function() {
                if (m)
                    return !1;
                m = !0;
                $("#submitLogin").val(la._45);
                $(this);
                isUserHuman(!0).done(function(f) {
                    var n = $("#emailRegister").val().trim();
                    f = {
                        path: "user/session",
                        type: "register",
                        username: $("#username").val().trim(),
                        password: $("#password").val().trim(),
                        email: n,
                        captcha: f,
                        sso: "fbBot",
                        content: a ? "fb" : "tg",
                        version: 3
                    };
                    0 === n.length && delete f.email;
                    var r = function(p, z) {
                        $("#loginForm").find(".error").remove();
                        $("#submitLogin").val(la._42);
                        $("#pwreset").hide();
                        $("#loginForm").find("label[for=" + p + "]").append('<span class="error">' + z + "</span>")
                    };
                    network.request(f).done(function(p) {
                        m = !1;
                        if (p.error)
                            switch (p.error.type) {
                            case "usernametaken":
                                r("username", la._50);
                                break;
                            case "emailAddressTaken":
                                r("email", la._936);
                                $("#pwreset").show().velocity({
                                    opacity: 1
                                }, {
                                    duration: 300
                                });
                                break;
                            default:
                                reportBug(null, "user/session register: default " + JSON.stringify(p)),
                                showErrorPopup()
                            }
                        else
                            $("#submitLogin").val(la._44),
                            document.location = redirect_uri + p.hash
                    }).fail(function(p) {
                        m = !1;
                        if (p.hasOwnProperty("details") && p.hasOwnProperty("error") && "invalidParameter" === p.error)
                            for (var z in p.details) {
                                var F = p.details[z];
                                if ("invalid" !== F.message) {
                                    var I = ""
                                      , E = "";
                                    switch (F.type) {
                                    case "userName":
                                        I = "username";
                                        E = la._48.replace("6", "4");
                                        break;
                                    case "userPasswordOld":
                                    case "userPassword":
                                        I = "password";
                                        E = la._48;
                                        break;
                                    case "userEmail":
                                        I = "email";
                                        E = la._49;
                                        break;
                                    case "captcha":
                                        I = F.type;
                                        E = F.message;
                                        break;
                                    default:
                                        reportBug(null, "user/session register: case unknown " + JSON.stringify(p)),
                                        showErrorPopup()
                                    }
                                    $("#loginForm").find(".error").remove();
                                    $("#loginForm").find("label[for=" + I + "]").append('<span class="error">' + E + "</span>")
                                }
                            }
                        else
                            reportBug(null, "keepa register " + JSON.stringify(p)),
                            showErrorPopup("Register Failed.");
                        $("#submitLogin").val(la._42)
                    })
                }).fail(function() {
                    $("#submitLogin").val(la._42);
                    m = !1
                })
            };
            m = !1;
            $("#loginForm").submit(function(f) {
                f.preventDefault();
                if ($("#loginTab").hasClass("inactive"))
                    t();
                else {
                    if (m)
                        return !1;
                    m = !0;
                    $("#submitLogin").val(la._45);
                    replaceHtml("loginError", "");
                    network.request({
                        path: "user/session",
                        type: "login",
                        username: $("#username").val().trim(),
                        password: $("#password").val().trim(),
                        sso: "fbBot",
                        content: a ? "fb" : "tg",
                        version: 3
                    }).done(function(n) {
                        m = !1;
                        null === n.error || "undefined" == typeof n.error ? (localStorageSupported && settings.setToken(n.token, !0),
                        $("#submitLogin").val(la._44),
                        document.location = redirect_uri + n.hash) : "loginCredentialsWrong" === n.error.type ? ($("#submitLogin").val(la._2),
                        replaceHtml("loginError", la._46)) : (showErrorPopup("Login Failed."),
                        reportBug(null, "user/session login: " + JSON.stringify(n)))
                    }).fail(function(n) {
                        m = !1;
                        if (n.hasOwnProperty("details") && n.hasOwnProperty("error") && "invalidParameter" === n.error)
                            for (var r in n.details) {
                                var p = n.details[r];
                                if ("invalid" != p.message) {
                                    var z = ""
                                      , F = "";
                                    switch (p.type) {
                                    case "userName":
                                        z = "username";
                                        F = la._48.replace("6", "4");
                                        break;
                                    case "userPasswordOld":
                                    case "userPassword":
                                        z = "password";
                                        F = la._48;
                                        break;
                                    default:
                                        reportBug(null, "user/session register: case unknown " + JSON.stringify(n)),
                                        showErrorPopup()
                                    }
                                    $("#loginForm").find(".error").remove();
                                    $("#loginForm").find("label[for=" + z + "]").append('<span class="error">' + F + "</span>")
                                }
                            }
                        else
                            reportBug(null, "user/session login: " + JSON.stringify(n)),
                            showErrorPopup("Login Failed.");
                        $("#submitLogin").val(la._2)
                    })
                }
            })
        }
    })
}
function pageLoaded() {
    "function" === typeof window.callPhantom && window.callPhantom({
        status: "loaded"
    })
}
var popupActive3 = !1
  , popupActive4 = !1;
function showErrorPopup(a) {
    return a ? showPopup("Error", a + "<br>" + la._error, !0) : showPopup("Error", la._error, !0)
}
function showDialog(a, b, d, h) {
    function m() {
        $("#shareChartOverlay-close" + (3 == h ? "" : h)).on("click", t);
        $("#popupMessage" + (3 == h ? "" : h) + ' a[id != "terms"]').on("click", t);
        $("#overlayShadowTop" + h).on("click", t);
        if (3 == h)
            $("#abortOp").on("click", t)
    }
    function t() {
        n.reject();
        f()
    }
    function f() {
        shareChartOverlayActive = !1;
        window["popupActive" + h] = !1;
        $("#overlayShadowTop" + h).fadeOut(300, function() {
            $("#" + r).remove()
        });
        p.velocity("transition.shrinkOut", 150, function() {
            p.parent().remove();
            addon()
        })
    }
    var n = $.Deferred();
    if (window["popupActive" + h])
        return !1;
    window["popupActive" + h] = !0;
    var r = "popup" + h;
    a = '<div id="' + r + '"><div id="overlayShadowTop' + h + '"></div><div class="relativeAlignCenter flex"><div class="hidden generalOverlay" style="max-height: 80%;"><div class="text_long mdc-elevation--z10" style="margin:0px;text-align:justify; color: #444; max-width:95%;position: relative;">' + (d ? '<div id="shareChartOverlay-close' + (3 == h ? "" : h) + '"><i class="fa fa-times-circle fa-2x"></i></div>' : "") + '<div id="popupTitle' + (3 == h ? "" : h) + '" style="font-size: 18px; margin: 0 40px 15px 0;display: inline-block; color: #111">' + a + '</div><br><span id="popupMessage' + (3 == h ? "" : h) + '">' + b + "</span></div></div></div></div>";
    0 < $("#contentAlign").length ? $("#contentAlign").before(a) : $("body").append(a);
    var p = $("#" + r + " .generalOverlay");
    p.velocity("transition.shrinkIn", 250, function() {
        setTimeout(function() {
            p.css("transform", "");
            var z = Math.max(1.25 * $(p).height(), 25 + p.find(".text_long").height());
            addon("resize", Math.max($(document).height(), 120 + float2int(z)))
        }, 1)
    });
    m();
    return {
        close: function() {
            n.resolve();
            f()
        },
        update: function(z) {
            replaceHtml("popupMessage" + (3 == h ? "" : h), z);
            m()
        },
        promise: n
    }
}
function showPopPopup(a, b, d) {
    return showDialog(a, b, d, 4)
}
function showPopup(a, b, d) {
    return showDialog(a, b, d, 3)
}
var resend_Verify = function() {
    showPopup(la._361, la._362 + '<br><br><input type="submit" class="button" id="resendVerify" value="' + (la._363 + '"><br><br><hr style="border-color:#38F !important">') + la._364 + '&ensp;<span style="color: #39F">' + storage.email + '</span>&ensp;<a class="settings-chpw" id="gotoSettings" href="#!channels">' + la._365 + "</a>", !0);
    $("#gotoSettings").click(function() {
        $("#shareChartOverlay-close").trigger("click")
    });
    var a = !1
      , b = $("#resendVerify");
    b.click(function(d) {
        d.preventDefault();
        if (a)
            return !1;
        a = !0;
        $("#resendVerify").val(la._45);
        network.ajax({
            type: "GET",
            url: "user/verify/?type=send&user=" + storage.token,
            dataType: "json"
        }, !0).done(function(h) {
            if (0 != parseInt(h))
                switch (h.status) {
                case "IS_BLOCKED":
                    replaceElement(b[0], "div", "<br>" + la._368, "color:tomato;");
                    break;
                case "NEW_MAIL_SENT":
                    replaceElement(b[0], "div", "<br>" + la._366, "color:tomato;");
                    break;
                case "IS_VERIFIED":
                    replaceElement(b[0], "div", "<br>" + la._360, "color:#009000;");
                    break;
                case "ALREADY_SENT_RECENTLY":
                    replaceElement(b[0], "div", "<br>" + la._369, "color:tomato;");
                    break;
                case "MAX_ATTEMPTS_REACHED":
                    replaceElement(b[0], "div", "<br>" + la._370, "color:tomato;");
                    break;
                default:
                    reportBug(null, "resendVerifyButton default " + JSON.stringify(h)),
                    replaceElement(b[0], "div", "<br>" + la._error, "color:tomato;")
                }
        }).fail(function() {
            replaceElement(b[0], "div", "<br>" + la._error, "color:tomato;");
            reportBug(null, "resendVerify " + textStatus + "<br>" + errorThrown)
        })
    })
};
function updateThemeColor(a) {
    $("meta[name=theme-color]").remove();
    $("meta[name=msapplication-navbutton-color]").remove();
    $("meta[name=apple-mobile-web-app-status-bar-style]").remove();
    $("head").append('<meta name="theme-color" content="' + a + '">');
    $("head").append('<meta name="msapplication-navbutton-color" content="' + a + '">');
    $("head").append('<meta name="apple-mobile-web-app-status-bar-style" content="' + a + '">')
}
function showWebSocketNotSupported() {
    showPopup("Your browser is outdated", 'Keepa.com uses a WebSocket for communication, which your browser does not support.<br><br>Please update your browser or <a class="url" href="http://caniuse.com/#feat=websockets">check out supported browsers</a>.', !1);
    $(".generalOverlay").css("top", "4%");
    $(".generalOverlay").css("left", "4%");
    $(".text_long").css("width", "80%");
    setTimeout(function() {
        try {
            window.parent.postMessage({
                key: "resize",
                value: "800px",
                origin: "keepaIframe"
            }, "*")
        } catch (a) {}
    }, 1500)
}
var onready = function(a) {
    if ((!keepaApp || a) && "undefined" == typeof isSnapshotPage)
        if ("WebSocket"in window || "MozWebSocket"in window) {
            a = 0 < location.href.indexOf("#!fbMessengerLogin");
            var b = 0 < location.href.indexOf("#!tgMessengerLogin");
            a || b ? fbBotLogin(a) : localStorageSupported ? (initializeSettings(),
            a = null,
            a = 3 == storage.language ? loadLanguage("de") : 4 == storage.language ? loadLanguage("fr") : 5 == storage.language ? loadLanguage("ja") : 7 == storage.language ? loadLanguage("cn") : 8 == storage.language ? loadLanguage("it") : 9 == storage.language ? loadLanguage("es") : loadLanguage("en"),
            a.done(function() {
                var d = null
                  , h = '<br><br><div style="color: #9a4100">Please check if there is an update available for your browser. It is possible that your connection to Keepa is interrupted by browser extensions, proxys or firewalls you or your company use. You can try to use a private/incognito browser session, use another browser or your mobile device to verify if that is the case. Certain anti-virus software (like Kaspersky, avast!, NOD32) features (usually called something like "web security") can prevent Keepa from working as well - try disabling them to see if that is the case. <br><br>' + (isMobile ? "We suggest you try out another browser, we recommend Chrome Mobile of Firefox Mobile." : "If the error persists, please open your browser console (F12 > Console) to look for any 'WebSocket' errors logged and send us a snapshot of them to info@keepa.com.") + "</div>";
                try {
                    /bot|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent) && (storage.initFailed = Date.now())
                } catch (t) {}
                setTimeout(function() {
                    initRun || (network.connectToServer(!0),
                    setTimeout(function() {
                        if ("undefined" == typeof isLoggerPage && !initRun) {
                            $("#networkOverlay").hide();
                            var t = "";
                            "undefined" == typeof storage.initFailed ? t = ' or, if it still fails, switch to the <span class="url blue" id="ifcm">compatibility mode</span>.' : reportBug(null, "init failed in cm mode");
                            d = showPopup("Oh no! Initialization Failed", 'Checking your connection to Keepa:&emsp;&emsp;<span id="ajaxCheck"><span class="dotLoading" style="display:inline-block;height: 8px;"></span></span><br><br>Your browser\'s user agent:<br><span style="color:#868686;">' + navigator.userAgent + '</span><br><br>You can try to <span class="url blue" id="ifr">reload</span>' + t, !1);
                            network.ajax({
                                url: "https://" + server[0] + "/isOnline",
                                type: "GET",
                                dataType: "text"
                            }, !0).done(function(f) {
                                $("#networkOverlay").hide();
                                f.startsWith("200") ? network.ajax({
                                    url: "https://" + server[0] + "/getWebSocketHeader",
                                    type: "GET",
                                    dataType: "text"
                                }, !0).done(function(n) {
                                    replaceHtml("ajaxCheck", '<span class="green">OK!</span><br>Checking WebSocket connectivity:&emsp;&emsp;<span id="wsCheck"><span class="dotLoading" style="display:inline-block;height: 8px;"></span><br>');
                                    var r = new WebSocket("wss://" + server[0] + "/apps/cloud/?app=keepaWebsite&version=1.6");
                                    r.binaryType = "arraybuffer";
                                    r.onclose = function(p) {
                                        var z = p.code;
                                        p = p.reason;
                                        "blocked" == p ? ($("#networkOverlay").show(),
                                        $("#networkBar").html("You are blocked from our services. Please contact us via info@keepa.com for resolution."),
                                        storage.updated1008 = "1",
                                        replaceHtml("wsCheck", '<span class="red">Failed</span>')) : replaceHtml("wsCheck", '<span class="red">Failed with status ' + z + " " + p + "</span><div><div>Connection headers:</div><div>" + n + "</div></div>" + h)
                                    }
                                    ;
                                    r.onerror = function(p) {
                                        r.close()
                                    }
                                    ;
                                    r.onopen = function(p) {
                                        replaceHtml("wsCheck", '<span class="green">OK!</span><br><br>There appears to be no problem with your connection. Please try to reload. If the error persists, please open your browser console (F12 > Console) to look for any errors logged and send us a snapshot of them to info@keepa.com. If you are on a mobile device you can try to use another browser.')
                                    }
                                }) : replaceHtml("ajaxCheck", '<span class="red">Failed. ' + f + " - Please try again later.</span>")
                            }).fail(function(f) {
                                replaceHtml("ajaxCheck", '<span class="red">Failed. Are you offline? Maybe Keepa is down right now.</span>')
                            });
                            $("#ifr").on("click", function() {
                                network.connectToServer(!0);
                                document.location.reload(!0)
                            });
                            $("#ifcm").on("click", function() {
                                reportBug(null, "init failed in sw mode, set to cm mode.");
                                storage.initFailed = Date.now();
                                window.forceNoSWConnection = !0;
                                setTimeout(function() {
                                    document.location.reload(!0)
                                }, 500)
                            });
                            network.ajax({
                                url: "app/stats/?type=failedWS",
                                type: "GET",
                                dataType: "json"
                            }, !0)
                        }
                    }, 6E3))
                }, 12E3);
                var m = function() {
                    settings.retrieve(!0).always(function() {
                        if (null != d)
                            try {
                                d.close()
                            } catch (f) {}
                        initPage();
                        if ("undefined" != typeof storage.initFailed) {
                            var t = Number(storage.initFailed);
                            $.isNumeric(t) && 6048E5 < Date.now() - t && (storage.removeItem("initFailed"),
                            settings.send())
                        }
                    })
                };
                network.connectToServer(!1);
                null == network.onConnected() ? m() : network.onConnected().done(m);
                "undefined" == typeof $.ui && jQuery.getScript(CDNUrl + "jquery-ui-1.11.3.custom.min.js")
            })) : (showPopup("Your browser settings prevent Keepa from functioning", 'Keepa.com needs permission to store data in your browser. Please check your browser privacy settings and add an exception allowing Keepa to store website data (even for third party, as our Keepa Box is third party when embedded on Amazon):<br><br><span style="text-align: left"><span style="color: cornflowerblue">Chrome:</span><br>Open the Content&nbsp;Settings&nbsp;Page at <span style="color: #777">chrome://settings/content</span>, select Cookies and add <span style="color:#4CA14E">[*.]keepa.com</span> as an allowed exception in the section "Allow".<br><br><span style="color: cornflowerblue">Firefox:</span><br>Open Options -> Privacy, select "Exceptions..." under "Cookies and Site Data" and add <span style="color:#4CA14E">https://keepa.com</span> as an allowed exception.</span><br>In case you have Content Blocking (Tracking Protection) enabled, please make sure you only block tracker cookies instead of all (Open Options -> Privacy, select "Trackers (recommended)" under "Content Blocking" > "Third-Party Cookies"). Alternatively try to restore the default settings.<br><br>If this does not help: Please verify that none of your addons / extensions block access to local storage. You can also contact info@keepa.com if you need further help.', !1),
            $(".generalOverlay").css("top", "4%"),
            $(".generalOverlay").css("left", "4%"),
            $(".text_long").css("width", "80%"),
            setTimeout(function() {
                try {
                    window.parent.postMessage({
                        key: "resize",
                        value: "800px",
                        origin: "keepaIframe"
                    }, "*")
                } catch (d) {}
            }, 1500))
        } else
            showWebSocketNotSupported()
};
function getDefaultLocation() {
    try {
        var a = navigator.language || navigator.userLanguage;
        if (0 <= a.indexOf("ja"))
            return 5;
        if (0 <= a.indexOf("de"))
            return 3;
        if (0 <= a.indexOf("cn") || 0 <= a.indexOf("zh"))
            return 7;
        if (0 <= a.indexOf("it"))
            return 8;
        if (0 <= a.indexOf("es"))
            return 9
    } catch (b) {}
    return 1
}
function initializeSettings() {
    try {
        for (var a = 0; a < storage.length; a++) {
            var b = storage.key(a);
            "null" != storage[b] && "undefined" !== storage[b] || storage.removeItem(b)
        }
    } catch (d) {}
    storage.token || settings.setToken(storage["keepa.hash"], !0);
    !storage.email && storage["keepa.email"] && (storage.email = storage["keepa.email"]);
    "null" != storage.email && "undefined" != storage.email || storage.removeItem("email");
    storage.token && 64 === storage.token.length || settings.reset(!0, !1);
    storage.domain = storage.domain || getDefaultLocation();
    /^([1-9]|1[0-9])$/.test(storage.domain) || (storage.domain = getDefaultLocation());
    storage.language = storage.language || getDefaultLocation();
    storage.accountType = storage.accountType || 0;
    storage.accountType = "none" == storage.accountType ? 0 : storage.accountType;
    storage.graphInterval = storage.graphInterval || 2160;
    storage.graphScale = storage.graphScale || 0;
    storage.extremeFilter = storage.extremeFilter || 0;
    storage.dealsThumbSize = storage.dealsThumbSize || 0;
    storage.dealsMerchant = storage.dealsMerchant || 1;
    storage.dealsInterval = storage.dealsInterval || 2;
    storage.lastVisit = storage.lastVisit || 0;
    storage.emailVerified = storage.emailVerified || 0;
    storage.sortDefault = storage.sortDefault || 0;
    storage.manageView = storage.manageView || 0;
    storage.salesRankInverse = storage.salesRankInverse || 0;
    refreshDomain(storage.domain);
    SettingsSubscription.reset();
    hasDataAccessSubscription = !1
}
(function(a) {
    a.onerror = function(b, d, h, m, t) {
        "object" === typeof b && b.srcElement && b.target && (b = "[object HTMLScriptElement]" == b.srcElement && "[object HTMLScriptElement]" == b.target ? "Error loading script" : "Event Error - target:" + b.target + " srcElement:" + b.srcElement);
        b = b.toString();
        var f = ""
          , n = "";
        m = m || 0;
        if (t && t.stack) {
            n = f = t.stack;
            try {
                f = t.stack.split("\n").splice(1).splice(1).join("&ensp;&lArr;&ensp;"),
                f = f.replace(/http|s:\/\/.*?\//g, "").replace(/:[0-9]*?\)/g, ")").replace(/[ ]{2,}/g, "")
            } catch (r) {
                console.log(r)
            }
        }
        b = "error: " + b + " url: " + (d || document.location.toString()) + " line: " + parseInt(h || 0) + " col: " + parseInt(m || 0);
        console.log(b + " " + n);
        if (f.startsWith("https://www.amazon") || f.startsWith("https://sellercentral"))
            return !1;
        reportBug(t, b + " date: " + new Date + " stack: " + f);
        return !1
    }
}
)(window);
var pointSymbols = {
    square: function(a, b, d, h, m) {
        h = h * Math.sqrt(Math.PI) / 2;
        a.rect(b - h, d - h, h + h, h + h)
    },
    diamond: function(a, b, d, h, m) {
        h *= Math.sqrt(Math.PI / 2);
        a.moveTo(b - h, d);
        a.lineTo(b, d - h);
        a.lineTo(b + h, d);
        a.lineTo(b, d + h);
        a.lineTo(b - h, d)
    },
    triangle: function(a, b, d, h, m) {
        h *= Math.sqrt(2 * Math.PI / Math.sin(Math.PI / 3));
        var t = h * Math.sin(Math.PI / 3);
        a.moveTo(b - h / 2, d + t / 2);
        a.lineTo(b + h / 2, d + t / 2);
        m || (a.lineTo(b, d - t / 2),
        a.lineTo(b - h / 2, d + t / 2))
    },
    cross: function(a, b, d, h, m) {
        h = h * Math.sqrt(Math.PI) / 2;
        a.moveTo(b - h, d - h);
        a.lineTo(b + h, d + h);
        a.moveTo(b - h, d + h);
        a.lineTo(b + h, d - h)
    },
    nabla: function(a, b, d, h, m) {
        h *= Math.sqrt(2 * Math.PI / Math.sin(Math.PI / 3));
        var t = h * Math.sin(Math.PI / 3);
        a.moveTo(b - h / 2, d - t / 2);
        a.lineTo(b + h / 2, d - t / 2);
        m || (a.lineTo(b, d + t / 2),
        a.lineTo(b - h / 2, d - t / 2))
    },
    lastPoint: function(a, b, d, h, m, t) {
        t && a.arc(b, d, 1.5, 0, m ? Math.PI : 2 * Math.PI, !1)
    }
}
  , graph = function() {
    function a() {
        for (var q = [], L = 112; L <= (new Date).getYear(); L++) {
            var A = (new Date(1900 + L,0,1,0,0,0,0)).getTime();
            q.push({
                color: "#aaa",
                lineWidth: 2,
                xaxis: {
                    from: A,
                    to: A
                }
            })
        }
        return q
    }
    function b() {
        var q = m(!0, !0), L = {}, A = 0, O;
        for (O in q) {
            var P = q[O];
            P.index = 100 + A++;
            P.series.index = P.index;
            P.series.lines.show = !1;
            P.series.label = null;
            P.series.labelText = (CsvType[O].currency ? la._342.replace("&nbsp;", " ") : la._860) + ": " + P.series.labelText;
            P.series.dashes = {
                show: !0,
                steps: !0,
                lineWidth: 1.2,
                dashLength: 13
            };
            P.series.points.show = !1;
            L[desiredSeriesPrefix + O] = P
        }
        return L
    }
    function d(q, L, A, O, P) {
        var M = {}, u = -1, v;
        for (v in q) {
            q = L[v];
            u++;
            var G = 1 == A[v].length ? "" : ' <i class="fa fa-sitemap" aria-hidden="true"></i> ' + (A[v].length - 1);
            M[v] = {
                index: u,
                isDisabled: !1,
                series: {
                    index: v,
                    data: [],
                    label: q.contextFreeName + G,
                    labelText: q.contextFreeName + G,
                    getLabelText: function(w) {
                        w = getValueAtTime(P, w, CsvType.SALES);
                        return -1 == w ? P[1] : w
                    },
                    labelReferenceHistory: v == O ? P : null,
                    lines: {
                        show: !0,
                        steps: !0,
                        fill: v == O,
                        fillColor: {
                            colors: ["rgba(198, 237, 203, 0.1)", "rgba(198, 237, 203, 1.0)"]
                        },
                        lineWidth: 1
                    },
                    hoverable: !1,
                    color: v == O ? CsvType.SALES.color : $.color.parse(CsvType.SALES.color).add("rgb", -25 * u).toString(),
                    backgroundColor: CsvType.SALES.bg,
                    points: {
                        show: !0,
                        symbol: pointSymbols.lastPoint
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: u + 2,
                    isCurrency: !1
                }
            }
        }
        return M
    }
    function h(q, L, A) {
        var O = {};
        A = -1;
        for (var P in q)
            A++,
            O[P] = {
                index: P,
                deal: !1,
                currency: !1,
                showDefault: 1,
                isEnabled: !0,
                isWithShipping: !1,
                isTopGraph: !1,
                isOfferData: !1,
                isSalesRankGraph: !0,
                color: "#8FBC8F",
                bg: "rgba(198, 237, 203, 0.8)"
            };
        O.length = A;
        O.getName = function(M) {
            return L[M].contextFreeName
        }
        ;
        O.getObjectNameByName = function(M) {
            return O[M]
        }
        ;
        O.getObject = function(M) {
            return O[M]
        }
        ;
        O.getObjectName = function(M) {
            return M
        }
        ;
        return O
    }
    function m(q, L) {
        var A = keepaApp ? 1 : 1.5
          , O = keepaApp ? 1.5 : 2.5
          , P = function(u) {
            var v = graphIsRestricted(q, u)
              , G = CsvType.getName(u)
              , w = "";
            "undefined" == typeof isSnapshotPage && (u === CsvType.SALES.index && (G = CsvType.getName(u) + ('<span class="salesRankInverse">&ensp;' + ("0" === storage.salesRankInverse ? '<i class="fa fa-sort-numeric-desc"></i>' : '<i class="fa fa-sort-numeric-asc"></i>') + "&ensp;</span>"),
            v || (G += '<span class="toggleSalesRankGraph" style="margin-left:3px;color:' + ("1" == storage.showSalesRankGraph ? "#34bf34" : "#666") + '" title="Toggle standalone Sales Rank graph"><i class="fa fa fa-sitemap"></i> <span style="font-style:italic;">sub-ranks</span></span>')),
            u === CsvType.EBAY_NEW_SHIPPING.index && (w = '<span class="graphEbayNewLink" title="show listing on ebay">&ensp;<i class="fa fa-external-link"></i>&ensp;</span></a>'),
            u === CsvType.EBAY_USED_SHIPPING.index && (w = '<span class="graphEbayUsedLink" title="show listing on ebay">&ensp;<i class="fa fa-external-link"></i>&ensp;</span></a>'));
            return v && keepaApp ? "" : G + (v ? '&ensp;<i class="fa fa-lock"></i>&ensp;' : w)
        }
          , M = function(u) {
            return 1 == J[u]
        };
        return {
            AMAZON: {
                index: 0,
                isDisabled: !CsvType.AMAZON.isEnabled,
                series: {
                    index: 0,
                    data: null,
                    label: P(0),
                    labelText: CsvType.getName(0),
                    labelDesc: CsvType.getDescription(0),
                    lines: {
                        show: M(0),
                        steps: !0,
                        fill: !0,
                        fillColor: {
                            colors: CsvType.AMAZON.fillColor
                        },
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.AMAZON.color,
                    backgroundColor: CsvType.AMAZON.bg,
                    points: {
                        show: !0,
                        symbol: pointSymbols.lastPoint
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.AMAZON.currency
                }
            },
            NEW: {
                index: 1,
                isDisabled: !CsvType.NEW.isEnabled,
                series: {
                    index: 1,
                    data: null,
                    label: P(1),
                    labelText: CsvType.getName(1),
                    labelDesc: CsvType.getDescription(1),
                    lines: {
                        show: M(1),
                        steps: !0,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.NEW.color,
                    backgroundColor: CsvType.NEW.bg,
                    points: {
                        show: !0,
                        symbol: pointSymbols.lastPoint
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.NEW.currency
                }
            },
            USED: {
                index: 2,
                isDisabled: !CsvType.USED.isEnabled,
                series: {
                    index: 2,
                    data: null,
                    label: P(2),
                    labelText: CsvType.getName(2),
                    labelDesc: CsvType.getDescription(2),
                    lines: {
                        show: M(2),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.USED.color,
                    backgroundColor: CsvType.USED.bg,
                    points: {
                        show: !0,
                        symbol: pointSymbols.lastPoint
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.USED.currency
                }
            },
            SALES: {
                index: 3,
                isDisabled: !CsvType.SALES.isEnabled,
                series: {
                    index: 3,
                    data: null,
                    label: P(3),
                    labelText: CsvType.getName(3),
                    labelDesc: CsvType.getDescription(3),
                    lines: {
                        show: M(3),
                        steps: !0,
                        lineWidth: A
                    },
                    hoverable: !1,
                    points: {
                        show: !1
                    },
                    color: CsvType.SALES.color,
                    backgroundColor: CsvType.SALES.bg,
                    dashes: {
                        show: !1
                    },
                    yaxis: 2,
                    isCurrency: CsvType.SALES.currency
                }
            },
            LISTPRICE: {
                index: 4,
                isDisabled: !CsvType.LISTPRICE.isEnabled,
                series: {
                    index: 4,
                    data: null,
                    label: P(4),
                    labelText: CsvType.getName(4),
                    labelDesc: CsvType.getDescription(4),
                    lines: {
                        show: M(4),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.LISTPRICE.color,
                    backgroundColor: CsvType.LISTPRICE.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.LISTPRICE.currency
                }
            },
            COLLECTIBLE: {
                index: 5,
                isDisabled: !CsvType.COLLECTIBLE.isEnabled,
                series: {
                    index: 5,
                    data: null,
                    label: P(5),
                    labelText: CsvType.getName(5),
                    labelDesc: CsvType.getDescription(5),
                    lines: {
                        show: M(5),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.COLLECTIBLE.color,
                    backgroundColor: CsvType.COLLECTIBLE.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.COLLECTIBLE.currency
                }
            },
            REFURBISHED: {
                index: 6,
                isDisabled: !CsvType.REFURBISHED.isEnabled,
                series: {
                    index: 6,
                    data: null,
                    label: P(6),
                    labelText: CsvType.getName(6),
                    labelDesc: CsvType.getDescription(6),
                    lines: {
                        show: M(6),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.REFURBISHED.color,
                    backgroundColor: CsvType.REFURBISHED.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.REFURBISHED.currency
                }
            },
            NEW_FBM_SHIPPING: {
                index: 7,
                isDisabled: !CsvType.NEW_FBM_SHIPPING.isEnabled,
                series: {
                    index: 7,
                    data: null,
                    label: P(7),
                    labelText: CsvType.getName(7),
                    labelDesc: CsvType.getDescription(7),
                    lines: {
                        show: M(7),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.NEW_FBM_SHIPPING.color,
                    backgroundColor: CsvType.NEW_FBM_SHIPPING.bg,
                    points: {
                        show: L,
                        symbol: pointSymbols.square,
                        lineWidth: 1,
                        radius: O
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.NEW_FBM_SHIPPING.currency
                }
            },
            LIGHTNING_DEAL: {
                index: 8,
                isDisabled: !CsvType.LIGHTNING_DEAL.isEnabled,
                series: {
                    index: 8,
                    data: null,
                    label: P(8),
                    labelText: CsvType.getName(8),
                    lines: {
                        show: M(8),
                        steps: !0,
                        fill: !1,
                        lineWidth: 5
                    },
                    hoverable: !1,
                    color: CsvType.LIGHTNING_DEAL.color,
                    backgroundColor: CsvType.LIGHTNING_DEAL.bg,
                    points: {
                        show: !0
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.LIGHTNING_DEAL.currency
                }
            },
            WAREHOUSE: {
                index: 9,
                isDisabled: !CsvType.WAREHOUSE.isEnabled,
                series: {
                    index: 9,
                    data: null,
                    label: P(9),
                    labelText: CsvType.getName(9),
                    lines: {
                        show: M(9),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.WAREHOUSE.color,
                    backgroundColor: CsvType.WAREHOUSE.bg,
                    points: {
                        show: L,
                        symbol: pointSymbols.cross,
                        lineWidth: 1,
                        radius: O + .5
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.WAREHOUSE.currency
                }
            },
            NEW_FBA: {
                index: 10,
                isDisabled: !CsvType.NEW_FBA.isEnabled,
                series: {
                    index: 10,
                    data: null,
                    label: P(10),
                    labelText: CsvType.getName(10),
                    labelDesc: CsvType.getDescription(10),
                    lines: {
                        show: M(10),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.NEW_FBA.color,
                    backgroundColor: CsvType.NEW_FBA.bg,
                    points: {
                        show: L,
                        symbol: pointSymbols.triangle,
                        lineWidth: 1,
                        radius: O
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.NEW_FBA.currency
                }
            },
            COUNT_NEW: {
                index: 11,
                isDisabled: !CsvType.COUNT_NEW.isEnabled,
                series: {
                    index: 11,
                    data: null,
                    label: P(11),
                    labelText: CsvType.getName(11),
                    lines: {
                        show: M(11),
                        steps: !0,
                        lineWidth: A
                    },
                    hoverable: !1,
                    points: {
                        show: !1
                    },
                    color: CsvType.COUNT_NEW.color,
                    backgroundColor: CsvType.COUNT_NEW.bg,
                    dashes: {
                        show: !1
                    },
                    yaxis: 3,
                    isCurrency: CsvType.COUNT_NEW.currency
                }
            },
            COUNT_USED: {
                index: 12,
                isDisabled: !CsvType.COUNT_USED.isEnabled,
                series: {
                    index: 12,
                    data: null,
                    label: P(12),
                    labelText: CsvType.getName(12),
                    lines: {
                        show: M(12),
                        steps: !0,
                        lineWidth: A
                    },
                    hoverable: !1,
                    points: {
                        show: !1
                    },
                    color: CsvType.COUNT_USED.color,
                    backgroundColor: CsvType.COUNT_USED.bg,
                    dashes: {
                        show: !1
                    },
                    yaxis: 3,
                    isCurrency: CsvType.COUNT_USED.currency
                }
            },
            COUNT_REFURBISHED: {
                index: 13,
                isDisabled: !CsvType.COUNT_REFURBISHED.isEnabled,
                series: {
                    index: 13,
                    data: null,
                    label: P(13),
                    labelText: CsvType.getName(13),
                    lines: {
                        show: M(13),
                        steps: !0,
                        lineWidth: A
                    },
                    hoverable: !1,
                    points: {
                        show: !1
                    },
                    color: CsvType.COUNT_REFURBISHED.color,
                    backgroundColor: CsvType.COUNT_REFURBISHED.bg,
                    dashes: {
                        show: !1
                    },
                    yaxis: 3,
                    isCurrency: CsvType.COUNT_REFURBISHED.currency
                }
            },
            COUNT_COLLECTIBLE: {
                index: 14,
                isDisabled: !CsvType.COUNT_COLLECTIBLE.isEnabled,
                series: {
                    index: 14,
                    data: null,
                    label: P(14),
                    labelText: CsvType.getName(14),
                    lines: {
                        show: M(14),
                        steps: !0,
                        lineWidth: A
                    },
                    hoverable: !1,
                    points: {
                        show: !1
                    },
                    color: CsvType.COUNT_COLLECTIBLE.color,
                    backgroundColor: CsvType.COUNT_COLLECTIBLE.bg,
                    dashes: {
                        show: !1
                    },
                    yaxis: 3,
                    isCurrency: CsvType.COUNT_COLLECTIBLE.currency
                }
            },
            EXTRA_INFO_UPDATES: {
                index: 15,
                isDisabled: !CsvType.EXTRA_INFO_UPDATES.isEnabled,
                series: {
                    index: 15,
                    data: null,
                    label: P(15),
                    labelText: CsvType.getName(15),
                    lines: {
                        show: M(15),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.EXTRA_INFO_UPDATES.color,
                    backgroundColor: CsvType.EXTRA_INFO_UPDATES.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.EXTRA_INFO_UPDATES.currency
                }
            },
            RATING: {
                index: 16,
                isDisabled: !CsvType.RATING.isEnabled,
                series: {
                    index: 16,
                    data: null,
                    label: P(16),
                    labelText: CsvType.getName(16),
                    lines: {
                        show: M(16),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.RATING.color,
                    backgroundColor: CsvType.RATING.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 6,
                    isCurrency: CsvType.RATING.currency
                }
            },
            COUNT_REVIEWS: {
                index: 17,
                isDisabled: !CsvType.COUNT_REVIEWS.isEnabled,
                series: {
                    index: 17,
                    data: null,
                    label: P(17),
                    labelText: CsvType.getName(17),
                    lines: {
                        show: M(17),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.COUNT_REVIEWS.color,
                    backgroundColor: CsvType.COUNT_REVIEWS.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 5,
                    isCurrency: CsvType.COUNT_REVIEWS.currency
                }
            },
            BUY_BOX_SHIPPING: {
                index: 18,
                isDisabled: !CsvType.BUY_BOX_SHIPPING.isEnabled,
                series: {
                    index: 18,
                    data: null,
                    label: P(18),
                    labelText: CsvType.getName(18),
                    labelDesc: CsvType.getDescription(18),
                    lines: {
                        show: M(18),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.BUY_BOX_SHIPPING.color,
                    backgroundColor: CsvType.BUY_BOX_SHIPPING.bg,
                    points: {
                        show: L,
                        symbol: pointSymbols.diamond,
                        lineWidth: 1,
                        radius: O
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.BUY_BOX_SHIPPING.currency
                }
            },
            USED_NEW_SHIPPING: {
                index: 19,
                isDisabled: !CsvType.USED_NEW_SHIPPING.isEnabled,
                series: {
                    index: 19,
                    data: null,
                    label: P(19),
                    labelText: CsvType.getName(19),
                    labelDesc: CsvType.getDescription(19),
                    lines: {
                        show: M(19),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.USED_NEW_SHIPPING.color,
                    backgroundColor: CsvType.USED_NEW_SHIPPING.bg,
                    points: {
                        show: L,
                        lineWidth: 1,
                        radius: O
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.USED_NEW_SHIPPING.currency
                }
            },
            USED_VERY_GOOD_SHIPPING: {
                index: 20,
                isDisabled: !CsvType.USED_VERY_GOOD_SHIPPING.isEnabled,
                series: {
                    index: 20,
                    data: null,
                    label: P(20),
                    labelText: CsvType.getName(20),
                    labelDesc: CsvType.getDescription(20),
                    lines: {
                        show: M(20),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.USED_VERY_GOOD_SHIPPING.color,
                    backgroundColor: CsvType.USED_VERY_GOOD_SHIPPING.bg,
                    points: {
                        show: L,
                        symbol: pointSymbols.diamond,
                        lineWidth: 1,
                        radius: O
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.USED_VERY_GOOD_SHIPPING.currency
                }
            },
            USED_GOOD_SHIPPING: {
                index: 21,
                isDisabled: !CsvType.USED_GOOD_SHIPPING.isEnabled,
                series: {
                    index: 21,
                    data: null,
                    label: P(21),
                    labelText: CsvType.getName(21),
                    labelDesc: CsvType.getDescription(21),
                    lines: {
                        show: M(21),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.USED_GOOD_SHIPPING.color,
                    backgroundColor: CsvType.USED_GOOD_SHIPPING.bg,
                    points: {
                        show: L,
                        symbol: pointSymbols.triangle,
                        lineWidth: 1,
                        radius: O
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.USED_GOOD_SHIPPING.currency
                }
            },
            USED_ACCEPTABLE_SHIPPING: {
                index: 22,
                isDisabled: !CsvType.USED_ACCEPTABLE_SHIPPING.isEnabled,
                series: {
                    index: 22,
                    data: null,
                    label: P(22),
                    labelText: CsvType.getName(22),
                    labelDesc: CsvType.getDescription(22),
                    lines: {
                        show: M(22),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.USED_ACCEPTABLE_SHIPPING.color,
                    backgroundColor: CsvType.USED_ACCEPTABLE_SHIPPING.bg,
                    points: {
                        show: L,
                        symbol: pointSymbols.square,
                        lineWidth: 1,
                        radius: O
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.USED_ACCEPTABLE_SHIPPING.currency
                }
            },
            COLLECTIBLE_NEW_SHIPPING: {
                index: 23,
                isDisabled: !CsvType.COLLECTIBLE_NEW_SHIPPING.isEnabled,
                series: {
                    index: 23,
                    data: null,
                    label: P(23),
                    labelText: CsvType.getName(23),
                    lines: {
                        show: M(23),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.COLLECTIBLE_NEW_SHIPPING.color,
                    backgroundColor: CsvType.COLLECTIBLE_NEW_SHIPPING.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.COLLECTIBLE_NEW_SHIPPING.currency
                }
            },
            COLLECTIBLE_VERY_GOOD_SHIPPING: {
                index: 24,
                isDisabled: !CsvType.COLLECTIBLE_VERY_GOOD_SHIPPING.isEnabled,
                series: {
                    index: 24,
                    data: null,
                    label: P(24),
                    labelText: CsvType.getName(24),
                    lines: {
                        show: M(24),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.COLLECTIBLE_VERY_GOOD_SHIPPING.color,
                    backgroundColor: CsvType.COLLECTIBLE_VERY_GOOD_SHIPPING.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.COLLECTIBLE_VERY_GOOD_SHIPPING.currency
                }
            },
            COLLECTIBLE_GOOD_SHIPPING: {
                index: 25,
                isDisabled: !CsvType.COLLECTIBLE_GOOD_SHIPPING.isEnabled,
                series: {
                    index: 25,
                    data: null,
                    label: P(25),
                    labelText: CsvType.getName(25),
                    lines: {
                        show: M(25),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.COLLECTIBLE_GOOD_SHIPPING.color,
                    backgroundColor: CsvType.COLLECTIBLE_GOOD_SHIPPING.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.COLLECTIBLE_GOOD_SHIPPING.currency
                }
            },
            COLLECTIBLE_ACCEPTABLE_SHIPPING: {
                index: 26,
                isDisabled: !CsvType.COLLECTIBLE_ACCEPTABLE_SHIPPING.isEnabled,
                series: {
                    index: 26,
                    data: null,
                    label: P(26),
                    labelText: CsvType.getName(26),
                    lines: {
                        show: M(26),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.COLLECTIBLE_ACCEPTABLE_SHIPPING.color,
                    backgroundColor: CsvType.COLLECTIBLE_ACCEPTABLE_SHIPPING.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.COLLECTIBLE_ACCEPTABLE_SHIPPING.currency
                }
            },
            REFURBISHED_SHIPPING: {
                index: 27,
                isDisabled: !CsvType.REFURBISHED_SHIPPING.isEnabled,
                series: {
                    index: 27,
                    data: null,
                    label: P(27),
                    labelText: CsvType.getName(27),
                    lines: {
                        show: M(27),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.REFURBISHED_SHIPPING.color,
                    backgroundColor: CsvType.REFURBISHED_SHIPPING.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.REFURBISHED_SHIPPING.currency
                }
            },
            EBAY_NEW_SHIPPING: {
                index: 28,
                isDisabled: !CsvType.EBAY_NEW_SHIPPING.isEnabled,
                series: {
                    index: 28,
                    data: null,
                    label: P(28),
                    labelText: CsvType.getName(28),
                    lines: {
                        show: M(28),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.EBAY_NEW_SHIPPING.color,
                    backgroundColor: CsvType.EBAY_NEW_SHIPPING.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.EBAY_NEW_SHIPPING.currency
                }
            },
            EBAY_USED_SHIPPING: {
                index: 29,
                isDisabled: !CsvType.EBAY_USED_SHIPPING.isEnabled,
                series: {
                    index: 29,
                    data: null,
                    label: P(29),
                    labelText: CsvType.getName(29),
                    lines: {
                        show: M(29),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.EBAY_USED_SHIPPING.color,
                    backgroundColor: CsvType.EBAY_USED_SHIPPING.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.EBAY_USED_SHIPPING.currency
                }
            },
            TRADE_IN: {
                index: 30,
                isDisabled: !CsvType.TRADE_IN.isEnabled,
                series: {
                    index: 30,
                    data: null,
                    label: P(30),
                    labelText: CsvType.getName(30),
                    lines: {
                        show: M(30),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.TRADE_IN.color,
                    backgroundColor: CsvType.TRADE_IN.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.TRADE_IN.currency
                }
            },
            RENT: {
                index: 31,
                isDisabled: !CsvType.RENT.isEnabled,
                series: {
                    index: 31,
                    data: null,
                    label: P(31),
                    labelText: CsvType.getName(31),
                    lines: {
                        show: M(31),
                        steps: !0,
                        fill: !1,
                        lineWidth: A
                    },
                    hoverable: !1,
                    color: CsvType.RENT.color,
                    backgroundColor: CsvType.RENT.bg,
                    points: {
                        show: !1
                    },
                    dashes: {
                        show: !1
                    },
                    yaxis: 1,
                    isCurrency: CsvType.RENT.currency
                }
            }
        }
    }
    function t() {
        var q = [], L;
        for (L in CsvType)
            "object" == typeof CsvType[L] && q.push(CsvType[L].showDefault);
        try {
            q[CsvType.AMAZON.index] = null == storage.s_merchantChart ? 1 : "1" === storage.s_merchantChart[0] ? 1 : 0,
            q[CsvType.NEW.index] = null == storage.s_merchantChart ? 1 : "1" === storage.s_merchantChart[1] ? 1 : 0,
            q[CsvType.USED.index] = null == storage.s_merchantChart ? 1 : "1" === storage.s_merchantChart[2] ? 1 : 0
        } catch (A) {}
        return q
    }
    function f(q) {
        var L = [], A;
        for (A in q.csv) {
            var O = "locales" == q.type || 3 > A.length ? q.objectType.getObjectName(A) : A;
            if (q.series[O]) {
                var P = q.series[O].series;
                null == q.data[A] || q.series[O].isDisabled ? P.data = null : (P.data = P.lines.show || P.dashes.show ? q.data[A] : [null, null],
                L.push(P))
            }
        }
        return L
    }
    function n(q) {
        var L = [];
        $.each(q.axes.y, function(v, G) {
            G.min = q.parameter.scale ? 0 : null
        });
        for (var A in q.csv)
            if (2 == q.graphIndex || $.isNumeric(A)) {
                var O = q.objectType.getObjectName(A);
                if ("undefined" == typeof O)
                    break;
                if ("undefined" != typeof q.series[O]) {
                    var P = q.series[O].series;
                    if (0 === q.graphIndex) {
                        if (3 === P.yaxis || 6 === P.yaxis)
                            continue
                    } else if (1 === q.graphIndex && 3 > P.yaxis)
                        continue;
                    1 != q.graphIndex && 6 != P.yaxis && 2 != q.graphIndex && 4 < P.yaxis || (2 == q.graphIndex ? L[P.yaxis] = q.axes.y[P.yaxis - 1].show : q.series[O].isDisabled || 0 == P.lines.show ? 1 != L[P.yaxis] && (L[P.yaxis] = !1) : L[P.yaxis] = !0)
                }
            }
        if (q.plot)
            for (var M in L)
                A = L[M],
                O = q.plot.getYAxes()[M - 1],
                2 == q.graphIndex ? O.options.color = A && 2 == M ? "#444" : "#fff" : (O.options.show = A,
                O.show = A);
        else
            for (var u in L)
                q.axes.y[u - 1].show = L[u]
    }
    function r(q, L) {
        if (!(1 >= q.syncedGraphs.length)) {
            $.each(q.plot.getYAxes(), function(T, oa) {
                oa.options.labelWidth = void 0;
                oa.labelWidth = void 0;
                oa.reserveSpace = void 0;
                oa.options.reserveSpace = void 0
            });
            $(q.plot.getYAxes()).each(function(T, oa) {
                oa.options.color = "#fff"
            });
            for (L = 0; L < q.syncedGraphs.length; L++) {
                var A = q.syncedGraphs[L];
                null != A.plot && ($.each(A.plot.getYAxes(), function(T, oa) {
                    oa.options.labelWidth = void 0;
                    oa.labelWidth = void 0;
                    oa.reserveSpace = void 0;
                    oa.options.reserveSpace = void 0
                }),
                $(A.plot.getYAxes()).each(function(T, oa) {
                    oa.options.color = "#fff"
                }),
                A.plot.getOptions().grid.tickColor = "#fff",
                A.plot.setupGrid(!0))
            }
            var O = A = L = 0
              , P = 0;
            $(q.plot.getYAxes()).each(function(T, oa) {
                oa.options.color = "#444"
            });
            var M = 0;
            q.plot.setupGrid(!0);
            for (var u = 0; u < q.syncedGraphs.length; u++) {
                var v = q.syncedGraphs[u].plot.getYAxes(), G = 0, w = 0, B = 0, Q;
                for (Q in v) {
                    var fa = v[Q];
                    fa.labelWidth = fa.labelWidth || 0;
                    0 == fa.labelWidth && (fa.options.labelWidth = 0);
                    "left" == fa.options.position ? (u == q.syncedGraphs.length - 1 && 0 < fa.labelWidth && M++,
                    w += fa.labelWidth) : (G++,
                    B += fa.labelWidth)
                }
                0 == u ? A = w : u == q.syncedGraphs.length - 1 && (O = w);
                L = Math.max(L, w);
                P = Math.max(P, B)
            }
            for (Q = 0; Q < q.syncedGraphs.length; Q++) {
                u = q.syncedGraphs[Q];
                $(u.plot.getYAxes()).each(function(T, oa) {
                    oa.options.color = "#444"
                });
                u.plot.setupGrid(!0);
                v = u.plot.getYAxes();
                G = 1;
                B = w = 0;
                for (var R in v)
                    fa = v[R],
                    0 == fa.labelWidth && (fa.options.reserveSpace = !1),
                    fa.reserveSpace && (B++,
                    "left" != fa.options.position ? G = R : w = R);
                0 < L && (Q == q.syncedGraphs.length - 1 ? A == L && O < A && (v[w].options.labelWidth = L - O + v[w].labelWidth) : (v[w].options.labelWidth = L,
                1 < M && (v[w].options.labelWidth += u.grid.axisMargin + u.grid.labelMargin)),
                v[w].options.reserveSpace = !0);
                0 < P && (v[G].options.labelWidth = P + (0 > B && 0 != B ? 18 : 0),
                v[G].options.reserveSpace = !0);
                graph.redraw(u, !1, !0)
            }
        }
    }
    function p(q) {
        try {
            qa(q);
            if (2 == q.graphIndex)
                q.objectType = h(q.salesRanks, q.salesRankCategories, q.salesRankCategoryTrees),
                q.series = d(q.salesRanks, q.salesRankCategories, q.salesRankCategoryTrees, q.salesRankReference, q.salesRankReferenceHistory);
            else {
                for (var L in q.series) {
                    var A = q.series[L].index;
                    null !== q.csv[A] && !0 === q.series[L].series.lines.show && graphIsRestricted(q.domainId, A) && (q.series[L].series.lines.show = !1)
                }
                if (null != q.buyBoxSellerIdHistory) {
                    var O = q.series[CsvType.getObjectName(CsvType.BUY_BOX_SHIPPING.index)].series;
                    O.buyBoxSellerIdHistory = q.buyBoxSellerIdHistory;
                    O.offers = q.offers;
                    O.bbHistory = q.bbHistory
                }
                q.currencySymbol = getCurrencyByDomain(q.domainId);
                ua(q)
            }
            600 > q.parameter.width.replace("px", "") && (q.axes.x[0].labelAngle = 30);
            q.axes.x[0].max = q.internal.time;
            q.axes.y[1].transform = 0 === q.parameter.salesRankInverse ? null : function(ja) {
                return -ja
            }
            ;
            q.axes.y[1].inverseTransform = 0 === q.parameter.salesRankInverse ? null : function(ja) {
                return -ja
            }
            ;
            0 === q.data.length && ea(q);
            var P = -1 == q.parameter.interval ? 99999999 : q.parameter.interval
              , M = q.parameter.forceInterval ? P : Math.min(ra(q, !1), P);
            q.axes.x[0].min = q.internal.time - 36E5 * M;
            if ((1 == q.graphIndex || 2 == q.graphIndex) && 0 < q.syncedGraphs.length) {
                var u = q.axes.x[0].min;
                for (L = 0; L < q.syncedGraphs.length; L++)
                    u = Math.min(q.syncedGraphs[L].axes.x[0].min, u);
                q.axes.x[0].min = u
            }
            361E4 > Math.abs(q.axes.x[0].min - q.axes.x[0].max) && (q.axes.x[0].min = q.axes.x[0].max - 36E5 * ra(q, !0));
            q.$container.css({
                width: q.parameter.width,
                height: q.parameter.height
            });
            var v = f(q);
            n(q);
            q.plot = $.plot(q.$container, v, {
                xaxes: q.axes.x,
                yaxes: q.axes.y,
                series: {
                    shadowSize: 0
                },
                graphSeries: q.series,
                currency: getCurrencyByDomain(q.domainId),
                domain: q.domainId,
                timeShiftOffset: keepaTime.timeShiftOffset,
                grid: q.grid,
                legend: {
                    show: q.showLegend,
                    noLegend: q.showOnlyTracked,
                    position: "nw"
                },
                selection: {
                    mode: "x",
                    color: "#777"
                },
                hooks: {
                    bindEvents: function(ja, W) {
                        W.mousemove(function(Aa, Ca) {
                            if (0 < q.syncedGraphs.length && !Ca)
                                for (Ca = 0; Ca < q.syncedGraphs.length; Ca++)
                                    q.syncedGraphs[Ca].plot.getEventHolder().trigger("mousemove", [Aa, !0])
                        });
                        W.on("touchmove", function(Aa, Ca) {
                            if (!(1 < Aa.touches.length) && 0 < q.syncedGraphs.length && !Ca)
                                for (Ca = 0; Ca < q.syncedGraphs.length; Ca++)
                                    Aa.pageX = Aa.originalEvent.touches[0].pageX,
                                    Aa.pageY = Aa.originalEvent.touches[0].pageY,
                                    q.syncedGraphs[Ca].plot.getEventHolder().trigger("mousemove", [Aa, !0])
                        })
                    }
                },
                graphIndex: q.graphIndex,
                showOnlyTracked: q.showOnlyTracked
            });
            0 < q.syncedGraphs.length && (q.plot.getOptions().$isSyncedWith = q.syncedGraphs);
            (u = "undefined" != typeof isSnapshotPage) ? H(q, !0, !0) : (I(q),
            E(q));
            if ((0 == q.graphIndex || 2 == q.graphIndex) && !u & !keepaApp) {
                var G = float2int(q.$container.height())
                  , w = float2int(q.$container.find(".legend > table").height())
                  , B = Math.max(G, w);
                B > G && (q.$container.height(B),
                q.parameter.height = B + "px",
                q.plot.resize(),
                q.plot.setupGrid(!0),
                q.plot.draw())
            }
            if (!u) {
                q.$container.on("plotselected", function(ja, W) {
                    ja = q.plot.getXAxes()[0].options;
                    S(q, ja.min, ja.max, W.xaxis.from, W.xaxis.to)
                });
                q.$container.on("plotunselected", function(ja) {
                    $("#selection").text("")
                });
                q.$container.on("dblclick", function(ja) {
                    ja = q.internal.time;
                    var W = q.plot.getXAxes()[0].options;
                    S(q, W.min, W.max, ja - 36E5 * q.parameter.interval, ja)
                });
                if (isMobile) {
                    var Q = Date.now()
                      , fa = Q
                      , R = Q
                      , T = q.plot.getPlotOffset()
                      , oa = function(ja, W) {
                        ja.pageX = ja.originalEvent.touches[W].pageX;
                        ja.pageY = ja.originalEvent.touches[W].pageY;
                        W = q.$container.offset();
                        return q.plot.c2p({
                            left: ja.pageX - W.left - T.left,
                            top: ja.pageY - W.top - T.top
                        }).x
                    }
                      , Z = q.plot.getXAxes();
                    q.$container.on("touchmove", function(ja) {
                        if (1 < ja.touches.length) {
                            ja.preventDefault();
                            var W = Z[0].options
                              , Aa = oa(ja, 0)
                              , Ca = oa(ja, 1);
                            ja = Math.abs(Aa - Ca) - R;
                            Ca = (Q + fa) / 2 - (Aa + Ca) / 2;
                            Aa = Math.max(Z[0].datamin, W.min + Ca + ja);
                            ja = Math.min(Date.now(), W.max + Ca - ja);
                            S(q, W.min, W.max, Aa, ja)
                        }
                    });
                    q.$container.on("touchstart", function(ja) {
                        if (1 < ja.touches.length) {
                            ja.preventDefault();
                            if (0 < q.syncedGraphs.length)
                                for (var W = 0; W < q.syncedGraphs.length; W++)
                                    q.syncedGraphs[W].plot.getEventHolder().trigger("mouseout", [ja, !0]);
                            Q = oa(ja, 0);
                            fa = oa(ja, 1);
                            R = Math.abs(Q - fa)
                        }
                    });
                    q.$container.on("touchend", function(ja) {})
                }
                if (!keepaApp)
                    q.$container.on("plotclick", function(ja, W, Aa) {
                        if (0 < Aa.length && null != q.offers) {
                            ja = [];
                            for (var Ca in Aa) {
                                var Ba = Aa[Ca]
                                  , ta = q.csv[Ba.series.index];
                                W = CsvType.getObject(Ba.series.index);
                                if (W.isOfferData) {
                                    var Ea = keepaTime.epochToMinutes(Ba.datapoint[0]) - keepaTime.timeShiftOffset
                                      , va = Number(Ba.datapoint[1].toFixed(2).replace(/,|\./g, ""));
                                    5 == q.domainId && (va /= 100);
                                    if (Ba.series.index != CsvType.BUY_BOX_SHIPPING.index) {
                                        Ba = W.isWithShipping ? 3 : 2;
                                        for (var da = 0; da < ta.length; da += Ba)
                                            if (ta[da] == Ea) {
                                                if (0 == da)
                                                    break;
                                                for (var Y = !1; (-1 == ta[da - Ba + 1] || ta[da - Ba + 1] == ta[da + 1] && (!W.isWithShipping || ta[da - Ba + 2] == ta[da + 2])) && 0 != da; )
                                                    Y = -1 != ta[da - Ba + 1],
                                                    da -= Ba;
                                                Y && (Ea = ta[da]);
                                                break
                                            }
                                    }
                                    if (ta = findOffer(q.offers, q.buyBoxSellerIdHistory, Ea, va, null, W, null))
                                        ta.item.type || (ta.item.type = []),
                                        ta.item.type[W.index] = W,
                                        ta && (ja[ta.offerId] = ta)
                                }
                            }
                            if (0 < ja.length) {
                                var ma = function() {
                                    for (var X in ca) {
                                        var sa = ca[X]
                                          , wa = q.sellerObjects[sa];
                                        if (wa && (sa = $("#" + sa + " a"),
                                        sa.text(wa.sellerName),
                                        null != wa.csv[0] && null != wa.csv[1] && 0 < sa.length))
                                            for (var xa = 0; xa < sa.length; xa++)
                                                0 < $(sa[xa]).siblings("span").length || $(sa[xa]).parent().append('<span>&emsp;<span style="color:#AA5D5D">' + la._440 + ":</span> " + getLast(wa.csv[0], CsvType.AMAZON) + '%&emsp;<span style="color:#AA5D5D">' + la._533 + ": </span>" + getLast(wa.csv[1], CsvType.AMAZON) + "</span>")
                                    }
                                };
                                Ca = Aa = "";
                                var ca = [];
                                "object" != typeof q.sellerObjects && (q.sellerObjects = {});
                                W = {};
                                for (var ha in ja) {
                                    W.$jscomp$loop$prop$offer$599$741 = ja[ha];
                                    "" != Aa && (Aa += "<hr>");
                                    W.$jscomp$loop$prop$offer$599$741.conditionComment || (W.$jscomp$loop$prop$offer$599$741.conditionComment = la._552);
                                    ta = "";
                                    for (var C in W.$jscomp$loop$prop$offer$599$741.item.type)
                                        va = W.$jscomp$loop$prop$offer$599$741.item.type[C],
                                        ta = "" == ta ? CsvType.getName(va.index) : ta + ("&emsp;" + CsvType.getName(va.index));
                                    !0 !== disableStockFeatures && !0 !== disableSoldNumbers && (W.$jscomp$loop$prop$offer$599$741.sold = getAggregatedDrop(W.$jscomp$loop$prop$offer$599$741.stockCSV, 0, 800),
                                    W.$jscomp$loop$prop$offer$599$741.sold30Day = getAggregatedDrop(W.$jscomp$loop$prop$offer$599$741.stockCSV, keepaTime.now() - 43200, 800));
                                    va = W.$jscomp$loop$prop$offer$599$741.isWarehouseDeal ? '<div style="max-width:500px;"><span><span style="color:#5983ff">' + la._553 + ":</span>&emsp;" + ConditionType.getName(W.$jscomp$loop$prop$offer$599$741.condition) + "</span></div>" : "";
                                    Ba = "https://www.amazon." + getTldByDomain(q.domainId) + "/gp/aag/details/?seller=" + W.$jscomp$loop$prop$offer$599$741.sellerId;
                                    7 != storage.domain && 0 != storage.accountType && (Ba = (iframe.isIframe ? rootURL : "") + "#!seller/" + q.domainId + "-" + W.$jscomp$loop$prop$offer$599$741.sellerId);
                                    Ba = W.$jscomp$loop$prop$offer$599$741.isWarehouseDeal ? "" : '<div style="max-width:500px;"><span><span style="color:#5983ff">' + la._554 + (':</span>&emsp;<span id="' + W.$jscomp$loop$prop$offer$599$741.sellerId + '"><a ' + (iframe.isIframe ? 'target="_blank"' : "") + ' href="' + Ba + '">' + W.$jscomp$loop$prop$offer$599$741.sellerId + "</a></span></span></div>");
                                    keepaApp && (Ba = W.$jscomp$loop$prop$offer$599$741.isWarehouseDeal ? "" : '<div style="max-width:500px;"><span><span style="color:#5983ff">' + la._554 + (':</span>&emsp;<span id="' + W.$jscomp$loop$prop$offer$599$741.sellerId + '"><a target="_blank">' + W.$jscomp$loop$prop$offer$599$741.sellerId + "</a></span></span></div>"));
                                    da = W.$jscomp$loop$prop$offer$599$741.isPrime ? '<span style="color:#2692c2;font-style: italic;">&ensp;Prime</span>' : "";
                                    Y = Money.format(W.$jscomp$loop$prop$offer$599$741.item.price, {
                                        sourceDomainId: q.domainId,
                                        targetDomainId: q.domainId
                                    }) + (0 < W.$jscomp$loop$prop$offer$599$741.item.shipping ? " + " + Money.format(W.$jscomp$loop$prop$offer$599$741.item.shipping, {
                                        sourceDomainId: q.domainId,
                                        targetDomainId: q.domainId
                                    }) : "");
                                    showReferencePrice(q.domainId) ? Y = Money.format(W.$jscomp$loop$prop$offer$599$741.item.price, {
                                        sourceDomainId: q.domainId
                                    }) + (0 < W.$jscomp$loop$prop$offer$599$741.item.shipping ? " + " + Money.format(W.$jscomp$loop$prop$offer$599$741.item.shipping, {
                                        sourceDomainId: q.domainId
                                    }) + " " + la._541 : "") + (' <span class="price__reference">(' + Y + ")</span>") : 0 < W.$jscomp$loop$prop$offer$599$741.item.shipping && (Y += " " + la._541);
                                    var U = ""
                                      , ia = "";
                                    !0 !== disableStockFeatures && (U = isStockMax(W.$jscomp$loop$prop$offer$599$741.item.stock, W.$jscomp$loop$prop$offer$599$741.stockLimit),
                                    U = '<div><div style="max-width:500px;"><span><span style="color:#5983ff">' + la._556 + ":</span>&emsp;" + (0 >= W.$jscomp$loop$prop$offer$599$741.item.stock ? "?" : (U ? ">" : "") + W.$jscomp$loop$prop$offer$599$741.item.stock + '&ensp;<span style="color:#8d8d8d">(' + (new Date(keepaTime.minutesToEpoch(Ea))).formatDate("M j Y, G:i") + ")</span>") + '</span></div><div style="margin: 10px 20px;" id="offerstockGraph' + W.$jscomp$loop$prop$offer$599$741.offerId + '"></div></div>',
                                    !0 !== disableSoldNumbers && (ia = '<div style="max-width:500px;"><span><span style="color:#5983ff">Sold in last 30 days (estimate from stock history):</span>&emsp;' + (0 >= W.$jscomp$loop$prop$offer$599$741.sold30Day ? "?" : W.$jscomp$loop$prop$offer$599$741.sold30Day) + '&ensp;<span style="color:#8d8d8d">(since offer was found: ' + (0 >= W.$jscomp$loop$prop$offer$599$741.sold ? "?" : W.$jscomp$loop$prop$offer$599$741.sold) + ")</span></span></div>"));
                                    Aa += '<div><div style="max-width:500px;"><span><span style="color:#5983ff">' + la._551 + ":</span>&emsp;" + (new Date(W.$jscomp$loop$prop$offer$599$741.item.time)).formatDate("M j Y, G:i") + '</span></div><div style="max-width:500px;"><span><span style="color:#5983ff">' + la._555 + ":</span>&emsp;" + ta + "</span></div>" + va + '<div class="flex"><div><div style="max-width:500px;"><span><span style="color:#5983ff">' + la._488 + ":</span>&emsp;" + Y + da + '</span></div><div style="margin: 10px 20px;" id="offerpriceGraph' + W.$jscomp$loop$prop$offer$599$741.offerId + '"></div></div>' + U + "</div>" + ia + Ba + '<div style="max-width:500px;"><span><span style="color:#5983ff">' + la._557 + ":</span>&emsp;" + W.$jscomp$loop$prop$offer$599$741.conditionComment + "</span></div></div>";
                                    W.$jscomp$loop$prop$offer$599$741.isWarehouseDeal || (ca.push(W.$jscomp$loop$prop$offer$599$741.sellerId),
                                    q.sellerObjects && q.sellerObjects[W.$jscomp$loop$prop$offer$599$741.sellerId] || (Ca = "" == Ca ? W.$jscomp$loop$prop$offer$599$741.sellerId : Ca + ("," + W.$jscomp$loop$prop$offer$599$741.sellerId)));
                                    W.$jscomp$loop$prop$offer$599$741.item.type = null;
                                    setTimeout(function(X) {
                                        return function() {
                                            var sa = function(wa) {
                                                var xa = $("<div/>", {
                                                    id: X.$jscomp$loop$prop$offer$599$741.offerId
                                                })
                                                  , Ia = $("<div/>", {
                                                    style: "visibility: hidden;"
                                                });
                                                Ia.append(xa);
                                                $("body").append(Ia);
                                                X.$jscomp$loop$prop$offer$599$741.updateCSV = q.csv[CsvType.EXTRA_INFO_UPDATES.index];
                                                X.$jscomp$loop$prop$offer$599$741.domainId = q.domainId;
                                                graph.insertOfferGraph(X.$jscomp$loop$prop$offer$599$741, X.$jscomp$loop$prop$offer$599$741.offerId, xa, wa);
                                                xa = xa.get(0);
                                                Ia.detach();
                                                $("#offer" + wa + "Graph" + X.$jscomp$loop$prop$offer$599$741.offerId).append(xa)
                                            };
                                            !0 !== disableStockFeatures && sa("stock");
                                            sa("price")
                                        }
                                    }(W), 0);
                                    W = {
                                        $jscomp$loop$prop$offer$599$741: W.$jscomp$loop$prop$offer$599$741
                                    }
                                }
                                showPopup(la._550, Aa, !0);
                                "" != Ca ? network.request({
                                    path: "pro/seller",
                                    domainId: q.domainId,
                                    asin: q.asin,
                                    seller: Ca,
                                    history: !0,
                                    version: 3
                                }).done(function(X) {
                                    X = X.merchants;
                                    for (var sa in X)
                                        q.sellerObjects[sa] = X[sa];
                                    ma()
                                }) : ma()
                            }
                        }
                    })
            }
            za[q.domainId + q.asin + q.graphIndex + q.isOnTrackingPage] = q;
            q.$container.data("domainId", q.domainId);
            q.$container.data("asin", q.asin);
            q.$container.data("index", q.graphIndex);
            u || (na(q),
            H(q, !0, !0));
            q.parentWidthCache = q.$container.parent().width()
        } catch (ja) {
            console.log(ja)
        }
    }
    function z(q) {
        return 0 != q.graphIndex ? !0 : 2 == q.csv[CsvType.SALES.index].length && -2 == q.csv[CsvType.SALES.index][1] ? !1 : 2 < q.csv[CsvType.SALES.index].length ? !0 : !("undefined" == typeof q.salesRankCategoryTrees || 0 === Object.keys(q.salesRankCategoryTrees).length && q.salesRankCategoryTrees.constructor === Object)
    }
    function F(q) {
        if (!q.isOnTrackingPage && !keepaApp && (0 == q.graphIndex && "1" == storage.showSalesRankGraph && z(q) || "1" == storage.moreData && (0 == q.graphIndex || 2 == q.graphIndex)))
            return "<tr><td><table></table></td></tr>";
        var L = '<tr style="border-top: 4px solid white;"><td class="legendIcon" style="vertical-align: initial;"><i style="font-size: 14px;" class="fa fa-calendar"></i></td><td class="legendLabel" style="vertical-align: top; line-height: 14px;"><table>'
          , A = ra(q, !1);
        if (0 < q.syncedGraphs.length)
            for (var O = 0; O < q.syncedGraphs.length; O++) {
                var P = q.syncedGraphs[O];
                P.graphIndex != q.graphIndex && (P = ra(P, !1),
                A = Math.max(A, P))
            }
        O = 0;
        P = Date.now();
        for (G in q.csv)
            if (7 != G) {
                var M = q.objectType.getObjectName(G);
                if ("undefined" != typeof M && !q.series[M].isDisabled && q.series[M].series.lines.show) {
                    var u = q.csv[G];
                    if (null != u) {
                        M = q.objectType[M].isWithShipping ? 3 : 2;
                        for (var v = u.length - 2; 0 < v; v -= M)
                            if ("" != u[v] && -1 != u[v]) {
                                O < u[v] && (O = Number(u[v]));
                                break
                            }
                    }
                }
            }
        0 == O && (O = -(P / precisionDevisor).toFixed(0));
        var G = Number(((P / 36E5).toFixed(0) - offsetHours - O / 60).toFixed(0));
        v = 2 > Math.abs(q.parameter.interval - A) ? " active" : "";
        var w = q.showOnlyTracked ? "" : "<td></td>";
        O = "<tr>" + w + '<td class="legendRange' + (24 == q.parameter.interval ? " active" : "") + '" range="24">' + la._136 + "</td></tr>";
        P = "<tr>" + w + '<td class="legendRange' + (168 == q.parameter.interval ? " active" : "") + '" range="168">' + la._137 + "</td></tr>";
        u = "<tr>" + w + '<td class="legendRange' + (744 == q.parameter.interval ? " active" : "") + '" range="744">' + la._139 + "</td></tr>";
        M = "<tr>" + w + '<td class="legendRange' + (2160 == q.parameter.interval ? " active" : "") + '" range="2160">' + la._140 + "</td></tr>";
        q = "<tr>" + w + '<td class="legendRange' + (8760 == q.parameter.interval ? " active" : "") + '" range="8760">' + la._141 + "</td></tr>";
        var B = Math.floor(A / 24);
        v = 0 == B ? "" : "<tr>" + w + '<td class="legendRange' + v + '" range="' + A + '">' + la._142 + " (" + B + " " + la._143 + ")</td></tr>";
        24 < A && 24 > G && (L += O);
        168 < A && 168 > G && (L += P);
        744 < A && 744 > G && (L += u);
        2160 < A && 2160 > G && (L += M);
        8760 < A && 8760 > G && (L += q);
        L = L + v + "</table></td></tr>";
        return keepaApp ? (replaceHtml("legendInterval", L),
        "") : L
    }
    function I(q) {
        var L = 1 == q.parameter.extreme ? '&nbsp;<i class="fa fa-toggle-off"></i>' : '&nbsp;<i class="fa fa-toggle-on"></i>'
          , A = q.internal.filteredExtremes ? '<tr border-top: 4px solid white; class="legendFilter" ><td class="legendIcon">' + g + '</td><td class="legendLabel">' + la._164 + " " + L + "</td></tr>" : "";
        L = (q.showOnlyTracked ? "" : '<tr style="line-height: 12px;"><td>&emsp;</td></tr>') + '<tr class="legendScale"><td class="legendIcon"><i style="font-size: 14px;" class="fa fa-search"></i></td><td class="legendLabel"><span><span ' + (q.showOnlyTracked ? 'title="' + la._144 + '"' : "") + ">" + (q.showOnlyTracked ? "" : la._144) + (1 == q.parameter.scale ? '&nbsp;<i class="fa fa-toggle-off"></i>' : '&nbsp;<i class="fa fa-toggle-on"></i>') + "</span>" + (q.showOnlyTracked && q.internal.filteredExtremes ? '&emsp;<span title="' + la._164 + '">' + g + "&ensp;" + L : "") + "</span></span></td></tr>" + (q.showOnlyTracked ? "" : A) + F(q);
        q.$container.find(".legend").find("table").append(L)
    }
    function E(q) {
        q.$container.find(".legendScale").on("click dblclick", function() {
            q.parameter.scale = 1 === q.parameter.scale ? 0 : 1;
            storage.graphScale = q.parameter.scale;
            settings.send();
            $(this).find(".legendLabel").html((q.showOnlyTracked ? "" : la._144) + (1 == q.parameter.scale ? '&nbsp;<i class="fa fa-toggle-off"></i>' : '&nbsp;<i class="fa fa-toggle-on"></i>'));
            $.each(q.plot.getYAxes(), function(A, O) {
                O.options.min = q.parameter.scale ? 0 : null
            });
            H(q, !0, !0);
            return !1
        });
        q.$container.find(".legendFilter").on("click dblclick", function() {
            q.parameter.extreme = 1 === q.parameter.extreme ? 0 : 1;
            storage.extremeFilter = q.parameter.extreme;
            settings.send();
            $(this).find(".legendLabel").html((q.showOnlyTracked ? "" : la._164) + " " + (1 == q.parameter.extreme ? '&nbsp;<i class="fa fa-toggle-off"></i>' : '&nbsp;<i class="fa fa-toggle-on"></i>'));
            ea(q);
            q.plot.setData(f(q));
            H(q, !0, !0);
            return !1
        });
        q.$container.find(".salesRankInverse").on("click dblclick", function(A, O) {
            A = q.parameter.salesRankInverse = 1 === q.parameter.salesRankInverse ? 0 : 1;
            storage.salesRankInverse = q.parameter.salesRankInverse;
            O = ["fa-sort-numeric-asc", "fa-sort-numeric-desc"];
            q.$container.find(".salesRankInverse > i").removeClass(O[1 == A ? 1 : 0]).addClass(O[1 == A ? 0 : 1]);
            settings.send();
            A = q.plot.getYAxes()[1].options;
            A.transform = 0 === q.parameter.salesRankInverse ? null : function(P) {
                return -P
            }
            ;
            A.inverseTransform = 0 === q.parameter.salesRankInverse ? null : function(P) {
                return -P
            }
            ;
            H(q, !0, !0);
            return !1
        });
        !0 === q.isOnTrackingPage && q.$container.find(".toggleSalesRankGraph").remove();
        var L = q.$container.find(".toggleSalesRankGraph");
        keepaApp && L.remove();
        L.on("click dblclick", function(A) {
            "1" === storage.showSalesRankGraph ? (storage.showSalesRankGraph = "0",
            settings.send(),
            hideSalesRankGraph(q.domainId, q.asin),
            L.css({
                color: "#666"
            })) : (storage.showSalesRankGraph = "1",
            settings.send(),
            showSalesRankGraph(q.p, q.domainId, q.syncedGraphs),
            L.css({
                color: "#8FBC8F"
            }));
            return !1
        });
        q.$container.find(".graphEbayNewLink").on("click dblclick", function(A, O) {
            window.open(getEbayRedirectByDomain(q.domainId, q.asin, !1, CsvType.EBAY_NEW_SHIPPING.index), "_blank").focus();
            return !1
        });
        q.$container.find(".graphEbayUsedLink").on("click dblclick", function(A, O) {
            window.open(getEbayRedirectByDomain(q.domainId, q.asin, !1, CsvType.EBAY_USED_SHIPPING.index), "_blank").focus();
            return !1
        });
        q.$container.find(".legendLabel").each(function() {
            if ("legendColorBox" == $(this).prev().attr("class")) {
                var A = function(O) {
                    return q.objectType.getObjectName(O.children(".legendLabel").data().type)
                };
                $(this).parent().on("click dblclick", function() {
                    var O = $(this)
                      , P = A($(this));
                    if (q.isHighlighted) {
                        for (var M in q.series) {
                            var u = q.series[M];
                            u.series.Yignore = !1;
                            u.series.color = u.series.colorBackup;
                            u.series.lines.lineWidth = u.series.lines.lineWidthBackup;
                            u.series.lines.fill && (u.series.lines.fillColor.colors = [],
                            u.series.lines.fillColor.colors[0] = u.series.lines.fillColorBackup[0],
                            u.series.lines.fillColor.colors[1] = u.series.lines.fillColorBackup[1])
                        }
                        q.isHighlighted = !1
                    }
                    M = q.series[P];
                    u = q.objectType[P];
                    u = comparePricesOverlayActive ? u.index : q.domainId;
                    if (graphIsRestricted(u, M.index)) {
                        O = '<i class="fa fa-line-chart"></i>&emsp;' + la._896;
                        P = [];
                        var v = [], G;
                        for (G in CsvType)
                            "object" === typeof CsvType[G] && ([CsvType.EBAY_NEW_SHIPPING.index, CsvType.EBAY_USED_SHIPPING.index].includes(CsvType[G].index) && !1 === globalEbayArray[u] || graphIsRestricted(u, CsvType[G].index) && (CsvType[G].isTopGraph ? P.push(CsvType[G].index) : v.push(CsvType[G].index)));
                        var w = "";
                        P = P.concat(v);
                        if (P.length) {
                            w = '<div class="block block--columns-250-2">';
                            P = $jscomp.makeIterator(P);
                            for (G = P.next(); !G.done; G = P.next())
                                if (G = G.value,
                                ![CsvType.EBAY_NEW_SHIPPING.index, CsvType.EBAY_USED_SHIPPING.index].includes(G) || [CsvType.EBAY_NEW_SHIPPING.index, CsvType.EBAY_USED_SHIPPING.index].includes(M.index))
                                    w += "<div>" + CsvType.getNameWithCircle(G) + "</div>";
                            w += "</div"
                        }
                        P = "";
                        [CsvType.EBAY_NEW_SHIPPING.index, CsvType.EBAY_USED_SHIPPING.index].includes(M.index) && (P = '<p class="mdc-typography--caption">\n\t\t\t\t\t\t' + la._893 + "\n\t\t\t\t\t</p>");
                        M = '<div class="popup--medium popup--medium-fixed">\n\t\t\t\t\t<p class="mdc-typography--body2">\n\t\t\t\t\t\t' + la._892 + "<br>&raquo; " + la._897 + "\n\t\t\t\t\t\t" + w + "\n\t\t\t\t\t</p>\n\t\t\t\t\t" + P + '\n\t\t\t\t\t<p class="mdc-typography--body2">\n\t\t\t\t\t\t<a class="mdc-button mdc-button--raised" href="https://keepa.com/#!settings/1" target="_blank"><i class="fa fa-shopping-bag" ></i>&ensp; ' + la._894 + '</a>\n\t\t\t\t\t</p>\n\t\t\t\t\t<p class="mdc-typography--body2">' + la._924 + "</p>\n\t\t\t\t</div>";
                        comparePricesOverlayActive ? showDialog(O, M, !0, 5) : showPopup(O, M, !0)
                    } else {
                        v = M.index;
                        u = !!M.series.lines.show;
                        G = !0;
                        2 < v && 99 > v && (J[v] = u ? 0 : 1,
                        "priceTypes" == q.type && (storage.showGraphs = JSON.stringify(J),
                        settings.send()));
                        M.series.lines.show = !u;
                        "undefined" != typeof q.series[desiredSeriesPrefix + P] && (q.series[desiredSeriesPrefix + P].series.dashes.show = !u);
                        P = M.series.yaxis;
                        for (w in q.series)
                            if (null != q.series[w]) {
                                var B = q.series[w].series;
                                if (!q.series[w].isDisabled && B.index != v && B.yaxis == P && B.lines.show) {
                                    G = !1;
                                    break
                                }
                            }
                        O = O.children(".legendColorBox").children().first().children().first();
                        u ? (O.css("borderColor", "#ccc"),
                        O.css("borderWidth", "1px")) : (O.css("borderColor", M.series.color),
                        O.css("borderWidth", "6px"));
                        q.plot.setData(f(q));
                        G && (M = q.plot.getYAxes()[P - 1],
                        M.options.min = q.parameter.scale ? 0 : null,
                        M.options.max = null);
                        H(q, !G, !0);
                        G && r(q)
                    }
                    return !1
                });
                $(this).parent().mouseenter(function() {
                    pa(q, A($(this)), !0)
                }).mouseleave(function() {
                    pa(q, A($(this)), !1)
                })
            }
        });
        K(q)
    }
    function K(q) {
        if (q.isOnTrackingPage || keepaApp || !(0 == q.graphIndex && "1" == storage.showSalesRankGraph && z(q) || "1" == storage.moreData && (0 == q.graphIndex || 2 == q.graphIndex)))
            (keepaApp ? $("#legendInterval .legendRange") : q.$container.find(".legendRange")).on("click", function() {
                var L = $(this)
                  , A = q.plot.getXAxes()[0].options
                  , O = Math.round(Number(L.attr("range")));
                L.parent().parent().find(".legendRange").removeClass("active");
                L.addClass("active");
                q.parameter.interval = O;
                for (L = 0; L < q.syncedGraphs.length; L++)
                    q.syncedGraphs[L].$container.find(".legendRange").removeClass("active"),
                    q.syncedGraphs[L].$container.find(".legendRange[range=" + O + "]").addClass("active"),
                    q.syncedGraphs[L].$container.find(".legendRange[range=" + O + "]").addClass("active"),
                    q.syncedGraphs[L].parameter.interval = O;
                L = q.internal.time;
                S(q, A.min, A.max, L - 36E5 * O, L);
                return !1
            }),
            q.showOnlyTracked || q.$container.find(".legendLabel td").first().text(la._135).css({
                "padding-right": "7px",
                width: "45px"
            })
    }
    function H(q, L, A) {
        var O = q.internal.time
          , P = ra(q, !1);
        O -= 36E5 * Math.min(P, q.parameter.interval);
        var M = q.plot.getXAxes()[0];
        P = M.options.min;
        M = M.options.max;
        n(q);
        var u = q.$container.find(".legend table").last().parent().parent();
        u.attr("id") != q.$container.attr("id") && replaceElement(u[0], "tr", F(q), "border-top: 4px solid white;");
        K(q);
        L ? S(q, P, M, A ? P : O, M) : (361E4 > Math.abs(O - M) && (O = M - 36E5 * ra(q, !0)),
        q.plot.getXAxes()[0].options.min = Math.round(A ? P : O),
        q.plot.getXAxes()[0].options.max = Math.round(M),
        q.plot.setupGrid(!0),
        q.plot.draw(),
        q.plot.clearSelection(),
        na(q))
    }
    function V(q, L, A, O) {
        var P = Number.MAX_VALUE
          , M = Number.MIN_VALUE
          , u = q.plot.getData();
        for (fa in u) {
            var v = u[fa];
            if (v.yaxis.n == L.n && (v.lines.show || v.dashes.show) && !v.Yignore)
                for (var G = !0, w = 0; w < v.data.length; w++) {
                    var B = v.data[w];
                    if (!(null == B || B[0] < A)) {
                        if (B[0] > O) {
                            if (G && 0 < w) {
                                var Q = v.data[w - 1];
                                null != Q && (Q[1] > M && (M = Number(Q[1])),
                                Q[1] < P && (P = Number(Q[1])))
                            }
                            break
                        }
                        G && (G = !1,
                        0 < w && (Q = v.data[w - 1],
                        null != Q && (Q[1] > M && (M = Number(Q[1])),
                        Q[1] < P && (P = Number(Q[1])))));
                        B[1] > M && (M = Number(B[1]));
                        B[1] < P && (P = Number(B[1]))
                    }
                }
        }
        A = L.datamin;
        O = L.datamax;
        u = L.options.min;
        var fa = L.options.max;
        v = L.min;
        G = L.max;
        L.datamin = P;
        L.options.min = 0 == L.options.min && q.parameter.scale ? 0 : null;
        L.min = null;
        L.datamax = M;
        L.options.max = null;
        L.max = null;
        if (2 == q.graphIndex || L.show || L.options.reserveSpace)
            q.plot.setRange(L),
            q.plot.setupTickGeneration(L),
            q.plot.setTicks(L),
            q.plot.snapRangeToTicks(L, L.ticks);
        q = L.min;
        w = L.max;
        L.datamin = A;
        L.options.min = u;
        L.min = v;
        L.datamax = O;
        L.options.max = fa;
        L.max = G;
        M == Number.MIN_VALUE && (M = w = 100);
        P == Number.MAX_VALUE && (P = q = 0);
        1E100 < Math.abs(w) && (M = w = 100);
        1E100 < Math.abs(q) && (P = q = 0);
        return {
            datamin: P,
            datamax: M,
            ymin: q,
            ymax: w
        }
    }
    function S(q, L, A, O, P) {
        var M = [];
        q.animationCount || (q.animationCount = 1);
        var u = []
          , v = [];
        if (0 < q.syncedGraphs.length)
            for (var G = 0; G < q.syncedGraphs.length; G++)
                M.push(q.syncedGraphs[G]);
        else
            M.push(q);
        var w = O - L
          , B = P - A;
        for (G = 0; G < M.length; G++) {
            var Q = M[G]
              , fa = Q.plot.getYAxes()
              , R = []
              , T = [];
            Q.plot.getXAxes()[0].options.min = Math.round(O);
            Q.plot.getXAxes()[0].options.max = Math.round(P);
            for (var oa = 0; oa < fa.length; oa++)
                if (fa[oa].show || 2 == Q.graphIndex && 3 == fa[oa].n)
                    R[oa] = V(Q, fa[oa], O, P),
                    T[oa] = {
                        datamin: fa[oa].datamin || R[oa].datamin,
                        datamax: fa[oa].datamax || R[oa].datamax,
                        ymin: fa[oa].options.min || fa[oa].min,
                        ymax: (fa[oa].options.max || fa[oa].max) + 1,
                        diffMin: R[oa].ymin - (fa[oa].min || 0) || 0,
                        diffMax: R[oa].ymax - (fa[oa].max || 0) || 0
                    };
            Q.plot.getXAxes()[0].options.min = Math.round(L);
            Q.plot.getXAxes()[0].options.max = Math.round(A);
            Q.plot.unhighlight();
            u[G] = R;
            v[G] = T
        }
        if (isMobile || 1 == q.animationCount)
            aa({
                pos: 1
            }, M, u, v, L, A, w, B),
            r(q);
        else {
            var Z = 0;
            q.$container.stop().animate({
                tabIndex: 0
            }, {
                duration: 300,
                easing: "easeInOutCubic",
                step: function(ja, W) {
                    aa(W, M, u, v, L, A, w, B);
                    0 == Z++ % 3 && r(q)
                },
                complete: function() {
                    r(q)
                }
            })
        }
        q.animationCount++
    }
    function aa(q, L, A, O, P, M, u, v) {
        try {
            for (var G = 0; G < L.length; G++) {
                var w = L[G];
                if ("undefined" != typeof w) {
                    var B = A[G]
                      , Q = O[G]
                      , fa = w.plot.getYAxes();
                    w.plot.getXAxes()[0].options.min = Math.round(P + u * q.pos);
                    w.plot.getXAxes()[0].options.max = Math.round(M + v * q.pos);
                    for (var R = 0; R < fa.length; R++)
                        if ((fa[R].show || 2 == w.graphIndex && 3 == fa[R].n) && B[R] && "undefined" != typeof B[R] && (B[R].ymin != Number.MIN_VALUE && (fa[R].options.min = Math.round(Q[R].ymin + Q[R].diffMin * q.pos)),
                        B[R].ymax != Number.MAX_VALUE && (fa[R].options.max = Math.round(Q[R].ymax + Q[R].diffMax * q.pos)),
                        1 == w.graphIndex && 6 == fa[R].n)) {
                            var T = .1;
                            .4 > B[R].datamax - B[R].datamin && (T = .2);
                            fa[R].options.max = B[R].datamax + T;
                            fa[R].options.min = B[R].datamin - T;
                            w.parameter.scale ? (fa[R].options.max = 5.1,
                            fa[R].options.min = .9) : (5.01 < fa[R].options.max && (fa[R].options.max = 5.01),
                            0 < fa[R].options.min && 1 > fa[R].options.min ? fa[R].options.min = .8 : 5 == fa[R].options.min && (fa[R].options.min = 4.6))
                        }
                    w.plot.setupGrid(!0);
                    w.plot.unhighlight();
                    w.plot.draw();
                    w.plot.clearSelection();
                    na(w)
                }
            }
        } catch (oa) {
            console.log(oa)
        }
    }
    function ea(q) {
        var L = 0 == q.graphIndex
          , A = 1 == q.graphIndex;
        var O = 5 == q.domainId ? 100 : 1;
        var P = 99E5 * O, M = 2E4 * O, u;
        for (u in q.csv) {
            O = !1;
            var v = 0
              , G = q.csvType || u
              , w = q.objectType.getObject(u);
            if (3 > u.length && null == w)
                console.error("unknown type: " + G, u);
            else {
                var B = q.csv[u]
                  , Q = 3 > u.length ? w.isWithShipping : !1
                  , fa = "locales" == q.type
                  , R = "merchant" == q.type;
                fa && (Q = CsvType.getObject(G).isWithShipping);
                var T = Q ? 3 : 2
                  , oa = Q ? 2 : 1;
                fa = fa || 3 > u.length ? q.objectType.getObjectName(u) : u;
                if (q.series[fa]) {
                    var Z = q.series[fa].series.yaxis;
                    var ja = 2 == Z || 3 == Z || 6 == Z ? !0 : 1 == q.parameter.extreme;
                    var W = q.series[fa].series.isCurrency ? q.domainId : 5;
                    "RATING" != fa || R || (W = 100);
                    R = !1;
                    if (q.series[fa].isDisabled || null == B || 2 == B.length && 0 > B[1] && -2 !== B[1])
                        q.series[fa].isDisabled = !0;
                    else {
                        if (3 > u.length && (L || A)) {
                            if (w.isTopGraph && A)
                                continue;
                            if (!w.isTopGraph && !A)
                                continue
                        }
                        var Aa = 3 > u.length ? getWeightedMean(q.csv[u], keepaTime.now(), 1E3, w) : 0;
                        w = B[B.length - T] - B[0];
                        if (4 < B.length && 168 < w) {
                            if (0 === Aa && !Q) {
                                for (; v < B.length - 3; v += 2)
                                    0 < B[v + 1] ? Aa += B[v + 1] * (B[v + 2] - B[v]) : w -= B[v + 2] - B[v];
                                Aa = Math.round(Aa / w)
                            }
                        } else
                            3 > u.length && (ja = !0);
                        if ("" != B[0])
                            if (B.length == T && 0 > B[1] && -2 !== B[1])
                                q.series[fa].isDisabled = !R;
                            else {
                                w = [];
                                for (v = 0; v < B.length; v += T) {
                                    w.push(B[v]);
                                    var Ca = B[v + 1];
                                    b: {
                                        var Ba = Z;
                                        var ta = !1;
                                        2 < G.length && (ta = Ca > P);
                                        if (!ta) {
                                            if (0 > Ca || 0 == Aa || q.objectType.SALES && G == q.objectType.SALES.index) {
                                                Ba = !1;
                                                break b
                                            }
                                            ta = Ca > M && Ca > 5 * Aa || Ca < 0 * Aa
                                        }
                                        ta && (O = !0,
                                        2 != Ba && 3 != Ba && 6 != Ba && 5 != Ba && 4 != Ba && (q.internal.filteredExtremes = !0));
                                        Ba = ja ? !1 : ta
                                    }
                                    Ba ? w.push(-1) : w.push(Ca);
                                    Q && w.push(B[v + 2])
                                }
                                q.data[u] = [];
                                for (v = 0; v < w.length; v += T)
                                    G = [],
                                    0 > w[v + 1] && -2 !== w[v + 1] && 0 == q.data[u].length || (G[0] = (w[v] + keepaTime.timeShiftOffset) * keepaTime.precisionDevisor + offset,
                                    B = w[v + 1],
                                    Q && (ja = w[v + 2],
                                    B += 0 > ja ? 0 : ja),
                                    G[1] = Money.raw(B, {
                                        sourceDomainId: W,
                                        targetDomainId: W
                                    }),
                                    0 > w[v + 1] && -2 !== w[v + 1] ? 0 != v && -1 != w[v - oa] && (B = w[v - oa],
                                    Q && (ja = w[v - 1],
                                    B += 0 > ja ? 0 : ja),
                                    G[1] = Money.raw(B, {
                                        sourceDomainId: W,
                                        targetDomainId: W
                                    }),
                                    G[0] != q.data[u][q.data[u].length - 1][0] && q.data[u].push(G),
                                    null != q.data[u][q.data[u].length - 1] && q.data[u].push(null)) : (R = !0,
                                    q.data[u].push(G)));
                                "" == q.data[u] || 1 == q.data[u].length && null == q.data[u][0][1] ? q.data[u] = null : (v -= T,
                                T = [],
                                T[0] = q.internal.time,
                                0 > w[v + 1] ? null != q.data[u][q.data[u].length - 1] && q.data[u].push(null) : (oa = w[v + 1],
                                Q && (v = w[v + 2],
                                oa += 0 > v ? 0 : v),
                                T[1] = Money.raw(oa, {
                                    sourceDomainId: W,
                                    targetDomainId: W
                                }),
                                q.data[u].push(T),
                                R = !0));
                                O || (q.series[fa].isDisabled = !R)
                            }
                    }
                }
            }
        }
    }
    function ra(q, L) {
        var A = 9999999999999
          , O = Date.now();
        for (w in q.csv)
            if (7 != w) {
                var P = q.objectType.getObjectName(w);
                if ("undefined" != typeof P && (L || !q.series[P].isDisabled && q.series[P].series.lines.show)) {
                    var M = q.csv[w];
                    if (null != M) {
                        P = q.objectType[P].isWithShipping ? 3 : 2;
                        for (var u = 0, v = M.length; u < v; u += P)
                            if ("" != M[u] && -1 != M[u + 1]) {
                                A > M[u] && (A = Number(M[u]));
                                break
                            }
                    }
                }
            }
        if (9999999999999 == A) {
            for (var G in q.csv)
                if (7 != G && (M = q.objectType.getObjectName(G),
                "undefined" != typeof M && (L || !q.series[M].isDisabled && q.series[M].series.lines.show))) {
                    var w = q.csv[G];
                    if (null != w)
                        for (M = q.objectType[M].isWithShipping ? 3 : 2,
                        P = 0,
                        u = w.length; P < u; P += M)
                            if ("" != w[P] && -1 != w[P + 1]) {
                                A > w[P] && (A = Number(w[P]));
                                break
                            }
                }
            9999999999999 == A && (A = (O / precisionDevisor).toFixed(0) - offsetVar)
        }
        L = (O / precisionDevisor).toFixed(0) - offsetVar - A;
        L = Number((L / 60).toFixed(0));
        1 > q.parameter.interval && (q.parameter.interval = L);
        return L + keepaTime.timeShiftOffset / 60
    }
    function pa(q, L, A) {
        var O = q.series[L];
        if (O) {
            if (O.series.lines.show) {
                for (var P in q.series) {
                    var M = q.series[P];
                    M.series.lines.lineWidthBackup || (M.series.lines.lineWidthBackup = M.series.lines.lineWidth,
                    M.series.points.lineWidthBackup = M.series.points.lineWidth,
                    M.series.lines.fill && (M.series.lines.fillColorBackup = [],
                    M.series.lines.fillColorBackup[0] = M.series.lines.fillColor.colors[0],
                    M.series.lines.fillColorBackup[1] = M.series.lines.fillColor.colors[1]),
                    M.series.colorBackup = M.series.color);
                    var u = M.series.yaxis - 1;
                    O.index != M.index ? (O.series.yaxis == M.series.yaxis && (M.series.Yignore = A),
                    2 == q.graphIndex && (q.axes.y[u].show = !A),
                    M.series.color = A ? $.color.parse(M.series.color).add("a", -.7).toString() : M.series.colorBackup,
                    M.series.lines.fill && (M.series.lines.fillColor.colors[0] = A ? $.color.parse(M.series.lines.fillColorBackup[0]).add("a", -.7).toString() : M.series.lines.fillColorBackup[0])) : (M.series.Yignore = !1,
                    2 == q.graphIndex && (q.axes.y[u].show = A));
                    2 != q.graphIndex || A || (q.axes.y[u].show = q.axes.y[u].defaultShow)
                }
                if ("priceTypes" == q.type && 2 != q.graphIndex)
                    if (P = q.$container.find(".typeStats"),
                    A) {
                        M = 650 > q.plot.width();
                        var v = function(oa) {
                            return CsvType.format(L, oa, q.domainId)
                        }
                          , G = q.stats[O.index];
                        u = v(G.highest.val);
                        var w = M || "-" == u ? "" : ' <span style="color: #b0b0b0">(' + prettyDate(keepaTime.now() - G.highest.date) + ")</span>"
                          , B = v(G.lowest.val)
                          , Q = M || "-" == B ? "" : ' <span style="color: #b0b0b0">(' + prettyDate(keepaTime.now() - G.lowest.date) + ")</span>"
                          , fa = '<span style="color: #000;">' + v(G.avg.val) + "</span>"
                          , R = '<span style="color: #000;">' + v(G.avg180.val) + "</span>";
                        v = '<span style="color: #000;">' + v(G.current.val) + "</span>";
                        0 == P.length && q.$container.append('<div class="typeStats"></div>');
                        P = q.$container.find(".typeStats");
                        P.css("right", q.plot.getPlotOffset().right + "px");
                        P.html("<span>" + CsvType.getNameWithCircle(O.index) + '</span><span style="color: rgb(60, 179, 113);">' + la._383 + " " + B + Q + "</span><span>" + la._344 + " " + v + '</span><span style="color: tomato">' + la._384 + " " + u + ' <span style="color: #b0b0b0">' + w + "</span></span>" + (M ? "" : "<span>" + la._385 + " 90 " + la._143 + " " + fa + "&ensp;180 " + la._143 + " " + R + "</span>"));
                        P.show()
                    } else
                        P.hide();
                O.series.lines.lineWidth = A ? 2 * O.series.lines.lineWidth : O.series.lines.lineWidthBackup;
                O.series.points.lineWidth = A ? 2 * (O.series.points.lineWidth || O.series.lines.lineWidth) : O.series.points.lineWidthBackup;
                O.series.lines.fill && (O.series.lines.fillColor.colors[0] = A ? $.color.parse(O.series.lines.fillColorBackup[0]).add("a", .2).toString() : O.series.lines.fillColorBackup[0],
                O.series.lines.fillColor.colors[1] = A ? $.color.parse(O.series.lines.fillColorBackup[1]).add("rgb", -18).toString() : O.series.lines.fillColorBackup[1]);
                q.isHighlighted = A;
                q.plot.setData(f(q));
                !A && q.grid.backUpMarkings && (q.grid.markings = q.grid.backUpMarkings,
                delete q.grid.backUpMarkings,
                q.plot.getOptions().grid.markings = q.grid.markings,
                q.plot.setupGrid(!0));
                if (O.index == CsvType.BUY_BOX_SHIPPING.index && A) {
                    q.grid.backUpMarkings = q.grid.markings;
                    q.grid.markings = a();
                    P = keepaTime.epochToMinutes(q.plot.getAxes().xaxis.min) - keepaTime.timeShiftOffset;
                    M = -1;
                    for (u = 0; u < q.csv[O.series.index].length; u += 3)
                        if (w = q.csv[O.series.index][u],
                        w >= P) {
                            M = w;
                            break
                        }
                    for (u = 0; u < q.bbHistory.length; u += 2)
                        if (w = Number(q.bbHistory[u]),
                        B = u + 2 < q.bbHistory.length ? q.bbHistory[u + 2] : keepaTime.now(),
                        !(B < P || (w < M && (w = P),
                        G = q.bbHistory[u + 1].sellerId,
                        4 > G.length))) {
                            Q = "#ffc86e";
                            if (!isSellerIdAmazon(G, q.domainId) && (Q = CsvType.NEW.color,
                            null != q.offers)) {
                                R = [];
                                fa = null;
                                var T = $jscomp.makeIterator(q.offers);
                                for (v = T.next(); !v.done; v = T.next())
                                    v = v.value,
                                    v.sellerId === G && R.push(v);
                                1 <= R.length && (fa = R[0]);
                                if (1 < R.length)
                                    for (G = getValueAtTime(q.csv[CsvType.BUY_BOX_SHIPPING.index], w, CsvType.BUY_BOX_SHIPPING),
                                    R = $jscomp.makeIterator(R),
                                    v = R.next(); !v.done; v = R.next())
                                        v = v.value,
                                        getValueAtTime(v.offerCSV, w, CsvType.BUY_BOX_SHIPPING) == G && (fa = v);
                                null != fa && (Q = fa.isFBA ? "#ff5722" : CsvType.NEW_FBM_SHIPPING.color)
                            }
                            w += keepaTime.timeShiftOffset;
                            q.grid.markings.push({
                                color: Q,
                                lineWidth: 2,
                                text: "",
                                isBuyBoxMarker: !0,
                                xaxis: {
                                    from: keepaTime.minutesToEpoch(w),
                                    to: keepaTime.minutesToEpoch(w >= changeV5 ? B + keepaTime.timeShiftOffset : w)
                                }
                            })
                        }
                    q.plot.getOptions().grid.markings = q.grid.markings;
                    q.plot.setupGrid(!0)
                }
                H(q, !0, !0)
            }
            O.tip || (O.tip = q.$container.parent().find(".legendTip"));
            A && O.series.labelDesc ? (O.tip.html('<div style="color: ' + O.series.color + '; font-weight: bold">' + O.series.label + "</div>" + O.series.labelDesc),
            O.tip.css("border-top-color", O.series.color),
            O.tip.show()) : O.tip.hide()
        }
    }
    function ua(q) {
        for (var L = [], A = 0; A < CsvType.length; A++)
            L[A] = !1;
        if ("object" == typeof q.parameter.tracking) {
            A = q.parameter.tracking;
            q.grid.markings.push({
                color: "#000",
                lineWidth: 1,
                text: 0 === q.graphIndex ? '<img src="' + flags[A.mainDomainId] + '"> ' + la._197 : "",
                xaxis: {
                    from: keepaTime.minutesToEpoch(A.createDate + keepaTime.timeShiftOffset),
                    to: keepaTime.minutesToEpoch(A.createDate + keepaTime.timeShiftOffset)
                }
            });
            if (null != A.notificationCSV)
                for (var O = 0; O < A.notificationCSV.length; O += 5)
                    try {
                        var P = A.notificationCSV[O + 4]
                          , M = q.series[q.objectType.getObjectName(A.notificationCSV[O + 1])]
                          , u = M.series.color;
                        if (0 === q.graphIndex) {
                            if (3 === M.series.yaxis || 6 === M.series.yaxis)
                                continue
                        } else if (1 === q.graphIndex && 3 > M.series.yaxis)
                            continue;
                        var v = q.objectType.getObject(A.notificationCSV[O + 1]);
                        q.grid.markings.push({
                            color: u,
                            text: la._868 + ':&ensp;<img src="' + flags[A.notificationCSV[O]] + '"> ' + q.objectType.getName(A.notificationCSV[O + 1]) + " - " + NotificationCause.getName(A.notificationCSV[O + 3], v.currency),
                            lineWidth: 1,
                            xaxis: {
                                from: keepaTime.minutesToEpoch(P) + 6E4 * keepaTime.timeShiftOffset,
                                to: keepaTime.minutesToEpoch(P) + 6E4 * keepaTime.timeShiftOffset
                            }
                        })
                    } catch (fa) {
                        console.error(fa)
                    }
            if (null != A.thresholdValues)
                for (P = b(),
                M = 0; M < A.thresholdValues.length; M++)
                    try {
                        var G = A.thresholdValues[M];
                        if (G.domain == q.domainId && G.csvType != CsvType.EBAY_NEW_SHIPPING.index && G.csvType != CsvType.EBAY_USED_SHIPPING.index) {
                            var w = q.objectType.getObjectName(G.csvType)
                              , B = q.series[w];
                            if (0 === q.graphIndex) {
                                if (3 === B.series.yaxis || 6 === B.series.yaxis)
                                    continue
                            } else if (1 === q.graphIndex && 3 > B.series.yaxis)
                                continue;
                            L[G.csvType] = !0;
                            w = desiredSeriesPrefix + w;
                            var Q = P[w];
                            if (!B.isDisabled) {
                                if (B.series.isCurrency) {
                                    if (G.domain != A.mainDomainId && null != G.thresholdValueCSV)
                                        for (u = 0; u < G.thresholdValueCSV.length; u += 2)
                                            G.thresholdValueCSV[u + 1] = Money.raw(G.thresholdValueCSV[u + 1], {
                                                sourceDomainId: A.mainDomainId,
                                                targetDomainId: G.domain,
                                                keepUnit: !0
                                            })
                                } else if (G.csvType == CsvType.RATING.index && null != G.thresholdValueCSV)
                                    for (u = 0; u < G.thresholdValueCSV.length; u += 2)
                                        fakeDomain = 100,
                                        G.thresholdValueCSV[u + 1] = Money.raw(G.thresholdValueCSV[u + 1], {
                                            sourceDomainId: fakeDomain,
                                            targetDomainId: fakeDomain
                                        });
                                q.csv[w] = G.thresholdValueCSV;
                                Q.series.dashes.show = B.series.lines.show;
                                q.series[w] = Q
                            }
                        }
                    } catch (fa) {
                        console.error(fa)
                    }
            if (q.showOnlyTracked)
                for (G = [],
                w = "undefined" !== typeof storage.manageGridDefaultGraphMode ? JSON.parse(storage.manageGridDefaultGraphMode) : {},
                1 === w.mode && (G = w.types,
                G = G.map(function(fa) {
                    return Number(fa)
                })),
                w = 0; w < CsvType.length; w++)
                    w != CsvType.LIGHTNING_DEAL.index && (B = q.objectType.getObjectName(w),
                    L[w] || -1 !== G.indexOf(w) && !graphIsRestricted(q.domainId, w) ? q.series[B].series.lines.show = !0 : q.series[B].isDisabled = !0)
        }
    }
    function na(q) {
        if ("object" == typeof q.parameter.tracking && "undefined" == typeof isSnapshotPage) {
            var L = q.parameter.tracking
              , A = q.plot.pointOffset({
                x: keepaTime.minutesToEpoch(L.createDate + keepaTime.timeShiftOffset)
            })
              , O = q.$container.find("#trackingStartedLabel");
            0 == O.length && (L = L.mainDomainId == q.domainId ? "" : ' (<a class="gcblink noDecoration" href="#!product/' + L.mainDomainId + "-" + L.asin + '">.' + getTldByDomain(L.mainDomainId) + "</a>)",
            q.$container.append("<div id='trackingStartedLabel' style='font-size:11px;display:none;position:absolute;left:" + (A.left + 3) + "px;top:-13px;color:#666;white-space:nowrap'>" + la._197 + L + "</div>"));
            O = q.$container.find("#trackingStartedLabel");
            0 < A.left && A.left < q.plot.width() * (1 == storage.language ? .98 : .95) ? (O.css("left", A.left + 3),
            O.show()) : O.hide()
        }
    }
    function qa(q) {
        if (!q.preProcessedCSV) {
            q.preProcessedCSV = !0;
            q.bbHistory = getMergedBB(q.buyBoxSellerIdHistory, q.csv[CsvType.BUY_BOX_SHIPPING.index], q.csv[CsvType.COUNT_NEW.index], !0);
            var L = q.csv[CsvType.EXTRA_INFO_UPDATES.index]
              , A = "locales" == q.type
              , O = "merchant" == q.type;
            if (null != q.salesRanks && null != q.salesRankCategoryTrees && ("undefined" != typeof storage.showGraphs && "1" == storage.showGraphs[7] || "1" == storage.showSalesRankGraph)) {
                var P = getCategorySalesRanks(q.salesRankCategoryTrees, q.salesRankCategories, q.salesRanks);
                setTimeout(function() {
                    for (var Aa = "", Ca = q.stats[3].avgDrops && 0 < q.stats[3].avgDrops ? '<span style="color: darkcyan; cursor: help;font-size:11px" title="Average number of times a relevant sales rank drop (e.g. from #1000 to # 500) occurred per month based on the last 90 days. \nA sales rank drop usually indicates sales, though each drop may correspond to any number of units sold. \nIf the rank is very good (e.g. #5) the product must be bought consistently just to keep its rank, so the absence of any drop does not indicate that the product does not sell.\nIf the drop number is interpreted as a sales indicator one should consider that the real sales volume is likely higher (not lower)."><i class="fa fa-arrow-right fa-rotate-45"></i> ' + q.stats[3].avgDrops + " drops / month</span>" : "", Ba = '<table id="salesRankDetails" style="font-size: 12px;margin-left:30px;color:#7d7d7d;margin-top: 8px;position:relative;max-width: 800px;">\n\t\t\t\t\t\t\t<tr><td colspan="5"><i class="fa fa-circle" style="font-size: 7px;transform: translateY(-1px);color:#8FBC8F"></i>  Sales Rank' + (q.isParentSalesRank ? '<span style="margin-left: 10px">(likely shared between all variations)</span>' : "") + "</td></tr>", ta = 0, Ea = 0, va = 0, da = function(ia) {
                        return -1 == ia ? "-" : NumberUtil.format(ia)
                    }, Y = !1, ma = !1, ca = $jscomp.makeIterator(P), ha = ca.next(); !ha.done; ha = ca.next())
                        ha = ha.value,
                        0 < ha.avg90 && (Y = !0),
                        0 < ha.avg365 && (ma = !0);
                    ca = $jscomp.makeIterator(P);
                    for (ha = ca.next(); !ha.done; ha = ca.next())
                        if (ha = ha.value,
                        -1 != ha && (-1 != ha.avg365 || -1 != ha.rank)) {
                            0 == ta && (ta = 10 + 9 * (ha.rank + "").length);
                            0 == Ea && (Ea = 10 + 9 * (ha.avg90 + "").length);
                            0 == va && (va = 10 + 9 * (ha.avg365 + "").length);
                            var C = 100 < ha.topPct ? "-" : ha.topPct;
                            C = 'Top <span style="width: 30px; display: inline-block; text-align: right;">' + (0 == C ? " - " : C) + "%</span>";
                            100 < ha.topPct && (C = "");
                            C = ' <td style="width: 65px; display: inline-block;cursor: help;color:#40bdb2" title="Products in Category: ' + NumberUtil.format(ha.cr.productCount) + '">' + C + "</td>";
                            var U = ' <td style="color:#333;cursor: help;" title="' + (ha.cr.contextFreeName == ha.tree ? "" : ha.tree) + '">' + ha.cr.contextFreeName + '<span style="margin-left: 7px;color:grey">' + (ha.cr.catId == q.salesRankReference ? Ca : '<span style="cursor: help;" title=\'subcategory level (number of ancestors in the category tree)\'><i class="fa fa-sitemap" aria-hidden="true"></i> ' + ha.sublevel + "</span>") + "</span></td>";
                            Aa += '<tr>\n\t\t\t\t\t\t\t\t\t<td style="padding-right: 20px;color:' + CsvType.SALES.color + ";width: " + ta + 'px;">#<span style="display: inline-block; width: ' + (ta - 10) + 'px;text-align: right;">' + da(ha.rank) + "</span></td>\n\t\t\t\t\t\t\t\t\t" + (Y ? '<td style="padding-right: 5px;color:' + CsvType.SALES.color + ";width: " + Ea + 'px;">#<span style="display: inline-block;width: ' + (Ea - 10) + 'px;text-align: right;">' + da(ha.avg90) + "</span></td>" : "") + "\n\t\t\t\t\t\t\t\t\t" + (ma ? '<td style="padding-right: 5px;color:' + CsvType.SALES.color + ";width: " + va + 'px;">#<span style="display: inline-block;width: ' + (va - 10) + 'px;text-align: right;">' + da(ha.avg365) + "</span></td>" : "") + "\n\t\t\t\t\t\t\t\t</td>" + C + U + "</tr>"
                        }
                    Ca = '<tr><td style="padding-right: 20px;width: ' + ta + 'px;">current</td>\n\t\t\t\t\t\t\t\t\t' + (Y ? '<td style="cursor:help;padding-right: 20px;width: ' + Ea + 'px;" title="average sales rank in the last 90 days">90d</td>' : "") + "\n\t\t\t\t\t\t\t\t\t" + (ma ? '<td style="cursor:help;padding-right: 20px;width: ' + va + 'px;" title="average sales rank in the last 365 days">365d</td>' : "") + "\n\t\t\t\t\t\t\t\t\t</tr>";
                    0 < Aa.length && ($("#subGraphHover").before(Ba + Ca + Aa + "</div>"),
                    addon())
                }, 0)
            }
            if ("undefined" == typeof isSnapshotPage && null != q.csv[CsvType.BUY_BOX_SHIPPING.index] && null != q.buyBoxSellerIdHistory) {
                for (var M = q.csv[CsvType.BUY_BOX_SHIPPING.index], u = q.buyBoxSellerIdHistory, v = [], G = 0, w = 0, B = 0, Q = -1, fa = -1; G < M.length || w < u.length; ) {
                    if (w >= u.length) {
                        for (; G < M.length; G += 3)
                            v.push(M[G]),
                            v.push(M[G + 1]),
                            v.push(M[G + 2]);
                        break
                    }
                    if (G >= M.length) {
                        for (; w < u.length; w += 2)
                            v.push(Number(u[w])),
                            v.push(Q),
                            v.push(fa);
                        break
                    }
                    B = M[G];
                    var R = Number(u[w]);
                    B == R ? (Q = M[G + 1],
                    fa = M[G + 2],
                    G += 3,
                    w += 2) : B > R ? (B = R,
                    w += 2) : (Q = M[G + 1],
                    fa = M[G + 2],
                    G += 3);
                    v.push(B);
                    v.push(Q);
                    v.push(fa)
                }
                q.csv[CsvType.BUY_BOX_SHIPPING.index] = v
            }
            if (null != L || A || O)
                for (var T in q.csv)
                    if (null != q.csv[T] && (!A || q.csvType != CsvType.RATING.index && q.csvType != CsvType.COUNT_REVIEWS.index) && (A || O || T != CsvType.RATING.index && T != CsvType.COUNT_REVIEWS.index) && (Q = 0,
                    u = A ? q.csvType : T,
                    v = CsvType.getObject(u),
                    w = (G = 3 > T.length ? v.isWithShipping : !1) ? 3 : 2,
                    A && (L = q.updateCSV[T]),
                    M = A || 3 > T.length ? q.objectType.getObjectName(T) : T,
                    q.series[M] && v.isOfferData)) {
                        fa = q.csv[T];
                        M = [];
                        B = 0;
                        if (-2 !== fa[1])
                            for (Q = 0; Q < L.length; Q += 2) {
                                for (var oa = L[Q], Z = fa[B]; Z < oa; )
                                    B += w,
                                    Z = fa[B];
                                if (!(oa < Z && 0 == B)) {
                                    if (!A && !O)
                                        if (u == CsvType.BUY_BOX_SHIPPING.index) {
                                            if (0 == Math.max(getValueAtTime(q.csv[CsvType.COUNT_NEW.index], oa, CsvType.COUNT_NEW), 0) + Math.max(getValueAtTime(q.csv[CsvType.COUNT_USED.index], oa, CsvType.COUNT_USED), 0) + Math.max(getValueAtTime(q.csv[CsvType.COUNT_COLLECTIBLE.index], oa, CsvType.COUNT_COLLECTIBLE), 0) + Math.max(getValueAtTime(q.csv[CsvType.COUNT_REFURBISHED.index], oa, CsvType.COUNT_REFURBISHED), 0) || -2 === fa[B + 1]) {
                                                oa == Z && (B += w);
                                                continue
                                            }
                                        } else if (T == CsvType.NEW_FBA.index || T == CsvType.NEW_FBM_SHIPPING.index) {
                                            if (0 == Math.max(getValueAtTime(q.csv[CsvType.COUNT_NEW.index], oa, CsvType.COUNT_NEW), 0)) {
                                                oa == Z && (B += w);
                                                continue
                                            }
                                        } else if (T == CsvType.REFURBISHED_SHIPPING.index) {
                                            if (0 == Math.max(getValueAtTime(q.csv[CsvType.COUNT_REFURBISHED.index], oa, CsvType.COUNT_REFURBISHED), 0)) {
                                                oa == Z && (B += w);
                                                continue
                                            }
                                        } else {
                                            if ((T == CsvType.USED_ACCEPTABLE_SHIPPING.index || T == CsvType.USED_GOOD_SHIPPING.index || T == CsvType.USED_NEW_SHIPPING.index || T == CsvType.USED_VERY_GOOD_SHIPPING.index || T == CsvType.COLLECTIBLE_ACCEPTABLE_SHIPPING.index || T == CsvType.COLLECTIBLE_GOOD_SHIPPING.index || T == CsvType.COLLECTIBLE_NEW_SHIPPING.index || T == CsvType.COLLECTIBLE_VERY_GOOD_SHIPPING.index) && 0 == Math.max(getValueAtTime(q.csv[T], oa, v), 0)) {
                                                oa == Z && (B += w);
                                                continue
                                            }
                                        }
                                    else if (A && -2 === fa[B + 1]) {
                                        oa == Z && (B += w);
                                        continue
                                    }
                                    R = M[M.length - 2];
                                    var ja = M[M.length - 1];
                                    if (oa >= Z) {
                                        oa = Math.max(fa[B + 1], -1);
                                        if (G) {
                                            var W = Math.max(fa[B + 2], -1);
                                            oa == R && ja == W || M.push(Z, oa, W, Z, -1, -1)
                                        } else
                                            oa != R && M.push(Z, oa, Z, -1);
                                        B += w
                                    } else
                                        G ? (Z = Math.max(fa[B - 2], -1),
                                        W = Math.max(fa[B - 1], -1),
                                        Z == R && ja == W || M.push(oa, Z, W, oa, -1, -1)) : (ja = Math.max(fa[B - 1], -1),
                                        ja != R && M.push(oa, ja, oa, -1))
                                }
                            }
                        if (0 === M.length && -2 === fa[1])
                            for (v = $jscomp.makeIterator(fa),
                            G = v.next(); !G.done; G = v.next())
                                M.push(G.value);
                        if (u == CsvType.BUY_BOX_SHIPPING.index) {
                            u = q.csv[T];
                            q.csv[T] = [];
                            for (v = 0; v < M.length; v += 3)
                                if (G = M[v],
                                G <= changeV5)
                                    q.csv[T].push(G),
                                    q.csv[T].push(M[v + 1]),
                                    q.csv[T].push(M[v + 2]);
                                else
                                    break;
                            M = !1;
                            for (v = 0; v < u.length; v += 3)
                                G = u[v],
                                G >= changeV5 && (q.csv[T].push(G),
                                q.csv[T].push(u[v + 1]),
                                q.csv[T].push(u[v + 2]),
                                M = !0);
                            M || (q.csv[T].push(changeV5),
                            q.csv[T].push(u[u.length - 2]),
                            q.csv[T].push(u[u.length - 1]))
                        } else if (u == CsvType.WAREHOUSE.index) {
                            u = q.csv[T];
                            q.csv[T] = [];
                            for (v = 0; v < u.length; v += 2)
                                G = u[v],
                                q.csv[T].push(G),
                                q.csv[T].push(u[v + 1]),
                                q.csv[T].push(G),
                                q.csv[T].push(-1);
                            q.csv[T] = ka(M, q.csv[T])
                        } else
                            q.csv[T] = M
                    }
        }
    }
    function ka(q, L) {
        for (var A = [], O = 0, P = 0; O < q.length && P < L.length; ) {
            var M = q[O] - L[P];
            0 < M ? (A.push(L[P++]),
            A.push(L[P++])) : 0 > M ? (A.push(q[O++]),
            A.push(q[O++])) : O += 2
        }
        A = P < L.length ? A.concat(L.slice(P)) : A.concat(q.slice(O));
        q = [];
        L = -2;
        for (O = 0; O < A.length; O += 2)
            if (P = A[O + 1],
            -1 != P || -1 != L)
                q.push(A[O]),
                q.push(P),
                L = P;
        return q
    }
    var za = {}
      , J = null
      , g = '<img style="vertical-align: bottom;" src="' + imgCDNUrl + 'filter.png">'
      , D = $(window).width()
      , N = !1
      , ba = function(q) {
        N || (N = !0,
        window.setTimeout(function() {
            var L = $(window).width();
            if (q || L != D) {
                D = L;
                for (var A in za)
                    if (L = za[A],
                    "stock" != L.type) {
                        var O = L.$container.parent().width();
                        0 != O && L.parentWidthCache != O && (L.parentWidthCache = O,
                        L.$container.css("width", 0),
                        L.preResizeHook && L.preResizeHook(),
                        L.parameter.width = float2int(O - L.parameter.offsetLeft - (L.showOnlyTracked ? 140 : 215)) + "px",
                        L.$container.css("width", L.parameter.width),
                        L.plot.resize(),
                        H(L, !1, !0),
                        r(L),
                        L.resizeHook && L.resizeHook())
                    }
                addon()
            }
            N = !1
        }, 100))
    };
    if ("undefined" == typeof isSnapshotPage)
        $(window).on("resize", function() {
            ba(!1)
        });
    return {
        prepare: function(q) {
            try {
                J = storage.showGraphs ? JSON.parse(storage.showGraphs) : null
            } catch (A) {
                J = null,
                reportBug(A)
            }
            null == J && (J = t(),
            storage.showGraphs = JSON.stringify(J),
            settings.send());
            var L = {
                csv: [],
                data: [],
                dataWithExtremes: [],
                stats: {},
                $container: null,
                series: m(q, "undefined" == typeof isSnapshotPage),
                domainId: q,
                asin: null,
                graphIndex: 0,
                plot: null,
                currencySymbol: null,
                syncedGraphs: [],
                type: "priceTypes",
                objectType: CsvType,
                resizeHook: null,
                preResizeHook: null,
                isOnTrackingPage: !1,
                showOnlyTracked: !1,
                axes: {
                    x: [{
                        mode: "time",
                        twelveHourClock: !1,
                        monthNames: la._79,
                        show: !0
                    }],
                    y: [{
                        index: 1,
                        tickDecimals: 0,
                        min: 0,
                        position: "left",
                        tickFormatter: function(A, O) {
                            return Money.format(A, {
                                sourceDomainId: q,
                                targetDomainId: q,
                                isDivided: !0,
                                noDigits: !0
                            }).replace(" ", "&nbsp;")
                        },
                        show: !1
                    }, {
                        index: 2,
                        tickDecimals: 0,
                        min: 0,
                        position: "right",
                        tickFormatter: function(A, O) {
                            return "#" + NumberUtil.format(A)
                        },
                        transform: "0" === storage.salesRankInverse ? null : function(A) {
                            return -A
                        }
                        ,
                        inverseTransform: "0" === storage.salesRankInverse ? null : function(A) {
                            return -A
                        }
                        ,
                        tickLength: 0,
                        show: !1
                    }, {
                        index: 3,
                        tickDecimals: 0,
                        position: "right",
                        tickFormatter: function(A, O) {
                            return NumberUtil.format(A)
                        },
                        show: !1
                    }, {
                        index: 4,
                        tickDecimals: 0,
                        alignTicksWithAxis: 0,
                        position: "right",
                        tickFormatter: function(A, O) {
                            return NumberUtil.format(A) + "%"
                        },
                        show: !1
                    }, {
                        index: 5,
                        tickDecimals: 0,
                        position: "left",
                        tickFormatter: function(A, O) {
                            return NumberUtil.format(A)
                        },
                        tickLength: 0,
                        show: !1
                    }, {
                        index: 6,
                        tickDecimals: 1,
                        position: "left",
                        tickFormatter: function(A, O) {
                            A = NumberUtil.format(A, 1);
                            return 5 < A || 1 > A ? "" : A + '<i style="color:#f1bb00;display: inline;margin-left:2px" class="fa fa-star"></i>'
                        },
                        tickLength: 0,
                        show: !1
                    }]
                },
                grid: {
                    color: "#444",
                    show: !0,
                    clickable: !0,
                    backgroundColor: null,
                    labelMargin: 4,
                    axisMargin: 3,
                    tickColor: "#eee",
                    borderWidth: 1,
                    borderColor: "#444",
                    hoverable: !0,
                    markings: a()
                },
                parameter: {
                    interval: Number(storage.s_range) || 2160,
                    forceInterval: !1,
                    scale: Number(storage.graphScale),
                    extreme: Number(storage.extremeFilter),
                    salesRankInverse: Number(storage.salesRankInverse),
                    height: "450px",
                    width: "100%",
                    showSymbols: !0,
                    showOfferLines: !0,
                    offsetLeft: 0
                },
                internal: {
                    nowMinutes: keepaTime.now(),
                    filteredExtremes: !1,
                    time: Date.now() + keepaTime.timeShiftOffset * keepaTime.precisionDevisor
                }
            };
            graphDateFormatIFrame = get("s_dateFormat");
            return L
        },
        create: p,
        getGraphObject: function(q, L, A, O) {
            return za[q + L + A + O]
        },
        setNewInterval: function(q) {
            for (var L in za) {
                var A = za[L];
                if (12 != L.length) {
                    var O = A.plot.getXAxes()[0].options
                      , P = A.internal.time;
                    A.parameter.interval = q;
                    for (var M = 0; M < A.syncedGraphs.length; M++)
                        A.syncedGraphs[M].$container.find(".legendRange").removeClass("active"),
                        A.syncedGraphs[M].$container.find(".legendRange[range=" + q + "]").addClass("active"),
                        A.syncedGraphs[M].$container.find(".legendRange[range=" + q + "]").addClass("active"),
                        A.syncedGraphs[M].parameter.interval = q;
                    S(A, O.min, O.max, P - 36E5 * q, P)
                }
            }
        },
        remove: function(q, L, A, O) {
            var P = za[q + L + A + O];
            P && (P.plot.shutdown(),
            P.syncedGraphs = [],
            delete za[q + L + A + O],
            P.$container.off())
        },
        redraw: H,
        removeAll: function() {
            for (var q in za)
                za[q].plot.shutdown();
            za = {}
        },
        updateYAxes: n,
        getDefaultShowGraphSetting: t,
        syncGraphAlignment: r,
        getLocaleSeriesTemplates: function(q) {
            q = m(!0, !0)[q];
            for (var L = {}, A = " #5B7837 #96A6CD #C85332 #593C68 #85D1AD #D1B547 #CAA68A #6D3A2A #84D551 #AA65D0 #CB5086 #42554F".split(" "), O = 0; O < numberOfDomains; O++)
                if (7 != O) {
                    var P = Object.assign({}, q);
                    P.series = Object.assign({}, q.series);
                    P.series.lines = Object.assign({}, q.series.lines);
                    P.series.points = Object.assign({}, q.series.points);
                    P.series.index = O;
                    P.series.label = LocaleType.getName(O);
                    P.series.labelText = P.series.label;
                    P.isDisabled = !0;
                    P.series.color = A[O];
                    P.series.lines.fill = !1;
                    P.series.lines.show = !0;
                    P.series.domain = O;
                    delete P.series.lines.fillColor;
                    var M = $.color.parse(P.series.color);
                    M.r = Math.round(M.r + .65 * (255 - M.r));
                    M.g = Math.round(M.g + .65 * (255 - M.g));
                    M.b = Math.round(M.b + .65 * (255 - M.b));
                    M.a = .8;
                    P.series.backgroundColor = M.toString();
                    L[P.series.label] = P
                }
            return L
        },
        getMerchantSeriesTemplates: function() {
            return {
                RATING: {
                    index: 0,
                    isDisabled: !1,
                    series: {
                        index: 0,
                        data: null,
                        label: MerchantType.getName(0),
                        labelText: MerchantType.getName(0),
                        lines: {
                            show: !0,
                            steps: !0,
                            fill: !1,
                            lineWidth: 1.5
                        },
                        hoverable: !1,
                        color: MerchantType.RATING.color,
                        backgroundColor: MerchantType.RATING.bg,
                        points: {
                            show: !1
                        },
                        dashes: {
                            show: !1
                        },
                        yaxis: 4,
                        isCurrency: MerchantType.RATING.currency,
                        formatter: function(q) {
                            return "<span>" + MerchantType.getName(0) + "</span><br>" + NumberUtil.format(q) + " %"
                        }
                    }
                },
                RATING_COUNT: {
                    index: 1,
                    isDisabled: !1,
                    series: {
                        index: 1,
                        data: null,
                        label: MerchantType.getName(1),
                        labelText: MerchantType.getName(1),
                        lines: {
                            show: !0,
                            steps: !0,
                            fill: !1,
                            lineWidth: 1.5
                        },
                        hoverable: !1,
                        color: MerchantType.RATING_COUNT.color,
                        backgroundColor: MerchantType.RATING_COUNT.bg,
                        points: {
                            show: !1
                        },
                        dashes: {
                            show: !1
                        },
                        yaxis: 3,
                        isCurrency: MerchantType.RATING_COUNT.currency
                    }
                },
                LISTINGS_COUNT: {
                    index: 2,
                    isDisabled: !1,
                    series: {
                        index: 2,
                        data: null,
                        label: MerchantType.getName(2),
                        labelText: MerchantType.getName(2),
                        lines: {
                            show: !0,
                            steps: !0,
                            lineWidth: 1.5
                        },
                        hoverable: !1,
                        points: {
                            show: !1
                        },
                        color: MerchantType.LISTINGS_COUNT.color,
                        backgroundColor: MerchantType.LISTINGS_COUNT.bg,
                        dashes: {
                            show: !1
                        },
                        yaxis: 5,
                        isCurrency: MerchantType.LISTINGS_COUNT.currency
                    }
                }
            }
        },
        insertOfferGraph: function(q, L, A, O, P) {
            try {
                var M = graph.prepare(q.domainId);
                M.asin = L;
                M.graphIndex = 5;
                M.updateCSV = [];
                M.parameter.interval = P ? P : 2160;
                M.parameter.forceInterval = !0;
                M.parameter.scale = 0;
                var u = {
                    STOCK: {
                        index: 0,
                        isDisabled: !1,
                        series: {
                            index: 0,
                            data: null,
                            label: OfferType.getName(0),
                            labelText: OfferType.getName(0),
                            lines: {
                                show: !0,
                                steps: !0,
                                fill: !1,
                                lineWidth: 1
                            },
                            hoverable: !1,
                            color: OfferType.STOCK.color,
                            backgroundColor: OfferType.STOCK.bg,
                            points: {
                                show: !0,
                                symbol: pointSymbols.lastPoint
                            },
                            dashes: {
                                show: !1
                            },
                            yaxis: 3,
                            isCurrency: !1
                        }
                    },
                    PRICE: {
                        index: 1,
                        isDisabled: !1,
                        series: {
                            index: 1,
                            data: null,
                            label: OfferType.getName(1),
                            labelText: OfferType.getName(1),
                            lines: {
                                show: !0,
                                steps: !0,
                                fill: !1,
                                lineWidth: 1
                            },
                            hoverable: !1,
                            color: CsvType.NEW.color,
                            backgroundColor: CsvType.NEW.bg,
                            points: {
                                show: !0,
                                symbol: pointSymbols.lastPoint
                            },
                            dashes: {
                                show: !1
                            },
                            yaxis: 1,
                            isCurrency: !0
                        }
                    }
                };
                M.series = u;
                var v = ConditionType.getCorrespondingCsvType(q.condition);
                null == v && (v = q.isFBA ? CsvType.NEW_FBA : CsvType.NEW_FBM_SHIPPING);
                q.isAmazon && (v = CsvType.AMAZON);
                q.isWarehouseDeal && (v = CsvType.WAREHOUSE);
                M.series.PRICE.series.color = v.color;
                M.series.PRICE.series.backgroundColor = v.bg;
                M.series.PRICE.series.label = M.series.PRICE.series.labelText = CsvType.getName(v.index);
                L = [];
                var G = keepaTime.now();
                "price" === O && (L[OfferType.PRICE.index] = q.offerCSV.slice(),
                (null == q.updateCSV || q.lastSeen != q.updateCSV[q.updateCSV.length - 2]) && 720 < G - q.lastSeen && L[OfferType.PRICE.index].push(q.lastSeen + 60, -1, -1));
                if ("stock" === O) {
                    L[OfferType.STOCK.index] = q.stockCSV ? q.stockCSV.slice() : null;
                    var w = L[OfferType.STOCK.index];
                    null == w && (w = [G, -1, -1]);
                    q.lastSeen != q.updateCSV[q.updateCSV.length - 2] && 720 < G - q.lastSeen && w.push(q.lastSeen + 60, -1, -1);
                    L[OfferType.STOCK.index] = w
                }
                M.csv = L;
                M.type = "stock";
                M.objectType = OfferType;
                M.showLegend = !1;
                M.$container = A;
                M.$container.show();
                M.parameter.offsetLeft = -30;
                M.parameter.width = "180px";
                M.parameter.height = "95px";
                if (null != q.updateCSV && "price" === O)
                    for (A = 0; A < q.updateCSV.length; A += 2) {
                        var B = q.updateCSV[A] + keepaTime.timeShiftOffset
                          , Q = (new Date(keepaTime.minutesToEpoch(B))).formatDate("M j, G:i");
                        M.grid.markings.push({
                            color: "#ff0098",
                            lineWidth: 1,
                            text: "offer data was updated on " + Q,
                            isUpdateMarker: !0,
                            xaxis: {
                                from: keepaTime.minutesToEpoch(B),
                                to: keepaTime.minutesToEpoch(B)
                            }
                        })
                    }
                p(M)
            } catch (fa) {
                console.log(fa)
            }
        },
        resizeGraphs: ba
    }
}();
var iframe = function() {
    function a() {
        $("#detailProductPage").hover(function() {
            $("#casinLine .casinLineContinent").css("opacity", "1")
        }, function() {
            $("#casinLine .casinLineContinent").css("opacity", "0.5")
        })
    }
    function b() {
        replaceHtml("initPage", '<div id="detailProductPage" class="detailProductPageIFrame"><table id="productTableIFrame"><tr><td style="vertical-align: top;"><div id="productTableDescriptionIFrame"></div></td></tr></table></div><div id="networkOverlay"><div id="networkBar"></div></div>')
    }
    function d() {
        if (z)
            if (get("s_boxHorizontal") || resetSettings(0),
            comparePricesOverlayActive = !1,
            compareCache = "",
            shareChartOverlayActive = !1,
            "1-0-B000000001" == lastSubUrl)
                b(),
                isSettings = !0,
                h("");
            else {
                F || (F = !0,
                "onhashchange"in window ? (hashChangeSupport = !0,
                window.onhashchange = I) : interval = window.setInterval(I, 100));
                keepaApp && (keepaApp.domainId ? lastSubUrl = keepaApp.domainId + "-0-" + keepaApp.asin : (reportBug(null, "iframe_app invalid data: " + JSON.stringify(keepaApp) + " localStorageIsPolyFill: " + localStorageIsPolyFill),
                $("#detailProductPage").html("app communication error.")));
                var pa = lastSubUrl.split("-");
                3 > pa.length && 2 < location.search.length && (pa = location.search.substring(1).split("-"));
                n = parseInt(pa[0]);
                sendInitTimeStat(n);
                if ((pa = (f = pa[2]) ? f.match(verifyRegExp.asin) : null) && !(10 > pa[1].length)) {
                    f = pa[1];
                    var ua = network.request({
                        path: "tracking/community",
                        version: 3,
                        type: "product",
                        asin: f,
                        maxAge: 0
                    })
                      , na = f
                      , qa = function(za) {
                        f == na && ua.always(function(J) {
                            za.trackings = J.comTrackings;
                            r && (r = !1);
                            f == na && m(za)
                        })
                    }
                      , ka = null;
                    sendReceive({
                        key: "getState"
                    }).done(function(za) {
                        ka = za.value
                    });
                    network.request({
                        path: "product",
                        history: !0,
                        type: "ws",
                        domainId: n,
                        asin: f,
                        maxAge: 3,
                        version: 3,
                        refreshProduct: r
                    }).done(function(za) {
                        if (f == na) {
                            var J = getProductFromList(f, za.products)
                              , g = null !== J ? J.csv[CsvType.SALES.index] : null
                              , D = null === g || null != g && 2 === g.length && -1 === g[1];
                            if (null != J && null != ka)
                                try {
                                    J.variationCSV = Object.keys(ka.asin_variation_values).join(",")
                                } catch (N) {
                                    reportBug(N, JSON.stringify(ka)),
                                    ka = null
                                }
                            null !== J && null !== J.parentAsin && null == J.variationCSV ? (isTest && console.log("loading parentAsin: " + J.parentAsin + " " + n),
                            network.request({
                                path: "product",
                                history: !0,
                                type: "ws",
                                domainId: n,
                                asin: J.parentAsin,
                                onlyParent: !0,
                                maxAge: 3,
                                version: 3,
                                refreshProduct: r
                            }).done(function(N) {
                                N = getProductFromList(J.parentAsin, N.products);
                                try {
                                    null != N.variationCSV && (null == J.variationCSV || J.variationCSV.length < N.variationCSV.length) && (J.variationCSV = N.variationCSV);
                                    var ba = null != N.csv && null != N.csv[CsvType.SALES.index] ? N.csv[CsvType.SALES.index].length : 0;
                                    if (D)
                                        J.csv[CsvType.SALES.index] = N.csv[CsvType.SALES.index],
                                        J.isParentSalesRank = 2 < ba;
                                    else if (2 < ba) {
                                        var q = keepaTime.now()
                                          , L = getWeightedMean(N.csv[CsvType.SALES.index], q, 30, CsvType.SALES)
                                          , A = getWeightedMean(J.csv[CsvType.SALES.index], q, 30, CsvType.SALES)
                                          , O = Math.min(L, A) / Math.max(L, A);
                                        .88 < O && (console.log("merged parent and child sales rank history", O),
                                        J.csv[CsvType.SALES.index] = mergeCSV(J.csv[CsvType.SALES.index], N.csv[CsvType.SALES.index], CsvType.SALES),
                                        J.isParentSalesRank = !0)
                                    }
                                } catch (P) {} finally {
                                    qa(za)
                                }
                            }).fail(function(N) {
                                qa(za)
                            })) : qa(za)
                        }
                    }).fail(function(za) {
                        b();
                        replaceHtml("productTableDescriptionIFrame", "server not responding: <br>" + la._error)
                    })
                }
            }
    }
    function h(pa, ua) {
        var na = "";
        if (null != ua)
            try {
                var qa = 0;
                null == ua.categories || 0 == ua.categories.length ? 0 < ua.rootCategory && ua.rootCategory < invalidIfLargerCatId && (qa = ua.rootCategory) : qa = ua.categories[0];
                0 < qa && (na = '<a href="' + rootURL + "#!bestseller/" + ua.domainId + "-" + qa + '" target="_blank">Related Best Sellers</a><span>&ensp;&#x271C;&ensp;</span>')
            } catch (N) {
                console.error(N)
            }
        na = '<a href="' + rootURL + '#!news" target="_blank">' + la._25 + '</a><span>&ensp;&#x271C;&ensp;</span><a href="' + (rootURL + '#!discuss" target="_blank">Support</a><span>&ensp;&#x271C;&ensp;</span><a href="') + (rootURL + '#!manage" target="_blank">' + la._239 + '</a><span>&ensp;&#x271C;&ensp;</span><a href="') + (rootURL + '#!finder" target="_blank">Product Finder</a><span>&ensp;&#x271C;&ensp;</span>') + pa + "<span>&ensp;&#x271C;&ensp;</span>" + na;
        qa = storage.username ? '<span id="keepaBoxSettings"></span>' : '<span id="keepaBoxLogin">' + la._9 + "</span>";
        var ka = 7 != storage.domain ? '<li class="tabItemI" class="hidden" id="tabMore" rel="more">Data</li>' : ""
          , za = null != ua && "Guild Product" !== ua.productGroup ? '<li class="tabSubItem" data-box="#MoreTab2">Offers</li>' : ""
          , J = null != ua && (null != ua.variationCSV && 12 < ua.variationCSV.length || null != ua.variations && 1 < ua.variations.length) ? '<li class="tabItemI" class="hidden" id="tabVariation" rel="more">' + la._747 + "</li>" : "";
        pa = null != ua && !isAWS && !(storage.email && 0 < storage.email.indexOf("@amazon.")) && K.includes(ua.domainId);
        na = '<div>\n\t\t\t\t<div>\n\t\t\t\t\t<div dir="rtl" id="keepaCopyright"><span id="keepaCopyrightWhitespace">-</span>' + la._272 + "<span>&ensp;&#x271C;&ensp;</span>" + na + qa + '</div>\n\t\t\t\t\t<ul id="tabHeadIFrame">\n\t\t\t\t\t\t<li class="tabItemI active" id="tabGraph" rel="graph">' + la._97 + '</li>\n\t\t\t\t\t\t<li class="tabItemI" id="tabTrack" rel="track">' + la._125 + "</li>\n\t\t\t\t\t\t" + ka + "\n\t\t\t\t\t\t" + J + "\n\t\t\t\t\t\t" + (pa ? '<li class="tabItemI" id="tabAffiliate" rel="affiliate">\n\t\t\t\t' + la._748 + "\n\t\t\t</li>" : "") + '\t\t\t\t\t\t\n\t\t\t\t\t\t<li class="tabItemI" id="tabSettings" rel="settings">' + la._8 + '</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<div id="tabContentIFrame">\n\t\t\t\t\t<div id="priceHistory" class="active"><div class="graph unselectable" id="graph"></div></div>\n\t\t\t\t\t<div id="track" class="productTrack" style="margin: 0 0 0 23px;"></div>\t\t\t\t\n\t\t\t\t\t<div id="more" class="hidden" style="margin-right:10px;min-height:60px;">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<ul id="tabHeadSub">\n\t\t\t\t\t\t\t\t<li class="tabSubItem active" data-box="#MoreTab1">Product Details</li>\n\t\t\t\t\t\t\t\t' + za + '\n\t\t\t\t\t\t\t\t<li class="tabSubItem" data-box="#MoreTab3">Buy Box Statistics</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="loadingIconAdv" style="position:absolute !important;left:185px;top:80px;"><div id="loadingProgress"></div></div>\n\t\t\t\t\t\t' + (0 == storage.accountType ? '<div style="margin:15px 0;color:#000;font-style:italic;">' + la._926 + "</div><br>" : "") + '\n\t\t\t\t\t\t<div style="margin-top: 20px;">\n\t\t\t\t\t\t\t<div id="MoreTab1" class="active"></div>\n\t\t\t\t\t\t\t<div id="MoreTab2" class="hidden"></div>\n\t\t\t\t\t\t\t<div id="MoreTab3" class="hidden"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="variation"></div>\n\t\t\t\t\t<div id="affiliateContent" class="block block--affiliate" style="display:none;"></div>\n\t\t\t\t\t<div id="settingsContent" style="display:none;" ></div>\n\t\t\t\t</div>\n\t\t\t</div>';
        keepaApp && replaceHtml("content", '<div id="priceHistory" class="active"><div class="graph unselectable" id="graph" style="margin-left:5px;margin:20px 0 15px 0;"></div></div><div id="legendInterval"></div>');
        replaceHtml("productTableDescriptionIFrame", na);
        na = $("#keepaBoxSettings");
        1 == na.length && (na[0].innerText = storage.username);
        setupQuotaWidget(!0);
        $("#variation").css({
            maxWidth: float2int($("#productTableDescriptionIFrame").width()) - 50 + "px",
            overflow: "auto"
        });
        $("#tabHeadSub").on("click", function(N) {
            N = $(N.target);
            N.hasClass("active") || (N.siblings(".active").removeClass("active"),
            N.addClass("active"),
            N = $(N.data("box")),
            N.siblings(".active").removeClass("active").addClass("hidden"),
            N.removeClass("hidden").addClass("active"),
            t(N.attr("id"), ua),
            addon("resize", 50 + float2int($("#initPage").height())))
        });
        $("#keepaBoxLogin").click(function() {
            registerAnonymous(!0)
        });
        $("#keepaBoxSettings").click(function() {
            window.open(rootURL + "#!channels")
        });
        insertSettings();
        na = '<br><span id="reload">' + la._279 + '</span><br><section id="settingsMore"><span>' + getLogoSVG(220) + '</span><br><span id="lfeedback">&rarr;&ensp;<a href="' + rootURL + '#!comment" target="blank">' + la._282 + "</a>&ensp;</span></section>";
        $("#settingsTab").after(na);
        var g = $("#tabContentIFrame")
          , D = $("#tabHeadIFrame");
        p = Number(get("s_boxVertical")) + 100;
        $("#tabGraph").click(function() {
            $(this).hasClass("active") || (g.children(".active").hide(0),
            g.children(".active").removeClass("active"),
            $("#priceHistory").addClass("active"),
            $("#priceHistory").fadeIn(),
            D.children().removeClass("active"),
            $("#tabGraph").addClass("active"),
            $("#subGraphButtons").show(0),
            $("#refreshProductBox").show(0),
            addon())
        });
        $("#tabTrack").click(function() {
            $(this).hasClass("active") || (0 === $("#track .tracking").length && (TrackingComponent.init({
                products: [ua]
            }),
            $("#grid-tools-variation").show(),
            $("#grid-wrapper-variation").show(),
            $("#grid-wrapper-variation-filter").show()),
            g.children(".active").hide(0),
            g.children(".active").removeClass("active"),
            $("#track").addClass("active"),
            $("#track").fadeIn(),
            D.children().removeClass("active"),
            $("#tabTrack").addClass("active"),
            TrackingComponent.addonResizeHook())
        });
        $("#tabVariation").on("click", function(N) {
            $(this).hasClass("active") || (g.css("height", ""),
            g.children(".active").hide(0).removeClass("active"),
            $("#variation").addClass("active").fadeIn().width($("#tabContent").width()),
            D.children().removeClass("active"),
            $("#tabVariation").addClass("active"),
            iframe.loadVariationMatrix(ua))
        });
        pa && $("#tabAffiliate").click(function() {
            $(this).hasClass("active") || (g.children(".active").hide(0).removeClass("active"),
            $("#affiliateContent").addClass("active").fadeIn(),
            D.children().removeClass("active"),
            $(this).addClass("active"),
            ea(),
            addon())
        });
        $("#tabSettings").click(function() {
            $(this).hasClass("active") || (g.children(".active").hide(0),
            g.children(".active").removeClass("active"),
            $("#settingsContent").addClass("active"),
            $("#settingsContent").fadeIn(),
            D.children().removeClass("active"),
            $("#tabSettings").addClass("active"),
            addon())
        });
        $("#tabHeadIFrame li").click(function() {
            $(".ag-cell-focus").length && $(".ag-cell-focus").contextMenu("hide")
        });
        isSettings && ($("#tabSettings").trigger("click"),
        $("#tabHeadIFrame").hide(),
        $("#reload").hide())
    }
    function m(pa) {
        b();
        var ua = keepaTime.now()
          , na = '<span id="refreshProductBox"><br>&emsp;&emsp;('
          , qa = ' <i id="refreshProduct" title="' + la._217 + '" class="fa fa-refresh fa-rotate-90" style="cursor: pointer;"></i>'
          , ka = pa.products;
        if (null == ka || 0 == ka.length)
            replaceHtml("productTableDescriptionIFrame", la._121);
        else {
            ka = getProductFromList(f, pa.products);
            var za = !0;
            try {
                30 > ua - ka.trackingSince && console.log("no historical data yet"),
                2 == ka.csv[0].length && -1 == ka.csv[0][1] && 2 == ka.csv[1].length && -1 == ka.csv[1][1] && 2 == ka.csv[2].length && -1 == ka.csv[2][1] && null == ka.csv[CsvType.COLLECTIBLE.index] && null == ka.csv[CsvType.REFURBISHED.index] && 2 == ka.csv[3].length && -1 == ka.csv[3][1] && ($("#graph").html('<span style="color:#ff6347; margin-left: 20px;"><i class="fa fa-exclamation-triangle" ></i>&emsp;Product never was in stock since we started tracking it.</span>').show(),
                za = !1)
            } catch (O) {
                za = !1
            }
            if (za)
                try {
                    ka.stats = getStatistics(ka)
                } catch (O) {
                    console.error(O)
                }
            var J = []
              , g = 13 == ka.domainId
              , D = function() {
                return addon("resize", "80px")
            };
            if (5 == ka.productType)
                null == ka.variationCSV || "" == ka.variationCSV ? replaceHtml("productTableDescriptionIFrame", la._121) : (addon("resize", "80px"),
                replaceHtml("productTableDescriptionIFrame", "<div>\u271c Keepa: Please select a specific variation of this product.</div><br>"),
                $(".childASINs").on("click", function() {
                    setTimeout(function() {
                        location.reload()
                    }, 10)
                }));
            else if (3 == ka.productType || g)
                pa = g ? "Keepa can sadly no longer update product data for Amazon." + getTldByDomain(ka.domainId) : la._341,
                za ? (replaceHtml("productTableDescriptionIFrame", '<div style="color:tomato;font-size: 16px;"><i class="fa fa-exclamation-triangle"></i>&emsp;' + pa + '</div><br>Below is our <strong>outdated</strong> historical data for this product:<br><br><div id="priceHistory" style="margin-bottom: 30px;" class="active"><div class="graph unselectable" id="graph"></div></div>'),
                pa = $("#graph"),
                na = graph.prepare(n),
                na.csv = ka.csv,
                na.salesRanks = ka.salesRanks,
                na.p = ka,
                na.salesRankCategoryTrees = ka.salesRankCategoryTrees,
                na.salesRankReference = ka.salesRankReference,
                na.salesRankCategories = ka.salesRankCategories,
                na.isParentSalesRank = ka.isParentSalesRank,
                na.asin = ka.ASIN,
                na.graphIndex = 0,
                na.syncedGraphs = J,
                J.push(na),
                na.stats = ka.stats,
                na.buyBoxSellerIdHistory = ka.buyBoxSellerIdHistory,
                na.offers = ka.offers,
                na.$container = pa,
                na.$container.show(),
                na.parameter.width = float2int(pa.parent().width()) - 200 + "px",
                na.parameter.interval = (ua - ka.trackingSince) / 60,
                na.parameter.forceInterval = !0,
                graph.create(na),
                addSubGraphMenu(ka, n, J),
                $("#casinLine").hide(),
                addon()) : (replaceHtml("productTableDescriptionIFrame", pa),
                D());
            else if (2 == ka.productType)
                replaceHtml("productTableDescriptionIFrame", la._395),
                D();
            else if (4 == ka.productType)
                replaceHtml("productTableDescriptionIFrame", la._341),
                D();
            else {
                ka.ASIN = f;
                ka.MANUFACTURER = ka.manufacturer;
                ka.TITLE = ka.title;
                ka.IMAGES = null == ka.imagesCSV ? [""] : ka.imagesCSV.split(",");
                ka.LASTUPDATE = ka.lastUpdate;
                null != ka.csv && (ka.AMAZON = ka.csv[CsvType.AMAZON.index],
                ka.MARKET_NEW = ka.csv[CsvType.NEW.index],
                ka.MARKET_USED = ka.csv[CsvType.USED.index],
                ka.SALESRANK = ka.csv[CsvType.SALES.index],
                ka.AMAZON_LAST = ka.AMAZON[ka.AMAZON.length - 1],
                ka.MARKET_NEW_LAST = ka.MARKET_NEW[ka.MARKET_NEW.length - 1],
                ka.MARKET_USED_LAST = ka.MARKET_USED[ka.MARKET_USED.length - 1]);
                ka.TYPE = ka.productType;
                addLightningDealBox(ka);
                D = 0;
                null == ka.AMAZON ? (E = !0,
                na += qa + ")</span>") : (E = !1,
                ka.AMAZON_LAST = ka.AMAZON[ka.AMAZON.length - 1],
                ka.MARKET_NEW_LAST = ka.MARKET_NEW[ka.MARKET_NEW.length - 1],
                ka.MARKET_USED_LAST = ka.MARKET_USED[ka.MARKET_USED.length - 1],
                D = Date.now() / 6E4 - (ka.lastUpdate + 60 * offsetHours),
                qa = 60 < D ? qa : "",
                na += la._123 + prettyDate(D) + qa + ")</span>");
                ka.ASIN = f;
                getCurrencyByDomain(n);
                graphShareURL = GraphService.getShareUrl(ka.asin, n);
                qa = "";
                if (ka.categories && 0 < ka.categories.length)
                    try {
                        var N = JSON.parse(JSON.stringify(dealWrapperInstance.get().loadRequest("last")));
                        null == N.includeCategories && (N.includeCategories = []);
                        N.includeCategories[ka.domainId] = ka.categories;
                        N.dateRange = 4;
                        qa = '<a href="https://keepa.com/#!deals/' + encodeURIComponent(JSON.stringify(N)) + '" target="blank">' + la._420 + "</a>"
                    } catch (O) {
                        reportBug(O)
                    }
                h(qa, ka);
                var ba = $("#tabContentIFrame")
                  , q = $("#tabHeadIFrame");
                $("#tabMore").click(function() {
                    if (!$(this).hasClass("active")) {
                        ba.css("height", "");
                        $("#subGraphButtons").hide(0);
                        $("#refreshProductBox").hide(0);
                        ba.children(".active").hide(0);
                        ba.children(".active").removeClass("active");
                        $("#more").addClass("active");
                        $("#more").fadeIn();
                        q.children().removeClass("active");
                        $("#tabMore").addClass("active");
                        var O = float2int($("#tabContentIFrame").height()) + 160;
                        addon("resize", O);
                        p = float2int($("#productTableIFrame").height());
                        t("MoreTab1", ka);
                        addon()
                    }
                });
                if (E)
                    ba.css("height", "60px"),
                    $("#tabHeadIFrame").hide(),
                    J = la._341,
                    2 == ka.TYPE && (J = la._395),
                    $("#graph").html('<div style="margin-left: 30px; font-size: 12px; color: #555"><i class="fa fa-exclamation-circle tomato fa-lg"></i>&emsp;' + J + "</div>").show("fast"),
                    addon("resize", 100);
                else {
                    if (!(isAWS || storage.email && 0 < storage.email.indexOf("@amazon."))) {
                        var L = getLastWithShipping(ka.csv[CsvType.EBAY_NEW_SHIPPING.index], CsvType.EBAY_NEW_SHIPPING);
                        qa = getLastWithShipping(ka.csv[CsvType.EBAY_USED_SHIPPING.index], CsvType.EBAY_USED_SHIPPING);
                        N = "";
                        if (0 < L[0]) {
                            g = Money.format(L[0] + L[1], {
                                sourceDomainId: n,
                                targetDomainId: n
                            });
                            var A = Money.format(L[0], {
                                sourceDomainId: n,
                                targetDomainId: n
                            });
                            L = 0 == L[1] ? 0 : Money.format(L[1], {
                                sourceDomainId: n,
                                targetDomainId: n
                            });
                            A = 0 === L ? "free shipping" : A + " + " + L + " shipping";
                            N += '<span class="productTableDescriptionPriceDescr">' + CsvType.getName(CsvType.EBAY_NEW_SHIPPING.index).replace(" \ud83d\ude9a", "") + ':</span>\n\t\t\t\t\t\t<span class="productTableDescriptionPrice priceEbayNew" title="' + A + '" style="color:' + CsvType.EBAY_NEW_SHIPPING.color + ';">' + g + "</span>"
                        }
                        0 < qa[0] && (g = Money.format(qa[0] + qa[1], {
                            sourceDomainId: n,
                            targetDomainId: n
                        }),
                        A = Money.format(qa[0], {
                            sourceDomainId: n,
                            targetDomainId: n
                        }),
                        qa = 0 == qa[1] ? 0 : Money.format(qa[1], {
                            sourceDomainId: n,
                            targetDomainId: n
                        }),
                        qa = 0 === qa ? "free shipping" : A + " + " + qa + " shipping",
                        N += '&emsp;<span class="productTableDescriptionPriceDescr">' + CsvType.getName(CsvType.EBAY_USED_SHIPPING.index).replace(" \ud83d\ude9a", "") + ':</span>\n\t\t\t\t\t\t<span class="productTableDescriptionPrice priceEbayUsed" title="' + qa + '" style="color:#000;">' + g + "</span>");
                        N && (N = '<span id="ebayLinkPriceHover">' + N + "</span>");
                        qa = "";
                        if (globalEbayArray[ka.domainId]) {
                            qa = "";
                            g = "unverified if sold on eBay";
                            if (44640 > ua - getLastTime(ka.csv[CsvType.EBAY_NEW_SHIPPING.index], CsvType.EBAY_NEW_SHIPPING) || 44640 > ua - getLastTime(ka.csv[CsvType.EBAY_USED_SHIPPING.index], CsvType.EBAY_USED_SHIPPING))
                                qa = 'style="color:#888"',
                                g = "show on eBay";
                            N && (g = "");
                            qa = '&emsp;&emsp;<li class="tabItemI tabExtern"><a id="ebayLink" target="_blank" href="' + getEbayRedirectByDomain(ka.domainId, ka.asin, !0) + '" rel="ebay" title="' + g + '" ' + qa + '>\u2192&ensp;<span>e</span><span style="margin-left: -2px;">b</span><span style="margin-left: -2px;">a</span><span style="margin-left: -2px;">y</span></a>';
                            $("#tabHeadIFrame").append(qa + N);
                            N && $("#ebayLink").hover(function() {
                                $("#ebayLinkPriceHover").show()
                            }, function() {
                                $("#ebayLinkPriceHover").hide()
                            })
                        }
                    }
                    ka.timeStamp = pa.timeStamp;
                    ka.trackingInfos = getTrackingInfos(n, pa.trackings, ka);
                    ua = Number(get("s_boxVertical"));
                    keepaApp && (ua = window.innerHeight - 80);
                    za && (za = $("#graph"),
                    N = graph.prepare(n),
                    ka.stats || (ka.stats = getStatistics(ka)),
                    N.csv = ka.csv,
                    N.salesRanks = ka.salesRanks,
                    N.p = ka,
                    N.salesRankCategoryTrees = ka.salesRankCategoryTrees,
                    N.isParentSalesRank = ka.isParentSalesRank,
                    N.salesRankReference = ka.salesRankReference,
                    N.salesRankCategories = ka.salesRankCategories,
                    N.asin = ka.ASIN,
                    N.graphIndex = 0,
                    N.stats = ka.stats,
                    N.buyBoxSellerIdHistory = ka.buyBoxSellerIdHistory,
                    N.offers = ka.offers,
                    N.axes.y[0].labelWidth = 60,
                    N.parameter.height = ua,
                    N.syncedGraphs = J,
                    J.push(N),
                    N.$container = za,
                    N.$container.show(),
                    null != ka.trackingInfos && ka.trackingInfos.isTrackedByUser && (N.parameter.tracking = ka.trackingInfos.userTracking),
                    N.parameter.width = float2int(za.parent().width()) - 220 + "px",
                    keepaApp && (N.parameter.width = float2int(za.parent().width()) - 150 + "px"),
                    graph.create(N),
                    addSubGraphMenu(ka, n, J),
                    $("#subGraphButtons").prepend(na),
                    ra(),
                    $("#refreshProduct").one("click", function() {
                        $("#refreshProduct").addClass("fa-spin");
                        r = !0;
                        d()
                    }));
                    if (!keepaApp)
                        if (360 < D) {
                            if (z) {
                                try {
                                    $($("#refreshProduct").get(0).previousSibling).replaceWith("<span>&emsp;&emsp;(&emsp;</span>"),
                                    $("#refreshProduct").trigger("click")
                                } catch (O) {
                                    console.error(O)
                                }
                                z = !1
                            }
                        } else
                            setTimeout(function() {
                                if (storage.previewCasin) {
                                    var O = function() {
                                        callCasin(function(P) {
                                            comparePricesLine(ka.ASIN, n, P)
                                        }, ka.ASIN, n, !0)
                                    };
                                    if (r)
                                        O();
                                    else
                                        $("#detailProductPage").one("mouseover", O)
                                }
                            }, 1);
                    $(window).width();
                    dataProduct = ka;
                    keepaApp || TrackingComponent.init(pa);
                    gotInterupted = !1;
                    try {
                        storage.noDataPromo && storage.removeItem("noDataPromo")
                    } catch (O) {}
                    addon()
                }
            }
        }
    }
    function t(pa, ua) {
        if (0 == storage.accountType)
            replaceHtml("MoreTab1", ""),
            replaceHtml("MoreTab2", "");
        else if (null == ua.proDeferred || "pending" !== ua.proDeferred.state())
            if (ua.proDeferred || (ua.proDeferred = $.Deferred()),
            "" !== $("#MoreTab1").html())
                1 > $("#" + pa).find(".grid-wrapper").length && Object.keys(H).length && ("MoreTab1" == pa ? aa() : "MoreTab2" == pa ? S() : V());
            else {
                $("#loadingIconAdv").show();
                addon("resize", 300 + float2int($("#initPage").height()));
                var na = !1
                  , qa = function(ka) {
                    var za = "Failed loading advanced product information.<br>" + la._error;
                    429 == ka.status && (za = quotaExceeded);
                    $("#loadingIconAdv").hide();
                    replaceHtml("MoreTab1", za);
                    replaceHtml("MoreTab2", za);
                    addDataUpdateHandler()
                };
                network.request({
                    path: "pro/product",
                    domainId: ua ? ua.domainId : n,
                    history: !0,
                    getSellersNoHistory: !0,
                    asin: ua ? ua.asin : f,
                    offerPages: 6,
                    type: "offers",
                    maxAge: 0,
                    version: 3
                }).progress(function(ka) {
                    na || replaceHtml("loadingProgress", ka + "%")
                }).always(function() {
                    na = !0;
                    ua.proDeferred.resolve()
                }).done(function(ka) {
                    $("#loadingIconAdv").hide();
                    "undefined" !== typeof ka.products && ka.products[0] ? (H = ka,
                    replaceHtml("MoreTab1", '<div style="display:flex;"><div id="grid-container-product-detail" class="on-white" style="flex: 0 1 auto;margin-right:23px"></div><div id="grid-container-product-price" class="on-white" style="flex: 0 1 auto;"></div></div>'),
                    replaceHtml("MoreTab2", '<div id="offerGrid" class="on-white"></div>'),
                    replaceHtml("MoreTab3", '<div id="grid-container-buy-box-history" class="on-white"></div>'),
                    ka = $("#tabHeadSub").find(".active").data("box"),
                    "#MoreTab1" === ka && aa(),
                    "#MoreTab2" === ka && S(),
                    "#MoreTab3" === ka && V()) : qa(ka)
                }).fail(function(ka) {
                    qa(ka)
                })
            }
    }
    setTimeout(function() {
        try {
            waitForExtensionStorage && !storagePolyFillHasData || onready(!1),
            sendReceive({
                key: "ping"
            }).done(function(pa) {
                isIframe && (iframe.parent = pa.location || pa.value.location)
            })
        } catch (pa) {
            console.log(pa),
            setTimeout(function() {
                onready(!1)
            }, 100)
        }
    }, 0);
    var f = ""
      , n = 1
      , r = !1
      , p = 0
      , z = !0
      , F = !1
      , I = function() {
        -1 < window.location.hash.substring(1).indexOf(f) || (lastSubUrl = window.location.hash.substring(1),
        $("#detailProductPage").html('<div style="margin-top: 60px">' + window.loader(.75, 1) + "</div>"),
        z = !0,
        d())
    }
      , E = !1
      , K = [1]
      , H = {}
      , V = function() {
        if (hasDataAccessSubscription && H.products[0].buyBoxSellerIdHistory && H.products[0].buyBoxSellerIdHistory.length)
            GridBuyBoxStatistics.init(H, "grid-container-buy-box-history").always(function() {
                return addon()
            });
        else {
            var pa = $("#grid-container-buy-box-history");
            pa.length && pa.html('<div style="margin:15px 0;color:#b30093;font-weight:500;font-style:italic;">The "Buy Box History" feature requires a Data Access subscription. You can get a monthly subscription <a href="https://keepa.com/#!settings/1"${iframe.isIframe ? \' target="_blank"\' : \'\'}>here</a>.</div>')
        }
    }
      , S = function() {
        GridOffer.init(H, "offerGrid").always(function() {
            return addon()
        })
    }
      , aa = function() {
        var pa = GridProductDetail.init(H, "grid-container-product-detail")
          , ua = GridProductPrice.init(H, "grid-container-product-price");
        addon("resize", "1000");
        $.when(pa, ua).always(addon)
    }
      , ea = function(pa) {
        var ua, na = $("#affiliateContent");
        if (pa || "" === na.html()) {
            na.html('<div id="loadingIcon"></div>');
            $("#loadingIcon").show();
            var qa = 0 == storage.accountType
              , ka = 1 == storage.accountType
              , za = function(ba) {
                showErrorPopup((ba.msg ? ba.msg + "<br>" : "") + (ba.error ? "[" + ba.error.type + "] " + ba.error.message + "<br>" : "") + "Status: " + ba.status)
            }
              , J = function(ba) {
                var q = ba.affiliateId
                  , L = {
                    sourceDomainId: 1,
                    targetDomainId: 1
                }
                  , A = Money.format(ba.referralFeeExtension, L)
                  , O = Money.format(ba.referralFeeData, L);
                Money.format(ba.referralFeeAPI, L);
                var P = "https://get.keepa.com/#type#" + q;
                q = P.replace("#type#", "e");
                var M = material.getRadio("affiliateExtension", la._750, !0, "affiliateType", !1, "e")
                  , u = material.getRadio("affiliateData", la._751, !1, "affiliateType", !1, "d");
                q = '<p class="mdc-typography--body2">' + la._752 + "</p>\n\t\t\t\t\t" + (qa || ka ? '<p class="mdc-typography--body2"><a class="link--register">&raquo; ' + la._749 + "</a></p>" : '<p class="mdc-typography--body2">' + la._753 + "</p>\n\t\t\t\t\t<div>" + M + u + '</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="promotionMessage black">\n\t\t\t\t\t\t<div class="copy-text">' + q + '</div>\n\t\t\t\t\t\t<span class="colorTip colorTipContainer"><span class="colorTipContent">' + la._754 + '</span><span class="pointyTipShadow"></span><span class="pointyTip"></span></span>\n\t\t\t\t\t\t<div class="promotionMessageIcon"><i class="fa fa-files-o"></i></div>\n\t\t\t\t\t</div><br><br>') + '\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<p class="mdc-typography--body2">' + la._755 + '</p>\n\t\t\t\t\t<ul class="mdc-typography--body2">\n\t\t\t\t\t\t<li>' + la._756 + '</li>\n\t\t\t\t\t\t<li class="affiliate-info affiliate-info--type-e">' + la._757.replace("{FEE}", "<nobr>" + A + "</nobr>") + '</li>\n\t\t\t\t\t\t<li class="affiliate-info affiliate-info--type-d" style="display:none;">' + la._758.replace("{FEE}", "<nobr>" + O + "</nobr>") + "</li>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<li>" + la._760 + "</li>\n\t\t\t\t\t</ul>\n\t\t\t\t";
                A = '<p class="mdc-typography--subtitle1">' + la._761 + '</p>\n\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th></th>\n\t\t\t\t\t\t\t\t<th class="cell--number">' + la._762 + '</th>\n\t\t\t\t\t\t\t\t<th class="cell--number" title="' + la._773.replace(/\. /g, ".<br>") + '">' + la._763 + '</th>\n\t\t\t\t\t\t\t\t<th class="cell--number">' + la._764 + '</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td title="' + la._765.replace("{FEE}", A) + '">' + la._750 + ' <i class="fa fa-info"></i></td>\n\t\t\t\t\t\t\t\t<td class="cell--number">' + ba.totalExtensionClicks + '</td>\n\t\t\t\t\t\t\t\t<td class="cell--number">' + ba.pendingExtension + '</td>\n\t\t\t\t\t\t\t\t<td class="cell--number">' + ba.extensionReferrals + '</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td title="' + la._765.replace("{FEE}", O) + '">' + la._751 + ' <i class="fa fa-info"></i></td>\n\t\t\t\t\t\t\t\t<td class="cell--number">' + ba.totalDataClicks + '</td>\n\t\t\t\t\t\t\t\t<td class="cell--number">' + ba.pendingData + '</td>\n\t\t\t\t\t\t\t\t<td class="cell--number">' + ba.dataUsers + "</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</table>\n\t\t\t\t\t";
                O = "\n\t\t\t\t\t\t" + (null != ba.balance && 0 < ba.balance ? '<p class="mdc-typography--body2">\n\t\t\t\t\t\t\t\t' + la._766 + "&emsp;\n\t\t\t\t\t\t\t\t<span>" + Money.format(ba.balance, L) + '</span>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p class="mdc-typography--body2">' + material.getButton("requestPayout", la._767, "", "money") + "</p>" : '<p class="mdc-typography--body2">' + la._768 + "</p>") + "\n\t\t\t\t\t";
                M = "";
                if (ba.payments && ba.payments.length) {
                    M = "";
                    for (u = ba.payments.length - 1; 0 <= u; u--) {
                        var v = ba.payments[u];
                        M += "<tr>\n\t\t\t\t\t\t\t\t<td>" + (new Date(v.createDate)).formatDate("M j, Y") + "</td>\n\t\t\t\t\t\t\t\t<td>Amazon." + getTldByDomain(v.quantity) + '</td>\n\t\t\t\t\t\t\t\t<td class="cell--number">' + Money.format(v.totalBill, L) + "</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t"
                    }
                    M = '<br><p class="mdc-typography--body2">' + la._802 + ":</p>\n\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<th>" + la._803 + "</th>\n\t\t\t\t\t\t\t\t\t<th>" + la._804 + '</th>\n\t\t\t\t\t\t\t\t\t<th class="cell--number">' + la._805 + "</th>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t" + M + "\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t"
                }
                na.html('<h6 class="mdc-typography--headline6">Keepa ' + la._779 + "</h6>\n\t\t\t\t\t\t<section>" + q + "</section><hr>\n\t\t\t\t\t\t\t<section>\n\t\t\t\t\t\t\t" + A + "\n\t\t\t\t\t\t\t" + O + "\n\t\t\t\t\t\t\t" + M + '\n\t\t\t\t\t\t</section><hr>\n\t\t\t\t\t\t<section><p class="mdc-typography--subtitle1">' + (la._769 + '</p>\n\t\t\t\t\t\t<p class="mdc-typography--body2">' + la._770 + '</p>\n\t\t\t\t\t\t<p class="mdc-typography--body2">' + la._771 + '</p>\n\t\t\t\t\t\t<p class="mdc-typography--body2" style="font-size:0.8em;line-height:0.9rem;">' + la._772 + '</p>\n\t\t\t\t\t\t<ul class="mdc-typography--body2" style="font-size:0.8em;line-height:0.9rem;">\n\t\t\t\t\t\t\t<li>' + la._773 + "</li>\n\t\t\t\t\t\t\t<li>" + la._774 + "</li>\n\t\t\t\t\t\t\t<li>" + la._775 + "</li>\n\t\t\t\t\t\t\t<li>" + la._776 + "</li>\n\t\t\t\t\t\t\t<li>" + la._777 + "</li>\n\t\t\t\t\t\t\t<li>" + la._778 + "</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</section>\n\t\t\t\t\t"));
                addon();
                ba = $(".block--affiliate .promotionMessage");
                var G = ba.find(".copy-text")
                  , w = ba.find(".colorTip");
                ba.click(function() {
                    try {
                        navigator.clipboard.writeText(G.html())
                    } catch (Q) {
                        selectText(G.get(0)),
                        document.execCommand("copy")
                    }
                    var B = -18 - w.height();
                    -40 > B && (B -= 3);
                    w.css({
                        marginLeft: -w.outerWidth() / 2,
                        top: B
                    }).show()
                });
                ba.mouseout(function() {
                    setTimeout(function() {
                        w.fadeOut(200)
                    }, 300)
                });
                $('input[name="affiliateType"]').on("change", function() {
                    var B = $(this).val();
                    G.html(P.replace("#type#", B));
                    $(".block--affiliate .affiliate-info").hide();
                    $(".block--affiliate .affiliate-info--type-" + B).show()
                });
                $(".block--affiliate td, .block--affiliate th").colorTip({
                    color: "facebook"
                });
                $("#requestPayout").on("click", function() {
                    g()
                });
                $(".link--register").on("click", function() {
                    registerAnonymous()
                })
            }
              , g = function() {
                var ba = network.request({
                    path: "service/stripe",
                    type: "location",
                    dashboard: "data",
                    version: 3
                });
                network.request({
                    path: "service/stripe",
                    type: "countries",
                    dashboard: "data",
                    version: 3
                }).done(function(q) {
                    ba.done(function(L) {
                        var A = la._780;
                        L = D(q.countries, L.json ? tryParseJSON(L.json) : null);
                        ua = showPopup(A, L, !0);
                        ua.promise.always(function() {
                            ea(!0)
                        });
                        addon()
                    })
                }).fail(function() {
                    showErrorPopup()
                })
            }
              , D = function(ba, q) {
                var L = material.getRadio("individual", la._781, !0, "bcb"), A = material.getRadio("business", la._782, !1, "bcb", !0, !1, la._783), O = '<div style="width:204px;">' + material.getInput(!0, "\\S{3,}.*", "formName", la._784, "name", "billing-name", la._785, !1, !0) + "</div>", P = '<div style="width:384px;">' + material.getInput(!0, "\\S{2,}.*", "formAddress", la._786, "billing street-address", "billing-address", la._787, !1, !0) + "</div>", M = "<div>" + material.getInput(!0, "\\S{2,}.*", "formCity", la._788, "billing address-level2", "billing-city", la._789, !1, !0) + "</div>", u = "<div>" + material.getInput(!0, "\\S{2,}.*", "formPostcode", la._790, "billing postal-code", "billing-zip", la._791, !1, !0) + "</div>", v = [], G;
                for (G in priceDataAPI.statesUS)
                    v.push({
                        value: G,
                        label: G
                    });
                v = '<div style="margin-top:12px;" id="formStateWrapper">' + material.getSelect("formState", "billing-state", "", v, "State", !1, !0) + "</div>";
                ba = material.getCountrySelect(ba, q ? q.country_code : "");
                q = [];
                for (G = 1; G < numberOfDomains; G++)
                    7 != G && K.includes(G) && q.push({
                        value: G,
                        label: "Amazon." + getTldByDomain(G)
                    });
                q = material.getSelect("domainSelect", "payout-domain", "", q, la._792, !1, !0);
                G = material.getButton("submitAffiliate", la._793, "amazon");
                L = '<div id="payoutFormWrapper" class="block block--affiliate-form">\n\t\t\t\t\t<form id="payoutForm">\n\t\t\t\t\t\t<section id="b2bRadio" >' + L + A + '</section>\n\t\t\t\t\t\t<div class="flex">' + O + P + '</div>\n\t\t\t\t\t\t<div class="flex" style="justify-content: space-between;">' + ba + '<div class="flex" style="width: 384px;justify-content: space-between;">' + M + u + v + "</div></div>\n\t\t\t\t\t\t<div>" + la._794 + "*&emsp;" + q + '</div>\n\t\t\t\t\t\t<div id="submitAffiliateWrapper" style="margin:20px 0;">' + G + '</div>\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t<p class="mdc-typography--body2"><b>' + la._795 + "</b><br>" + la._796 + "</p>\t\t\n\t\t\t\t\t</form>\n\t\t\t\t</div>";
                material.init("#payoutForm");
                setTimeout(function() {
                    var w = null;
                    isTest && "localhost" === document.location.hostname && "63342" === document.location.port && (w = "anything");
                    var B = $("#countrySelect")
                      , Q = function() {
                        var fa = "US" == $(B.find(":selected")).attr("id")
                          , R = $("#formStateWrapper")
                          , T = R.find("select");
                        fa ? (T.prop("disabled", !1),
                        T.prop("required", !0),
                        R.css({
                            visibility: "visible"
                        })) : (T.val(""),
                        T.prop("disabled", !0),
                        T.prop("required", !1),
                        R.css({
                            visibility: "hidden"
                        }))
                    };
                    B.on("change", Q);
                    Q();
                    $("#payoutForm").on("submit", function(fa) {
                        fa.preventDefault();
                        if (w)
                            N();
                        else {
                            fa = getSocialLoginURL("amazonLogin", "", "0");
                            window.open(fa, popupName, popupSettings);
                            var R = "affiliateAmazonLink" + Date.now();
                            loginCallbacks[R] = function(T) {
                                delete loginCallbacks[R];
                                T ? network.request({
                                    path: "user/settings",
                                    type: "getSettings",
                                    version: 3
                                }).done(function(oa) {
                                    setTimeout(function() {
                                        $("#tabAffiliate").trigger("click")
                                    }, 100);
                                    w = oa.user.amazonEmailAddress || oa.user.amazonUsername;
                                    oa = $("#submitAffiliateWrapper");
                                    oa.siblings().hide();
                                    oa.html('\n\t\t\t\t\t\t\t\t\t\t\t<p class="mdc-typography--body2">\n\t\t\t\t\t\t\t\t\t\t\t\t' + la._797 + ":&emsp;<span>" + w + "</span><br>\n\t\t\t\t\t\t\t\t\t\t\t\t" + la._798.replace("{SUBMIT}", la._225) + '\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t<a id="submitAffiliate" class="mdc-button mdc-button--raised mdc-button--primary" data-mdc-auto-init="MDCRipple">\n\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-check"></i>&ensp;' + la._225 + "</a>");
                                    addon();
                                    var Z = !1;
                                    $("#submitAffiliate").on("click", function(ja) {
                                        ja.preventDefault();
                                        Z || (Z = !0,
                                        N())
                                    })
                                }).fail(function(oa) {
                                    za(oa)
                                }) : isTest && console.log("@todo:", "handleAmazonLoginFailed?")
                            }
                        }
                    })
                }, 0);
                return L
            }
              , N = function() {
                var ba = $("#payoutForm")
                  , q = {
                    billingContact: ba.find("#formName").val(),
                    billingCountry: ba.find("#countrySelect").find(":selected")[0].getAttribute("data-country"),
                    billingCity: ba.find("#formCity").val(),
                    billingStreet: ba.find("#formAddress").val(),
                    billingZipCode: ba.find("#formPostcode").val(),
                    billingBusiness: !1
                };
                replaceHtml("payoutFormWrapper", '<div id="loadingIcon"></div>');
                $("#loadingIcon").show();
                addon();
                ba = {
                    path: "user/affiliate",
                    type: "payout",
                    content: JSON.stringify(q),
                    domainId: Number(ba.find("#domainSelect").val()),
                    version: 3
                };
                isTest && console.info("%payoutRequest:", "color:#8A2BE2;font-weight:bold;", ba);
                network.request(ba).done(function(L) {
                    isTest && console.info("%cpayoutRequest response:", "color:#8A2BE2;font-weight:bold;", L);
                    var A = "";
                    A = L.error || "undefined" === typeof L.affiliate || null == L.affiliate ? '<span class="tomato">' + la._799 + "</span>" : la._800;
                    L = material.getButton("closePopup", la._801, "window-close", null, !1, !1);
                    replaceHtml("payoutFormWrapper", '<p class="mdc-typography--body2">' + A + "</p><div>" + L + "</div>");
                    addon();
                    $("#closePopup").on("click", function(O) {
                        O.preventDefault();
                        ua.close();
                        ea(!0)
                    })
                }).fail(function(L) {
                    za(L)
                })
            };
            network.request({
                path: "user/affiliate",
                type: "get",
                version: 3
            }).done(function(ba) {
                var q = ba.affiliate;
                isTest && console.info("%cAffiliate:", "color:#8A2BE2;font-weight:bold;", q);
                ba.error || "undefined" === typeof q || null == q ? za(ba) : J(q)
            }).fail(function(ba) {
                401 === ba.status && "undefined" !== typeof ba.affiliate && null !== ba.affiliate ? J(ba.affiliate) : za(ba)
            })
        }
    }
      , ra = function() {
        var pa = Date.now();
        if (Date.now() < (new Date("2018/11/27 16:00:00")).getTime()) {
            pa = '<div style="text-align: center;">\n\t\t\t\t\t<div class="promotionMessage black">\n\t\t\t\t\t\t<div class="copy-text">get.keepa.com</div>\n\t\t\t\t\t\t<div class="copy-text-full" style="display:none;">Amazon Price Tracker Keepa: https://get.keepa.com</div>\n\t\t\t\t\t\t<span class="colorTip colorTipContainer"><span class="colorTipContent">Copied to clipboard!</span><span class="pointyTipShadow"></span><span class="pointyTip"></span></span>\n\t\t\t\t\t\t<div class="promotionMessageIcon"><i class="fa fa-files-o"></i></div>\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<br><span style="margin-top: 5px;display: inline-block;">' + (pa < (new Date("2018/11/24 16:00:00")).getTime() ? "<b>Black Friday</b> is on November 23rd!" : "<b>Cyber Monday</b> is on November 26th!") + ' Share Keepa with friends and family to help them save!</span>\n\t\t\t\t\t<br><span style="font-size: 10px;color: #7b7b7b;display: inline-block;">(get.keepa.com is an automatic redirect to our browser extension for the respective browser being used)</span>\n\t\t\t\t</div>';
            $("#casinLine").after(pa);
            pa = $(".promotionMessage");
            var ua = pa.find(".colorTip");
            pa.click(function() {
                var na = $(".copy-text-full");
                try {
                    navigator.clipboard.writeText(na.html())
                } catch (qa) {
                    selectText(na.get(0)),
                    document.execCommand("copy")
                }
                na = -18 - ua.height();
                -40 > na && (na -= 3);
                ua.css({
                    marginLeft: -ua.outerWidth() / 2,
                    top: na
                }).show()
            });
            pa.mouseout(function() {
                setTimeout(function() {
                    ua.fadeOut(200)
                }, 300)
            })
        }
    };
    return {
        init: function() {
            lastSubUrl = window.location.hash.substring(1);
            d();
            sendHelloGraph();
            a();
            window.addEventListener("unload", function() {
                addon = function() {}
            }, !1)
        },
        load: d,
        loadVariationMatrix: function(pa) {
            if ("" !== $("#variation").html())
                addon();
            else {
                var ua = [];
                pa.parentAsin && pa.variationCSV && (ua = pa.variationCSV.split(","));
                1 < ua.length ? (replaceHtml("variation", '<div id="loadingFlipper" style="display: flex;justify-content: center;margin: 80px;flex-direction: column;align-content: center;align-items: center;"><div style="position: relative;width: 50px;display: block;margin-bottom: 50px;"><div class="cssload-box-loading"></div></div><div id="loadingProgress"></div></div>'),
                network.request({
                    path: "product",
                    type: "variation",
                    version: 3,
                    asin: pa.parentAsin,
                    domainId: pa.domainId,
                    history: !1,
                    maxAge: 0,
                    refreshProduct: !1
                }).done(function(na) {
                    var qa = [];
                    null !== na.products && "undefined" !== typeof na.products && 0 < na.products.length && (qa = na.products);
                    replaceHtml("variation", '<div id="variationGrid" class="on-white"></div>');
                    GridVariation.init(qa, "variationGrid").always(addon)
                }).fail(function() {
                    replaceHtml("variation", "Failed loading advanced product information.<br>" + la._error)
                })) : replaceHtml("variation", "No variations available.")
            }
        },
        initGridBuyBoxStatistics: V,
        initGridOffer: S,
        initGridProductDetail: aa,
        loadDataOffers: t,
        getIframeHeight: function() {
            return p
        },
        isIframe: isIframe
    }
}()
  , firefox = !1
  , gotInterupted = !1;
function loadProductIFrame() {
    iframe.load()
}
var addonCache = []
  , prevResize = 0;
function addon(a, b) {
    if ("undefined" == typeof a || "resize" == a && "undefined" == typeof b)
        a = "resize",
        b = float2int($("#initPage").height());
    try {
        if ("resize" != a || b != prevResize)
            "resize" == a && (prevResize = b),
            window.parent.postMessage({
                key: a,
                value: b,
                origin: "keepaIframe",
                location: "" + document.location
            }, "*"),
            addonCache[a] = b
    } catch (d) {}
}
function syncAddonDOM(a) {
    addon = a
}
;